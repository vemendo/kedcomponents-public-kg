var testpagecoursebuilder=function(e){function t(t){for(var a,o,i=t[0],l=t[1],c=t[2],d=0,m=[];d<i.length;d++)o=i[d],r[o]&&m.push(r[o][0]),r[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);m.length;)m.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={2:0},s=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window.webpackJsonp_name_=window.webpackJsonp_name_||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;return s.push([89,0]),n()}([function(e,t){e.exports=React},,function(e,t,n){"use strict";function a(e){for(var t=0,n=e.length;t<n;++t)if(e.charCodeAt(t)<8192)return e.substr(0,t)+e[t].toLocaleUpperCase()+e.substr(t+1);return e}function r(e,t){return"object"!=typeof t?e:(Object.keys(t).forEach(function(n){e[n]=t[n]}),e)}function s(e,t){var n={};return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),t&&r(n,t),n}n.d(t,"d",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"k",function(){return i}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"i",function(){return d}),n.d(t,"n",function(){return m}),n.d(t,"m",function(){return p}),n.d(t,"l",function(){return h}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"e",function(){return v}),n.d(t,"j",function(){return g});var o=[].concat;function i(e){return o.apply([],e)}function l(e){return function(t,n){var a=t[e],r=n[e];return a>r?1:a<r?-1:0}}function c(e,t,n){return(e=Array.isArray(e)?e:[e]).map(function(e){return function(a,r){return function(e,a){return"string"==typeof e?e.localeCompare(a,t,n):e<a?-1:e>a?1:0}(a[e],r[e])}}).reduce(function(e,t){return function(n,a){return e(n,a)||t(n,a)}})}function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e[0];return function(e,t){for(var n=e[0],a=1,r=e.length;a<r;++a)n+=t[a-1]+e[a];return n}(e,t)}function d(e,t){var n;return"string"==typeof t&&(n=/\/Date\((\d*)\)\//.exec(t))?new Date(+n[1]):t}function m(e){var t=new CustomEvent("info",{detail:e});window.dispatchEvent(t)}function p(e){var t="string"==typeof e?e:e.message,n=new CustomEvent("customerror",{detail:t});console.error(e),window.dispatchEvent(n)}function h(e,t){return e.length>t?e.substr(0,t-3)+"...":e}function f(e,t){for(var n={},a=0,r=e.length;a<r;++a){var s=e[a],o=t(s),i=n[o];i?i.push(s):n[o]=[s]}return n}function b(e,t){for(var n={},a=0,r=e.length;a<r;++a){var s=e[a];n[t(s)]=s}return n}function v(e,t){for(var n={},a=0,r=t;a<r.length;a++){var s=r[a];s in e&&(n[s]=e[s])}return n}function g(e,t){var n=b(e,t);return Object.keys(n).map(function(e){return n[e]})}},function(e,t,n){"use strict";var a="undefined"==typeof KED?{}:KED;"undefined"!=typeof window&&"undefined"==typeof KED&&(window.KED=a);var r=a;r.env||(r.env={});t.a=r.env},,,function(e,t,n){"use strict";var a=n(23);n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return a.b}),n.d(t,"c",function(){return a.c}),n.d(t,"d",function(){return a.e}),n.d(t,"e",function(){return a.f}),n.d(t,"f",function(){return a.g})},,function(e,t){e.exports=jQuery},function(e,t,n){"use strict";var a=n(21);a.a.cfg||(a.a.cfg={}),t.a=a.a.cfg},function(e,t,n){"use strict";function a(e,t){var n=(t||{}).toLower,a={};return e&&e.length>1&&e.substr(1).split("&").map(function(e){return e.split("=").map(function(e){return decodeURIComponent(e.trim())})}).forEach(function(e){var t=e[0],r=e[1];return a[n?t.toLowerCase():t]=r}),a}function r(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}function s(e){return"?"+r(e)}function o(e){var t=e.indexOf("?");return t>=0?[e.substr(0,t),e.substr(t)]:[e,""]}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return o})},function(e,t,n){"use strict";n.d(t,"j",function(){return m}),n.d(t,"c",function(){return p}),n.d(t,"g",function(){return h}),n.d(t,"l",function(){return f}),n.d(t,"i",function(){return b}),n.d(t,"k",function(){return v}),n.d(t,"b",function(){return g}),n.d(t,"f",function(){return E}),n.d(t,"e",function(){return y}),n.d(t,"a",function(){return N}),n.d(t,"h",function(){return C}),n.d(t,"d",function(){return D});var a=n(1),r=n(5),s=n.n(r),o=n(6),i=n(22),l=n.n(i),c=n(8),u=n.n(c),d=n(3);function m(e,t,n,r,s){for(var i={},c=t.id,u=function(l){var u=r[l],d=e[l]||[],m=t[l];if(!m)return"continue";for(var p=m.map(function(e,t){return{doc:e,idx:t}}),h=0,f=p.filter(function(e){return!d.some(function(t){return t.id===e.doc.id})});h<f.length;h++){var b=f[h],v=(C=a.a({},b.doc)).$meta;delete C.$meta,"add"===v?(C.id||(C.id=Object(o.e)()),s.add(u,C)):"update"===v&&s.put(u,C),s.link(n,c,u,C.id,l),i[l]||(i[l]={}),i[l][b.idx]={$set:C}}for(var g=0,k=d.filter(function(e){return!m.some(function(t){return t.id===e.id})});g<k.length;g++){var E=k[g];s.unlink(n,c,u,E.id,l)}for(var y=0,N=p.filter(function(e){return d.some(function(t){return t.id===e.doc.id&&"update"===e.doc.$meta})});y<N.length;y++){var C,D=N[y];delete(C=a.a({},D.doc)).$meta,s.put(u,C),i[l]||(i[l]={}),i[l][D.idx]={$set:C}}},d=0,m=Object.keys(r);d<m.length;d++){u(m[d])}return l()(t,i)}function p(e){return s()(e).format("YYMMDD HH:mm")}function h(e){return s()(e).format("YYMMDD")}function f(e,t,n){return l()(t,{dateTime:{$set:e},modifiedDate:{$set:e},modifiedBy:{$set:{name:n.displayName,url:"mailto:"+n.mail}}})}function b(e,t,n){return l()(t,{createdDate:{$set:Date.now()},createdBy:{$set:{name:n.displayName,url:"mailto:"+n.mail}}})}function v(e,t){var n=Date.now();return(e=f(n,e,t)).createdBy||(e=b(0,e,t)),e}function g(e,t,n){var r=a.a({},e),s=t[e.id];s&&(r.$etag=s);for(var o=0,i=n;o<i.length;o++){var l=i[o],c=e[l].map(function(e){return g(e,t,[])});r[l]=c}return r}function k(e,t){return new Promise(function(e,n){var a=new FileReader;a.onload=function(t){return e(t.target.result)},a.onabort=function(e){return n(new Error("file read aborted"))},a.onerror=function(e){return n(e.target.error)},t(a)})}function E(e){return k(0,function(t){return t.readAsText(e)})}function y(e){return k(0,function(t){return t.readAsDataURL(e)})}function N(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function C(e){var t=u()("div.course-builder")[0];t&&(t.className="course-builder"+(e?" status "+e:""))}function D(e,t){return a.b(this,void 0,void 0,function(){var n,r,s,o,i,l;return a.d(this,function(a){switch(a.label){case 0:return n=d.a.kedBackendClient,r=t&&t.includeTemplateChain,[4,Promise.all([n.get("courses",e,{include:["centralContent","knowledgeRequirements","abilities","images","acl"]}),n.list("tasks",{hasEdgesFrom:e,include:["knowledgeRequirements","centralContent","abilities","acl"],flags:["includeIdsOnly"]}),r&&n.list("courses",{hasEdgesFrom:e,flags:["idsOnly"]})])];case 1:return s=a.sent(),o=s[0],i=s[1],l=s[2],o.tasks=i,o.knowledgeRequirementsOrder&&(o.knowledgeRequirements=o.knowledgeRequirementsOrder.map(function(e){return o.knowledgeRequirements.find(function(t){return t.id===e})})),o.centralContentOrder&&(o.centralContent=o.centralContentOrder.map(function(e){return o.centralContent.find(function(t){return t.id===e})})),r&&(o.templateChain=l),[2,o]}})})}},function(e,t,n){"use strict";var a=n(1),r=n(6);function s(e){return[{type:"email",value:e.mail},{type:"school",value:e.school}].concat(e.roles.map(function(e){return{type:"role",value:e}})).concat(e.roles.map(function(t){return{type:"schoolRole",value:e.school+"/"+t}}))}var o=n(3),i=n(10);n.d(t,"a",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"b",function(){return p}),n.d(t,"e",function(){return h}),n.d(t,!1,function(){return s});var l=["user","role","school","debug","testVersion","testversion","schoolType","schooltype"];function c(e,t){var n=s(o.a.currentUser);return Object(r.f)(r.b.fromStringArray(e.acl||[]),n,t)}function u(e){return c(e,"W")}function d(e){var t=o.a.currentUser.roles.some(function(e){return"EMPLOYEE"===e||"ADMIN"===e}),n=(e||"").toLowerCase()===o.a.currentUser.school.toLowerCase();return t&&n}var m={actAs:function(e){var t=e.role,n=e.school,r=e.url,s=Object(i.b)(location.search),o=a.a({},s,{role:t,school:n}),l=Object(i.a)(o);r?location.href=""+r+l:(location.hash="#",location.search=l)}};function p(e){m.actAs(e)}function h(e,t){for(var n=Object(i.b)(location.search),r=a.a({},t),s=0,o=l;s<o.length;s++){var c=o[s];n[c]&&(r[c]=n[c])}return""+e+Object(i.a)(r)}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(0),r=function(){return a.createElement("span",null,a.createElement("i",{className:"fa fa-spinner fa-spin","aria-hidden":"true"})," ")}},function(e,t,n){"use strict";function a(){var e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:7&n|8).toString(16)})}function r(e){var t=null;return function(){return t||(t=e.apply(this,arguments).then(function(e){return t=null,e})),t}}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return l});var a=n(5),r=n.n(a);function s(e){return"AT"===e?[32,51]:[1,25]}function o(e){return e.month()>=7?[r()(new Date(e.year(),7,1)),r()(new Date(e.year(),11,31))]:[r()(new Date(e.year(),0,1)),r()(new Date(e.year(),6,31))]}function i(e){var t=e.year(),n=e.month()>=7,a=n?[t,t+1]:[t-1,t];return{academicYear:a[0]+"/"+a[1],term:n?"AT":"ST",week:e.week()}}function l(e,t){return e.split("/").map(function(e){return parseInt(e)+t}).map(function(e){return""+e}).join("/")}},,function(e,t,n){"use strict";var a=n(23),r=function(){function e(){}return e.prototype.save=function(e,t){sessionStorage.setItem("bearer-"+e,JSON.stringify(t))},e.prototype.load=function(e){try{var t=sessionStorage.getItem("bearer-"+e);return Promise.resolve(t?JSON.parse(t):{token:null,expires:0})}catch(e){return Promise.resolve({token:null,expires:0})}},e}(),s=n(14);function o(e){e.resources||(e.resources=[])}function i(e,t,n){switch(t){case"courses":!function(e,t){e.modules||(e.modules=[]),e.modules.forEach(function(e){e.resources||(e.resources=[]),e.taskIds||(e.taskIds=[])}),e.responsibleTeachers||(e.responsibleTeachers=[]),"resourses"in e&&!("resources"in e)&&(e.resources=e.resourses,delete e.resourses),e.resources||(e.resources=[]),t&&t.forEach(function(t){switch(t){case"tasks":e.tasks.forEach(function(e){return o(e)})}})}(e,n);break;case"tasks":o(e)}}var l,c=(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n,a){return new(n||(n=Promise))(function(r,s){function o(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,i)}l((a=a.apply(e,t||[])).next())})},d=function(e,t){var n,a,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=a[2&s[0]?"return":s[0]?"throw":"next"])&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[0,r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}};!function(e){if(!e.__migrator_mixed_in){e.__migrator_mixed_in=!0;var t=e.get,n=e.list;e.get=function(e,n,a){var r=a&&a.include;return t.apply(this,arguments).then(function(t){return i(t,e,r&&r.toString().split(",")),t})},e.list=function(e,t){var a=t&&t.include;return n.apply(this,arguments).then(function(t){return t.forEach(function(t){return i(t,e,a&&a.toString().split(","))}),t})}}}(a.d.prototype);var m=new r,p=Date.now(),h=function(){function e(e,t,n){this.tokenPath=e,this.tokenResponseMapper=t,this.tokenId=n,this.tokenInfo={token:null,expires:0},this.getBearer=Object(s.a)(this.getBearer.bind(this)),this.refreshBearer=Object(s.a)(this.refreshBearer.bind(this))}return e.prototype.getBearer=function(){return u(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return this.tokenInfo.token?[3,2]:this.tokenId?(e=this,[4,m.load(this.tokenId)]):[3,2];case 1:e.tokenInfo=t.sent(),t.label=2;case 2:return this.tokenInfo.expires<Date.now()?[4,this.refreshBearer()]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2,this.tokenInfo]}})})},e.prototype.refreshBearer=function(){return u(this,void 0,void 0,function(){var e,t,n,a,r;return d(this,function(s){switch(s.label){case 0:return[4,fetch(this.tokenPath,{headers:{Accept:"text/plain; application/json"},redirect:"manual",cache:"no-cache",credentials:"same-origin"})];case 1:return(302===(e=s.sent()).status||!e.status&&"opaqueredirect"===e.type)&&Date.now()-p>6e4&&(this.wantsRedirect=!0,console.log("Redirect wanted. Reload page."),window.location.reload(!0)),200==e.status?[3,3]:(t=Error.bind,n="HTTP"+e.status+" ",[4,e.text()]);case 2:throw new(t.apply(Error,[void 0,n+s.sent()]));case 3:return a=this,r=this.tokenResponseMapper,[4,e.text()];case 4:return a.tokenInfo=r.apply(this,[s.sent()]),m.save(this.tokenId,this.tokenInfo),[2,this.tokenInfo]}})})},e}(),f={fetch:fetch.bind(self),btoa:btoa.bind(self)},b=function(e){function t(t,n,a){var r="string"!=typeof n?n:new h(n,a&&a.tokenResponseMapper||function(e){return{token:e,expires:Date.now()+212400}},a&&a.tokenId);return e.call(this,f,r,t)||this}return c(t,e),t}(a.d);n.d(t,"d",function(){return m}),n.d(t,"b",function(){return h}),n.d(t,"c",function(){return f}),n.d(t,"a",function(){return b})},,function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(14),r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s=function(e,t,n,a){return new(n||(n=Promise))(function(r,s){function o(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,i)}l((a=a.apply(e,t||[])).next())})},o=function(e,t){var n,a,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=a[2&s[0]?"return":s[0]?"throw":"next"])&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[0,r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},i=function(){function e(e,t,n){this.isomorphic=e,this.baseUrl=t,this.options=n,this.fetchOptions={mode:"cors"},this.authHeader=n.bearer?"Bearer "+n.bearer:n.username?"Basic "+e.btoa(n.username+":"+(n.password||"")):null,this.bearerProvider=n.bearerProvider||null}return e.prototype.fetch=function(e,t,n,i,l){return s(this,void 0,void 0,function(){var s,c,u,d,m,p,h,f,b,v,g;return o(this,function(o){switch(o.label){case 0:return l&&"no-cache"===l.cache&&(i=r({},i,{nocache:Object(a.b)()})),s=i&&Object.keys(i).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(i[e])}).join("&"),u=(c=this).authHeader,d=c.tokenInfo,m=c.bearerProvider,u||d||!m?[3,2]:(p=this,[4,m.getBearer()]);case 1:p.tokenInfo=d=o.sent(),o.label=2;case 2:return d?d.expires<Date.now()?(console.log("Token expired. Refresh it:"),h=this,[4,m.refreshBearer()]):[3,4]:[3,5];case 3:h.tokenInfo=d=o.sent(),o.label=4;case 4:u="Bearer "+d.token,o.label=5;case 5:return u&&(n.Authorization=u),f=this.baseUrl+e+(s?"?"+s:""),[4,this.isomorphic.fetch(f,r({},this.fetchOptions,{headers:n,method:t},l))];case 6:return 401==(b=o.sent()).status&&this.bearerProvider?(v=b.headers.get("www-authenticate"),console.log("Got "+b.status+" from "+(this.baseUrl+e)),v&&/Bearer/i.test(v)?(g=this,[4,this.bearerProvider.refreshBearer()]):[3,9]):[3,9];case 7:return g.tokenInfo=o.sent(),n.Authorization="Bearer "+this.tokenInfo.token,[4,this.isomorphic.fetch(f,r({},this.fetchOptions,{headers:n,method:t},l))];case 8:b=o.sent(),o.label=9;case 9:return[2,b]}})})},e.prototype.get=function(e,t,n){return this.fetch(e,"GET",{Accept:"application/json; text/plain"},t,n)},e.prototype.post=function(e,t,n){return this.fetch(e,"POST",{"Content-Type":"application/json",Accept:"application/json"},null,r({},n,{body:JSON.stringify(t)}))},e.prototype.delete=function(e,t,n,a){return this.fetch(e,"DELETE",{Accept:"application/json; text/plain"},t,r({},a,{body:n}))},e}()},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";var a="undefined"==typeof KED?{}:KED;"undefined"!=typeof window&&"undefined"==typeof KED&&(window.KED=a),t.a=a},,function(e,t,n){"use strict";var a=n(19),r=n(14),s=function(e,t,n,a){return new(n||(n=Promise))(function(r,s){function o(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,i)}l((a=a.apply(e,t||[])).next())})},o=function(e,t){var n,a,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=a[2&s[0]?"return":s[0]?"throw":"next"])&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[0,r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},i=function(){function e(e,t,n,s,o,i,l){this.isomorphic=e,this.storage=t,this.tokenId=n,this.clientId=s,this.clientSecret=o,this.tokenUrl=i,this.tokenQuery=l,this.tokenInfo={token:null,expires:0},this.client=new a.a(e,"",{username:this.clientId,password:this.clientSecret}),this.getBearer=Object(r.a)(this.getBearer.bind(this)),this.refreshBearer=Object(r.a)(this.refreshBearer.bind(this))}return e.prototype.getBearer=function(){return s(this,void 0,void 0,function(){var e,t,n,a;return o(this,function(r){switch(r.label){case 0:if(e=this.tokenInfo,t=e.token,n=e.expires,t&&n>=Date.now())return[2,this.tokenInfo];r.label=1;case 1:return r.trys.push([1,4,,6]),a=this,[4,this.storage.load(this.clientId+"/"+this.tokenId)];case 2:return a.tokenInfo=r.sent(),this.tokenInfo.token&&this.tokenInfo.expires>=Date.now()?[2,this.tokenInfo]:[4,this.refreshBearer()];case 3:return r.sent(),[2,this.tokenInfo];case 4:return r.sent(),[4,this.refreshBearer()];case 5:return r.sent(),[2,this.tokenInfo];case 6:return[2]}})})},e.prototype.refreshBearer=function(){return s(this,void 0,void 0,function(){var e,t,n,a;return o(this,function(r){switch(r.label){case 0:t=0,r.label=1;case 1:return t<6?(console.log("Retrieving token for "+this.tokenId),[4,this.client.get(this.tokenUrl,this.tokenQuery,{cache:"reload"})]):[3,5];case 2:return 200!==(e=r.sent()).status?(console.warn("Got "+e.status+" "+e.statusText),[3,4]):(n=this,a={},[4,e.text()]);case 3:return n.tokenInfo=(a.token=r.sent(),a.expires=Date.now()+354e4,a),console.log("Got token for "+this.tokenId+": "+JSON.stringify(this.tokenInfo)),this.storage.save(this.clientId+"/"+this.tokenId,this.tokenInfo),[2,this.tokenInfo];case 4:return++t,[3,1];case 5:throw new Error("Failed to retrieve token for "+JSON.stringify(this.tokenId))}})})},e}(),l=function(){function e(e,t,n){this.accessClaimType=e,this.accessClaimValue=t,this.right=n}return e.fromString=function(t){if(!t)return null;var n=t.split(":");if(n.length<3)throw new Error("Invalid access string: "+t);var a=e.unescape(n[0]),r=e.unescape(n[1]),s=n[2];if("R"!==s&&"W"!==s&&"S"!==s)throw new Error("Invalid access string: "+t);return new e(a,r,s)},e.escape=function(e){return e.replace(/\%/g,"%25").replace(/\:/g,"%3A")},e.unescape=function(e){return e.replace(/\%3A/g,":").replace(/\%25/g,"%")},e.prototype.toString=function(){return e.escape(this.accessClaimType)+":"+e.escape(this.accessClaimValue)+":"+this.right},e.fromStringArray=function(t){return t.map(function(t){return e.fromString(t)}).filter(function(e){return e})},e.toStringArray=function(e){return e.map(function(e){return e.toString()})},e}();function c(e,t,n){return!!t.some(function(e){return"role"===e.type&&"ADMIN"===e.value})||e.some(function(e){return t.some(function(t){return e.accessClaimType===t.type&&e.accessClaimValue===t.value&&("R"===e.right&&"R"===n||"W"===e.right&&["R","W"].indexOf(n)>=0||"S"===e.right)})})}var u,d=(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(e){function t(t,n){var a=e.call(this,"HTTP"+t+" "+n)||this;return a.code=t,a.message=n,a.name="http"+t,a}return d(t,e),t}(Error);n.d(t,"d",function(){return b}),n.d(t,"a",function(){return v}),n.d(t,"f",function(){return r.b}),n.d(t,"e",function(){return i}),n.d(t,"b",function(){return l}),n.d(t,"g",function(){return c}),n.d(t,"c",function(){return m});var p=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},h=function(e,t,n,a){return new(n||(n=Promise))(function(r,s){function o(e){try{l(a.next(e))}catch(e){s(e)}}function i(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,i)}l((a=a.apply(e,t||[])).next())})},f=function(e,t){var n,a,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=a[2&s[0]?"return":s[0]?"throw":"next"])&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[0,r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},b=function(){function e(e,t,n){this.http=new a.a(e,n,{bearerProvider:t})}return e.prototype.getMyClaims=function(e,t){return h(this,void 0,void 0,function(){var n,a,r;return f(this,function(s){switch(s.label){case 0:return[4,this.http.get("me/claims/"+(e||""),null,t)];case 1:return 200==(n=s.sent()).status?[3,3]:(a=m.bind,r=[void 0,n.status],[4,n.text()]);case 2:throw new(a.apply(m,r.concat([s.sent()])));case 3:return[4,n.json()];case 4:return[2,s.sent()]}})})},e.prototype.get=function(e,t,n,a){return h(this,void 0,void 0,function(){var r,s,o;return f(this,function(i){switch(i.label){case 0:return[4,this.http.get(e+"/"+t,n,a)];case 1:return 200==(r=i.sent()).status?[3,3]:(s=m.bind,o=[void 0,r.status],[4,r.text()]);case 2:throw new(s.apply(m,o.concat([i.sent()])));case 3:return[4,r.json()];case 4:return[2,i.sent()]}})})},e.prototype.list=function(e,t,n){return h(this,void 0,void 0,function(){var a,r,s;return f(this,function(o){switch(o.label){case 0:return[4,this.http.get(""+e,t,n)];case 1:return 200==(a=o.sent()).status?[3,3]:(r=m.bind,s=[void 0,a.status],[4,a.text()]);case 2:throw new(r.apply(m,s.concat([o.sent()])));case 3:return[4,a.json()];case 4:return[2,o.sent()]}})})},e.prototype.batch=function(e,t){return h(this,void 0,void 0,function(){var n,a,r;return f(this,function(s){switch(s.label){case 0:return e=e.slice().sort(function(e,t){return"add"===e.op?-1:"add"===t.op?1:"delete"===e.op?1:"delete"===t.op?-1:0}),[4,this.http.post("batch",e,t)];case 1:return 200==(n=s.sent()).status?[3,3]:(a=m.bind,r=[void 0,n.status],[4,n.text()]);case 2:throw new(a.apply(m,r.concat([s.sent()])));case 3:return[4,n.json()];case 4:return[2,s.sent()]}})})},e.prototype.do=function(e){return h(this,void 0,void 0,function(){var t;return f(this,function(n){switch(n.label){case 0:return t=new v,e(t),[4,this.batch(t.mutationRequests)];case 1:return[2,n.sent()]}})})},e.prototype.deleteRealm=function(e){return h(this,void 0,void 0,function(){var t,n,a;return f(this,function(r){switch(r.label){case 0:return[4,this.http.delete("realms/"+e)];case 1:return 200==(t=r.sent()).status?[3,3]:(n=m.bind,a=[void 0,t.status],[4,t.text()]);case 2:throw new(n.apply(m,a.concat([r.sent()])));case 3:return[4,t.json()];case 4:return[2,r.sent()]}})})},e.prototype.add=function(e,t){return this.do(function(n){return n.add(e,t)})},e.prototype.put=function(e,t){return this.do(function(n){return n.put(e,t)})},e.prototype.delete=function(e,t){return this.do(function(n){return n.delete(e,t)})},e.prototype.share=function(e,t,n){return this.do(function(a){return a.share(e,t,n)})},e.prototype.unshare=function(e,t,n){return this.do(function(a){return a.unshare(e,t,n)})},e.prototype.link=function(e,t,n,a,r){return this.do(function(s){return s.link(e,t,n,a,r)})},e.prototype.link2=function(e,t,n,a){return this.do(function(r){return r.link2(e,t,a,n)})},e.prototype.unlink=function(e,t,n,a,r){return this.do(function(s){return s.unlink(e,t,n,a,r)})},e.prototype.unlink2=function(e,t,n,a){return this.do(function(r){return r.unlink2(e,t,a,n)})},e}(),v=function(){function e(){this.mutationRequests=[]}return e.prototype.add=function(e,t){return this.mutationRequests.push({op:"add",table:e,doc:t}),this},e.prototype.put=function(e,t){return delete(t=p({},t)).acl,this.mutationRequests.push({op:"put",table:e,doc:t}),this},e.prototype.delete=function(e,t){return this.mutationRequests.push({op:"delete",table:e,id:t}),this},e.prototype.share=function(e,t,n){return this.mutationRequests.push({op:"share",table:e,id:t,acl:n}),this},e.prototype.unshare=function(e,t,n){return this.mutationRequests.push({op:"unshare",table:e,id:t,acl:n}),this},e.prototype.link=function(e,t,n,a,r){return this.mutationRequests.push({op:"link",sourceTable:e,sourceId:t,targetTable:n,targetId:a,label:r}),this},e.prototype.link2=function(e,t,n,a){this.mutationRequests.push({op:"link",sourceTable:e,sourceId:t,targetId:a,label:n})},e.prototype.unlink=function(e,t,n,a,r){return this.mutationRequests.push({op:"unlink",sourceTable:e,sourceId:t,targetTable:n,targetId:a,label:r}),this},e.prototype.unlink2=function(e,t,n,a){return this.mutationRequests.push({op:"unlink",sourceTable:e,sourceId:t,targetId:a,label:n}),this},e}()},function(e,t,n){"use strict";var a=n(1),r=n(19),s=n(6),o=n(30),i=n(2),l=[{courseId:"2070d120-30ad-49e9-89c3-9c584a6cfa29",periodName:"HT2017",periodGoalGrade:"A",name:"Naturkunskap 1b",shortName:"XXX",courseSteps:[]},{courseId:"2070d120-30ad-49e9-89c3-9c584a6cfa2c",periodName:"VT2017",periodGoalGrade:"A",name:"Engelska",shortName:"EN",courseSteps:[{stepId:"61f02bc7-1a0d-4b80-9bf1-07b6280379db",name:"1. Lära känna varandra",shortName:"1",isCompleted:!0,completedDate:"/Date(1472111903600)/"},{stepId:"a34c07c7-3932-4f64-87f9-feb5646db3db",name:"10. En saga",shortName:"10",isCompleted:!0,completedDate:"/Date(1472111903740)/"},{stepId:"e931f2bb-5727-4d99-b9e5-1bababfbc2e9",name:"11. Det här är jag",shortName:"11",isCompleted:!0,completedDate:"/Date(1472111903757)/"},{stepId:"ab823339-90ac-4b7f-a895-869d25cef504",name:"12. Jag och min familj",shortName:"12",isCompleted:!0,completedDate:"/Date(1472111903770)/"},{stepId:"53e00313-4980-4ab2-84ff-abe80ecd72d2",name:"13. Jag och mina vänner",shortName:"13",isCompleted:!0,completedDate:"/Date(1472111903787)/"},{stepId:"828796e9-84ad-4496-aa78-7850dd5bb23a",name:"14. Jag och min fritid",shortName:"14",isCompleted:!0,completedDate:"/Date(1472111903803)/"},{stepId:"31e08f37-4ec5-4366-9af6-bca5b9070198",name:"15. The Blog",shortName:"15",isCompleted:!0,completedDate:"/Date(1472111904117)/"},{stepId:"4f88e9a3-9b36-47af-9686-d28b00ca98fc",name:"16. Sport",shortName:"16",isCompleted:!0,completedDate:"/Date(1474888651180)/"},{stepId:"abb57443-be68-48b7-a719-3454afbf3daa",name:"17. Musik",shortName:"17",isCompleted:!0,completedDate:"/Date(1477656328037)/"},{stepId:"964f7ac3-8cf7-4042-912f-58ffb6812ddb",name:"18. Vykort",shortName:"18",isCompleted:null,completedDate:null},{stepId:"3002e95c-8de0-4914-a754-0773a18606bf",name:"19. Läsa noveller",shortName:"19",isCompleted:null,completedDate:null},{stepId:"d8708a56-e4fb-4ad3-84ef-bb40481eaf80",name:"2. Veckans aktiviteter",shortName:"2",isCompleted:!0,completedDate:"/Date(1472111903613)/"},{stepId:"46915f18-288c-44df-b224-1852d221b6ca",name:"20. Summer camp",shortName:"20",isCompleted:null,completedDate:null},{stepId:"db22d300-0126-4a32-950d-aaf2f7142627",name:"21. Hus och hem",shortName:"21",isCompleted:null,completedDate:null},{stepId:"68111c18-e610-45c0-b290-9dd3cede1e48",name:"22. Sightseeing",shortName:"22",isCompleted:null,completedDate:null},{stepId:"4c84dd89-66f2-4ea1-bce8-3fde1724dcc9",name:"23. Vid matbordet",shortName:"23",isCompleted:!0,completedDate:"/Date(1488205880703)/"},{stepId:"75943640-f031-41da-8495-9d87b5804a3e",name:"24. Traditioner",shortName:"24",isCompleted:null,completedDate:null},{stepId:"72021bc2-0ea8-4d39-87fa-11cc976e9c9f",name:"25. Staying with a host family",shortName:"25",isCompleted:null,completedDate:null},{stepId:"574e1626-cad3-4220-8ba7-b443f03830b4",name:"26. Det engelska språket",shortName:"26",isCompleted:null,completedDate:null},{stepId:"50a3682e-057d-45b1-81b5-e2eaa8b6d16b",name:"27. Skolan och framtidsdrömmar",shortName:"27",isCompleted:null,completedDate:null},{stepId:"15a47a71-989a-4348-8fcb-a10683d263ec",name:"28. Identitet",shortName:"28",isCompleted:null,completedDate:null},{stepId:"5717f099-477f-433d-b10a-c2bf0dfe6f8e",name:"29. Att läsa en bok",shortName:"29",isCompleted:null,completedDate:null},{stepId:"0443638f-a546-40d8-a533-e2d12abef609",name:"3. Fira ett speciellt tillfälle",shortName:"3",isCompleted:!0,completedDate:"/Date(1472111903630)/"},{stepId:"54ff6488-f0ae-4fb6-b4e4-0f29d9274b23",name:"30. The World Today",shortName:"30",isCompleted:null,completedDate:null},{stepId:"2ab8a527-cd74-4847-97a6-79f629e22e84",name:"31. Entertainment",shortName:"31",isCompleted:null,completedDate:null},{stepId:"1b5d42ff-9615-439a-9ae2-89779040bf91",name:"32. Interview",shortName:"32",isCompleted:null,completedDate:null},{stepId:"29ffc098-d26d-4f3b-a295-b5f065923bf2",name:"33. Filmed books",shortName:"33",isCompleted:null,completedDate:null},{stepId:"4d5fe734-9af9-42b8-8c50-920c9a450bc1",name:"34. See the film",shortName:"34",isCompleted:null,completedDate:null},{stepId:"dd87c548-4a3a-4a62-9114-70ec7e713aee",name:"35. Write a bestseller",shortName:"35",isCompleted:null,completedDate:null},{stepId:"1fb5ce80-faf0-465c-9be8-c9bc722297bb",name:"36. The English-speaking World",shortName:"36",isCompleted:null,completedDate:null},{stepId:"f0007f75-0d1f-48c7-8f19-bb2e9f2c5377",name:"37. Poetry",shortName:"37",isCompleted:null,completedDate:null},{stepId:"addebfcc-5b3c-4360-b819-0de0269a5e2d",name:"38. Rhetoric",shortName:"38",isCompleted:null,completedDate:null},{stepId:"23c16db5-d435-49d3-8daa-c2b6433366b7",name:"39. An important issue",shortName:"39",isCompleted:null,completedDate:null},{stepId:"e4d22285-735a-4bab-8884-ca5b736ebb88",name:"4. Åka någonstans",shortName:"4",isCompleted:!0,completedDate:"/Date(1472111903647)/"},{stepId:"4c489a2b-ee79-4f89-9818-787632abfba8",name:"40. Write a speech",shortName:"40",isCompleted:null,completedDate:null},{stepId:"9667976c-83ab-4b9e-8a76-d330983c28f5",name:"41. Changing world",shortName:"41",isCompleted:null,completedDate:null},{stepId:"6bb14af9-9094-4938-be2d-2725a931895c",name:"42. An organization",shortName:"42",isCompleted:null,completedDate:null},{stepId:"fe313a1a-dc5c-4890-b11e-b8e109db689b",name:"43. The written word",shortName:"43",isCompleted:null,completedDate:null},{stepId:"f1a592ec-6095-4ae4-9b9e-ebd527c18a2a",name:"44. Communication",shortName:"44",isCompleted:null,completedDate:null},{stepId:"5f6a5e15-462b-40ab-981b-b93e5fc0ee22",name:"45. Giving a lecture",shortName:"45",isCompleted:null,completedDate:null},{stepId:"8c9b57c1-cf05-4465-84b2-68cf353b1075",name:"5. Min semester",shortName:"5",isCompleted:!0,completedDate:"/Date(1472111903660)/"},{stepId:"1bd11f36-6438-40b5-ad4c-4b02b6f481d0",name:"6. Låt oss prata om det",shortName:"6",isCompleted:!0,completedDate:"/Date(1472111903677)/"},{stepId:"d49c08ee-c0e6-4599-b79f-5efd811fe33c",name:"7. Jag är en turist",shortName:"7",isCompleted:!0,completedDate:"/Date(1472111903693)/"},{stepId:"2def3414-de65-46c0-8f48-f8aa18be7b7c",name:"8. Vänner över hela världen",shortName:"8",isCompleted:!0,completedDate:"/Date(1472111903707)/"},{stepId:"ea8ff1a0-4bad-43ac-b328-62dff3e4d08e",name:"9. Hjältar och kända personer",shortName:"9",isCompleted:!0,completedDate:"/Date(1472111903723)/"}]},{courseId:"9d129e6a-9557-4849-a53f-416725502895",periodName:"VT2017",periodGoalGrade:"C",name:"Matematik",shortName:"MA",courseSteps:[{stepId:"f1af6c2c-799a-4a3d-9985-c423940e91c0",name:"1. Tal och mönster",shortName:"1",isCompleted:!0,completedDate:"/Date(1474401815917)/"},{stepId:"4a34c53d-93d0-4247-ba19-9ce9dbed6de5",name:"10. Lägesmått och diagram",shortName:"10",isCompleted:!0,completedDate:"/Date(1474401816200)/"},{stepId:"0816a2b0-3aa7-41a9-bc39-971ccc7bd79c",name:"11. Räknesätt",shortName:"11",isCompleted:!0,completedDate:"/Date(1476103754013)/"},{stepId:"fdc90a9c-b06a-48b1-9781-606c230c425c",name:"12. Geometri",shortName:"12",isCompleted:!0,completedDate:"/Date(1481279716607)/"},{stepId:"bfd77c92-6636-45fa-9002-d813beaa56c3",name:"13. Rymdgeometri",shortName:"13",isCompleted:!0,completedDate:"/Date(1489669353170)/"},{stepId:"58a619a1-b99a-487b-bbd5-abd31a903e5a",name:"14. Räknemetoder och algebra",shortName:"14",isCompleted:null,completedDate:null},{stepId:"55b88760-22aa-452a-8a57-131346669aad",name:"15. Problemet",shortName:"15",isCompleted:null,completedDate:null},{stepId:"47f16476-ea47-40a2-a073-7ac4b36c4bf0",name:"16. Delen och det hela",shortName:"16",isCompleted:null,completedDate:null},{stepId:"704e3d5b-fce7-409b-b989-340b2d7b2e18",name:"17. Geometri och vinklar",shortName:"17",isCompleted:null,completedDate:null},{stepId:"db5693ea-48ef-44ce-8107-be9915ef5256",name:"18. Funktioner",shortName:"18",isCompleted:null,completedDate:null},{stepId:"f9250c97-d932-4bf6-989e-204c0ef582c9",name:"19. Proportionalitet",shortName:"19",isCompleted:null,completedDate:null},{stepId:"d0411b1d-c9b4-452f-9fb6-ea7206755ecd",name:"2. Längd och räknesätt",shortName:"2",isCompleted:!0,completedDate:"/Date(1474401815930)/"},{stepId:"616b742e-b175-45c3-a926-fda3e4d8af80",name:"20. Förflyttningsgraf",shortName:"20",isCompleted:null,completedDate:null},{stepId:"f8a9b467-6ba6-4d9a-8174-87e369062621",name:"21. Likformighet",shortName:"21",isCompleted:null,completedDate:null},{stepId:"8fe483d7-b78b-4d9d-9402-15d57da05832",name:"22. Bråk, sannolikhet och kombinatorik",shortName:"22",isCompleted:null,completedDate:null},{stepId:"7eb39090-6461-4ce4-b008-dd98f8a57679",name:"23. Negativa tal, procentsatser och förändringsfaktor",shortName:"23",isCompleted:null,completedDate:null},{stepId:"34cb3911-3a78-4773-a823-2f9054a9a925",name:"24. Algebra och ekvationer",shortName:"24",isCompleted:null,completedDate:null},{stepId:"49abad1a-dd4b-4b0b-8d1f-752796723ca1",name:"25. Lotteriet",shortName:"25",isCompleted:null,completedDate:null},{stepId:"6756d8bc-e31a-4139-8d95-8f47916a361b",name:"26. Geometriska samband",shortName:"26",isCompleted:null,completedDate:null},{stepId:"0f0efee5-e617-4bca-b84e-e50e32aac90b",name:"27. Rymdgeometri",shortName:"27",isCompleted:null,completedDate:null},{stepId:"de4e12d1-f678-4b1a-ac7b-5d62cdaeb52d",name:"28. Storheter och proportionella samband",shortName:"28",isCompleted:null,completedDate:null},{stepId:"80323de8-fe66-4750-bb2e-d0dbabbb3dac",name:"29. Funktioner och grafer",shortName:"29",isCompleted:null,completedDate:null},{stepId:"68894968-8a16-497a-8b97-711df61fca71",name:"3. Tal och enheter",shortName:"3",isCompleted:!0,completedDate:"/Date(1474401815947)/"},{stepId:"fa32d170-ab25-466d-91a8-a88f955cc5bc",name:"30. Förpackning",shortName:"30",isCompleted:null,completedDate:null},{stepId:"4c31e00f-aeda-409f-8583-9805c0bb4f7f",name:"31. Negativa tal och statistik",shortName:"31",isCompleted:null,completedDate:null},{stepId:"691bb48b-070d-4227-8fb6-2edce2fc6be4",name:"32. Bråk",shortName:"32",isCompleted:null,completedDate:null},{stepId:"320481da-e417-4c52-af23-0076b694794d",name:"33. Procent och förändringsfaktor",shortName:"33",isCompleted:null,completedDate:null},{stepId:"f3a4338d-504e-4092-9610-ef2775b5b411",name:"34. Potenser",shortName:"34",isCompleted:null,completedDate:null},{stepId:"f43d7931-158c-4759-b7be-b14cf68c939a",name:"35. Solsystemet",shortName:"35",isCompleted:null,completedDate:null},{stepId:"8931fc26-693a-41bd-8040-e01a6d22b2b5",name:"36. Ekvationer och algebra",shortName:"36",isCompleted:null,completedDate:null},{stepId:"94370d70-dcbd-4eef-baf1-e92f6680b966",name:"37. Funktioner och grafer",shortName:"37",isCompleted:null,completedDate:null},{stepId:"ab0535df-68cc-4c10-86eb-afba3e199d0a",name:"38. Geometri",shortName:"38",isCompleted:null,completedDate:null},{stepId:"4ba66c7a-7d8f-4576-aefa-c09397b99db0",name:"39. Sannolikhet",shortName:"39",isCompleted:null,completedDate:null},{stepId:"c4e12bc8-1428-4d1b-a273-e947fa0574f3",name:"4. Multiplikation och division",shortName:"4",isCompleted:!0,completedDate:"/Date(1474401815963)/"},{stepId:"0b75ce2b-89de-432a-9eee-d6a7b74b6f38",name:"40. Chokladfabriken",shortName:"40",isCompleted:null,completedDate:null},{stepId:"dba4a055-c143-4bd4-b436-3eb508ebe658",name:"41. Genrella lösningsmetoder",shortName:"41",isCompleted:null,completedDate:null},{stepId:"db193873-0a8c-4073-8618-99c5a56f710b",name:"42. Avancerad ekvationslösning",shortName:"42",isCompleted:null,completedDate:null},{stepId:"357ee123-1d77-4568-8fa1-78b5662e12b3",name:"43. Problemlösning",shortName:"43",isCompleted:null,completedDate:null},{stepId:"015cdd58-7b31-4a89-a9fe-cd0bb45e7434",name:"44. Avancerad problemlösning",shortName:"44",isCompleted:null,completedDate:null},{stepId:"785e12ac-4a71-4acf-bf40-27652faf20ff",name:"45. Vad är matematik?",shortName:"45",isCompleted:null,completedDate:null},{stepId:"6372cdb6-91cf-4f0f-ac9c-8578c00760ff",name:"5. Form och storlek",shortName:"5",isCompleted:!0,completedDate:"/Date(1474401815977)/"},{stepId:"c781e529-fefa-43ce-99fb-d232585a1e1a",name:"6. Tid och räknesätt",shortName:"6",isCompleted:!0,completedDate:"/Date(1474401815993)/"},{stepId:"5df2975c-f84e-4620-abe9-5c47ebcb0f90",name:"7. Bråk och decimaltal",shortName:"7",isCompleted:!0,completedDate:"/Date(1474401816007)/"},{stepId:"9cbb966f-32df-48cf-be77-5e00d466d63a",name:"8. Procent och bråk",shortName:"8",isCompleted:!0,completedDate:"/Date(1474401816023)/"},{stepId:"b1b59f38-63c6-428a-a512-220b7d838e5f",name:"9. Sannolikhet och bråk",shortName:"9",isCompleted:!0,completedDate:"/Date(1474401816040)/"}]},{courseId:"cfdc5bc0-ea41-4683-b941-d980de4e82a5",periodName:"VT2017",periodGoalGrade:"D",name:"Spanska, språkval",shortName:"M2SP",courseSteps:[{stepId:"16bb0ce6-60ac-4937-8e60-dd633cd7c5f0",name:"1. Första mötet",shortName:"1",isCompleted:!0,completedDate:"/Date(1476255771933)/"},{stepId:"f3504ab6-386c-42d2-882b-668719f329b5",name:"10. Turist",shortName:"10",isCompleted:null,completedDate:null},{stepId:"d2de4e01-44dd-4ba7-a69f-075450c627a7",name:"11. Skolan",shortName:"11",isCompleted:null,completedDate:null},{stepId:"58e4d577-05f5-4071-8745-a41571df3019",name:"12. Fritiden",shortName:"12",isCompleted:null,completedDate:null},{stepId:"d8a079f9-3fef-4fbc-b868-6b050e3832d1",name:"13. Stämma träff",shortName:"13",isCompleted:null,completedDate:null},{stepId:"d62f63a1-3806-4650-b6a9-354eccd056b9",name:"14. Sport och musik",shortName:"14",isCompleted:null,completedDate:null},{stepId:"b475dc9d-e694-4eb9-8c78-b150494dfe84",name:"15. Presentera dig själv",shortName:"15",isCompleted:null,completedDate:null},{stepId:"009c68f6-db7e-44a3-bc5c-d1e2e78d327c",name:"16. När och fjärran",shortName:"16",isCompleted:null,completedDate:null},{stepId:"a124f250-2fb7-4b57-b2bc-b72e0e8fd21a",name:"17. Mat och traditioner",shortName:"17",isCompleted:null,completedDate:null},{stepId:"ec6ccef4-58b5-4111-b152-8a7a7f546bb8",name:"18. Planera en resa",shortName:"18",isCompleted:null,completedDate:null},{stepId:"ec96d506-112e-4b38-8946-6f19130bd741",name:"19. Etikett och regler",shortName:"19",isCompleted:null,completedDate:null},{stepId:"0b52b5e6-bbc7-4c78-815c-efc30fa984af",name:"2. Min familj",shortName:"2",isCompleted:!0,completedDate:"/Date(1488368769260)/"},{stepId:"e05c674b-1097-4646-ac47-1d8c4342a343",name:"20. Resan",shortName:"20",isCompleted:null,completedDate:null},{stepId:"f6f8cffb-69ae-4148-81fa-35e1f984f836",name:"21. Boende",shortName:"21",isCompleted:null,completedDate:null},{stepId:"aee9167c-2f65-4f8d-a94b-684458c300bc",name:"22. Familjeliv",shortName:"22",isCompleted:null,completedDate:null},{stepId:"115f28de-fe33-435e-a7fb-36fea0a37cce",name:"23. Bostadsläge",shortName:"23",isCompleted:null,completedDate:null},{stepId:"d5e8b9e2-b84e-4af7-8b20-e37896dec41d",name:"24. Min stad",shortName:"24",isCompleted:null,completedDate:null},{stepId:"c2f15857-a682-4b02-8d00-ec042858e799",name:"25. Presentera någon annan",shortName:"25",isCompleted:null,completedDate:null},{stepId:"1bc87327-1e3f-42f6-b839-e9b385200149",name:"26. Media",shortName:"26",isCompleted:null,completedDate:null},{stepId:"36f23967-f30b-4cbc-a69c-4191094e182d",name:"27. En tv-kväll",shortName:"27",isCompleted:null,completedDate:null},{stepId:"32ead07a-fa58-4770-ac20-3a31f27069cf",name:"28. Tidningar",shortName:"28",isCompleted:null,completedDate:null},{stepId:"598d7b7e-97b6-4ff3-b7a7-8f5c45c164cd",name:"29. Film",shortName:"29",isCompleted:null,completedDate:null},{stepId:"12e8d03b-7d80-434c-9201-7f852f5c114c",name:"3. Fler siffror, månader och väder",shortName:"3",isCompleted:null,completedDate:null},{stepId:"98f0825e-e200-43f4-9f4b-866bb50d28dd",name:"30. Tidningen",shortName:"30",isCompleted:null,completedDate:null},{stepId:"956757b9-979f-4d12-be01-8b30970b603e",name:"31. Min framtid",shortName:"31",isCompleted:null,completedDate:null},{stepId:"c2003358-0ce9-409b-82fa-e7a0bff891fc",name:"32. Ung i framtiden",shortName:"32",isCompleted:null,completedDate:null},{stepId:"1c1ca040-f96d-46af-862b-a978698e2745",name:"33. Insändare",shortName:"33",isCompleted:null,completedDate:null},{stepId:"64f620bb-8c77-4de2-88e2-feaa21f4c41e",name:"34. På gymnasiet",shortName:"34",isCompleted:null,completedDate:null},{stepId:"4c3c19eb-0447-47cf-bb72-8d1176118c71",name:"35. Framtiden",shortName:"35",isCompleted:null,completedDate:null},{stepId:"c3779788-030e-46f3-89a7-a15015931a51",name:"4. Det här är jag",shortName:"4",isCompleted:null,completedDate:null},{stepId:"a6628c06-443a-481d-96fc-c019800e8e4e",name:"5. Boken",shortName:"5",isCompleted:null,completedDate:null},{stepId:"f34e1dee-1dd3-4bcd-89b4-f0ba6638c65c",name:"6. På café",shortName:"6",isCompleted:null,completedDate:null},{stepId:"9ffb3665-0e3a-423a-af93-c5006a2a4839",name:"7. Att handla",shortName:"7",isCompleted:null,completedDate:null},{stepId:"63e62432-ba1e-4f96-911c-52bd756c803e",name:"8. I staden",shortName:"8",isCompleted:null,completedDate:null},{stepId:"3c93cf1d-2e82-452b-9333-16b336fdda6d",name:"9. På hotellet",shortName:"9",isCompleted:null,completedDate:null}]},{courseId:"3cc7c710-63fb-49bd-8dc5-b95be6374122",periodName:"VT2017",periodGoalGrade:"C",name:"Svenska",shortName:"SV",courseSteps:[{stepId:"379585a4-f602-4086-920d-d506d2e93fed",name:"1. Min bästa sak",shortName:"1",isCompleted:!0,completedDate:"/Date(1472559179490)/"},{stepId:"5d90747a-d5ff-4c12-818c-d301e4cf2405",name:"10. Quizkampen",shortName:"10",isCompleted:!0,completedDate:"/Date(1472559179630)/"},{stepId:"fb271830-5368-43dc-b911-3d65af082e26",name:"11. Ta kontakt",shortName:"11",isCompleted:!0,completedDate:"/Date(1472559179647)/"},{stepId:"bf7a93a6-24af-4d01-8839-aa4f3f6b438d",name:"12. Samla fakta och presentera",shortName:"12",isCompleted:!0,completedDate:"/Date(1472559179660)/"},{stepId:"2a712108-e5d7-4ffb-a55f-80ff195ea946",name:"13. Påverka och uttrycka åsikter",shortName:"13",isCompleted:!0,completedDate:"/Date(1472559179943)/"},{stepId:"94b5abaa-0471-4ab4-be3c-c0b0d4098609",name:"14. Språk i Sverige",shortName:"14",isCompleted:!0,completedDate:"/Date(1475049857367)/"},{stepId:"e0169353-8ac0-4fcd-8a45-4cfffc5fe55e",name:"15. Min förebild",shortName:"15",isCompleted:!0,completedDate:"/Date(1480951054357)/"},{stepId:"e12c8fa6-8aaa-4598-8e6f-5c6d318163db",name:"16. Förstå, minnas och lära",shortName:"16",isCompleted:!0,completedDate:"/Date(1490605558217)/"},{stepId:"1a19c53b-36f0-4309-adfd-26a307b43dbd",name:"17. Använda språket i olika sammanhang",shortName:"17",isCompleted:null,completedDate:null},{stepId:"31aa5b91-59d0-41db-ab2e-0bdec6342dfe",name:"18. Sammanfatta och presentera",shortName:"18",isCompleted:null,completedDate:null},{stepId:"48747057-835d-40fd-811f-dde4fd48f3a0",name:"19. Den moderna ungdomen",shortName:"19",isCompleted:null,completedDate:null},{stepId:"4708aedf-3b7d-4ec0-80c9-769de4cdda9b",name:"2. Författare",shortName:"2",isCompleted:!0,completedDate:"/Date(1472559179507)/"},{stepId:"4258123d-d122-4058-8120-9de7d1fb3d66",name:"20. Att vara ungdom idag",shortName:"20",isCompleted:null,completedDate:null},{stepId:"3d94e56d-9d38-4d3c-a3cb-d4f2d13814c9",name:"21. Upplysningstiden och romantiken",shortName:"21",isCompleted:null,completedDate:null},{stepId:"5d8c3d70-e996-4236-9326-982ed128340c",name:"22. Realismen och modernismen",shortName:"22",isCompleted:null,completedDate:null},{stepId:"02037ab3-ffdf-4fe2-a172-26de404c58bc",name:"23. Våga utanför ramarna",shortName:"23",isCompleted:null,completedDate:null},{stepId:"7c376d37-0170-49ac-865d-5479d82ce806",name:"24. Modern litteratur",shortName:"24",isCompleted:null,completedDate:null},{stepId:"7131b28d-89d1-40f6-8d87-80fd0c15486d",name:"25. Budskapet",shortName:"25",isCompleted:null,completedDate:null},{stepId:"30c876a6-48a7-4fc7-a49f-ad44bac3d4bb",name:"26. Övertyga och påverka",shortName:"26",isCompleted:null,completedDate:null},{stepId:"97b328ea-3342-41d6-a1c5-91e9c1d17a08",name:"27. Språkbruk genom tiderna",shortName:"27",isCompleted:null,completedDate:null},{stepId:"e4ec472d-b31c-4d20-886c-0162e1159e55",name:"28. Tidningstexter",shortName:"28",isCompleted:null,completedDate:null},{stepId:"47ccf40e-28a1-4432-91ed-f3013eb97aa8",name:"29. Samtala om texter",shortName:"29",isCompleted:null,completedDate:null},{stepId:"6c89c307-adff-46b8-9d75-2ecb1fc714ce",name:"3. Leka med ord",shortName:"3",isCompleted:!0,completedDate:"/Date(1472559179520)/"},{stepId:"2145d4aa-60db-42f9-918b-49f3bf714786",name:"30. Språkets möjligheter",shortName:"30",isCompleted:null,completedDate:null},{stepId:"c211ba3d-b8fa-4c5c-bbe1-bcfea2a243b5",name:"31. Dikt och diktanalys",shortName:"31",isCompleted:null,completedDate:null},{stepId:"fbeb356a-5c9d-4114-9a4b-9ac2325913d0",name:"32. Berättarteknik i skönlitteratur",shortName:"32",isCompleted:null,completedDate:null},{stepId:"4446df13-5bb8-4cf1-beb4-4d2b43bf97b8",name:"33. Utveckla ditt skönlitterära skrivande",shortName:"33",isCompleted:null,completedDate:null},{stepId:"47e0c5bf-2898-4cc3-8119-2346d4c6c78f",name:"34. Noveller",shortName:"34",isCompleted:null,completedDate:null},{stepId:"3b072a72-9f2c-4439-b095-33edb5ae3276",name:"35. Det fria ordet - En skönlitterär djupdykning",shortName:"35",isCompleted:null,completedDate:null},{stepId:"56a2b991-63f5-4f1c-8e48-1bc1f83fa9a9",name:"36. Debatt och retorik",shortName:"36",isCompleted:null,completedDate:null},{stepId:"7b0e633b-65b5-407d-8bdd-d77673d1be1f",name:"37. Argumenterande texter",shortName:"37",isCompleted:null,completedDate:null},{stepId:"d76356c9-2fdd-4845-aa7a-1bf54547a34e",name:"38. Analysera tal",shortName:"38",isCompleted:null,completedDate:null},{stepId:"eb312838-f59b-4815-987f-d7f11973a95f",name:"39. Tal",shortName:"39",isCompleted:null,completedDate:null},{stepId:"48559f29-37cb-451f-8f40-354101a413af",name:"4. Skrivarskola",shortName:"4",isCompleted:!0,completedDate:"/Date(1472559179537)/"},{stepId:"a054f1e2-b296-4185-b9b7-dac94f600ab3",name:"40. Muntlig argumentation",shortName:"40",isCompleted:null,completedDate:null},{stepId:"2e5ff9f3-ac8e-4fea-abe2-a7534e64e25f",name:"41. Modern lyrik",shortName:"41",isCompleted:null,completedDate:null},{stepId:"ceed4cee-dd38-40b9-af97-43b0af244a41",name:"42. Nobelpriset i litteratur",shortName:"42",isCompleted:null,completedDate:null},{stepId:"2df27363-1a57-4129-96dc-5e2a26dc0209",name:"43. Analysmetod i akademiska uppsatser",shortName:"43",isCompleted:null,completedDate:null},{stepId:"71062f38-2874-4d6a-96b9-8128a10e3559",name:"44. Litteratur som väckt debatt genom tiderna",shortName:"44",isCompleted:null,completedDate:null},{stepId:"d0e40b55-4638-45fd-b9f3-924c68c673cc",name:"45. Analysera vetenskapligt",shortName:"45",isCompleted:null,completedDate:null},{stepId:"5954c057-cdc2-4293-bb9e-8b96ec27e04c",name:"5. Min bästa sak på äventyr",shortName:"5",isCompleted:!0,completedDate:"/Date(1472559179553)/"},{stepId:"5b9e5c30-c9de-4092-b7e6-0dbb4e3513ff",name:"6. Faktatext",shortName:"6",isCompleted:!0,completedDate:"/Date(1472559179567)/"},{stepId:"2b823257-8dad-4f6b-8f2b-539e4dae0bd4",name:"7. Tal- och skriftspråk",shortName:"7",isCompleted:!0,completedDate:"/Date(1472559179583)/"},{stepId:"28e73fd2-c40a-4319-8b93-ec0f1b658c81",name:"8. Dikter",shortName:"8",isCompleted:!0,completedDate:"/Date(1472559179600)/"},{stepId:"35a5926a-8cb3-4c9d-a7ef-714761935755",name:"9. Olika texttyper",shortName:"9",isCompleted:!0,completedDate:"/Date(1472559179613)/"}]}],c={assessments:[{publishDateTime:"2017-08-28T09:05:43.16",text:"Testbedömning Engelsa 5",gradeName:"C",courseUnitName:"1. Ready, steady, go!"},{publishDateTime:"2017-08-28T08:59:21.253",text:"Testbedömning...\r\n/ Kim test",gradeName:"C",courseUnitName:"Tema 1"},{publishDateTime:"2017-08-10T09:43:36.797",text:"Test",gradeName:"D",courseUnitName:"Block 1"}]},u={StudyPlans:[{courseUnitName:"Hem- och konsumentkunskap",finalGoalGrade:"B",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Historia",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Fysik",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Geografi",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:"D"}]},{courseUnitName:"Matematik",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Samhällskunskap",finalGoalGrade:"B",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"D"}]},{courseUnitName:"Engelska",finalGoalGrade:"A",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"A"},{periodName:"HT2016",gradeName:"B"}]},{courseUnitName:"Religionskunskap",finalGoalGrade:"B",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Idrott och hälsa",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:"D"}]},{courseUnitName:"Biologi",finalGoalGrade:"D",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Svenska",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Teknik",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Bild",finalGoalGrade:"B",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"C"}]},{courseUnitName:"Spanska, språkval",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:""}]},{courseUnitName:"Kemi",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:"B"}]},{courseUnitName:"Slöjd",finalGoalGrade:"C",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"D"},{periodName:"HT2016",gradeName:"B"}]},{courseUnitName:"Musik",finalGoalGrade:"B",strategyText:"",periodGoals:[{periodName:"VT2017",gradeName:"C"},{periodName:"HT2016",gradeName:"D"}]}]},d=n(3);function m(){return{user:d.a.currentUser.mail}}n.d(t,"b",function(){return p}),n.d(t,"a",function(){return h});var p=function(){function e(e,t,n){this.http=new r.a(e,t,{bearerProvider:n}),this.getActiveCourses=b(this.getActiveCourses),this.getLatestAssessments=b(this.getLatestAssessments),this.getStudentGoals=b(this.getStudentGoals),this.getStudentFutureAbilities=b(this.getStudentFutureAbilities)}return e.prototype.getActiveCourses=function(e){return a.b(this,void 0,void 0,function(){var t,n,r,o,l;return a.d(this,function(c){switch(c.label){case 0:return c.trys.push([0,5,,6]),t=m(),e&&(e.courseCode&&(t.CourseCode=e.courseCode),e.periodName&&(t.PeriodName=e.periodName)),[4,this.http.get("studentactivecourses",t)];case 1:return 200==(n=c.sent()).status?[3,3]:(r=s.c.bind,o=[void 0,n.status],[4,n.text()]);case 2:throw new(r.apply(s.c,o.concat([c.sent()])));case 3:return[4,n.json()];case 4:return[2,c.sent().courses];case 5:throw l=c.sent(),console.error("Error from EDS: "+l),new Error(Object(i.a)(f||(f=a.e(["Kunde tyvärr inte ladda terminsmål eller avklarade steg från EDS. Försök igen senare..."],["Kunde tyvärr inte ladda terminsmål eller avklarade steg från EDS. Försök igen senare..."]))));case 6:return[2]}})})},e.prototype.getLatestAssessments=function(e){return a.b(this,void 0,void 0,function(){var t,n,r,o;return a.d(this,function(a){switch(a.label){case 0:return t=m(),isNaN(e)||(t.Count=e),[4,this.http.get("studentassessments",t)];case 1:return 200==(n=a.sent()).status?[3,3]:(r=s.c.bind,o=[void 0,n.status],[4,n.text()]);case 2:throw new(r.apply(s.c,o.concat([a.sent()])));case 3:return[4,n.json()];case 4:return[2,a.sent().assessments]}})})},e.prototype.getStudentGoals=function(){return a.b(this,void 0,void 0,function(){var e,t,n;return a.d(this,function(a){switch(a.label){case 0:return[4,this.http.get("studentgoals",m())];case 1:return 200==(e=a.sent()).status?[3,3]:(t=s.c.bind,n=[void 0,e.status],[4,e.text()]);case 2:throw new(t.apply(s.c,n.concat([a.sent()])));case 3:return[4,e.json()];case 4:return[2,a.sent().studentGoals]}})})},e.prototype.getStudentFutureAbilities=function(){return a.b(this,void 0,void 0,function(){var e,t,n;return a.d(this,function(a){switch(a.label){case 0:return[4,this.http.get("studentFutureAbilities",m())];case 1:return 200==(e=a.sent()).status?[3,3]:(t=s.c.bind,n=[void 0,e.status],[4,e.text()]);case 2:throw new(t.apply(s.c,n.concat([a.sent()])));case 3:return[4,e.json()];case 4:return[2,a.sent().studentFutureAbilities]}})})},e}(),h=function(){function e(e){if("string"==typeof e){if(this.period=e,this.term=this.period.startsWith("HT")?"AT":"ST",this.year=parseInt(this.period.substr(2)),isNaN(this.year))throw new Error("Invalid period: "+this.period)}else{var t=new o.a(e);this.period=("AT"===t.term?"HT":"VT")+t.year,this.term=t.term,this.year=t.year}}return Object.defineProperty(e.prototype,"schoolTerm",{get:function(){return new o.a({academicYear:"AT"===this.term?this.year+"/"+(this.year+1):this.year-1+"/"+this.year,term:this.term})},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.period},e.prototype.valueOf=function(){return this.year+":"+("ST"===this.term?"1":"2")},e}();var f;!function(){function e(){this.http=null}e.prototype.getActiveCourses=function(e){return a.b(this,void 0,void 0,function(){var t;return a.d(this,function(n){return t=l,e&&(e.courseCode&&(t=t.filter(function(t){return t.shortName===e.courseCode})),e.periodName&&(t=t.filter(function(t){return t.periodName===e.periodName}))),[2,t]})})},e.prototype.getLatestAssessments=function(e){return a.b(this,void 0,void 0,function(){return a.d(this,function(t){return[2,e?c.assessments.slice(0,e):c.assessments]})})},e.prototype.getStudentGoals=function(){return a.b(this,void 0,void 0,function(){return a.d(this,function(e){return[2,u.StudyPlans]})})},e.prototype.getStudentFutureAbilities=function(){return a.b(this,void 0,void 0,function(){return a.d(this,function(e){return[2,[]]})})}}();function b(e){var t={};return function(){var n=JSON.stringify([].slice.call(arguments));return t[n]||(t[n]=e.apply(this,arguments).then(function(e){return delete t[n],e})),t[n]}}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(1),r=n(0),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={headerOpen:t.headerOpen||!1},n}return a.c(t,e),t.prototype.componentWillReceiveProps=function(e){e.headerOpen!==this.props.headerOpen&&this.setState({headerOpen:e.headerOpen})},t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.className,s=t.children,o=t.headerClassName,i=t.contentClassName,l=this.state.headerOpen;return r.createElement("div",{className:(a||"")+" openClose"+(l?" open":"")},r.createElement("div",{className:"openHeader"+(o?" "+o:""),onClick:function(){e.props.onOpenClose&&e.props.onOpenClose(!e.state.headerOpen),e.setState({headerOpen:!e.state.headerOpen})}},n),r.createElement("div",{className:"openContent"+(i?" "+i:"")},s))},t}(r.Component)},,function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(1),r=n(0),s=n(8),o=n.n(s),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={editMode:!1,runtimeStyle:null,text:t.text||""},n}return a.c(t,e),t.prototype.componentWillReceiveProps=function(e){this.props.text!==e.text&&this.setState({text:e.text||""})},t.prototype.render=function(){var e=this,t=this.state.text||"";return r.createElement("div",{className:"renameable-text"+(t?"":" unnamed")+(this.props.readOnly?" disabled":""),tabIndex:!this.state.editMode&&0,onFocus:function(t){e.rename()},style:{width:"100%"}},r.createElement("div",{ref:function(t){return e.label=t},style:{display:this.state.editMode?"none":""}},t||this.props.clickAdvertiseText),"textarea"===this.props.tag?r.createElement("textarea",{ref:function(t){return e.input=t},maxLength:this.props.maxChars,style:a.a({},this.state.runtimeStyle,{display:this.state.editMode?"":"none"}),onFocus:function(e){return o()(e.target).select()},onBlur:this.onBlur.bind(this),value:t,onKeyDown:this.onKeyDown.bind(this),onChange:this.onChange.bind(this),tabIndex:this.state.editMode&&0,placeholder:this.props.placeholder}):r.createElement("input",{ref:function(t){return e.input=t},type:"text",maxLength:this.props.maxChars,style:a.a({},this.state.runtimeStyle,{display:this.state.editMode?"":"none"}),onFocus:function(e){return o()(e.target).select()},onBlur:this.onBlur.bind(this),value:t,onKeyDown:this.onKeyDown.bind(this),onChange:this.onChange.bind(this),tabIndex:this.state.editMode?0:void 0,placeholder:this.props.placeholder}))},t.prototype.onKeyDown=function(e){27===e.keyCode?(this.input.value=this.props.text||"",this.input.blur(),e.stopPropagation()):13===e.keyCode&&(this.propagateOnChange(this.input.value),this.setState({editMode:!1,text:this.input.value}))},t.prototype.onBlur=function(e){this.propagateOnChange(this.input.value),this.setState({editMode:!1,text:this.input.value})},t.prototype.propagateOnChange=function(e){this.propagatedOnChange!=e&&(this.propagatedOnChange=e,this.props.onChange(e))},t.prototype.onChange=function(e){this.setState({text:this.input.value}),this.props.eager&&this.propagateOnChange(this.input.value)},t.prototype.rename=function(e){var t=this;if(!this.state.editMode&&!this.props.readOnly){e=e||this.state.text||"";var n=o()(this.label);this.setState({text:e,editMode:!0,runtimeStyle:{textAlign:n.css("textAlign"),fontSize:n.css("font-size"),paddingTop:n.css("paddingTop"),paddingBottom:n.css("paddingBottom"),paddingLeft:n.css("paddingLeft"),paddingRight:n.css("paddingRight"),marginTop:n.css("marginTop"),marginBottom:n.css("marginBottom"),marginLeft:n.css("marginLeft"),marginRight:n.css("marginRight"),borderRadius:n.css("borderRadius"),backgroundColor:n.css("backgroundColor"),lineHeight:n.css("lineHeight"),fontWeight:n.css("fontWeight"),outLine:0,borderStyle:"none",height:"100%",width:"100%",boxSizing:"border-box"}},function(){return o()(t.input).focus()})}},t}(r.Component)},,,function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(5),r=n.n(a),s=n(15);var o=function(){function e(e){var t="academicYear"in e?e:Object(s.c)(r()(e));this.academicYear=t.academicYear,this.term=t.term}return Object.defineProperty(e.prototype,"year",{get:function(){return parseInt(this.academicYear.split("/")["AT"===this.term?0:1])},enumerable:!0,configurable:!0}),e.prototype.nextTerm=function(){return new e("AT"===this.term?{term:"ST",academicYear:this.academicYear}:{term:"AT",academicYear:Object(s.a)(this.academicYear,1)})},e.prototype.prevTerm=function(){return new e("AT"===this.term?{term:"ST",academicYear:Object(s.a)(this.academicYear,-1)}:{term:"AT",academicYear:this.academicYear})},e.prototype.toLocaleString=function(e,t){var n="AT"===this.term?this.academicYear.split("/")[0]:this.academicYear.split("/")[1];t&&(n=n.substr(2));for(var a=0,r=e;a<r.length;a++){switch(r[a].split("-")[0].split("_")[0].toLowerCase()){case"en":return("AT"===this.term?"AT":"ST")+" "+n;case"sv":return("AT"===this.term?"HT":"VT")+" "+n}}},e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a,r=n(1),s=n(0),o=n(2),i=function(e){var t=e.onClick,n=e.className,i=e.style,l=e.title;return s.createElement("div",{title:l||Object(o.a)(a||(a=r.e(["Radera"],["Radera"]))),className:"removeItem "+(n||""),onClick:t,style:i})}},,,,,function(e,t,n){"use strict";var a=n(10),r=n(3),s=function(){return function(){var e=r.a.currentUser,t=Object(a.b)(location.search,{toLower:!0});(t.features||"").split(",").map(function(e){return e.toLowerCase()}),this.EditUserTasksViaPenOnly="Grundskolor"!==e.schoolType&&"Grundskolor"!==t.schooltype,this.SubTasks="Grundskolor"!==e.schoolType&&"Grundskolor"!==t.schooltype,this.AssignmentTasks=!!t.testversion}}();n.d(t,"a",function(){return s})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(1),r=function(){function e(e){this.comm=e,this.listPromise=null,this.items=null,this.subscribers=[]}return e.prototype.subscribe=function(e){var t=this;return this.ensureHasData().then(function(){e(t.items),t.subscribers.push(e)})},e.prototype.unsubscribe=function(e){this.subscribers=this.subscribers.filter(function(t){return t!==e})},e.prototype.notifySubscribers=function(){var e=this;this.subscribers.forEach(function(t){return t(e.items)})},e.prototype.ensureHasData=function(){return this.listPromise||this.refreshFromServer(),this.listPromise},e.prototype.refreshFromServer=function(){var e=this;return this.listPromise=this.comm.query().then(function(t){e.items=t,e.notifySubscribers()}),this.listPromise},e.prototype.update=function(e){return a.b(this,void 0,void 0,function(){var t;return a.d(this,function(n){switch(n.label){case 0:return[4,this.ensureHasData()];case 1:return n.sent(),t=Array.isArray(e)?e:[e],this.items=this.items.map(function(e){var n=t.find(function(t){var n=t.id;return e.id===n});return n?Object.assign({},n):e}),this.notifySubscribers(),[2]}})})},e.prototype.insert=function(e){var t=this;return this.ensureHasData().then(function(){t.items=t.items.concat(e),t.notifySubscribers()})},e.prototype.delete=function(e){var t=this,n=Array.isArray(e)?e:[e];return this.ensureHasData().then(function(){t.items=t.items.filter(function(e){return!n.some(function(t){return e.id===t})}),t.notifySubscribers()})},e}()},,,function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=[{displayName:"Administratör",mail:"vemendo@kedschools.com",roles:["ADMIN","EMPLOYEE"],school:"KED",username:"admin"},{displayName:"David",mail:"david.fahlander@vemendo.se",roles:["ADMIN","EMPLOYEE"],school:"KED",username:"david"},{displayName:"Test-Live-Elev1",mail:"ubw6757@edu.kunskapsgymnasiet.se",roles:["STUDENT"],school:"Uppsala",username:"ubw6757@edu.kunskapsgymnasiet.se"},{displayName:"Test-Live-Elev2",mail:"ums4302@edu.kunskapsgymnasiet.se",roles:["STUDENT"],school:"Uppsala",username:"ums4302@edu.kunskapsgymnasiet.se"},{displayName:"Test-Live-Elev3",mail:"uhh3460@edu.kunskapsgymnasiet.se",roles:["STUDENT"],school:"Uppsala",username:"uhh3460@edu.kunskapsgymnasiet.se"},{displayName:"Test-Live-Elev4(fel goals issue)",mail:"umt6826@edu.kunskapsskolan.se",roles:["STUDENT"],school:"Uppsala",username:"umt6826@edu.kunskapsskolan.se"},{displayName:"Test-Live-Elev5(future abilities)",mail:"ujg3833@edu.kunskapsskolan.se",roles:["STUDENT"],school:"Uppsala",username:"ujg3833@edu.kunskapsskolan.se"},{displayName:"Test-Live-Elev6(future abilities)",mail:"ujt1363@edu.kunskapsskolan.se",roles:["STUDENT"],school:"Uppsala",username:"ujt1363@edu.kunskapsskolan.se"},{displayName:"Test-Live-Lärare1",mail:"rickard.albertsson@kunskapsgymnasiet.se",roles:["EMPLOYEE"],school:"Uppsala",username:"rickard.albertsson@kunskapsgymnasiet.se"},{displayName:"EDSTestUserGymnasium",mail:"uhh3200@edu.kunskapsgymnasiet.se",roles:["STUDENT"],username:"EDSTestUser1",school:"KED",schoolType:"Gymnasium"},{displayName:"vemendo.elev@kedschools.com",mail:"vemendo.elev@kedschools.com",roles:["STUDENT"],username:"vemendo.elev@kedschools.com",school:"KED",schoolType:"Gymnasium"},{displayName:"Medarbetare Nacka",mail:"medarbetare.nacka@kunskapsskolan.se",roles:["EMPLOYEE"],username:"medarbetare.nacka/KS",school:"Nacka",schoolType:"Grundskolor"},{displayName:"Medarbetare Globen",mail:"medarbetare.globen@kunskapsgymnasiet.se",roles:["EMPLOYEE"],username:"medarbetare.globen/KS",school:"Globen",schoolType:"Gymnasium"},{displayName:"Elev Globen",mail:"elev.globen@edu.kunskapsgymnasiet.se",schoolGrade:2,roles:["STUDENT"],username:"elev.globen",school:"Globen",schoolType:"Gymnasium"},{displayName:"Elev Borås",mail:"elev.boras@edu.kunskapsskolan.se",schoolGrade:7,roles:["STUDENT"],username:"elev.boras",school:"Borås",schoolType:"Grundskolor"},{displayName:"Elev Borlänge",mail:"elev.borlange@edu.kunskapsskolan.se",schoolGrade:9,roles:["STUDENT"],username:"elev.borlange/KS",school:"Borlänge",schoolType:"Gymnasium"},{displayName:"Roll-lös",mail:"none@kunskapsskolan.se",username:"none",roles:[]}]},,,,,,,,,function(e,t,n){"use strict";var a=n(3),r=n(9),s=n(17);a.a.kedBackendClient=new s.a(r.a.KED_API_URL,a.a.bearerProvider)},function(e,t,n){"use strict";var a=n(1),r=n(10),s=n(17),o=n(6),i=n(9),l=n(3),c=n(12),u=n(2);function d(e,t,n){var s=Object(r.b)(t),o=Object(u.e)(s,c.a),i=Object(r.c)(e),l=i[0],d=i[1],m=Object(r.b)(d);return l+Object(r.a)(a.a({},m,o,{scopes:n.join(",")}))}function m(e,t){return e+"/"+t}function p(e,t,n){return new o.d(s.c,s.d,e+t.mail+location.search,i.a.KED_CLIENT_ID,i.a.KED_CLIENT_SECRET,e,{email:t.mail.toLowerCase(),roles:t.roles,school:t.school,schoolType:t.schoolType,scopes:n})}var h,f,b=l.a.currentUser&&l.a.currentUser.mail;if(b)if(i.a.KED_TOKEN_PATH){var v=d(i.a.KED_TOKEN_PATH,location.search,["kedbackend","EDS"]);l.a.bearerProvider=function(e,t){var n=m(e,t);return new s.b(e,function(e){var t=JSON.parse(e);if(!t.ok)throw new Error(t.error);return t.user&&function(e,t){l.a.currentUser=e,sessionStorage.setItem("userInfo"+t,JSON.stringify(e))}(t.user,n),{token:t.token,expires:Date.now()+354e4}},n)}(v,b),h=m(v,b),(f=sessionStorage.getItem("userInfo"+h))&&(l.a.currentUser=JSON.parse(f));var g=d(i.a.KED_TOKEN_PATH,location.search,["https://www.googleapis.com/auth/calendar.readonly"]);l.a.googleTokenProvider=function(e,t){var n=m(e,t);return new s.b(e,function(e){var t=JSON.parse(e);if(!t.ok)throw new Error(t.error);return{token:t.token,expires:Date.now()+354e4}},n)}(g,b)}else{if(!(i.a.KED_TOKEN_URL&&i.a.KED_CLIENT_ID&&i.a.KED_CLIENT_SECRET))throw new Error("Missing configuration parameter KED_TOKEN_PATH");l.a.bearerProvider=p(i.a.KED_TOKEN_URL,l.a.currentUser,["kedbackend","EDS"]),l.a.googleTokenProvider=p(i.a.KED_TOKEN_URL+"/google",l.a.currentUser,["https://www.googleapis.com/auth/calendar.readonly"])}},,function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a,r,s=n(1),o=n(0),i=n(2),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={error:void 0,info:void 0},n._unhandledRejection=n._unhandledRejection.bind(n),n._error=n._error.bind(n),n._customError=n._customError.bind(n),n._onInfo=n._onInfo.bind(n),n}return s.c(t,e),t.prototype.componentDidMount=function(){window.addEventListener("unhandledrejection",this._unhandledRejection),window.addEventListener("error",this._error),window.addEventListener("customerror",this._customError),window.addEventListener("info",this._onInfo)},t.prototype.componentWillUnmount=function(){window.removeEventListener("unhandledrejection",this._unhandledRejection),window.removeEventListener("error",this._error),window.removeEventListener("customerror",this._customError),window.removeEventListener("info",this._onInfo)},t.prototype._unhandledRejection=function(e){var t=this;this.setState({error:e.reason?e.reason.message:Object(i.a)(a||(a=s.e(["Ett okänt fel inträffade..."],["Ett okänt fel inträffade..."]))),info:null}),setTimeout(function(){return t.setState({error:null})},1e4)},t.prototype._error=function(e){var t=this;this.setState({error:e.error?e.error.message:Object(i.a)(r||(r=s.e(["Ett okänt fel inträffade..."],["Ett okänt fel inträffade..."]))),info:null}),setTimeout(function(){return t.setState({error:null})},1e4)},t.prototype._customError=function(e){var t=this;this.setState({error:e.detail,info:null}),setTimeout(function(){return t.setState({error:null})},1e4)},t.prototype._onInfo=function(e){var t=this;this.setState({error:null,info:e.detail}),setTimeout(function(){return t.setState({info:null})},1e4)},t.prototype.render=function(){return o.createElement("div",{className:"error-success-feedback",style:{position:"fixed",left:0,top:0,width:"100%",pointerEvents:"none"}},o.createElement("div",{style:{display:"table",margin:"0 auto"}},o.createElement("p",{className:"error",style:{display:this.state.error?"":"none"}},this.state.error&&this.state.error),o.createElement("p",{className:"info",style:{display:this.state.info?"":"none"}},this.state.info)))},t}(o.Component)},,,function(e,t,n){"use strict";var a=n(3),r=n(9),s=n(17),o=n(24);a.a.edsClient=new o.b(s.c,r.a.EDS_API_URL,a.a.bearerProvider)},,function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(0),r=n(40);function s(){return a.createElement("div",{className:"sv-layout"},a.createElement("h2",null,"Välj användare"),a.createElement("table",{className:"login-table"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Namn"),a.createElement("th",null,"Roller"),a.createElement("th",null,"E-post"),a.createElement("th",null,"Skola"))),a.createElement("tbody",null,r.a.map(function(e){var t=e.username,n=e.displayName,r=e.mail,s=e.school,o=e.roles;return a.createElement("tr",{key:r,onClick:function(){return location.search="?user="+t}},a.createElement("td",null,n),a.createElement("td",{style:0===o.length?{fontStyle:"italic"}:{}},0===o.length?"saknar roller":o.join(", ")),a.createElement("td",null,r),a.createElement("td",{style:s?{}:{fontStyle:"italic"}},s||"saknar skola"))}))))}},function(e,t,n){var a={"./en-au":47,"./en-au.js":47,"./en-ca":46,"./en-ca.js":46,"./en-gb":45,"./en-gb.js":45,"./en-ie":44,"./en-ie.js":44,"./en-nz":43,"./en-nz.js":43,"./sv":42,"./sv.js":42};function r(e){var t=s(e);return n(t)}function s(e){var t=a[e];if(!(t+1)){var n=new Error('Cannot find module "'+e+'".');throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(a)},r.resolve=s,e.exports=r,r.id=58},function(e,t,n){"use strict";n(50),n(49),n(55)},function(e,t,n){"use strict";var a=n(9),r=n(3),s=n(40),o=n(10);a.a.ENVIRONMENT="test",a.a.KED_TOKEN_PATH=null,a.a.KED_TOKEN_URL="https://kedauthtest.azurewebsites.net/token",a.a.KED_CLIENT_ID="testclient",a.a.KED_CLIENT_SECRET="fHjEaIla4kvdjF",a.a.KED_API_URL="https://kedbackendtest.azurewebsites.net/api/",a.a.EDS_API_URL="https://api.kedschools.se/studentportal/";var i=Object(o.b)(location.search).user;if(i){var l=s.a.find(function(e){return e.username===i});l&&(r.a.currentUser=l)}var c=Object(o.b)(location.search),u=c.role,d=c.school;r.a.currentUser&&(u&&(r.a.currentUser.roles=u.split(",")),d&&(r.a.currentUser.school=d))},,,,,,,,,function(e,t,n){"use strict";var a=n(1),r=n(0),s=n(2),o=n(16),i=n(52),l=n(11),c=n(6),u=n(3),d=[{name:"schools",text:Object(s.a)(h||(h=a.e(["Skolor"],["Skolor"]))),route:"/schools"},{name:"subjects",text:Object(s.a)(f||(f=a.e(["Ämnen"],["Ämnen"]))),route:"/subjects"}],m=[{name:"courseBuilder",text:Object(s.a)(b||(b=a.e(["Kursbyggaren"],["Kursbyggaren"]))),route:"/courses/new"},{name:"studentPage",text:Object(s.a)(v||(v=a.e(["Elevsida"],["Elevsida"]))),route:""},{name:"feedback",text:r.createElement("span",null,r.createElement("i",{className:"fa fa-commenting-o","aria-hidden":"true"})," Feedback"),route:"https://kg.kunskapsporten.se/kursbyggaren/"}];function p(e,t,n,a){var r=Object(c.e)();n.update({imageId:{$set:r},images:{$set:[{id:r,url:a,acl:["role:USER:R","schoolRole:"+u.a.currentUser.school+"/EMPLOYEE:S"],$meta:"add"}]}})}var h,f,b,v,g,k,E,y,N,C,D,w,I,T,S,O=function(e){var t=e.title,n=(e.isTemplate,e.host),i=e.course,c=(e.origCourse,e.backgroundImage),h=e.activePage,f=u.a.currentUser.roles.some(function(e){return"ADMIN"===e}),b=m;return f&&(b=d.concat(b)),r.createElement("div",{className:"sv-row sv-layout sv-skip-spacer"},r.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-12"},r.createElement("div",{className:"sv-script-portlet sv-portlet sv-skip-spacer"},c&&r.createElement("style",null,"\n        .pageHeader {\n          background-image: url('"+c+"') !important;\n        }\n      "),r.createElement("div",{className:"pageHeader",onDragOver:i&&l.a,onDrop:i&&function(e){return function(e,t,n,r){return a.b(this,void 0,void 0,function(){var n,r,o,i,c,u;return a.d(this,function(d){switch(d.label){case 0:return e.stopPropagation(),e.preventDefault(),n=e.dataTransfer.files,r=null,o=Array.from(e.dataTransfer.items),n.length>0?(i=n[0]).size>2097152?(Object(s.m)(Object(s.a)(g||(g=a.e(["Kan inte ladda upp bilder större än 2 MB"],["Kan inte ladda upp bilder större än 2 MB"])))),[2]):[4,Object(l.e)(i)]:[3,2];case 1:return r=d.sent(),[3,6];case 2:c=function(e){var t;return a.d(this,function(n){switch(n.label){case 0:return(t=o[e]).type.match("^text/uri-list")?[4,new Promise(function(e){return t.getAsString(e)})]:[3,2];case 1:r=n.sent(),n.label=2;case 2:return[2]}})},u=0,d.label=3;case 3:return u<o.length?[5,c(u)]:[3,6];case 4:d.sent(),d.label=5;case 5:return++u,[3,3];case 6:return null==r?(Object(s.m)(Object(s.a)(k||(k=a.e(["Kunde inte hitta någon bild i innehållet"],["Kunde inte hitta någon bild i innehållet"])))),[2]):(p(0,0,t,r),[2])}})})}(e,n)}},r.createElement("a",null,r.createElement("h1",null,t)),r.createElement("div",{className:"buttonsField"},r.createElement("div",{className:"buttonsContainer"},r.createElement("div",{className:"align-horizontal"}),r.createElement("div",{className:"horizontalMenu"},r.createElement("ul",null,b.map(function(t){return{item:t,isActive:h===t.name,callback:e.callbacks&&e.callbacks[t.name],givenRoute:e.routes&&e.routes[t.name],defaultRoute:t.route}}).filter(function(e){return e.callback||e.defaultRoute||e.givenRoute}).map(function(e){var t=e.item,n=e.isActive,a=e.callback,s=e.defaultRoute,i=e.givenRoute;return r.createElement("li",{key:t.name,className:n?"activePage":"",onClick:a},a?r.createElement("a",null,t.text):s||i?i||/^http[s]\:\/\//i.test(s)?r.createElement("a",{href:i||s},t.text):r.createElement(o.b,{to:s},t.text):r.createElement("a",null,t.text))})))))))))},x=n(12),j=n(13),U=function(e){var t=e.schools,n=e.viewCourseUrl,a=u.a.currentUser.roles.some(function(e){return"ADMIN"===e});return r.createElement("div",{className:"editable-school-list"},r.createElement("div",null,t?r.createElement("table",null,r.createElement("tbody",null,t.map(function(e){return r.createElement("tr",{className:"align-horizontal",key:e.id},r.createElement("td",null,r.createElement(o.b,{className:"editItem",to:"/schools/"+e.id+"/edit"})),r.createElement("td",null,r.createElement("p",null,e.name)),r.createElement("td",null,r.createElement("p",null,r.createElement("a",{style:{cursor:"pointer"},onClick:function(){return Object(x.b)({role:"EMPLOYEE",school:e.name})}},"Agera som lärare på denna skola"))),r.createElement("td",null,r.createElement("p",null,r.createElement("a",{style:{cursor:"pointer"},onClick:function(){return Object(x.b)({role:"STUDENT",school:e.name,url:n})}},"Agera som elev på denna skola"))))}))):r.createElement("p",null,r.createElement(j.a,null),"V.g. vänta medan skolor laddas")),r.createElement("br",null),t&&a&&r.createElement(o.b,{to:"/schools/new",className:"btn"},"Lägg till skola"))},R=function(e){function t(t){var n=e.call(this,t)||this;return n.state={schools:null},n}return a.c(t,e),t.prototype.componentDidMount=function(){this.load().catch(function(e){return Object(s.m)(e.message||e)})},t.prototype.load=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:return[4,u.a.kedBackendClient.list("schools")];case 1:return e=t.sent(),this.setState({schools:e}),[2]}})})},t.prototype.render=function(){var e=this.state.schools;return e&&e.sort(Object(s.g)("name")),r.createElement("div",{style:{outline:0}},r.createElement(O,{title:"Skolor",activePage:"schools",routes:{feedback:this.props.feedbackUrl}}),r.createElement("div",{className:"sv-row sv-layout"},r.createElement("div",{className:"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer"},r.createElement(U,{schools:e,viewCourseUrl:this.props.viewCourseUrl}))))},t}(r.Component),M=function(e){function t(t){var n=e.call(this,t)||this;return n.state=null,n}return a.c(t,e),t.prototype.componentDidMount=function(){this.load().catch(function(e){return Object(s.m)(e)})},t.prototype.load=function(){return a.b(this,void 0,void 0,function(){var e,t;return a.d(this,function(n){switch(n.label){case 0:return this.props.id?(e=this.props.id,[4,u.a.kedBackendClient.get("schools",e)]):[3,2];case 1:return t=n.sent(),this.origSchool=a.a({},t),this.setState(a.a({},t)),[3,3];case 2:this.setState({id:Object(c.e)()}),n.label=3;case 3:return[2]}})})},t.prototype.save=function(){return a.b(this,void 0,void 0,function(){var e,t;return a.d(this,function(n){switch(n.label){case 0:return e=new c.a,t=a.a({},this.state),this.origSchool?[3,1]:(t.acl=["role:USER:R"],t.acl.push(new c.b("schoolRole",t.name+"/EMPLOYEE","W").toString()),e.add("schools",t),[3,5]);case 1:return this.origSchool.name===this.state.name?[3,4]:(e.unshare("schools",t.id,[new c.b("schoolRole",this.origSchool.name+"/EMPLOYEE","W")].map(function(e){return e.toString()})),this.origSchool.name.toLowerCase()!==this.state.name.toLowerCase()?[3,3]:[4,u.a.kedBackendClient.batch(e.mutationRequests)]);case 2:n.sent(),e.mutationRequests=[],n.label=3;case 3:return e.share("schools",this.state.id,[new c.b("schoolRole",this.state.name+"/EMPLOYEE","W")].map(function(e){return e.toString()})),e.put("schools",t),[3,5];case 4:e.put("schools",t),n.label=5;case 5:return[4,u.a.kedBackendClient.batch(e.mutationRequests)];case 6:return n.sent(),location.hash="#/schools",[2]}})})},t.prototype.deleteSchool=function(){return a.b(this,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return confirm(Object(s.a)(E||(E=a.e(['Är du säker på att ta bort skolan "','"'],['Är du säker på att ta bort skolan "','"'])),this.state.name))?[4,u.a.kedBackendClient.delete("schools",this.state.id)]:[3,2];case 1:e.sent(),location.hash="#/schools",e.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.title,i=!!t.id,l=this.state,c=this.origSchool,d=u.a.currentUser.roles.some(function(e){return"ADMIN"===e});return r.createElement("div",{style:{outline:0}},r.createElement(O,{title:"Skolor",activePage:"schools",callbacks:{schools:function(){return location.hash="#/schools"}},routes:{feedback:this.props.feedbackUrl}}),r.createElement("div",{className:"sv-row sv-layout"},r.createElement("div",{className:"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer"},r.createElement("h2",null,n),r.createElement("hr",null),r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},"Namn:"),r.createElement("div",{className:"horizontalItem top"},r.createElement("input",{type:"text",autoFocus:!0,disabled:!d,tabIndex:1,size:50,value:l?l.name:"",onChange:function(t){return e.setState({name:t.target.value})}})),r.createElement("div",{className:"horizontalItem top spaced"})),d&&i&&r.createElement("div",{tabIndex:2,className:"btn btn-warning btn-large pull-right",onClick:function(){return e.deleteSchool().catch(s.m)}},"Ta bort skola"),r.createElement("div",{className:"pull-right"}," "),r.createElement(o.b,{className:"btn btn-warning btn-large pull-right",to:"/schools"},"Avbryt"),d&&r.createElement("a",{tabIndex:1,className:"btn btn-large",onClick:function(){c&&c.name!==l.name&&!confirm(Object(s.a)(y||(y=a.e(["Är du säker på att du vill döpa om skolan? Detta påverkar portalens funktion för lärare och elever som tillhör skolan. Namnet måste stämma exakt överens med namngivningen av skolan på användarobjekten.\n\nDet som händer annars är att elever och lärare på skolan inte längre hittar några kurser.\n\nBlir det fel kan du dock alltid bara döpa tillbaka skolans namn."],["Är du säker på att du vill döpa om skolan? Detta påverkar portalens funktion för lärare och elever som tillhör skolan. Namnet måste stämma exakt överens med namngivningen av skolan på användarobjekten.\n\nDet som händer annars är att elever och lärare på skolan inte längre hittar några kurser.\n\nBlir det fel kan du dock alltid bara döpa tillbaka skolans namn."]))))||e.save().catch(s.m)}},"Spara"))))},t}(r.Component),L=function(e){return r.createElement(M,{title:"Lägg till skola",feedbackUrl:e.feedbackUrl})},A=n(8),B=n.n(A),P=function(e){function t(t){var n=e.call(this,t)||this;return n.coursesElems={},n.centralContentElems=[],n.knowledgeRequirementElems=[],n.state={showFullText:!1,changes:[],isWorking:!0,isImporting:!1},n}return a.c(t,e),t.prototype.componentDidMount=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:this.addClassesForCherryPickedElements(),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,this.diffWithExisting()];case 2:return e=t.sent(),this.setState({changes:e}),[3,4];case 3:return this.setState({isWorking:!1}),[7];case 4:return[2]}})})},t.prototype.addClassesForCherryPickedElements=function(){var e=B()(this.purposeElem).find("li").first().parent().children("li");e.addClass("ability");var t=B()(this.centralContentElems).find("li");t.addClass("central-content");var n=B()(this.knowledgeRequirementElems).find("p");n.addClass("knowledge-requirement"),B()([e,t,n]).addClass("marked-area")},t.prototype.cherryPickData=function(){var e=this,t=this.props,n=Array.from(B()(this.purposeElem).find("li").first().parent().children("li"));return{name:t.name,code:t.code,abilities:n.map(function(e,t){return t+1+". "+B()(e).html()}),courses:Object.keys(this.coursesElems).map(function(t){return e.coursesElems[t]}).map(function(e){var t=e.course,n=e.elem;return{name:t.name,code:t.code,points:t.points,centralContent:Array.from(B()(n).find(".central-content")).map(function(e){return B()(e).html()}),knowledgeRequirements:Array.from(B()(n).find(".grade-step-E .knowledge-requirement")).map(function(e){return B()(e).html()}).map(function(e){return{gradeStep:"E",html:e}}).concat(Array.from(B()(n).find(".grade-step-C .knowledge-requirement")).map(function(e){return B()(e).html()}).map(function(e){return{gradeStep:"C",html:e}})).concat(Array.from(B()(n).find(".grade-step-A .knowledge-requirement")).map(function(e){return B()(e).html()}).map(function(e){return{gradeStep:"A",html:e}}))}})}},t.prototype.diffWithExisting=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r,s,o,i,l,d,m,p,h,f,b,v,g,k,E,y,N,C,D,w=this;function I(){var e=i;return i+=2,e}return a.d(this,function(T){switch(T.label){case 0:return e=this.cherryPickData(),t=[],[4,u.a.kedBackendClient.list("subjects")];case 1:return n=T.sent(),r=n.filter(function(e){return e.code===w.props.code})[0],s=[],o=[],i=Date.now(),r?[4,u.a.kedBackendClient.get("subjects",r.id,{include:"courseTemplates"})]:[3,8];case 2:return r=T.sent(),[4,Promise.all(r.courseTemplates.map(function(e){return u.a.kedBackendClient.get("courses",e.id,{include:["centralContent","knowledgeRequirements"]})}))];case 3:l=T.sent(),d=function(n){var r,s,o,i,l,c,d,m;return a.d(this,function(p){switch(p.label){case 0:if(r=e.courses.find(function(e){return e.name===n.name}),(s=r.centralContent.map(function(e){return n.centralContent.filter(function(t){return t.name===e}).map(function(e){return e.id})[0]})).some(function(e){return!e}))throw new Error("Could not lookup all central contents!");if((o=r.knowledgeRequirements.map(function(e){return n.knowledgeRequirements.filter(function(t){return t.name===e.html&&t.gradeStep===e.gradeStep}).map(function(e){return e.id})[0]})).some(function(e){return!e}))throw new Error("Could not lookup all knowledge requirements!");return[4,u.a.kedBackendClient.list("courses",{name:n.name})];case 1:for(i=(i=p.sent()).filter(function(t){return t.subjectCode===e.code}),l=function(e){e.centralContentOrder&&e.knowledgeRequirementsOrder&&e.centralContentOrder.join(",")===s.join(",")&&e.knowledgeRequirementsOrder.join(",")===o.join(",")||(e.centralContentOrder=s,e.knowledgeRequirementsOrder=o,t.push({change:"Uppdatera ordningen för centralt innehåll och kunskapskrav",content:e.name+" på "+e.school+" ("+e.description+")",mutations:function(t){t.put("courses",a.a({},e))}}))},c=0,d=i;c<d.length;c++)m=d[c],l(m);return[2]}})},m=0,p=l,T.label=4;case 4:return m<p.length?(h=p[m],[5,d(h)]):[3,7];case 5:T.sent(),T.label=6;case 6:return m++,[3,4];case 7:return[3,9];case 8:for(f=r={id:Object(c.e)(),acl:["role:USER:R"],code:e.code,name:e.name,publishable:!1,dateTime:I()},t.push({change:"Nytt ämne",content:e.name+" ("+e.code+")",mutations:function(e){return e.add("subjects",f)}}),b=[],v=function(e){var n={id:Object(c.e)(),name:e,acl:["role:USER:R"],dateTime:I()};b.push(n),t.push({change:"Ny förmåga",content:e,mutations:function(e){e.add("abilities",n),e.link("subjects",f.id,"abilities",n.id,"abilities")}})},g=0,k=e.abilities;g<k.length;g++)E=k[g],v(E);for(y=function(e){var n={id:Object(c.e)(),subjectCode:f.code,tags:["sub:"+f.code],dateTime:I(),isTemplate:!0,acl:["role:EMPLOYEE:R"],name:e.name,code:e.code,points:e.points,modules:[],subjectId:f.id,resources:[],createdBy:{name:u.a.currentUser.displayName,url:"mailto:"+u.a.currentUser.mail},createdDate:Date.now(),knowledgeRequirementsOrder:[],centralContentOrder:[]};t.push({change:"Ny kurs",content:e.name,mutations:function(e){e.add("courses",n),e.link("subjects",f.id,"courses",n.id,"courseTemplates")}});for(var a=function(e){var a=s.filter(function(t){return t.name===e})[0];a?t.push({mutations:function(e){e.link("courses",n.id,"central-content",a.id,"centralContent")}}):(a={id:Object(c.e)(),dateTime:I(),name:e,acl:["role:USER:R"]},s.push(a),t.push({change:"Nytt centralt innehåll",content:e,mutations:function(e){e.add("central-content",a),e.link("courses",n.id,"central-content",a.id,"centralContent")}})),n.centralContentOrder.push(a.id)},r=0,i=e.centralContent;r<i.length;r++){a(i[r])}for(var l=function(e){var a=o.filter(function(t){return t.name===e.html&&t.gradeStep===e.gradeStep})[0];a?t.push({mutations:function(e){e.link("courses",n.id,"knowledge-requirements",a.id,"knowledgeRequirements")}}):(a={id:Object(c.e)(),dateTime:I(),name:e.html,gradeStep:e.gradeStep,acl:["role:USER:R"]},o.push(a),t.push({change:"Nytt kunskapskrav för betyget "+e.gradeStep,content:e.html,mutations:function(e){e.add("knowledge-requirements",a),e.link("courses",n.id,"knowledge-requirements",a.id,"knowledgeRequirements")}})),n.knowledgeRequirementsOrder.push(a.id)},d=0,m=e.knowledgeRequirements;d<m.length;d++){l(m[d])}for(var p=function(e){t.push({mutations:function(t){t.link("courses",n.id,"abilities",e.id,"abilities")}})},h=0,v=b;h<v.length;h++){p(v[h])}},N=0,C=e.courses;N<C.length;N++)D=C[N],y(D);T.label=9;case 9:return[2,t]}})})},t.prototype.cancel=function(){this.props.onCancel()},t.prototype.import=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:this.setState({isWorking:!0,isImporting:!0}),e=this.state.changes.map(function(e){return e.mutations}),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,u.a.kedBackendClient.do(function(t){e.forEach(function(e){return e(t)})})];case 2:return t.sent(),[3,4];case 3:return this.setState({isWorking:!1,isImporting:!1}),[7];case 4:return this.props.onImportSuccess(this.props.name),[2]}})})},t.prototype.fixL=function(e){return e},t.prototype.render=function(){var e=this;return r.createElement("div",null,r.createElement("h1",null,Object(s.a)(N||(N=a.e(["Uppladdat Ämne"],["Uppladdat Ämne"])))),this.state.isWorking?r.createElement("p",null,"Arbetar..."):this.state.isImporting?r.createElement("p",null,"Importerar..."):0===this.state.changes.length?r.createElement("div",null,r.createElement("p",null,"Ämnet redan importerat."),r.createElement("button",{onClick:function(){return e.cancel()}}," OK ")):r.createElement("div",null,r.createElement("table",null,r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{colSpan:2},"Granskning av ändringar i grund-data")),r.createElement("tr",null,r.createElement("th",null,"Ändring"),r.createElement("th",null,"Innehåll"))),r.createElement("tbody",null,this.state.changes.filter(function(e){return e.change}).map(function(e){return r.createElement("tr",{key:e.change+e.content},r.createElement("td",null,e.change),r.createElement("td",{dangerouslySetInnerHTML:{__html:e.content}}))}))),r.createElement("button",{onClick:function(){return e.cancel()},disabled:this.state.isImporting},"Avbryt"),r.createElement("button",{onClick:function(){return e.import()},disabled:this.state.isImporting},"Importera"),r.createElement("br",null)),r.createElement("button",{onClick:function(){return e.setState({showFullText:!e.state.showFullText})}},this.state.showFullText?Object(s.a)(C||(C=a.e(["Dölj nedan"],["Dölj nedan"]))):Object(s.a)(D||(D=a.e(["Visa hela texten från Skolverket"],["Visa hela texten från Skolverket"])))),r.createElement("table",{style:{display:this.state.showFullText?"":"none"}},r.createElement("tbody",null,r.createElement("tr",null,r.createElement("th",null,"Namn"),r.createElement("td",null,this.props.name)),r.createElement("tr",null,r.createElement("th",null,"Ämneskod"),r.createElement("td",null,this.props.code)),r.createElement("tr",null,r.createElement("th",null,"Syfte"),r.createElement("td",{ref:function(t){return e.purposeElem=t},dangerouslySetInnerHTML:{__html:this.fixL(this.props.purpose)}})),r.createElement("tr",null,r.createElement("th",null,"Kurser"),r.createElement("td",null,this.props.courses.map(function(t){return r.createElement("table",{key:t.code,ref:function(n){return e.coursesElems[t.code]={course:t,elem:n}}},r.createElement("tbody",null,r.createElement("tr",null,r.createElement("th",null,"Kursens namn"),r.createElement("td",null,t.name)),r.createElement("tr",null,r.createElement("th",null,"Kurskod"),r.createElement("td",null,t.code)),r.createElement("tr",null,r.createElement("th",null,"Poäng"),r.createElement("td",null,t.points)),r.createElement("tr",null,r.createElement("th",null,"Centralt innehåll"),r.createElement("td",{ref:function(t){return e.centralContentElems.push(t)},dangerouslySetInnerHTML:{__html:e.fixL(t.centralContent)}})),r.createElement("tr",null,r.createElement("th",null,"Kunskapskrav Betyg E"),r.createElement("td",{className:"grade-step-E",ref:function(t){return e.knowledgeRequirementElems.push(t)},dangerouslySetInnerHTML:{__html:e.fixL(t.knownledgeRequirements.filter(function(e){return"E"===e.gradeStep})[0].text)}})),r.createElement("tr",null,r.createElement("th",null,"Kunskapskrav Betyg C"),r.createElement("td",{className:"grade-step-C",ref:function(t){return e.knowledgeRequirementElems.push(t)},dangerouslySetInnerHTML:{__html:e.fixL(t.knownledgeRequirements.filter(function(e){return"C"===e.gradeStep})[0].text)}})),r.createElement("tr",null,r.createElement("th",null,"Kunskapskrav Betyg A"),r.createElement("td",{className:"grade-step-A",ref:function(t){return e.knowledgeRequirementElems.push(t)},dangerouslySetInnerHTML:{__html:e.fixL(t.knownledgeRequirements.filter(function(e){return"A"===e.gradeStep})[0].text)}}))))}))))))},t}(r.Component),_=function(e){function t(t){var n=e.call(this,t)||this;return n.state={subject:null},n}return a.c(t,e),t.prototype.componentWillMount=function(){this.load()},t.prototype.load=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:return[4,u.a.kedBackendClient.get("subjects",this.props.id,{include:"courseTemplates"})];case 1:return e=t.sent(),this.setState({subject:e}),[2]}})})},t.prototype.render=function(){if(!this.state.subject)return r.createElement("p",null,r.createElement(j.a,null));var e=this.state.subject,t=e.name,n=e.code,a=e.courseTemplates;return r.createElement("div",null,r.createElement(O,{title:t,activePage:"subjects",routes:{feedback:this.props.feedbackUrl}}),r.createElement("h2",null,"Kurser för ämnet ",t," (",n,")"),r.createElement("ul",{className:"entity-list"},a.map(function(e){var t=e.id,n=e.name,a=(e.code,e.publishable,e.points);return r.createElement("li",{key:t,className:"complete"},n," - ",a,"p")})))},t}(r.Component),z=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isListingSubjects:!0,subjects:[],uploadedSubject:null},n}return a.c(t,e),t.prototype.componentWillMount=function(){this.load()},t.prototype.load=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:return[4,u.a.kedBackendClient.list("subjects")];case 1:return(e=t.sent()).sort(Object(s.g)("name")),this.setState({subjects:e,isListingSubjects:!1}),[2]}})})},t.prototype.handleFileSelect=function(e){return a.b(this,void 0,void 0,function(){var t,n,r,s,o,i,c,u;return a.d(this,function(a){switch(a.label){case 0:return e.stopPropagation(),e.preventDefault(),t=e.dataTransfer.files,[4,Object(l.f)(t[0])];case 1:for(n=a.sent(),r=B()(B.a.parseXML(n)),s={name:r.find("subject>name").text(),code:r.find("subject>code").text(),purpose:r.find("subject>purpose").text(),courses:[]},o=r.find("subject>courses"),i=0;i<o.length;++i)c=B()(o[i]),u=[].slice.call(c.find("knowledgeRequirements")).map(function(e){return{gradeStep:B()(e).find("gradeStep").text(),text:B()(e).find("text").text()}}),s.courses.push({name:c.find("name").text(),code:c.find("code").text(),centralContent:c.find("centralContent").text(),points:parseInt(c.find("point").text()),knownledgeRequirements:u});return this.setState({uploadedSubject:s}),[2]}})})},t.prototype.onImportSuccess=function(e){Object(s.n)(Object(s.a)(w||(w=a.e(["Importen av "," lyckades"],["Importen av "," lyckades"])),e)),this.setState({uploadedSubject:null}),this.load()},t.prototype.render=function(){var e=this;return r.createElement("div",null,r.createElement(O,{title:Object(s.a)(I||(I=a.e(["Ämnen"],["Ämnen"]))),activePage:"subjects",routes:{feedback:this.props.feedbackUrl}}),this.state.uploadedSubject?r.createElement(P,a.a({onCancel:function(){return e.setState({uploadedSubject:null})},onImportSuccess:function(t){return e.onImportSuccess(t)}},this.state.uploadedSubject)):this.state.isListingSubjects?r.createElement("div",null,r.createElement("p",null,r.createElement(j.a,null),"Var god vänta medan ämnen hämtas...")):r.createElement("div",null,r.createElement("h2",null,Object(s.a)(T||(T=a.e(["Ämnen"],["Ämnen"])))),r.createElement("ul",null,this.state.subjects.map(function(e){return r.createElement("li",{key:e.id,className:e.publishable?"complete":"incomplete"},r.createElement(o.b,{to:"/subjects/"+e.id},e.name))})),r.createElement("div",{className:"drop-zone",onDragOver:l.a,onDrop:function(t){return e.handleFileSelect(t)}},"Droppa Subject-fil här från skolverket (Hämtas från ",r.createElement("a",{href:"http://opendata.skolverket.se",target:"skolverket"},"opendata.skolverket.se"),")")))},t}(r.Component),K=n(20),G=n(35),H=n.n(G),F=function(e){function t(t){var n=e.call(this,t)||this;return n.state=n.props.resource||{name:"",url:""},n}return a.c(t,e),t.prototype.save=function(){var e=this.state;if(!H.a.isUri(e.url))throw new Error(Object(s.a)(S||(S=a.e(["Angiven URL '","' är ogiltig. Ska börja med exempelvis http:, https: eller mailto:"],["Angiven URL '","' är ogiltig. Ska börja med exempelvis http:, https: eller mailto:"])),e.url));this.props.onSave(e)},t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.onSave,s=t.onDelete,o=this.state,i=H.a.isUri(this.state.url);return r.createElement("div",null,r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},r.createElement("h2",null,n),r.createElement("hr",null),r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},"Namn:"),r.createElement("div",{className:"horizontalItem top"},r.createElement("input",{type:"text",autoFocus:!0,tabIndex:1,size:50,value:o.name,onChange:function(t){return e.setState({name:t.target.value})}})),r.createElement("div",{className:"horizontalItem top spaced"})),r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},"Länk:"),r.createElement("div",{className:"horizontalItem top "},r.createElement("input",{type:"text",tabIndex:1,size:50,value:o.url,onChange:function(t){return e.setState({url:t.target.value})}})),r.createElement("div",{className:"horizontalItem top spaced"})),r.createElement("br",null)),r.createElement("div",{className:"sv-html-portlet sv-portlet"},(o.createdDate||o.modifiedDate)&&r.createElement("div",null,o.createdDate&&r.createElement("p",null,"Resursen/Länken skapades ",Object(l.c)(o.createdDate)," av ",r.createElement("strong",null,o.createdBy.name),"."),o.modifiedDate&&r.createElement("p",null,"Resursen/Länken redigerades senast ",Object(l.c)(o.modifiedDate)," av ",r.createElement("strong",null,o.modifiedBy.name),"."),r.createElement("br",null),r.createElement("br",null)),s&&r.createElement("div",{tabIndex:2,className:"btn btn-warning btn-large pull-right",onClick:function(){return s()}},"Ta bort resurs/länk"),r.createElement("a",{tabIndex:1,className:"btn btn-large"+(i?"":" btn-inactive"),onClick:i&&function(){return a(o)}},"Spara")))},t}(r.Component),q=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.host,n=e.onUpdate,a=e.resources;return r.createElement("div",null,r.createElement("div",{className:"taskContainer"},a.map(function(e,a){return r.createElement("div",{className:"align-horizontal",key:a},r.createElement("div",{className:"horizontalItem top"},r.createElement("a",{className:"editItem",onClick:function(){return t.openDialog({Component:F,props:{title:"Redigera resurs",resource:e,onSave:function(e){var r=Object(l.k)(e,u.a.currentUser);n({$splice:[[a,1,r]]}),t.closeDialog()},onDelete:function(){n({$splice:[[a,1]]}),t.closeDialog()}}})}})),r.createElement("div",{className:"horizontalItem top"},r.createElement("a",{href:e.url,target:"_blank"},e.name)))})),r.createElement("a",{className:"btn",onClick:function(){return t.openDialog({Component:F,props:{title:"Lägg till resurs",onSave:function(e){var a=Object(l.k)(e,u.a.currentUser);n({$push:[a]}),t.closeDialog()}}})}},r.createElement("i",{className:"fa fa-paperclip","aria-hidden":!0})," Lägg till resurs"))},t}(r.Component),$=function(e){function t(t){return e.call(this,t)||this}return a.c(t,e),t.prototype.render=function(){for(var e=this.props,t=e.knowledgeRequirements,n=e.markedIds,a=this.props,s=a.idsToMarkNotOk,o=a.markMode,i=a.onMarkChanged,l=["E","C","A"],c=[],u=t.slice(),d=null;!(d=l.map(function(e){var t=u.findIndex(function(t){return t.gradeStep.toUpperCase()===e});if(t<0)return null;var n=u[t];return u.splice(t,1),n})).every(function(e){return null===e});)c.push(d);return r.createElement("div",null,r.createElement("table",null,r.createElement("thead",null,r.createElement("tr",null,l.map(function(e){return r.createElement("th",{key:e},e)}))),r.createElement("tbody",null,c.map(function(e,t){return r.createElement("tr",{key:t},e.map(function(e,t){var a=e&&n&&n.indexOf(e.id)>=0,l=e&&s&&s[e.id];return r.createElement("td",{key:t,dangerouslySetInnerHTML:{__html:e?e.name:""},className:(o?"selectable":"")+(a?" markedGreen":l?" markedRed":""),onClick:o&&e?function(){return i(e.id,!a)}:void 0})}))}))))},t}(r.Component),V=n(22),Y=n.n(V),W=n(25),J=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return a.c(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.options,a=t.title,s=t.markedIds,o=t.markMode;return r.createElement(W.a,{title:r.createElement("p",null,a),className:"larger"},n.map(function(t){var n=s.some(function(e){return e===t.id});return r.createElement("div",{className:"align-horizontal",key:t.id,onClick:function(){return o&&e.props.onMarkChanged(t.id,!n)}},r.createElement("div",{className:"horizontalItem top spaced"+(o?" selectable":"")+(n?" markedGreen":"")},r.createElement("p",{dangerouslySetInnerHTML:{__html:t.name}}),r.createElement("br",null)))}))},t}(r.Component),X=function(){function e(e){this.queryer=e,this.promise=null,this.result=null}return e.prototype.query=function(){var e=this;return this.promise?this.promise:this.promise=this.queryer().then(function(t){return e.result=t})},e.prototype.reset=function(){this.promise=null},e}(),Q=(function(){}(),["Lära att lära","Samarbeta","Agera globalt","Visa handlingskraft","Vara innovativ","Leva digitalt"]),Z=new DOMParser,ee={b:{},i:{},p:{},u:{},strike:{},pre:{},h1:{},h2:{},h3:{},h4:{},h5:{},img:{src:!0,class:!0,style:!0,tabindex:!0},a:{href:!0,target:!0},ul:{},ol:{},li:{},hr:{},br:{},div:{},span:{},table:{border:!0},tbody:{},thead:{},tfoot:{},tr:{},td:{headers:!0,colspan:!0,rowspan:!0},th:{abbr:!0,headers:!0,scope:!0,sorted:!0,colspan:!0,rowspan:!0}};function te(e){for(var t=Z.parseFromString(e,"text/html"),n=t.body.childNodes,a=!1,r=0;r<n.length;++r)ne(n.item(r))&&(a=!0);return a?t.body.innerHTML:e}function ne(e){var t=!1;return function(e){return!!e.tagName}(e)&&function(e){var t=e.tagName&&ee[e.tagName.toLowerCase()];if(!t)return console.warn("Wysiwyg: not allowed tag",e.tagName),ae(e),function(e){for(var t=e.childNodes,n=0;n<t.length;++n)e.parentNode.insertBefore(t.item(n),e);e.remove()}(e),!0;for(var n=!1,a=0;a<e.attributes.length;++a){var r=e.attributes.item(a),s=r.name&&!!t[r.name.toLowerCase()];s||(n=!0,console.warn("Wysiwyg: not allowed attribute",r.name),e.removeAttribute(r.name))}return n}(e)&&(t=!0),ae(e)&&(t=!0),t}function ae(e){for(var t=!1,n=e.childNodes,a=0;a<n.length;++a)ne(n.item(a))&&(t=!0);return t}var re=function(e,t){void 0===t&&(t=null),document.execCommand(e,!1,t)},se={bold:{icon:"<b>B</b>",title:"Bold",result:function(){return re("bold")}},italic:{icon:"<i>I</i>",title:"Italic",result:function(){return re("italic")}},underline:{icon:"<u>U</u>",title:"Underline",result:function(){return re("underline")}},strikethrough:{icon:"<strike>S</strike>",title:"Strike-through",result:function(){return re("strikeThrough")}},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Heading 1",result:function(){return re("formatBlock","<H1>")}},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Heading 2",result:function(){return re("formatBlock","<H2>")}},heading3:{icon:"<b>H<sub>3</sub></b>",title:"Heading 3",result:function(){return re("formatBlock","<H3>")}},paragraph:{icon:"&#182;",title:"Paragraph",result:function(){return re("formatBlock","<P>")}},quote:{icon:"&#8220; &#8221;",title:"Quote",result:function(){return re("formatBlock","<BLOCKQUOTE>")}},olist:{icon:"&#35;",title:"Ordered List",result:function(){return re("insertOrderedList")}},ulist:{icon:"&#8226;",title:"Unordered List",result:function(){return re("insertUnorderedList")}},code:{icon:"&lt;/&gt;",title:"Code",result:function(){return re("formatBlock","<PRE>")}},line:{icon:"&#8213;",title:"Horizontal Line",result:function(){return re("insertHorizontalRule")}},link:{icon:"&#128279;",title:"Link",result:function(){var e=window.prompt("Enter the link URL");e&&re("createLink",e)}},image:{icon:"&#128247;",title:"Image",result:function(){var e=window.prompt("Enter the image URL");e&&re("insertImage",e)}}},oe="wysiwyg-actionbar",ie="wysiwyg-button",le="wysiwyg-content",ce="wysiwyg-focusrect",ue="wysiwyg-focuspoint",de="wysiwyg-content readonly",me=function(e){function t(t){var n=e.call(this,t)||this;return n.state={focusRect:null},n.onFocus=n.onFocus.bind(n),n.onBlur=n.onBlur.bind(n),n.onMouseDown=n.onMouseDown.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return a.c(t,e),t.prototype.componentDidMount=function(){var e=this;Array.from(this.contentDiv.querySelectorAll("img,a")).map(function(e){return e}).forEach(function(t){t.tabIndex=1,t.onfocus=e.onFocus,t.onblur=e.onBlur}),document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},t.prototype.componentDidUpdate=function(){var e=this;Array.from(this.contentDiv.querySelectorAll("img,a")).map(function(e){return e}).forEach(function(t){t.tabIndex=1,t.onfocus=e.onFocus,t.onblur=e.onBlur})},t.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},t.prototype.shouldComponentUpdate=function(e,t){return!this.contentDiv||t!=this.state||e.readOnly!==this.props.readOnly||e.html!==this.contentDiv.innerHTML},t.prototype.triggerOnChange=function(e){this.props.onChange&&this.props.onChange(te(e))},t.prototype.onFocus=function(e){var t=e.target;if(t&&t.tagName&&("IMG"===t.tagName||"A"===t.tagName)){var n={focusRect:pe(this.contentDiv.parentElement,t)};t.tagName,this.setState(n),this.focusElem=t}},t.prototype.onBlur=function(e){(e.target===this.focusElem&&e.relatedTarget!==this.focusRectDiv||e.target===this.focusRectDiv)&&this.setState({focusRect:null})},t.prototype.makeClickable=function(e){e.tabIndex=1},t.prototype.onMouseDown=function(e){if((e.target.className||"").split(" ").indexOf(ue)>=0){var t=this.getRectCorner(e);this.corner=t,this.resizeStartX=e.clientX}},t.prototype.onMouseMove=function(e){if(this.corner&&this.state.focusRect&&this.focusElem){e.preventDefault();var t=this.focusRectDiv.getBoundingClientRect();if(t.width<32)return;var n=Math.max(32,this.corner.endsWith("l")?t.width+(this.resizeStartX-e.clientX):t.width-(this.resizeStartX-e.clientX));this.resizeStartX=e.clientX;var a=n/t.width,r=t.height*a;this.focusElem.style.width=n+"px",this.focusElem.style.height=r+"px",this.setState({focusRect:pe(this.contentDiv.parentElement,this.focusElem)})}},t.prototype.onMouseUp=function(e){this.corner&&this.state.focusRect&&this.focusElem&&(this.corner=null,this.triggerOnChange(this.contentDiv.innerHTML))},t.prototype.getRectCorner=function(e){for(var t=0,n=(e.target.className||"").split(" ");t<n.length;t++){switch(n[t]){case"fpul":return"ul";case"fpur":return"fpur";case"fplr":return"lr";case"fpll":return"ll"}}return null},t.prototype.execImageEditAction=function(e){if(this.focusElem){switch(e){case"float-left":this.focusElem.style.cssFloat="left";break;case"float-right":this.focusElem.style.cssFloat="right";break;case"unfloat":this.focusElem.style.cssFloat=""}this.triggerOnChange(this.contentDiv.innerHTML),this.setState({focusRect:pe(this.contentDiv.parentElement,this.focusElem)})}},t.prototype.render=function(){var e,t=this,n=this.props.defaultActions||se,s=this.props.actions?this.props.actions.map(function(e){return"string"==typeof e?n[e]:n[e.name]?a.a({},n[e.name],e):e}):Object.keys(n).map(function(e){return n[e]});this.state.focusRect&&(s=s.concat((e=function(e){return t.execImageEditAction(e)},[{name:"float-left",icon:'<div style="position:relative">\n      <i class="fa fa-align-right" aria-hidden="true"></i>\n      <div style="position:absolute; left:-4px;top:0; transform: scale(0.5); transform-origin: left top">\n        <i class="fa fa-picture-o" aria-hidden="true"></i>\n      </div>\n    </div>',title:"Låt bilden flyta vänster om text",result:function(){return e("float-left")}},{name:"float-right",icon:'<div style="position:relative">\n      <i class="fa fa-align-left" aria-hidden="true"></i>\n      <div style="position:absolute; right:-4px;top:0; transform: scale(0.5); transform-origin: right top">\n        <i class="fa fa-picture-o" aria-hidden="true"></i>\n      </div>\n    </div>',title:"Låt bilden flyta höger om text",result:function(){return e("float-right")}},{name:"unfloat",icon:'<div style="position:relative;" aria-hidden="true">\n      <div style="position:absolute;top:0;left:0">&#8254;</div>\n      <div style="position:absolute;top:0:left:0;transform: scale(0.5); transform-origin: left bottom">\n        <i class="fa fa-picture-o" aria-hidden="true"></i>\n      </div>\n      <div style="position:absolute;top:0;left:0">_</div>\n    </div>',title:"Placera bilden på egen rad",result:function(){return e("unfloat")}}])));var o=this.state.focusRect,i=this.props.readOnly;return r.createElement("div",{className:this.props.className},!i&&r.createElement("div",{className:oe},s.map(function(e,n){return r.createElement("button",{key:n,className:ie,dangerouslySetInnerHTML:{__html:e.icon},title:e.title,onMouseDown:function(n){e.result(n,t)},onMouseUp:function(e){return setTimeout(function(){return t.contentDiv.focus()},10)}})})),r.createElement("div",{className:i?de:le,style:{position:"relative",top:0,left:0}},r.createElement("div",{className:"editor",ref:function(e){return t.contentDiv=e},dangerouslySetInnerHTML:{__html:te(this.props.html)},contentEditable:!i,onInput:function(e){return t.triggerOnChange(e.target.innerHTML)},onKeyDown:function(e){i||(e.which>=35&&e.which<=40&&e.stopPropagation(),9===e.which&&e.preventDefault(),(8===e.keyCode||46===e.keyCode)&&t.focusElem&&t.state.focusRect&&(t.focusElem&&t.focusElem.parentElement&&t.focusElem.parentElement.removeChild(t.focusElem),t.focusElem=null,t.setState({focusRect:null}),t.triggerOnChange(t.contentDiv.innerHTML)))}}),o&&r.createElement("div",{ref:function(e){return t.focusRectDiv=e},className:ce,onBlur:this.onBlur,tabIndex:1,style:{outline:0,position:"absolute",top:this.state.focusRect.top,left:this.state.focusRect.left,width:this.state.focusRect.width,height:this.state.focusRect.height}},r.createElement("div",{className:ue+" fpul",style:{position:"absolute",top:0,left:0}}),r.createElement("div",{className:ue+" fpur",style:{position:"absolute",top:0,right:0}}),r.createElement("div",{className:ue+" fplr",style:{position:"absolute",bottom:0,right:0}}),r.createElement("div",{className:ue+" fpll",style:{position:"absolute",bottom:0,left:0}}))))},t}(r.Component);function pe(e,t){var n=e.getBoundingClientRect(),a=t.getBoundingClientRect();return{top:a.top-n.top+e.scrollTop,left:a.left-n.left+e.scrollLeft,bottom:a.bottom-n.top+e.scrollTop,right:a.right-n.left+e.scrollLeft,width:a.width,height:a.height}}var he={bold:{icon:"<b>F</b>",title:"Fetstil",result:function(){return re("bold")}},italic:{icon:"<i>K</i>",title:"Kursiv",result:function(){return re("italic")}},underline:{icon:"<u>U</u>",title:"Understruken",result:function(){return re("underline")}},strikethrough:{icon:"<strike>S</strike>",title:"Struken",result:function(){return re("strikeThrough")}},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Rubrik 1",result:function(){return re("formatBlock","<H1>")}},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Rubrik 2",result:function(){return re("formatBlock","<H2>")}},heading3:{icon:"<b>H<sub>3</sub></b>",title:"Rubrik 3",result:function(){return re("formatBlock","<H3>")}},paragraph:{icon:"&#182;",title:"Paragraf",result:function(){return re("formatBlock","<P>")}},quote:{icon:"&#8220; &#8221;",title:"Citat",result:function(){return re("formatBlock","<BLOCKQUOTE>")}},olist:{icon:'<i class="fa fa-list-ol" aria-hidden="true"></i>',title:"Ordnad lista",result:function(){return re("insertOrderedList")}},ulist:{icon:'<i class="fa fa-list" aria-hidden="true"></i>',title:"Punktlista",result:function(){return re("insertUnorderedList")}},code:{icon:"&lt;/&gt;",title:"Programkod",result:function(){return re("formatBlock","<PRE>")}},line:{icon:"&#8213;",title:"Vågrät linje",result:function(){return re("insertHorizontalRule")}},link:{icon:'<i class="fa fa-link" aria-hidden="true"></i>',title:"Infoga länk",result:function(){var e=window.prompt("Ange länkens URL");e&&re("createLink",e)}},image:{icon:'<i class="fa fa-picture-o" aria-hidden="true"></i>',title:"Infoga bild",result:function(e,t){var n,a,r,s=window.prompt("Ange bildens URL");if(s){var o=document.createElement("img");o.src=s,o.tabIndex=1,n=o,window.getSelection&&(a=window.getSelection()).rangeCount&&((r=a.getRangeAt(0)).collapse(!0),r.insertNode(n),r.setStartAfter(n),r.collapse(!0),a.removeAllRanges(),a.addRange(r)),o.onfocus=t.onFocus,o.onblur=t.onBlur,t.props.onChange(t.contentDiv.innerHTML)}}}};var fe,be,ve,ge,ke,Ee,ye,Ne,Ce,De,we,Ie,Te,Se,Oe,xe,je=n(48),Ue=n(5),Re=n.n(Ue),Me=n(36),Le=function(e){function t(t){var n=e.call(this,t)||this;n.features=new Me.a;var r=!t.task||Object(x.c)(t.task);return n.state={title:t.task?r?Object(s.a)(fe||(fe=a.e(['Redigera uppgift till "','"'],['Redigera uppgift till "','"'])),t.module.name):Object(s.a)(be||(be=a.e(['Visa uppgift till "','"'],['Visa uppgift till "','"'])),t.module.name):t.searchMode?Object(s.a)(ve||(ve=a.e(['Sök ny uppgift till "','"'],['Sök ny uppgift till "','"'])),t.module.name):Object(s.a)(ge||(ge=a.e(['Lägg till egen uppgift till "','"'],['Lägg till egen uppgift till "','"'])),t.module.name),futureAbilitiesOpen:!1,taskCustomization:t.taskCustomization||{},task:t.task?a.a({$meta:t.task.$meta||"update"},t.task):t.searchMode?null:{id:Object(c.e)(),$meta:"add",tags:["sub:"+t.course.subjectCode],school:!t.course.isTemplate&&u.a.currentUser.school,resources:[],abilities:[],centralContent:[],futureAbilities:[],knowledgeRequirements:[],name:"",url:"",acl:t.course.isTemplate?["role:USER:R"]:["role:USER:R","schoolRole:"+u.a.currentUser.school+"/EMPLOYEE:S"]},searchMarkedIds:t.searchMode&&[],searchResult:t.searchMode&&[],isSearching:t.searchMode},t.searchMode&&(n.searchResponse=new X(function(){return u.a.kedBackendClient.list("tasks",{tags:"sub:"+t.course.subjectCode,include:["knowledgeRequirements","abilities","centralContent"],flags:["includeIdsOnly"]})})),n}return a.c(t,e),t.prototype.setStatePromised=function(t){var n=this;return new Promise(function(a){return e.prototype.setState.call(n,function(){return t},a)})},t.prototype.componentDidMount=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:if(!this.props.searchMode)return[3,8];this.setStatePromised({isSearching:!0}),t.label=1;case 1:return t.trys.push([1,5,6,8]),[4,this.searchResponse.query()];case 2:return t.sent(),this.state.searchMarkedIds&&0===this.state.searchMarkedIds.length?[4,this.updateSearchResult(this.state.searchMarkedIds)]:[3,4];case 3:t.sent(),t.label=4;case 4:return[3,8];case 5:return e=t.sent(),Object(s.m)(e),[3,8];case 6:return[4,this.setStatePromised({isSearching:!1})];case 7:return t.sent(),[7];case 8:return[2]}})})},t.prototype.updateSearchMarkedIds=function(e){return a.b(this,void 0,void 0,function(){var t;return a.d(this,function(n){switch(n.label){case 0:return t=this.setStatePromised({task:null,searchMarkedIds:e,previewTaskContent:null}),this.searchResponse.result?[3,3]:[4,this.searchResponse.promise];case 1:return n.sent(),[4,t];case 2:n.sent(),e=this.state.searchMarkedIds,n.label=3;case 3:return[4,this.updateSearchResult(e)];case 4:return n.sent(),[2]}})})},t.prototype.updateSearchResult=function(e){return a.b(this,void 0,void 0,function(){var t,n;return a.d(this,function(a){switch(a.label){case 0:return[4,this.searchResponse.query()];case 1:return t=a.sent(),n=t.filter(function(t){return e.every(function(e){return t.knowledgeRequirements.some(function(t){return t.id===e})||t.abilities.some(function(t){return t.id===e})||t.centralContent.some(function(t){return t.id===e})})}),this.setStatePromised({searchResult:n}),[2]}})})},t.prototype.onMarkChanged=function(e,t){if(this.props.searchMode){var n=this.state.searchMarkedIds;this.updateSearchMarkedIds(t?n.concat(e):n.filter(function(t){return t!==e})).catch(s.m)}else{var r=this.props.course,o=this.state.task,i=r.abilities.find(function(t){return t.id===e}),l=r.knowledgeRequirements.find(function(t){return t.id===e}),c=r.centralContent.find(function(t){return t.id===e}),u=i?["abilities",i]:l?["knowledgeRequirements",l]:c?["centralContent",c]:[null,null],d=u[0],m=u[1];if(d){var p=o[d].slice();t?p.push(m):p.splice(p.findIndex(function(t){return t.id===e}),1);var h=a.a({},o);h[d]=p,this.setStatePromised({task:h})}else console.error("Could not find marked id "+e)}},t.prototype.save=function(){return a.b(this,void 0,void 0,function(){var e,t,n;return a.d(this,function(r){switch(r.label){case 0:if(e=this.state,t=e.task,n=e.taskCustomization,!Object(x.c)(t))return[3,5];if(!t.url&&!t.content)throw new Error(Object(s.a)(ke||(ke=a.e(["Uppgiften måste antingen ha en URL eller ett innehåll"],["Uppgiften måste antingen ha en URL eller ett innehåll"]))));if(t.url&&!H.a.isUri(t.url))throw new Error(Object(s.a)(Ee||(Ee=a.e(["Angiven URL '","' är ogiltig. Den ska börja med http: eller https:"],["Angiven URL '","' är ogiltig. Den ska börja med http: eller https:"])),t.url));return this.props.task&&this.props.task.id!==t.id?[4,this.props.onReplace(this.props.task.id,t)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,this.props.onSave(t,null)];case 3:r.sent(),r.label=4;case 4:return[3,9];case 5:return this.props.searchMode?[4,this.props.onSave(t,n)]:[3,7];case 6:return r.sent(),[3,9];case 7:if(this.props.course.isTemplate&&"add"===t.$meta)throw new Error(Object(s.a)(ye||(ye=a.e(["Du saknar behörighet för att spara nya versioner av uppgifter i kursmallen"],["Du saknar behörighet för att spara nya versioner av uppgifter i kursmallen"]))));return[4,this.props.onSaveCustomization(n)];case 8:r.sent(),r.label=9;case 9:return[2]}})})},t.prototype.copyTask=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:return(e=a.a({},this.state.task,this.state.taskCustomization||{},{id:Object(c.e)(),acl:this.props.course.isTemplate?["role:USER:R"]:["role:USER:R","schoolRole:"+u.a.currentUser.school+"/EMPLOYEE:S"]})).$meta="add",[4,this.setStatePromised({task:e,title:Object(s.a)(Ne||(Ne=a.e(['Redigera kopierad uppgift till "','"'],['Redigera kopierad uppgift till "','"'])),this.props.module.name),taskCustomization:void 0})];case 1:return t.sent(),[2]}})})},t.prototype.getTaskProp=function(e){var t=this.state,n=t.task,a=t.taskCustomization,r=a&&a[e];return void 0!==r?r:n[e]},t.prototype.updateTaskOrCustomization=function(e,t){var n=this.state,r=n.task,s=n.taskCustomization;if(!(r&&Object(x.c)(r))||s&&void 0!==s[e]){var o=a.a({},s);o[e]=Y()(o[e]||r[e],t),this.setStatePromised({taskCustomization:o})}else{var i=a.a({},r);i[e]=Y()(r[e],t),this.setStatePromised({task:i})}},t.prototype.render=function(){var e=this,t=this.props,n=t.course,o=(t.module,t.onCancel,t.onDelete,t.idsNotCoveredByAnyTask),i=t.searchMode,c=this.state,u=c.task,d=c.taskCustomization,m=c.title,p=c.searchResult,h=c.searchMarkedIds,f=c.isSearching,b=i?h:u.centralContent.map(function(e){return e.id}).concat(u.abilities.map(function(e){return e.id})).concat(u.knowledgeRequirements.map(function(e){return e.id})),v=u&&Object(x.c)(u),g=(u&&H.a.isUri(u.url),this.features);return r.createElement("div",{className:"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer"},r.createElement("div",{className:"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer"},r.createElement("div",{className:"sv-text-portlet sv-use-margins sv-skip-spacer"},r.createElement("div",{className:"sv-text-portlet-content"},r.createElement("h1",{className:"h1"},m))),r.createElement("div",{className:"sv-fluid-grid sv-grid-ksgs12 sv-layout"},r.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-6"},r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},r.createElement("div",{className:"ked_boxed"},r.createElement("h3",null,i?"Filtrera på kunskapskrav":v?"Välj kunskapskrav":"Kunskapskrav"),i?r.createElement("p",null,"Markera de kunskapskrav som uppgiften måste täcka."):v&&r.createElement("p",null,"Markera de kunskapskrav som din uppgift täcker."),r.createElement($,{knowledgeRequirements:n.knowledgeRequirements,markedIds:b,idsToMarkNotOk:o,markMode:i||v,onMarkChanged:this.onMarkChanged.bind(this)}))),r.createElement("div",{className:"sv-html-portlet sv-portlet"},r.createElement(J,{options:n.abilities,title:v||i?"Välj förmågor":"Förmågor",markedIds:b,markMode:v||i,onMarkChanged:this.onMarkChanged.bind(this)})),r.createElement("div",{className:"sv-html-portlet sv-portlet"},r.createElement(J,{options:n.centralContent,title:v||i?"Välj centralt innehåll":"Centralt innehåll",markedIds:b,markMode:v||i,onMarkChanged:this.onMarkChanged.bind(this)})),!i&&r.createElement("div",{className:"sv-html-portlet sv-portlet"},r.createElement("div",{className:"openClose larger"+(this.state.futureAbilitiesOpen?" open":"")},r.createElement("div",{className:"openHeader",onClick:function(){return e.setStatePromised({futureAbilitiesOpen:!e.state.futureAbilitiesOpen})}},v?r.createElement("p",null,"Välj ytterligare alternativ"):r.createElement("p",null,"Ytterligare alternativ")),r.createElement("div",{className:"openContent"},r.createElement("h4",null,"Framtidsförmågor"),r.createElement("div",{className:"taskContainer"},Q.map(function(t){var n=u.futureAbilities.indexOf(t)>=0;return r.createElement("div",{className:"align-horizontal",key:t},r.createElement("div",{className:"horizontalItem top"},r.createElement("div",{className:"checkBox"+(n?" checked":""),onClick:v?function(){var r=a.a({},u);r.futureAbilities=n?u.futureAbilities.filter(function(e){return e!=t}):u.futureAbilities.concat(t),e.setStatePromised({task:r})}:void 0})),r.createElement("div",{className:"horizontalItem top"},t))})))))),r.createElement("div",{className:"sv-layout sv-column-6"},r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},f&&r.createElement("p",null,r.createElement(j.a,null)," Laddar uppgifter..."),p?r.createElement("div",{className:"task-search-result"+(this.state.task||this.state.previewTaskContent?"":" fixed")},0===h.length?r.createElement("h2",null,"Samtliga uppgifter för ämnet"):r.createElement("h2",null,"Uppgifter som täcker valda filter"),r.createElement("div",{className:"taskContainer"},p.map(function(t){return r.createElement("div",{key:t.id,className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},r.createElement("div",{className:"checkBox"+(u&&u.id===t.id?" checked":""),onClick:function(){return Object(K.findDOMNode)(e).parentElement.scrollTop=e.setStatePromised({task:t,previewTaskContent:null})}})),r.createElement("div",{className:"horizontalItem top"},t.content?r.createElement("a",{href:"#",onClick:function(n){e.setState({previewTaskContent:t.content,task:null}),n.preventDefault(),n.stopPropagation()}},t.name):r.createElement("a",{href:t.url,target:"_blank"},t.name)))})),r.createElement("br",null),r.createElement("hr",null)):u&&r.createElement("div",null,r.createElement("h2",null,"Uppgiftens namn och länk"),r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem top"},r.createElement("p",null,"Uppgiftens namn:")),r.createElement("div",{className:"horizontalItem top"},r.createElement("input",{autoFocus:!0,type:"text",size:35,value:u.name,disabled:!v,readOnly:!v,onChange:function(t){var n=a.a({},u);n.name=t.target.value,e.setStatePromised({task:n})}}))),r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem top"},r.createElement("p",null,"URL:")),r.createElement("div",{className:"horizontalItem top"},r.createElement("input",{type:"text",size:35,value:u.url,disabled:!v,readOnly:!v,onChange:function(t){var n=a.a({},u);n.url=t.target.value,e.setStatePromised({task:n})}}))),g.AssignmentTasks&&r.createElement(r.Fragment,null,r.createElement("h2",null,"Inlämningsuppgift"),r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},r.createElement("div",{className:"checkBox"+(this.getTaskProp("assignment")?" checked":""),onClick:function(){e.updateTaskOrCustomization("assignment",{$set:!e.getTaskProp("assignment")})}})),r.createElement("div",{className:"horizontalItem top"},r.createElement("p",null,"Den här uppgiften är en inlämningsuppgift"))),this.getTaskProp("assignment")&&r.createElement(r.Fragment,null,r.createElement("p",null,"Inlämningsdatum"),r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},r.createElement(je.a,{selected:this.getTaskProp("deadline")&&Re()(this.getTaskProp("deadline")),dateFormat:"YYYY-MM-DD",locale:"sv",popperPlacement:"bottom-start",onChange:function(t){e.updateTaskOrCustomization("deadline",{$set:t.format("YYYY-MM-DD")})}})),r.createElement("div",{className:"horizontalItem top"},this.getTaskProp("deadline")&&r.createElement("a",{className:"deleteDate",href:"#",title:"Ta bort inlämningsdatum",onClick:function(t){t.preventDefault(),e.updateTaskOrCustomization("deadline",{$set:null})}})))))),this.state.previewTaskContent?r.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.previewTaskContent}}):u&&r.createElement(r.Fragment,null,r.createElement("h3",null,"Uppgiftens lärandemål"),r.createElement("div",null,r.createElement("textarea",{className:"inputTextBox learning-goal-box",disabled:!v,value:u.learningGoal,onChange:function(t){var n=a.a({},u);n.learningGoal=t.target.value,e.setStatePromised({task:n})}})),r.createElement("br",null),(v||!!u.content)&&r.createElement(r.Fragment,null,r.createElement("h3",null,"Uppgiftens innehåll"),v&&r.createElement("p",null,"Om uppgiften inte länkar till något dokument kan du lägga innehåll här."),r.createElement(me,{actions:["bold","italic","underline","strikethrough","heading2","heading3","olist","ulist","line","link","image"],defaultActions:he,readOnly:!v,html:u.content,onChange:function(t){var n=a.a({},u);n.content=t,e.setState({task:n})}})),d&&d.resources?r.createElement("h3",null,"Resurser för uppgiften (modifierad för denna kursinstans)"):r.createElement("h3",null,"Resurser kopplade till uppgiften"),r.createElement(q,{resources:d&&d.resources||u.resources,host:this.props.host,onUpdate:function(t){e.updateTaskOrCustomization("resources",t)}}))),u&&r.createElement("div",{className:"sv-html-portlet sv-portlet"},r.createElement("hr",null),r.createElement("h3",null,"Uppgiftens status"),u.createdBy&&u.createdDate&&r.createElement("p",null,"Uppgiften skapades ",Object(l.c)(u.createdDate)," av ",r.createElement("strong",null,u.createdBy.name),"."),u.modifiedBy&&u.modifiedDate&&r.createElement("p",null,"Uppgiften redigerades senast ",Object(l.c)(u.modifiedDate)," av ",r.createElement("strong",null,u.modifiedBy.name),"."),r.createElement("br",null),!!this.props.onDelete&&r.createElement("div",{className:"btn btn-warning btn-large pull-right",onClick:function(){return e.props.onDelete()}},"Ta bort från kursmodul"),r.createElement("div",{className:"pull-right"}," "),r.createElement("div",{className:"btn btn-warning btn-large pull-right",onClick:function(){return e.props.onCancel()}},"Avbryt"),r.createElement("div",{className:"btn btn-large",onClick:function(){return e.save().catch(s.m)}},"Spara"),!v&&r.createElement("div",{className:"btn btn-large",onClick:function(){return e.copyTask().catch(s.m)}},"Skapa kopia av den här uppgiften")))),r.createElement("div",{className:"sv-layout"},r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"}))))},t}(r.Component),Ae=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return a.c(t,e),t.prototype.openTaskDialog=function(e){var t=this.props,n=t.taskCustomizations,a=t.course,r=t.host,s=t.module,o=(t.taskIds,t.onTaskAdded,t.onTaskUpdated),i=t.onTaskCustomizationUpdated,c=t.onTaskDeleted,d=t.idsNotCoveredByAnyTask,m=t.onTaskReplaced;r.openDialog({Component:Le,props:{task:e,taskCustomization:n&&n[e.id],module:s,course:a,host:r,idsNotCoveredByAnyTask:d,onSave:function(e){var t=Object(l.k)(e,u.a.currentUser);o(t),r.closeDialog()},onSaveCustomization:function(t){i(e.id,t),r.closeDialog()},onDelete:function(){c(e.id),r.closeDialog()},onReplace:function(e,t){m(e,t),r.closeDialog()},onCancel:function(){return r.closeDialog()}}})},t.prototype.render=function(){var e=this,t=this.props;return r.createElement("div",null,r.createElement("div",{className:"taskContainer"},t.taskIds.map(function(e){return t.course.tasks.find(function(t){return t.id===e})}).map(function(t){var n=Object(x.c)(t);return r.createElement("div",{className:"align-horizontal",key:t.id},r.createElement("div",{className:"horizontalItem top"},r.createElement("div",{className:n?"editItem":"viewItem",onClick:function(){return e.openTaskDialog(t)}})),r.createElement("div",{className:"horizontalItem top"},t.content?r.createElement("a",{href:"#",onClick:function(n){n.preventDefault(),e.openTaskDialog(t)}},t.name):r.createElement("a",{href:t.url,target:"_blank"},t.name)))})),r.createElement("br",null),r.createElement("a",{className:"btn",onClick:function(){var n=e.props,a=n.course,r=n.host,s=n.idsNotCoveredByAnyTask,o=n.module,i=n.onTaskAdded;n.onTaskCustomizationUpdated;t.host.openDialog({Component:Le,props:{searchMode:!0,module:o,course:a,host:r,idsNotCoveredByAnyTask:s,onSave:function(e,t){e=Object(l.k)(e,u.a.currentUser),i(e,t),r.closeDialog()},onCancel:function(){return r.closeDialog()}}})}},r.createElement("i",{className:"fa fa-search","aria-hidden":!0})," Sök uppgift")," ",r.createElement("a",{onClick:function(){var t=e.props,n=t.course,a=t.host,r=t.module,s=(t.taskIds,t.onTaskAdded),o=(t.onTaskUpdated,t.onTaskDeleted,t.idsNotCoveredByAnyTask);a.openDialog({Component:Le,props:{module:r,course:n,host:a,idsNotCoveredByAnyTask:o,onSave:function(e){e=Object(l.k)(e,u.a.currentUser),s(e),a.closeDialog()},onCancel:function(){return a.closeDialog()}}})},className:"btn"},r.createElement("i",{className:"fa fa-plus","aria-hidden":!0})," Lägg till egen uppgift"))},t}(r.Component),Be=n(27),Pe=n(31),_e=function(e){function t(t){var n=e.call(this,t)||this;return n.state={editMandatoryContent:!1},n}return a.c(t,e),t.prototype.getModuleIndex=function(){var e=this.props,t=e.course,n=e.module;return t.modules.findIndex(function(e){return e.id===n.id})},t.prototype.getModuleOrderIndex=function(){var e=this.props,t=(e.course,e.module);return this.props.getOrderedModules().findIndex(function(e){return e.id===t.id})},t.prototype.updateModule=function(e){var t=this.props.module,n=Y()(t,e),a=this.getModuleIndex();this.props.host.update({modules:{$splice:[[a,1,n]]}})},t.prototype.onTaskAdded=function(e,t){var n={},r=this.props.module.taskIds.slice();r.push(e.id),this.props.course.tasks.some(function(t){return t.id===e.id})||(n.tasks={$push:[e]});var s=a.a({},this.props.module.taskCustomizations||{});t&&(s[e.id]=t);var o=this.getModuleIndex();n.modules={},n.modules[o]={taskIds:{$set:r},taskCustomizations:{$set:s}},this.props.host.update(n)},t.prototype.onTaskUpdated=function(e){if(!e.$meta)throw new Error(Object(s.a)(Ce||(Ce=a.e(["Hoppsan, blev lite knas. Fel ID: ",""],["Hoppsan, blev lite knas. Fel ID: ",""])),"Pa7Dq"));var t=this.props.course.tasks.findIndex(function(t){return t.id===e.id});t>=0&&this.props.host.update({tasks:{$splice:[[t,1,e]]}})},t.prototype.onTaskCustomized=function(e,t){var n=a.a({},this.props.module.taskCustomizations||{});n[e]=t,this.updateModule({taskCustomizations:{$set:n}})},t.prototype.onTaskDeleted=function(e){this.updateModule({taskIds:{$set:this.props.module.taskIds.filter(function(t){return t!==e})},taskCustomizations:{$apply:function(t){var n=a.a({},t);return delete n[e],n}}})},t.prototype.onTaskReplaced=function(e,t){var n=this.props.module.taskIds.indexOf(e);if(n<0)Object(s.m)(Object(s.a)(De||(De=a.e(["Kunde inte spara uppgift. Felkod d72kQ"],["Kunde inte spara uppgift. Felkod d72kQ"]))));else{var r={taskIds:{$splice:[[n,1,t.id]]},taskCustomizations:{$apply:function(t){var n=a.a({},t);return delete n[e],n}}},o=Y()(this.props.module,r),i=this.getModuleIndex();this.props.host.update({modules:{$splice:[[i,1,o]]},tasks:{$set:this.props.course.tasks.concat(t)}})}},t.prototype.render=function(){for(var e=this,t=this.props,n=t.course,o=t.host,i=t.module,l=t.idsNotCoveredByAnyTask,c=this.getModuleIndex(),u=this.getModuleOrderIndex(),d=this.updateModule.bind(this),m=1,p=["--"],h=["--"],f=0;f<51;++f)p.push(""+m),h.push(""+ ++m);return r.createElement("div",{className:"course-module ked_boxed",style:{position:"relative"}},r.createElement("h3",null,r.createElement(Be.a,{eager:!0,clickAdvertiseText:"Namnlös modul",maxChars:100,text:i.name,onChange:function(e){return d({name:{$set:e}})}})),r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem center"},r.createElement("p",null,"Startvecka")),r.createElement("div",{className:"horizontalItem center"},r.createElement("select",{value:i.startWeek||"--",onChange:function(e){return d({startWeek:{$set:"--"===e.target.value?void 0:parseInt(e.target.value)}})}},p.map(function(e){return r.createElement("option",{key:e,value:e},e)}))),r.createElement("div",{className:"horizontalItem center"},r.createElement("p",null,"Slutvecka")),r.createElement("div",{className:"horizontalItem center"},r.createElement("select",{value:i.endWeek||"--",onChange:function(e){return d({endWeek:{$set:"--"===e.target.value?void 0:parseInt(e.target.value)}})}},h.map(function(e){return r.createElement("option",{key:e,value:e},e)})))),r.createElement("h4",null,"Kursmodulens introduktion"),r.createElement(me,{actions:["bold","italic","underline","strikethrough","heading2","heading3","olist","ulist","line","link","image"],defaultActions:he,html:i.mandatoryContent,onChange:function(e){d({mandatoryContent:{$set:e}})}}),r.createElement("h4",null,"Uppgifter"),r.createElement(Ae,{taskIds:i.taskIds,taskCustomizations:i.taskCustomizations,course:n,module:i,host:o,idsNotCoveredByAnyTask:l,onTaskAdded:function(t,n){return e.onTaskAdded(t,n)},onTaskUpdated:function(t){return e.onTaskUpdated(t)},onTaskCustomizationUpdated:function(t,n){return e.onTaskCustomized(t,n)},onTaskDeleted:function(t){return e.onTaskDeleted(t)},onTaskReplaced:function(t,n){return e.onTaskReplaced(t,n)}}),r.createElement("h4",null,"Modulresurser"),r.createElement("p",{className:"subHeader"},"(Eventuella resuser för redovisning av modulen samt för modulen som helhet)"),r.createElement(q,{resources:i.resources,onUpdate:function(e){return d({resources:e})},host:o}),r.createElement("div",{style:{position:"absolute",top:0,right:0}},u>0&&r.createElement("span",null,r.createElement("i",{className:"fa fa-arrow-circle-up selectable","aria-hidden":"true",onClick:function(){return e.props.onReorder(-1)}})," "),u<n.modules.length-1&&r.createElement("span",null,r.createElement("i",{className:"fa fa-arrow-circle-down selectable","aria-hidden":"true",onClick:function(){return e.props.onReorder(1)}})," "),r.createElement(Pe.a,{title:"Ta bort modulen",style:{display:"inline-block"},onClick:function(){return confirm(Object(s.a)(we||(we=a.e(["Ta bort modul ","?"],["Ta bort modul ","?"])),i.name))&&o.update({modules:{$splice:[[c,1]]}})}})))},t}(r.Component),ze=function(e){function t(t){var n=e.call(this,t)||this;return n._moduleRefs={},n.state={},n}return a.c(t,e),t.prototype.addModule=function(){this.props.host.update({modules:{$push:[{name:"Ny kursmodul",id:Object(c.e)(),resources:[],taskIds:[]}]}})},t.prototype.getOrderedModules=function(){var e=this.props.course,t=e.moduleOrder||e.modules.map(function(e){return e.id});return t.map(function(t){return e.modules.find(function(e){return e.id===t})}).filter(function(e){return!!e}).concat(e.modules.filter(function(e){return!t.find(function(t){return e.id===t})}))},t.prototype.reorder=function(e,t){return a.b(this,void 0,void 0,function(){var n,r,s,o,i,l,c;return a.d(this,function(a){switch(a.label){case 0:return this.props.course,n=this.getOrderedModules(),r=n.findIndex(function(t){return t.id===e}),(s=r+t)<0||s>=n.length?[2]:(o=n[s],(i=n.map(function(e){return e.id}))[s]=e,i[r]=o.id,l=document.documentElement.scrollTop,[4,this.props.host.update({moduleOrder:{$set:i}})]);case 1:if(a.sent(),c=Object(K.findDOMNode)(this._moduleRefs[e]))try{window.scrollTo({top:l}),c.scrollIntoView({behavior:"smooth",block:"start"})}catch(e){window.scrollTo(null,l),c.scrollIntoView(!0)}return[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.course,a=t.host,s=t.idsNotCoveredByAnyTask,o=(n.moduleOrder||n.modules.map(function(e){return e.id}),this.getOrderedModules());return r.createElement("div",{className:"sv-html-portlet sv-portlet",ref:function(t){return e._elem=t}},o.map(function(t){return r.createElement(_e,{ref:function(n){return e._moduleRefs[t.id]=n},key:t.id,course:n,module:t,onReorder:function(n){return e.reorder(t.id,n)},getOrderedModules:function(){return e.getOrderedModules()},host:a,idsNotCoveredByAnyTask:s})}),r.createElement("div",{className:"btn btn-large",onClick:function(){return e.addModule()}},"Lägg till kursmodul"))},t}(r.Component),Ke=new(function(e){function t(t){var n=e.call(this,{query:function(){return a.b(n,void 0,void 0,function(){var e,n;return a.d(this,function(r){switch(r.label){case 0:return e=t(),[4,u.a.kedBackendClient.list("schools",{name:e,include:["courses"]})];case 1:if(n=r.sent(),this._schoolId=n.length>0&&n[0].id,!this._schoolId)throw new Error(Object(s.a)(Ie||(Ie=a.e(["Skolan ",' finns inte registrerad i systemet.\n          Kontakta en administratör för Kursbyggarverktyget och be om att lägga till skolan med namnet "','"'],["Skolan ",' finns inte registrerad i systemet.\n          Kontakta en administratör för Kursbyggarverktyget och be om att lägga till skolan med namnet "','"'])),e,e));return[2,Object(s.k)(n.map(function(e){return e.courses}))]}})})}})||this;return n}return a.c(t,e),t.prototype.getSchoolId=function(){var e=this;return this.ensureHasData().then(function(){return e._schoolId})},t}(n(37).a))(function(){return u.a.currentUser.school}),Ge=function(e){function t(t){var n=e.call(this,t)||this;return n.state={schoolCourses:null},n.onSchoolCoursesUpdated=n.onSchoolCoursesUpdated.bind(n),n}return a.c(t,e),t.prototype.componentDidMount=function(){Ke.subscribe(this.onSchoolCoursesUpdated).catch(s.m)},t.prototype.componentWillUnmount=function(){Ke.unsubscribe(this.onSchoolCoursesUpdated)},t.prototype.onSchoolCoursesUpdated=function(e){var t=Object(s.g)("name"),n=Object(s.g)("createdDate");e.sort(function(e,a){return t(e,a)||n(e,a)}),this.setState({schoolCourses:e})},t.prototype.render=function(){var e=this.state.schoolCourses;return r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},r.createElement("div",{className:"ked_boxed"},r.createElement("h3",null,"Skolans kurser"),r.createElement("div",{className:"taskContainer odd-even"},e?e.map(function(e){return r.createElement("div",{className:"schoolCourse",key:e.id},r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top pull-right"},r.createElement(o.b,{to:"/courses/"+e.id+"/edit",className:"editItem"})),r.createElement("div",{className:"horizontalItem top"},r.createElement(o.b,{to:"/courses/"+e.id+"/edit"},e.name)),r.createElement("div",{className:"horizontalItem top"},e.active&&r.createElement("div",{className:"pill active"},"Aktiv")),e.active&&!e.publishable&&r.createElement("div",{className:"horizontalItem top"},r.createElement("div",{className:"pill incomplete"},"Inkomplett"))),r.createElement("div",{className:"horizontalItem top"},r.createElement("p",null,e.description)),r.createElement("div",{className:"horizontalItem top"},e.modifiedBy?r.createElement("p",{className:"small"},"Redigerad av ",e.modifiedBy.name," / ",Object(l.g)(e.modifiedDate)):r.createElement("p",{className:"small",style:{fontStyle:"italic"}}," ")))}):r.createElement("p",null,r.createElement(j.a,null)," Laddar skolans kurser")),"#/courses/new"!==location.hash&&r.createElement(o.b,{className:"btn",to:"/courses/new",onClick:function(){return window.scroll(0,0)}},"Skapa ny kurs")))},t}(r.Component);function He(e){var t=e.knowledgeRequirements.reduce(function(e,t){return e[t.id]=t,e},{});return e.tasks.forEach(function(e){e.knowledgeRequirements.forEach(function(e){delete t[e.id]})}),Object.keys(t).map(function(e){return t[e]})}var Fe,qe,$e,Ve,Ye,We,Je,Xe,Qe,Ze,et,tt,nt,at,rt=function(e){function t(t){var n=e.call(this,t)||this;return n.state={addEmtpyRow:0===t.teachers.length},n}return a.c(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.teachers,s=t.onUpdate,o=this.state.addEmtpyRow;return o&&(n=n.concat({name:"",url:""})),r.createElement("div",{className:"teachers-list"},r.createElement("h3",null,"Ansvariga lärare"),r.createElement("table",{tabIndex:1,style:{width:"100%"},onBlur:function(t){return(!t.relatedTarget||"INPUT"!==t.relatedTarget.tagName)&&e.props.teachers.length>0&&e.setState({addEmtpyRow:!1})}},r.createElement("thead",null,n.length>0&&r.createElement("tr",null,r.createElement("th",{style:{width:"20%"}},"Namn"),r.createElement("th",null,"Länk eller E-postadress"))),r.createElement("tbody",null,n.map(function(t,i){return r.createElement("tr",{key:i},r.createElement("td",null,r.createElement("input",{type:"text",ref:function(t){return e.nameElem=t},value:t.name,autoFocus:!t.name&&i>0,onChange:function(r){o&&i==n.length-1?(s({$push:[a.a({},t,{name:r.target.value})]}),e.setState({addEmtpyRow:!1})):r.target.value||t.url?s({$splice:[[i,1,a.a({},t,{name:r.target.value})]]}):(1===e.props.teachers.length&&e.setState({addEmtpyRow:!0}),s({$splice:[[i,1]]}))}})),r.createElement("td",null,r.createElement("input",{type:"text",style:{width:"100%"},value:t.url,onKeyDown:function(t){return 9===t.which&&!t.shiftKey&&i===n.length-1&&(n.length<1||!!n[n.length-1].name&&(e.setState({addEmtpyRow:!0}),t.preventDefault()))},onChange:function(r){o&&i==n.length-1?(s({$push:[a.a({},t,{url:r.target.value})]}),e.setState({addEmtpyRow:!1})):r.target.value||t.name?s({$splice:[[i,1,a.a({},t,{url:r.target.value})]]}):(1===e.props.teachers.length&&e.setState({addEmtpyRow:!0}),s({$splice:[[i,1]]}))}})))}))),r.createElement("br",null),r.createElement("a",{className:"btn",onClick:function(){return e.state.addEmtpyRow?e.nameElem.focus():e.setState({addEmtpyRow:!0})}},r.createElement("i",{className:"fa fa-user-plus","aria-hidden":!0})," Lägg till ansvarig lärare"))},t}(r.Component),st=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isOpen:!1},n}return a.c(t,e),t.prototype.render=function(){var e=this.props.course,t=(this.state.isOpen,[]),n=function(e){var t={};function n(e,n){(t[e]||(t[e]=[])).push(n)}return e.tasks.forEach(function(e){e.abilities.forEach(function(t){return n(t.id,e)}),e.centralContent.forEach(function(t){return n(t.id,e)}),e.futureAbilities.forEach(function(t){return n(t,e)})}),t}(e);return t.push(r.createElement("tr",{key:"centralContent",className:"covered-item-label"},r.createElement("td",{colSpan:2},"Centralt innehåll"))),e.centralContent.forEach(function(e,a){return t.push(r.createElement("tr",{key:e.id,className:a%2?"tableOdd":""},r.createElement("td",null,r.createElement("p",{className:"criteriaText",dangerouslySetInnerHTML:{__html:e.name}})),r.createElement("td",null,r.createElement("p",null,(n[e.id]||[]).length))))}),t.push(r.createElement("tr",{key:"abilities",className:"covered-item-label"},r.createElement("td",{colSpan:2},"Förmågor"))),e.abilities.forEach(function(e,a){return t.push(r.createElement("tr",{key:e.id,className:a%2?"tableOdd":""},r.createElement("td",null,r.createElement("p",{className:"abilityText",dangerouslySetInnerHTML:{__html:e.name}})),r.createElement("td",null,r.createElement("p",null,(n[e.id]||[]).length))))}),t.push(r.createElement("tr",{key:"futureAbilities",className:"covered-item-label"},r.createElement("td",{colSpan:2},"Framtidsförmågor"))),Q.forEach(function(e,a){return t.push(r.createElement("tr",{key:e,className:a%2?"tableOdd":""},r.createElement("td",null,r.createElement("p",{className:"abilityText"},e)),r.createElement("td",null,r.createElement("p",null,(n[e]||[]).length))))}),r.createElement(W.a,{className:"larger",title:r.createElement("p",null,"Kursens täckningstabell"),contentClassName:"weighted-items-table"},r.createElement("p",null,"Tabellen anger hur många uppgifter som berör varje del."),r.createElement("table",null,r.createElement("tbody",null,t)))},t}(r.Component),ot=function(e){function t(t){var n=e.call(this,t)||this;return n.state={url:n.props.url||""},n}return a.c(t,e),t.prototype.save=function(){var e=this.state.url;if(!H.a.isUri(e))throw new Error(Object(s.a)(Fe||(Fe=a.e(["Angiven URL '","' är ogiltig. Ska börja med http: eller https:"],["Angiven URL '","' är ogiltig. Ska börja med http: eller https:"])),e));this.props.onSave(e)},t.prototype.render=function(){var e=this,t=this.props,n=t.onSave,a=t.onDelete,s=this.state,o=H.a.isUri(this.state.url);return r.createElement("div",null,r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},r.createElement("h2",null,"Koppla en arbetsgång till kursen"),r.createElement("p",null,"Det går bara att lägga in en arbetsgång per kurs."),r.createElement("br",null),r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},"Länk:"),r.createElement("div",{className:"horizontalItem top "},r.createElement("input",{type:"text",tabIndex:1,size:50,value:s.url,onChange:function(t){return e.setState({url:t.target.value})}})),r.createElement("div",{className:"horizontalItem top spaced"})),r.createElement("br",null)),r.createElement("div",{className:"sv-html-portlet sv-portlet",id:"svid12_492422d515badf36646e4ff1"},a&&r.createElement("div",{tabIndex:2,className:"btn btn-warning btn-large pull-right",onClick:function(){return a()}},"Ta bort arbetsgång"),r.createElement("a",{tabIndex:1,className:"btn btn-large"+(o?"":" btn-inactive"),onClick:o&&function(){return n(s.url)}},"Spara")))},t}(r.Component),it=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.host,n=e.onUpdate,a=e.url;return r.createElement("div",null,r.createElement("div",{className:"taskContainer"},a&&r.createElement("div",{className:"align-horizontal"},r.createElement("div",{className:"horizontalItem top"},r.createElement("a",{className:"editItem",onClick:function(){return t.openDialog({Component:ot,props:{url:a,onSave:function(e){n({$set:e}),t.closeDialog()},onDelete:function(){n({$set:void 0}),t.closeDialog()}}})}})),r.createElement("div",{className:"horizontalItem top"},r.createElement("a",{href:a,target:"_blank"},"Nuvarande arbetsgång")))),!a&&r.createElement("a",{className:"btn",onClick:function(){return t.openDialog({Component:ot,props:{onSave:function(e){n({$set:e}),t.closeDialog()}}})}},r.createElement("i",{className:"fa fa-paperclip","aria-hidden":!0})," Koppla en arbetsgång till kursen"))},t}(r.Component),lt=function(e){function t(t){var n=e.call(this,t)||this;return n.state={changeImageUrl:!1},n}return a.c(t,e),t.prototype.setImageUrl=function(e){this.props.course.imageId},t.prototype.render=function(){var e=this.props,t=e.course,n=e.origCourse,o=e.host,i=He(t),c=function(e){var t={};return e.knowledgeRequirements.forEach(function(e){t[e.id]=!0}),e.abilities.forEach(function(e){t[e.id]=!0}),e.centralContent.forEach(function(e){t[e.id]=!0}),e.tasks.forEach(function(e){e.knowledgeRequirements.forEach(function(e){delete t[e.id]}),e.abilities.forEach(function(e){delete t[e.id]}),e.centralContent.forEach(function(e){delete t[e.id]})}),t}(t),u=function(e){return Object(s.k)([function(e){var t={};return Object(s.k)(e.modules.map(function(n){return n.taskIds.map(function(n){if(t[n]){var r=e.tasks.find(function(e){return e.id===n});return Object(s.a)(Te||(Te=a.e(['Samma uppgift förekommer flera gånger: "','"'],['Samma uppgift förekommer flera gånger: "','"'])),r.name)}t[n]=!0}).filter(function(e){return e})}))}(e),function(e){var t={};return e.tasks.map(function(e){if(e.url){if(t[e.url])return Object(s.a)(Se||(Se=a.e(['Två uppgifter pekar på samma URL: "','" samt "','"'],['Två uppgifter pekar på samma URL: "','" samt "','"'])),t[e.url].name,e.name);t[e.url]=e}}).filter(function(e){return e})}(e),function(e){return e.modules.some(function(e){return""===e.name})&&Object(s.a)(Oe||(Oe=a.e(["Det finns minst en modul utan angivet namn"],["Det finns minst en modul utan angivet namn"])))}(e),function(e){var t={};return e.modules.map(function(e){if(e.name&&t[e.name])return Object(s.a)(xe||(xe=a.e(["Modulen med namn "," förekommer flera gånger"],["Modulen med namn "," förekommer flera gånger"])),e.name);e.name&&(t[e.name]=!0)})}(e)]).filter(function(e){return e})}(t),d=t.images.find(function(e){return e.id===t.imageId}),m=d&&d.url.startsWith("data:");return r.createElement("div",{className:"sv-row sv-layout sv-skip-spacer"},r.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-7"},r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},t.isTemplate&&r.createElement("h1",null,"Kursmall"),r.createElement("h2",null,"Kursövergripande"),r.createElement("hr",null),r.createElement("div",{className:"ked_boxed"},r.createElement("div",null,r.createElement("h3",null,"Kursens bild"),m?r.createElement("p",null,"Kursens bild ligger i databasen. För att ändra bild måste du dra och släppa en ny bild ovanpå den gamla högst upp på denna sida. Bilden kan antingen vara från en annan webbsida. Lokala bildfiler går också bra att dra och släppa."):d?r.createElement("div",null,r.createElement("textarea",{value:d.url,style:{width:"100%",height:"30px"},onChange:function(e){return p(0,0,o,e.target.value)}}),r.createElement("p",null,"Bilden som visas högst upp hämtas från angiven URL. För att ändra bild kan du redigera URL ovan. Ett annat sätt att ändra bild är att dra och släppa en ny bild över den gamla högst upp på sidan.")):r.createElement("p",null,"Kursen saknar egen bild. Lägg till en bild genom att dra och släppa en bild på kurs-bannern högst upp på den här sidan."),r.createElement("br",null)),!t.isTemplate&&r.createElement("div",null,r.createElement("h3",null,"Beskrivning"),r.createElement("p",{className:"subHeader"},"(Beskrivning av kursen. För att skilja mellan olika varianter av samma gymnasiekurs)"),r.createElement("textarea",{className:"inputTextBox inputTextSmall",value:t.description,onChange:function(e){return o.update({description:{$set:e.target.value}})}}),r.createElement("br",null)),r.createElement("div",null,r.createElement("h3",null,"Upptaktstext"),r.createElement("p",{className:"subHeader"},"(texten ska visas på kursens upptaktssektion)"),r.createElement(me,{html:t.runUpText,defaultActions:he,actions:["bold","italic","underline","strikethrough","heading2","heading3","olist","ulist","line","link","image"],onChange:function(e){return o.update({runUpText:{$set:e}})}}),r.createElement("br",null)),r.createElement("h3",null,"Kursresurser"),r.createElement("p",{className:"subHeader"},"(Resurser för upptakt och kursen som helhet)"),r.createElement(q,{resources:t.resources,onUpdate:function(e){return o.update({resources:e})},host:o}),r.createElement("br",null),r.createElement("h3",null,"Arbetsgång"),r.createElement("p",{className:"subHeader"},"(Eventuell länk till arbetsgång för kursen)"),r.createElement(it,{url:t.workFlowLink,onUpdate:function(e){return o.update({workFlowLink:e})},host:o}),r.createElement("br",null),!t.isTemplate&&r.createElement("div",null,r.createElement("h3",null,"Google Classroom"),r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem top"},r.createElement("input",{placeholder:"Google classroom URL",type:"text",size:30,value:t.googleClassRoomURL,onChange:function(e){return o.update({googleClassRoomURL:{$set:e.target.value}})}})),r.createElement("div",{className:"horizontalItem top"},r.createElement("input",{placeholder:"kod",type:"text",size:8,value:t.googleClassRoomCode,onChange:function(e){return o.update({googleClassRoomCode:{$set:e.target.value}})}})))),r.createElement("br",null),!t.isTemplate&&r.createElement(r.Fragment,null,r.createElement(rt,{teachers:t.responsibleTeachers,onUpdate:function(e){o.update({responsibleTeachers:e})}}),r.createElement("br",null),r.createElement("h3",null,"Inlämnings E-post"),r.createElement("table",{tabIndex:1,style:{width:"100%"}},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"E-postaddress"))),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,r.createElement(Be.a,{eager:!0,clickAdvertiseText:"Klicka här för att ange vem som tar emot inlämningsuppgifter",text:t.assignmentEmails?t.assignmentEmails[0]:"",placeholder:"Ange mottagare av inlämningsuppgifter",tag:"input",onChange:function(e){return o.update({assignmentEmails:{$set:[e]}})}}))))))),r.createElement("div",{className:"sv-html-portlet sv-portlet",id:"svid12_6ab4811f15b13c706b43bb47"},r.createElement("div",{id:"Kursensmoduler"}),r.createElement("h2",null,"Kursens moduler"),r.createElement("hr",null)),r.createElement(ze,{host:o,course:t,idsNotCoveredByAnyTask:c}),r.createElement("div",null,r.createElement("br",null),r.createElement(st,{course:t})),r.createElement("div",{className:"sv-html-portlet sv-portlet"},r.createElement("h2",null,"Kursens status"),r.createElement("hr",null),t.createdBy&&t.createdDate&&r.createElement("p",null,"Kursen skapades ",Object(l.c)(t.createdDate)," av ",r.createElement("strong",null,t.createdBy.name),"."),t.modifiedBy&&t.modifiedDate&&r.createElement("p",null,"Kursen redigerades senast ",Object(l.c)(t.modifiedDate)," av ",r.createElement("strong",null,t.modifiedBy.name),"."),t.active?r.createElement("p",null,"Kursen är ",r.createElement("strong",null,"AKTIV")," sedan ",Object(l.c)(t.activatedDate)," av ",r.createElement("strong",null,t.activatedBy.name),"."):r.createElement("p",null,"Kursen är ",r.createElement("strong",null,"INAKTIV"),t.inactivatedBy?r.createElement("span",null,"sedan ",Object(l.c)(t.inactivatedDate)," av ",r.createElement("strong",null,t.inactivatedBy.name),"."):r.createElement("span",null,".")),0===i.length?r.createElement("p",{className:"markedGreen"},"Modulernas kunskapskrav täcker skolverkets krav för denna kurs"):r.createElement("div",{className:"markedRed warning-box"},r.createElement("div",{className:"warningFlag"},r.createElement("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"})),r.createElement("p",null,"Modulernas kunskapskrav täcker inte skolverkets krav för denna kurs.")),u.map(function(e){return r.createElement("div",{key:e,className:"markedRed warning-box"},r.createElement("div",{className:"warningFlag"},r.createElement("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"})),r.createElement("p",null,e))}),r.createElement("br",null),!t.isTemplate&&(n?r.createElement("div",{className:"btn btn-warning btn-large pull-right",onClick:function(){confirm(Object(s.a)(qe||(qe=a.e(['Bekräfta borttagning av kursen "'," - ",'" för skolan ',"\n\nKursen kommar att raderas helt!\n\nÄr du säker?"],['Bekräfta borttagning av kursen "'," - ",'" för skolan ',"\\n\\nKursen kommar att raderas helt!\\n\\nÄr du säker?"])),t.name,t.description,t.school))&&o.deleteCourse().catch(s.m)}},"Ta bort kurs"):r.createElement("div",{className:"btn btn-warning btn-large pull-right",onClick:function(){return history.go(-1)}},"Avbryt")),r.createElement("div",{className:"btn btn-large",onClick:function(){return o.save()}},"Spara"),t.active?r.createElement("div",{className:"btn btn-info btn-large",onClick:function(){return o.inactivateAndSave()}},"Inaktivera och spara"):r.createElement("div",{className:"btn btn-info btn-large",onClick:function(){return o.activateAndSave()}},"Aktivera och spara")))),r.createElement("div",{className:"sv-layout sv-column-5"},r.createElement(Ge,null)))},t}(r.Component),ct="production"===n(9).a.ENVIRONMENT?s.m:null,ut=Object(s.a)($e||($e=a.e(["Du har osparat data. Välj avbryt och tryck CTRL+S om du vill spara först."],["Du har osparat data. Välj avbryt och tryck CTRL+S om du vill spara först."]))),dt={origCourse:null,origTemplate:null,course:null,dialogContainers:[],hasUnsavedData:!1,view:"courseBuilder"},mt=function(e){function t(t){var n=e.call(this,t)||this;return n.state=a.a({},dt),n.update=n.update.bind(n),n.refDialog=n.refDialog.bind(n),n.contentYPos=0,n.onKeyDown=n.onKeyDown.bind(n),n.beforeUnload=n.beforeUnload.bind(n),n.onClickPreventUnload=n.onClickPreventUnload.bind(n),n.isSaving=!1,n.dialogs=[],t.view&&(n.state=a.a({},n.state,{view:t.view})),n}return a.c(t,e),t.prototype.setStatePromised=function(e){return this._setState(a.a({hasUnsavedData:!0},e))},t.prototype.setNonSaveableDataState=function(e){return this._setState(e)},t.prototype._setState=function(t){var n=this;if(t.course){var r=t.course,s=r.tasks,o={};r.modules.forEach(function(e){return e.taskIds.forEach(function(e){return o[e]=!0})});var i=s.filter(function(e){return o[e.id]}),l=a.a({},t.course);l.tasks=i,t=a.a({},t,{course:l})}var c=t.allCourses||this.state.allCourses,u=t.course||this.state.course;if(c){var d=c.findIndex(function(e){return e.id===n.props.id});c=Y()(c,{$splice:[[d,1,u]]}),(t=a.a({},t)).allCourses=c}return new Promise(function(a){return e.prototype.setState.call(n,function(){return t},a)})},t.prototype.componentWillMount=function(){this.load().catch(ct),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("beforeunload",this.beforeUnload),document.body.addEventListener("click",this.onClickPreventUnload)},t.prototype.componentWillUnmount=function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("beforeunload",this.beforeUnload),document.body.removeEventListener("click",this.onClickPreventUnload),Object(l.h)("")},t.prototype.componentWillReceiveProps=function(e){this.state&&this.state.course&&(e.id===this.props.id&&e.templateId===this.props.templateId||this.setStatePromised(dt)),e.view!==this.props.view&&this.setNonSaveableDataState({view:e.view})},t.prototype.componentDidUpdate=function(e,t){if(this.contentDiv){var n=Object(K.findDOMNode)(this.contentDiv);n&&(this.contentYPos=n.getBoundingClientRect().top)}t&&t.course&&(this.props.id===e.id&&this.props.templateId===e.templateId||this.load().catch(ct)),!t.hasUnsavedData&&this.state.hasUnsavedData&&Object(l.h)("unsaved")},t.prototype.loadFromTemplate=function(e){return a.b(this,void 0,void 0,function(){var t,n,r;return a.d(this,function(a){switch(a.label){case 0:return Object(s.n)("Laddar data från mall..."),[4,Object(l.d)(e,{includeTemplateChain:!0})];case 1:return t=a.sent(),(n=Object(l.i)(Date.now(),t,u.a.currentUser)).id=Object(c.e)(),n.parentId=e,n.active=!1,n.isTemplate=!1,n.templateChain=n.templateChain.slice(),n.templateChain.push({id:e,$meta:"ref"}),r=u.a.currentUser.school,n.school=r,n.description="",n.responsibleTeachers=[],n.acl=["role:USER:R","schoolRole:"+r+"/EMPLOYEE:S"],delete n.$etag,delete n.createdBy,delete n.createdDate,delete n.modifiedBy,delete n.modifiedDate,delete n.activatedBy,delete n.activatedDate,delete n.googleClassRoomCode,delete n.googleClassRoomURL,[4,this.setStatePromised({course:n,origCourse:null,origTemplate:t})];case 2:return a.sent(),Object(s.n)(""),[2]}})})},t.prototype.load=function(){return a.b(this,void 0,void 0,function(){return a.d(this,function(e){switch(e.label){case 0:return Object(l.h)(""),this.props.id?[4,this.loadExistingCourse(this.props.id)]:[3,2];case 1:return e.sent(),[3,5];case 2:return this.props.templateId?[4,this.loadFromTemplate(this.props.templateId)]:[3,4];case 3:return e.sent(),[3,5];case 4:throw new Error(Object(s.a)(Ve||(Ve=a.e(["Ogiltig parameter. id eller templateId måste anges"],["Ogiltig parameter. id eller templateId måste anges"]))));case 5:return[2]}})})},t.prototype.loadExistingCourse=function(e){return a.b(this,void 0,void 0,function(){var t;return a.d(this,function(n){switch(n.label){case 0:return Object(s.n)("Laddar kurs"),[4,Object(l.d)(e)];case 1:return(t=n.sent()).responsibleTeachers||(t.responsibleTeachers=[]),[4,this.setNonSaveableDataState({course:t,origCourse:t})];case 2:return n.sent(),Object(s.n)(""),[2]}})})},t.prototype.update=function(e){return a.b(this,void 0,void 0,function(){return a.d(this,function(t){switch(t.label){case 0:return[4,this.setStatePromised({course:Y()(this.state.course,e)})];case 1:return t.sent(),[2]}})})},t.prototype.deleteCourse=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r,o,i;return a.d(this,function(a){switch(a.label){case 0:return Object(s.n)("Raderar kursen..."),e=this.state.course.school,this.state.course.parentId,t=this.props.id,[4,u.a.kedBackendClient.list("courses",{hasEdgesTo:[this.props.id]})];case 1:for(n=a.sent(),r=new c.a,o=0,i=n;o<i.length;o++)i[o];return r.delete("courses",t),[4,u.a.kedBackendClient.batch(r.mutationRequests)];case 2:return a.sent(),e===u.a.currentUser.school&&Ke.delete(t),Object(s.n)(""),location.hash="#/courses/new",[2]}})})},t.prototype.save=function(){return a.b(this,void 0,void 0,function(){var e,t;return a.d(this,function(n){switch(n.label){case 0:if(this.isSaving)return[2];n.label=1;case 1:return n.trys.push([1,3,4,5]),this.isSaving=!0,[4,this._save()];case 2:return n.sent(),[3,5];case 3:return e=n.sent(),t=e&&e.message?e.message:Object(s.a)(Ye||(Ye=a.e(["Ett okänt fel har inträffat..."],["Ett okänt fel har inträffat..."]))),e&&("http409"===e.name||"http412"===e.name||"http404"===e.name?t=Object(s.a)(We||(We=a.e(["Kursen har redigerad av annan användare. Ladda om sidan och gör om ändrinarna."],["Kursen har redigerad av annan användare. Ladda om sidan och gör om ändrinarna."]))):"http403"===e.name&&(this.state.course.isTemplate?t=Object(s.a)(Je||(Je=a.e(["Ingen behörighet att spara kursmallen. Endast administratörer kan redigera kursmallar."],["Ingen behörighet att spara kursmallen. Endast administratörer kan redigera kursmallar."]))):this.state.course.school&&(t=Object(s.a)(Xe||(Xe=a.e(["Ingen behörighet att spara kursen ",". Kursen kan bara redigeras av anställda på ",""],["Ingen behörighet att spara kursen ",". Kursen kan bara redigeras av anställda på ",""])),this.state.course.name,this.state.course.school)))),Object(s.m)(t),Object(l.h)("error"),[3,5];case 4:return this.isSaving=!1,[7];case 5:return[2]}})})},t.prototype._save=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r,o,i,d,m,p,h,f,b;return a.d(this,function(v){switch(v.label){case 0:return e=this.state,t=e.course,n=e.origCourse,r=e.origTemplate,o=0===He(t).length,Object(s.n)(Object(s.a)(Qe||(Qe=a.e(["Sparar..."],["Sparar..."])))),i=Object(l.l)(Date.now(),t,u.a.currentUser),d=new c.a,m=n||r,p=i.tasks.map(function(e){if("add"===e.$meta||"update"===e.$meta){var t=m.tasks.find(function(t){return t.id===e.id});return Object(l.j)(t||{},e,"tasks",{knowledgeRequirements:"knowledge-requirements",centralContent:"central-content",abilities:"abilities"},d)}var n=a.a({},e);return delete n.$meta,n}),i=Y()(i,{tasks:{$set:p}}),i=Object(l.j)(n||{},i,"courses",{templateChain:"courses",centralContent:"central-content",knowledgeRequirements:"knowledge-requirements",abilities:"abilities",images:"images",tasks:"tasks"},d),(i=a.a({},i)).publishable=o,h=(i.tags||[]).filter(function(e){return"incomplete"!==e}),i.tags=i.publishable?h:h.concat("incomplete"),n?[3,3]:(d.add("courses",i),t.school?[4,Ke.getSchoolId()]:[3,2]);case 1:f=v.sent(),d.link("schools",f,"courses",t.id,"courses"),t.active&&d.link("schools",f,"courses",t.id,"activeCourses"),v.label=2;case 2:return[3,7];case 3:return d.put("courses",i),n.active||!t.active?[3,5]:[4,Ke.getSchoolId()];case 4:return f=v.sent(),d.link("schools",f,"courses",t.id,"activeCourses"),[3,7];case 5:return!n.active||t.active?[3,7]:[4,Ke.getSchoolId()];case 6:f=v.sent(),d.unlink("schools",f,"courses",t.id,"activeCourses"),v.label=7;case 7:return[4,u.a.kedBackendClient.batch(d.mutationRequests)];case 8:return b=v.sent(),Object(s.n)(n?Object(s.a)(Ze||(Ze=a.e(["Ändringarna har sparats"],["Ändringarna har sparats"]))):Object(s.a)(et||(et=a.e(["Kursen har skapats"],["Kursen har skapats"])))),b&&b.newEtags&&(i=Object(l.b)(i,b.newEtags,["images","tasks"])),t.school===u.a.currentUser.school&&(n?Ke.update(i):Ke.insert(i)),[4,this.setNonSaveableDataState({course:i,origCourse:i,hasUnsavedData:!1})];case 9:return v.sent(),Object(l.h)(""),n||(location.hash="#/courses/"+i.id+"/edit"),[2]}})})},t.prototype.activateAndSave=function(){var e=this,t=a.a({},this.state.course);t.active||(t.active=!0,t.activatedBy={name:u.a.currentUser.displayName,url:"mailto:"+u.a.currentUser.mail},t.activatedDate=Date.now(),this.setStatePromised({course:t}).then(function(){return e.save()}).catch(ct))},t.prototype.inactivateAndSave=function(){var e=this,t=a.a({},this.state.course);t.active&&(t.active=!1,t.inactivatedBy={name:u.a.currentUser.displayName,url:"mailto:"+u.a.currentUser.mail},t.inactivatedDate=Date.now(),this.setStatePromised({course:t}).then(function(){return e.save()}).catch(ct))},t.prototype.openDialog=function(e){this.setNonSaveableDataState({dialogContainers:this.state.dialogContainers.concat(e)})},t.prototype.closeDialog=function(){var e=this.state.dialogContainers,t=e.length;for(t&&this.setNonSaveableDataState({dialogContainers:e.slice(0,t-1)});this.dialogs.length>=t;)this.dialogs.pop()},t.prototype.refDialog=function(e,t){this.dialogs[t]=e},t.prototype.onKeyDown=function(e){if(83===e.which&&(e.ctrlKey||e.metaKey)){if(e.preventDefault(),this.state.dialogContainers.length>0)return void this.saveDialog();this.save()}else if(27===e.which&&this.state.dialogContainers.length>0)this.closeDialog(),e.preventDefault();else if(13===e.which){var t=e.target;this.state.dialogContainers.length>0&&"TEXTAREA"!==t.tagName&&"INPUT"!==t.tagName&&"SELECT"!==t.tagName&&"OPTION"!==t.tagName&&!t.contentEditable&&this.saveDialog()}},t.prototype.beforeUnload=function(e){if((this.state.dialogContainers.length>0||this.state.hasUnsavedData)&&!u.a.kedBackendClient.http.bearerProvider.wantsRedirect)return e.returnValue=ut,e.returnValue},t.prototype.onClickPreventUnload=function(e){if(e.target&&"a"===(""+e.target.tagName).toLowerCase()){var t=e.target;if(t.href&&"#"!==t.getAttribute("href")&&!t.target&&(this.state.dialogContainers.length>0||this.state.hasUnsavedData)&&!confirm(ut))return e.preventDefault(),e.stopPropagation(),!1}},t.prototype.saveDialog=function(){if(this.state.dialogContainers.length>0){var e=this.dialogs[this.state.dialogContainers.length-1];e&&e.save()}},t.prototype.render=function(){var e=this,t=(u.a.currentUser.roles.indexOf("ADMIN"),this.state.course);return this.state.course?r.createElement("div",{style:{outline:0}},r.createElement(O,{title:t.name+" - "+t.points+"p",activePage:this.state.view,routes:{studentPage:Object(x.e)(this.props.viewCourseUrl,{courseId:this.props.id}),feedback:this.props.feedbackUrl},host:this,course:t,origCourse:this.state.origCourse,backgroundImage:t.images.filter(function(e){return e.id===t.imageId}).map(function(e){return e.url})[0],isTemplate:t.isTemplate}),r.createElement("div",{className:"sv-row sv-layout"},r.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-12"},r.createElement("div",{className:"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer"},r.createElement("div",{className:"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer",ref:function(t){return e.contentDiv=t}},r.createElement(lt,{course:this.state.course,origCourse:this.state.origCourse,host:this}),r.createElement("br",null),this.state.dialogContainers.map(function(t,n){var s=t.Component,o=t.props;return r.createElement("div",{key:n},r.createElement("div",{className:"darken"}),r.createElement("div",{className:"modal-page-wrap"},r.createElement("div",{className:"modal-page"},r.createElement(s,a.a({ref:function(t){return e.refDialog(t,n)}},o)),r.createElement(Pe.a,{onClick:function(){return e.closeDialog()}}))))})))))):r.createElement("div",{style:{outline:0}},r.createElement(O,{title:"",activePage:this.state.view,routes:{feedback:this.props.feedbackUrl}}),r.createElement("p",null,r.createElement(j.a,null),"V.g. vänta medan kursen laddas..."))},t}(r.Component),pt=function(e){var t=e.courses;return r.createElement("div",null,r.createElement("h2",null,Object(s.a)(tt||(tt=a.e(["Välj kursmall att redigera: "],["Välj kursmall att redigera: "])))),r.createElement("ul",{className:"entity-list"},t.map(function(t){var n=t.id,a=t.name,s=(t.code,t.publishable),i=t.points,l=t.subjectId;return r.createElement("li",{key:n,className:(s?"complete":"incomplete")+(e.selectedCourseId===n?" selected":"")},r.createElement(o.b,{to:"/course-templates/"+l+"/"+n},a," - ",i))})))},ht=(function(e){function t(t){var n=e.call(this,t)||this;return n.state={subjects:null},n}a.c(t,e),t.prototype.componentWillMount=function(){this.load()},t.prototype.load=function(){return a.b(this,void 0,void 0,function(){var e;return a.d(this,function(t){switch(t.label){case 0:return[4,u.a.kedBackendClient.list("subjects",{include:"standardCourses"})];case 1:return e=t.sent(),this.setState({subjects:e}),[2]}})})},t.prototype.render=function(){var e=[];return this.state.subjects&&this.state.subjects.forEach(function(t){return e.push.apply(e,t.standardCourses)}),e.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),r.createElement("div",null,r.createElement(O,{title:Object(s.a)(nt||(nt=a.e(["Kursmallar"],["Kursmallar"]))),activePage:"templateBuilder",routes:{feedback:this.props.feedbackUrl}}),this.state.subjects?r.createElement(pt,{courses:e}):r.createElement("p",null,r.createElement(j.a,null),"V.g. vänta medan kurser laddas"))}}(r.Component),function(e){function t(t){var n=e.call(this,t)||this;return n.state={courseOptions:null,selectedTemplateId:"--",courses:null,selectedCourseId:""},n}return a.c(t,e),t.prototype.componentDidMount=function(){this.load().catch(s.m)},t.prototype.load=function(){return a.b(this,void 0,void 0,function(){var e,t,n;return a.d(this,function(a){switch(a.label){case 0:return Object(s.n)("Laddar kurser"),[4,u.a.kedBackendClient.list("subjects",{include:"courseTemplates"})];case 1:return e=a.sent(),t=Object(s.k)(e.map(function(e){return e.courseTemplates})).sort(Object(s.g)("name")),n=[{id:"--",name:"--"}].concat(t),Object(s.n)(""),this.setState({courseOptions:n}),[2]}})})},t.prototype.onSelectCourse=function(e){return a.b(this,void 0,void 0,function(){var t,n,r,o,i;return a.d(this,function(a){switch(a.label){case 0:return[4,u.a.kedBackendClient.list("courses",{hasEdgesTo:[e]})];case 1:return t=a.sent(),n=t.filter(function(e){return e.active}).map(function(e){var t=e.id,n=e.school,a=e.description,r=e.createdBy,o=e.modifiedBy;a&&(a=Object(s.l)(a,80));var i=a||(r?r.name+"s version":o&&o.name+"s version");return{id:t,name:"standard"===n?a?"Standard - "+a:"Standard":n+" - "+Object(s.l)(i,90),school:n}}).sort(Object(s.g)("name")),r=n.filter(function(e){return"standard"===e.school}),o=n.filter(function(e){return"standard"!==e.school}),i=r.concat([{id:e,name:"Tom"}],o),this.setState({courses:i,selectedTemplateId:e,selectedCourseId:i[0].id}),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.courseOptions,i=(t.selectedTemplateId,t.courses),l=t.selectedCourseId;return r.createElement("div",{style:{outline:0}},r.createElement(O,{title:Object(s.a)(at||(at=a.e(["Kursbyggaren"],["Kursbyggaren"]))),activePage:"courseBuilder",routes:{feedback:this.props.feedbackUrl}}),r.createElement("div",{className:"sv-row sv-layout"},r.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-12"},r.createElement("div",{className:"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer"},r.createElement("div",{className:"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer"},r.createElement("div",{className:"sv-row sv-layout sv-skip-spacer"},r.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-7"},r.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},r.createElement("h2",null,"Skapa ny kurs"),r.createElement("hr",null),r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem top"},r.createElement("p",null,"Välj gymnasiekurs :"))),r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem top"},n?r.createElement("select",{value:this.state.selectedTemplateId,onChange:function(t){return e.onSelectCourse(t.target.value).catch(s.m)}},n.map(function(e){return r.createElement("option",{key:e.id,value:e.id},e.name)})):r.createElement("div",null,r.createElement(j.a,null),r.createElement("select",{disabled:!0,value:""},r.createElement("option",null,"--"))))),i&&r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem top"},r.createElement("p",null,"Utgå från version: "))),i&&r.createElement("div",{className:"align-horizontal spaced"},r.createElement("div",{className:"horizontalItem top"},r.createElement("select",{value:l,onChange:function(t){return e.setState({selectedCourseId:t.target.value})}},i.map(function(e){return r.createElement("option",{key:e.id,value:e.id},e.name)})))),r.createElement("br",null),r.createElement("br",null),i&&l&&r.createElement(o.b,{to:"/courses/create-from-template/"+this.state.selectedCourseId,className:"btn btn-large"},"Skapa"))),r.createElement("div",{className:"sv-layout sv-column-5"},r.createElement(Ge,null))))))))},t}(r.Component)),ft=3e5,bt="/4.4b4cce2a160e445593f16043.html",vt=Date.now();function gt(){vt=Date.now()}function kt(){Date.now()-vt<ft&&function(){a.b(this,void 0,void 0,function(){var e,t;return a.d(this,function(n){switch(n.label){case 0:console.log("Sending heartbeat request to "+bt),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,fetch(bt,{cache:"no-cache",credentials:"same-origin"})];case 2:return e=n.sent(),console.log("Response from "+bt+": "+e.status+" "+e.statusText),[3,4];case 3:return t=n.sent(),console.warn("Request to "+bt+" failed: "+t),[3,4];case 4:return[2]}})})}()}n.d(t,"a",function(){return yt}),setInterval(kt,ft),setTimeout(function(){return B()("body").mousemove(gt).keypress(gt).scroll(gt)},100);var Et,yt=function(e){function t(t){return e.call(this,t)||this}return a.c(t,e),t.prototype.render=function(){var e=this,t=u.a.currentUser.roles.some(function(e){return"ADMIN"===e||"EMPLOYEE"===e}),n=u.a.currentUser.roles.some(function(e){return"ADMIN"===e});return r.createElement("div",{className:"course-builder"},r.createElement(o.a,null,t?r.createElement("div",null,r.createElement(o.c,{exact:!0,path:"/",render:function(t){t.match;return n?r.createElement(R,{viewCourseUrl:e.props.viewCourseUrl,feedbackUrl:e.props.feedbackUrl}):r.createElement(ht,{feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{exact:!0,path:"/schools",render:function(t){t.match;return r.createElement(R,{viewCourseUrl:e.props.viewCourseUrl,feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{exact:!0,path:"/schools/new",render:function(){return r.createElement(L,{feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{exact:!0,path:"/schools/:id/edit",render:function(t){var n=t.match;return r.createElement(M,{id:n.params.id,title:Object(s.a)(Et||(Et=a.e(["Editera skola"],["Editera skola"]))),feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{exact:!0,path:"/subjects",render:function(){return r.createElement(z,{feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{path:"/subjects/:id",render:function(t){var n=t.match;return r.createElement(_,{id:n.params.id,feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{exact:!0,path:"/courses/new",render:function(){return r.createElement(ht,{feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{path:"/courses/create-from-template/:templateId",render:function(t){var n=t.match;return r.createElement(mt,{templateId:n.params.templateId,view:"courseBuilder",viewCourseUrl:e.props.viewCourseUrl,feedbackUrl:e.props.feedbackUrl})}}),r.createElement(o.c,{path:"/courses/:id/edit",render:function(t){var n=t.match;return r.createElement(mt,{id:n.params.id,view:"courseBuilder",viewCourseUrl:e.props.viewCourseUrl,feedbackUrl:e.props.feedbackUrl})}})):r.createElement("div",null,r.createElement(o.c,{path:"/",render:function(){return r.createElement("div",null,r.createElement(O,{title:"Kursbyggaren",activePage:"courseBuilder",routes:{feedback:e.props.feedbackUrl}}),r.createElement("h2",null,"Behörighet saknas"),r.createElement("p",null,"Detta verktyg är endast till för anställda på Kunskapsskolan."),r.createElement("h3",null,"Användarattribut"),r.createElement("table",{className:"ked_boxed",style:{border:"1px solid #eee"}},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Attribut"),r.createElement("th",null,"Värde"))),r.createElement("tbody",null,Object.keys(u.a.currentUser).map(function(e){return r.createElement("tr",{key:e},r.createElement("td",null,e),r.createElement("td",null,u.a.currentUser[e]))}))))}}))),r.createElement(i.a,null))},t}(r.Component)},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(1),r=(n(60),n(59),n(3)),s=n(0),o=n(69),i=n(57),l=function(e){function t(t){var n=e.call(this,t)||this;return location.hash||(location.hash="#/"),n}return a.c(t,e),t.prototype.render=function(){return r.a.currentUser?s.createElement(o.a,{viewCourseUrl:"courseviewer.html",feedbackUrl:"http://svt.se/nyheter"}):s.createElement(i.a,null)},t}(s.Component);t.default=l}]);
//# sourceMappingURL=testpagecoursebuilder.min.js.map