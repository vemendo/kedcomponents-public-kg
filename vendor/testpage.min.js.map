{"version":3,"sources":["webpack://[name]/webpack/bootstrap","webpack://[name]/external \"React\"","webpack://[name]/./src/utils/utils.ts","webpack://[name]/./src/globals/ked.ts","webpack://[name]/./src/globals/KED.env.ts","webpack://[name]/./src/components/weekplanner/weekplanner-persisted-state.ts","webpack://[name]/./src/repos/user-tasks-repo.ts","webpack://[name]/external \"jQuery\"","webpack://[name]/./src/globals/KED.cfg.ts","webpack://[name]/./src/utils/query-string.ts","webpack://[name]/./src/access-control/get-user-claims.ts","webpack://[name]/./src/access-control/index.ts","webpack://[name]/./src/components/course-builder/sub-components/spinner.tsx","webpack://[name]/../kedbackend/js/ked-backend-client/utils.ts","webpack://[name]/./src/utils/school-moment.ts","webpack://[name]/../kedbackend/js/ked-backend-client-web/bearer-storage-sessionstorage.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate-task.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate-course.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/index.ts","webpack://[name]/../kedbackend/js/ked-backend-client-web/index.ts","webpack://[name]/../kedbackend/js/ked-backend-client/restclient.ts","webpack://[name]/external \"ReactDOM\"","webpack://[name]/./src/globals/KED.ts","webpack://[name]/../kedbackend/js/ked-backend-client/ked-bearer-provider.ts","webpack://[name]/../kedbackend/js/ked-backend-client/access-control.ts","webpack://[name]/../kedbackend/js/ked-backend-client/http-error.ts","webpack://[name]/../kedbackend/js/ked-backend-client/index.ts","webpack://[name]/./src/apis/eds-stubdata/ActiveCourses.ts","webpack://[name]/./src/apis/eds-stubdata/LatestAssessments.ts","webpack://[name]/./src/apis/eds-stubdata/StudentGoals.ts","webpack://[name]/./src/apis/edsclient.ts","webpack://[name]/./src/components/utility-components/open-close-box.tsx","webpack://[name]/./src/utils/weekutil.ts","webpack://[name]/./src/components/utility-components/renameable-text.tsx","webpack://[name]/./src/repos/hidden-courses-repo.ts","webpack://[name]/./src/repos/ked-repo.ts","webpack://[name]/./src/utils/school-term.ts","webpack://[name]/./src/components/course-builder/sub-components/remove-item.tsx","webpack://[name]/./src/globals/moment-sv-locale.ts","webpack://[name]/./src/components/course-viewer/subcomponents/confirmation.tsx","webpack://[name]/./src/components/course-viewer/subcomponents/task-list.tsx","webpack://[name]/./src/features/features.ts","webpack://[name]/./src/repos/repo.ts","webpack://[name]/./src/components/utility-components/dialogs.tsx","webpack://[name]/./src/components/calendar/course-name-to-css-class.ts","webpack://[name]/./src/test/data/users.ts","webpack://[name]/./src/components/weekplanner/get-task-type.ts","webpack://[name]/./src/components/weekplanner/user-tasks-box.tsx","webpack://[name]/./src/components/weekplanner/add-custom-goal.tsx","webpack://[name]/./src/components/utility-components/form-field.tsx","webpack://[name]/./src/components/utility-components/form-field-text-input.tsx","webpack://[name]/./src/components/utility-components/form-field-textarea.tsx","webpack://[name]/./src/components/weekplanner/add-custom-task.tsx","webpack://[name]/./src/components/weekplanner/add-or-edit-sub-task.tsx","webpack://[name]/./src/components/weekplanner/edit-user-task.tsx","webpack://[name]/./src/utils/pending-job.ts","webpack://[name]/./src/components/weekplanner/weekplanner.tsx","webpack://[name]/./src/components/weekplanner/refiner.ts","webpack://[name]/./src/global-setters/set-ked-backend-client.ts","webpack://[name]/./src/global-setters/set-bearer-providers.ts","webpack://[name]/./src/components/list-courses/list-courses.tsx","webpack://[name]/./src/components/course-viewer/subcomponents/learning-goals-list.tsx","webpack://[name]/./src/global-setters/set-eds-client.ts","webpack://[name]/./src/test/utils/choose-user.tsx","webpack://[name]/./node_modules/moment/locale sync sv|en","webpack://[name]/./src/global-setters/set-all.ts","webpack://[name]/./src/test/configure.ts","webpack://[name]/./src/components/learning-tasks/index.tsx","webpack://[name]/./src/apis/ked-learninggoals.ts","webpack://[name]/./src/repos/kg-termplanner-repo.ts","webpack://[name]/./src/components/kg-termplanner/week-note-dialog.tsx","webpack://[name]/./src/components/kg-termplanner/index.tsx","webpack://[name]/./src/components/ks-goals/goals-viewmodel.ts","webpack://[name]/./src/components/ks-goals/future-abilities-viewmodel.ts","webpack://[name]/./src/components/ks-goals/future-abilities-table.tsx","webpack://[name]/./src/components/ks-goals/goals.tsx","webpack://[name]/./src/components/ks-termplanner2/termplanner-utils.ts","webpack://[name]/./src/repos/ks-termplanner-repo.ts","webpack://[name]/./src/components/ks-termplanner2/viewmodel.ts","webpack://[name]/./src/components/ks-termplanner2/termplanner.tsx","webpack://[name]/./src/utils/table-walk.ts","webpack://[name]/./src/utils/constants.js","webpack://[name]/./src/components/calendar/day-view-event.tsx","webpack://[name]/./src/components/calendar/time-lines.tsx","webpack://[name]/./src/components/calendar/day-view.tsx","webpack://[name]/./src/components/calendar/crunch-colliding-events.ts","webpack://[name]/./src/components/calendar/hour-marker.tsx","webpack://[name]/./src/components/calendar/status-bar.tsx","webpack://[name]/./src/components/calendar/week-view.tsx","webpack://[name]/./src/apis/google-calendar.ts","webpack://[name]/./src/components/calendar/index.tsx","webpack://[name]/./src/components/calendar/should-include-calendar.ts","webpack://[name]/./src/components/my-courses/my-courses.tsx","webpack://[name]/./src/components/latest-assessments/latest-assessments.tsx","webpack://[name]/./src/test/data/learningModules.ts","webpack://[name]/./src/test/data/learningModules2.ts","webpack://[name]/./src/test/components.ts","webpack://[name]/./src/test/testpage.tsx"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","p","jsonpArray","window","oldJsonpFunction","bind","slice","React","capitalizeFirst","str","charCodeAt","substr","toLocaleUpperCase","extend","obj","extension","keys","forEach","key","clone","getOwnPropertyNames","getOwnPropertyDescriptor","concat","flatten","a","compareProp","prop","b","aProp","bProp","compareProps","props","locales","options","Array","isArray","map","localeCompare","reduce","cmp1","cmp2","L","text","args","_i","arguments","rv","buildMessage","dateTimeReviver","exec","Date","showInfo","msg","event","CustomEvent","detail","dispatchEvent","showError","errMsg","message","console","error","maxLength","maxLen","arrayToLookup","keyAccessor","item","array","arrayToMap","cherryPickProps","propsToPick","propsToPick_1","param","distinct","KED","ked","env","__webpack_exports__","weekplanner_persisted_state_WeekPlannerPersistedState","WeekPlannerPersistedState","userOrCopy","this","user","lastWrite","now","weekDate","moment_sv_locale","startOf","valueOf","openCourses","assign","load","cookie","localStorage","getItem","storedData","JSON","parse","state","isExpired","moment_default","save","json","stringify","setItem","asOf","isBefore","add","EXPIRATION_HOURS","VERSION","user_tasks_repo_userTasksRepo","KED_env","userTasksRepo","user_tasks_repo_UserTasksRepo","_super","UserTasksRepo","_this","getClient","kedBackendClient","optimistic","table","currentUser","mail","getQueryOptions","tslib_es6","userEmail","persistedState","_a","_b","sent","weekNumber","week","from","kedWeek","weekutil","year","notBefore","to","notAfter","role","include","flags","updatePersistedState","stateChanges","mem","notifySubscribers","setTaskDoneState","userTask","done","client","modifiedItem","update","$meta","list","cache","similarTasks","identicalTasks","filter","t","courseName","learningGoal","task","id","join","course","setSubTaskDoneState","subTaskId","subTasks","st","setWeekPlannerBoxOpen","isOpen","changeWeek","newPersisted","refreshFromServer","subscribe","subscriber","proxySubscriber","userTasks","ut","weekTexts","kedbackend_client","dateTime","assessment","strategy","acl","school","ac","toString","unsubscribe","subscribers","ked_repo","ensureHasData","jQuery","_KED__WEBPACK_IMPORTED_MODULE_0__","cfg","parseQueryString","locationSearch","toLower","split","part","decodeURIComponent","trim","toLowerCase","encodeParams","params","encodeURIComponent","generateQueryString","splitUrlAndQuery","urlWithPossibleQuery","pQuery","indexOf","getUserClaims","type","roles","access_control_IMPERSONATION_QUERY_PARAMS","access_control_hasAccess","doc","requestedRight","claims","fromStringArray","access_control_hasWriteAccess","access_control_isTeacherAtSchool","isTeacher","some","belongsToSchool","access_control_impersonationEnv","actAs","url","currentQuery","query_string","location","search","newQuery","newQueryString","href","hash","access_control_actAs","access_control_preserveImpersonationQuery","query","IMPERSONATION_QUERY_PARAMS_1","Spinner","react__WEBPACK_IMPORTED_MODULE_0__","className","aria-hidden","createUUID","replace","Math","random","floor","avoidSimultanousCalls","method","ongoingPromise","then","getFirstAndLastWeekOfTerm","term","getTermStartAndEnd","month","moment__WEBPACK_IMPORTED_MODULE_0___default","getSchoolMoment","thisYear","isAutumn","academicYear","addYear","aYear","numYearsToAdd","yearStr","parseInt","BearerStorageSessionStorage","tokenInfo","sessionStorage","Promise","resolve","token","expires","ex","migrateTask","resources","migrate_migrate","graphs","taskIds","responsibleTeachers","resourses","label","tasks","migrate_course_migrateCourse","__migrator_mixed_in","ked_model_migrator_KedModelMigratorMixin","ked_backend_client","ked_backend_client_web_storage","ked_backend_client_web_timeOfPageLoad","ked_backend_client_web_WebServerBearerProvider","WebServerBearerProvider","tokenPath","tokenResponseMapper","tokenId","getBearer","utils","refreshBearer","fetch","headers","Accept","redirect","credentials","res","_e","status","wantsRedirect","log","reload","Error","_c","_d","ked_backend_client_web_isomorphic","self","btoa","ked_backend_client_web_KedBackendClientWeb","KedBackendClientWeb","apiBaseUrl","providerOrTokenPath","bearerProvider","x","ked_backend_client_web_extends","_utils__WEBPACK_IMPORTED_MODULE_0__","RestClient","isomorphic","baseUrl","fetchOptions","mode","authHeader","bearer","username","password","path","__assign","nocache","queryStr","Authorization","wwwauth","test","post","Content-Type","body","delete","ReactDOM","ked_bearer_provider_KedBearerProvider","KedBearerProvider","storage","clientId","clientSecret","tokenUrl","tokenQuery","restclient","retries","warn","statusText","DocumentAccess","accessClaimType","accessClaimValue","right","fromString","claimType","unescape","claimValue","escape","accessComponent","toStringArray","hasAccess","userClaims","claim","HttpError","code","__extends","ked_backend_client_KedBackendClient","KedBackendClient","http","getMyClaims","batch","reqs","sort","req1","req2","op","do","scopeFn","runner","ked_backend_client_BatchRunner","mutationRequests","deleteRealm","realm","put","share","unshare","link","sourceTable","sourceId","targetTable","targetId","link2","unlink","unlink2","BatchRunner","ked_backend_client_assign","courses","courseId","periodName","periodGoalGrade","shortName","courseSteps","stepId","isCompleted","completedDate","assessments","publishDateTime","gradeName","courseUnitName","studyPlans","StudyPlans","finalGoalGrade","strategyText","periodGoals","edsclient_privatizingCacheBust","edsclient_EdsClient","EdsClient","getActiveCourses","edsclient_avoidSimultanousCalls","getLatestAssessments","getStudentGoals","getStudentFutureAbilities","q","courseCode","CourseCode","PeriodName","ex_1","edsclient_templateObject_1","limit","isNaN","Count","studentGoals","studentFutureAbilities","edsclient_EDSPeriod","EDSPeriod","periodStringOrSchoolTerm","period","startsWith","schoolTerm","school_term","StubEdsClient","ongoingPromises","argsJson","react__WEBPACK_IMPORTED_MODULE_1__","OpenCloseBox","headerOpen","tslib__WEBPACK_IMPORTED_MODULE_0__","componentWillReceiveProps","nextProps","setState","render","title","children","headerClassName","contentClassName","onClick","onOpenClose","KEDWeek","locale","toDate","getTime","getAdjustedWeek","weekday","RenameableText","editMode","runtimeStyle","readOnly","tabIndex","onFocus","e","rename","style","width","ref","display","clickAdvertiseText","tag","input","maxChars","ev","jquery__WEBPACK_IMPORTED_MODULE_2___default","target","select","onBlur","onKeyDown","onChange","placeholder","undefined","keyCode","blur","stopPropagation","propagateOnChange","newValue","propagatedOnChange","eager","txt","textAlign","css","fontSize","paddingTop","paddingBottom","paddingLeft","paddingRight","marginTop","marginBottom","marginLeft","marginRight","borderRadius","backgroundColor","lineHeight","fontWeight","outLine","borderStyle","height","boxSizing","focus","hiddenCoursesRepo","_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__","HiddenCoursesRepo","fullCourse","notifySubscriber","visible","err","kedRepo","_ked_repo__WEBPACK_IMPORTED_MODULE_1__","initPromise","init","all","kedCoursesPromise","edsCoursesPromise","catch","_utils_utils__WEBPACK_IMPORTED_MODULE_3__","bearerPromise","listKedCourses","listEDSCourses","userHiddenCoursesResolved","userHiddenCoursesPromise","resolveUserHiddenCoursesPromise","userHiddenCourses","activeCourses","edsActiveCourses","createCoursesList","cacheBust","schools","_apis_edsclient__WEBPACK_IMPORTED_MODULE_5__","_utils_school_moment__WEBPACK_IMPORTED_MODULE_6__","moment__WEBPACK_IMPORTED_MODULE_7___default","edsClient","hiddenCoursesMap","hc","show","visibleCoursesMap","isStudent","edsCourseMap","description","modifiedBy","edsCourse","defaultVisible","hideCourse","overrides","items","insert","kedbackend_client__WEBPACK_IMPORTED_MODULE_4__","ov","showCourse","KedRepo","_repo__WEBPACK_IMPORTED_MODULE_1__","queryOptions","getCacheBust","regenerateCacheBust","kedbackend_client__WEBPACK_IMPORTED_MODULE_2__","upsert","updater","$etag","updatedItem","reject","modifiedItems","memRepoItem","find","it","br","ids","freshItems","freshItem","modified","newEtags","stripGraphs","graph","stripped","foreignItems","graphs_1","stripped_1","SchoolTerm","dateOrSchoolMoment","schoolMoment","_school_moment__WEBPACK_IMPORTED_MODULE_1__","nextTerm","prevTerm","toLocaleString","shortYear","locales_1","RemoveItem","_utils_utils__WEBPACK_IMPORTED_MODULE_2__","templateObject_1","updateLocale","months","monthsShort","weekdays","weekdaysShort","weekdaysMin","longDateFormat","LT","LTS","LL","LLL","LLLL","lll","llll","calendar","sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse","relativeTime","future","past","ss","mm","h","hh","dd","M","MM","y","yy","dayOfMonthOrdinalParse","ordinal","number","dow","doy","localMoment","confirmation_Confirmation","external_React_","onConfirm","onCancel","task_list_TaskList","TaskList","confirmations","persisted","componentDidMount","user_tasks_repo","componentWillUnmount","toggleTask","learningTask","siteVisionPageId","latestTimeStamp","max","deadline","step","learningTasks","weekPlannerWeek","currentWeek","forWeekString","task_list_templateObject_1","task_list_templateObject_2","task_list_templateObject_3","idx","taskLookupId","isWorking","selected","describedAction","task_list_templateObject_4","task_list_templateObject_5","confirmationVisible","tid","opacity","features_Features","features","feature","EditUserTasksViaPenOnly","schoolType","schooltype","SubTasks","AssignmentTasks","testversion","Repo","comm","listPromise","Dialogs","componentDidUpdate","prevProps","lastDiv","dialogs","jquery__WEBPACK_IMPORTED_MODULE_4___default","react_dom__WEBPACK_IMPORTED_MODULE_3__","first","popDialog","attr","dialog","div","elem","aria-disabled","onKeyPress","which","tagName","click","ctrlKey","metaKey","domNode","preventDefault","_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__","courseNameToCssClass","cssPrefix","users","displayName","schoolGrade","getTaskType","user_tasks_box_UserTasksBox","UserTasksBox","learningGoals","src_features","open_close_box","user_tasks_box_templateObject_1","course_name_to_css_class","becameOpen","setIsOpen","lg","removeLearningGoal","taskType","expired","setTaskDone","viewCourseUrl","courseUrl","access_control","user_tasks_box_getTaskUrl","editTask","host","format","subTask","setSubTaskDone","editSubTask","addOwnTask","user_tasks_box_templateObject_2","add_custom_goal_AddCustomGoal","AddCustomGoal","onSave","size","autoFocus","form_field_FormField","FormField","htmlFor","node","recucheck","Set","findId","has","child","childId","form_field_text_input_TextInput","TextInput","form_field_textarea_TextAreaFormField","TextAreaFormField","cols","rows","add_custom_task_AddCustomTask","AddCustomTask","isTask","add_or_edit_sub_task_AddOrEditSubTask","AddOrEditSubTask","closeDialog","newSubTask_1","isEditMode","edit_user_task_EditUserTask","EditUserTask","onUserTasksChanged","myUserTask","isModified","addSubTask","openDialog","showCalendar","onUpdate","onDelete","isCustomTask","es","datePicker","dateFormat","popperPlacement","setOpen","pending_job_PendingJob","PendingJob","callback","timeoutId","cancelled","pending","isJobExecuting","jobCallback","triggerChange","throttle","clearTimeout","setTimeout","launchJob","stop","weekplanner_WeekPlanner","WeekPlanner","saving","weekTextsUT","isLoading","weekTextsSavingJob","saveWeekTexts","newState","isWeekTextsEdited","prevWeek","openAddGoalDialog","weekplanner_templateObject_1","addCustomGoal","openAddOwnTaskDialog","learningGoalName","weekplanner_templateObject_2","addCustomTask","weekplanner_templateObject_3","confirm","allTasks","copyFromPreviousWeek","prevWeekNo","prevKEDWeek","prevTasks","prevTask","taskOfCurrentWeek","copies","copy","taskSets","tasksPerCourse","courseTasks","tasksPerLearningGoal","resultLearningGoals","lgTasks","learningGoalTask","refiner_refine","isSaving","isStrategyEdited","isAssessmentEdited","enableSaveButton","weekplanner_templateObject_4","weekplanner_templateObject_5","spinner","weekplanner_templateObject_6","weekplanner_templateObject_7","weekplanner_templateObject_8","utility_components_dialogs","_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__","kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__","_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__","KED_API_URL","getMergedTokenPath","scopes","_utils_query_string__WEBPACK_IMPORTED_MODULE_1__","impersonationProps","_utils_utils__WEBPACK_IMPORTED_MODULE_7__","_access_control_index__WEBPACK_IMPORTED_MODULE_6__","tokenPathWithoutQuery","tokenQueryString","tokenPathQuery","getTokenId","mergedTokenPath","createTestTokenProvider","kedbackend_client__WEBPACK_IMPORTED_MODULE_3__","_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__","KED_CLIENT_ID","KED_CLIENT_SECRET","email","storedSessionUser","initialUserEmail","_globals_KED_env__WEBPACK_IMPORTED_MODULE_5__","KED_TOKEN_PATH","responseText","ok","saveUserInfo","createBearerProvider","googleMergedPath","googleTokenProvider","createGoogleTokenProvider","KED_TOKEN_URL","ListCourses","updateHiddenCourses","componentWillMount","_repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_6__","templateObject_2","_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__","visibleCourses","hiddenCourses","_utils_query_string__WEBPACK_IMPORTED_MODULE_4__","_access_control_index__WEBPACK_IMPORTED_MODULE_5__","LearningGoalsList","commonTasks","_task_list__WEBPACK_IMPORTED_MODULE_2__","_apis_edsclient__WEBPACK_IMPORTED_MODULE_3__","EDS_API_URL","ChooseUser","_data_users__WEBPACK_IMPORTED_MODULE_1__","fontStyle","./en-au","./en-au.js","./en-ca","./en-ca.js","./en-gb","./en-gb.js","./en-ie","./en-ie.js","./en-nz","./en-nz.js","./sv","./sv.js","webpackContext","req","webpackContextResolve","_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__","ENVIRONMENT","_utils_query_string__WEBPACK_IMPORTED_MODULE_3__","_data_users__WEBPACK_IMPORTED_MODULE_2__","u","_globals_KED_env__WEBPACK_IMPORTED_MODULE_1__","learning_tasks_LearningTasks","LearningTasks","apiPath","pageId","ked_learninggoals_getLearningGoalsAndTasks","moduleName","subject","commonTasksList","learningGoalsList","learning_goals_list","kg_termplanner_repo_termPlannerRepo","KGTermPlannerRepo","school_moment","termStart","termEnd","week_note_dialog_WeekNoteDialog","WeekNoteDialog","note","color","weekPlan","plans","wp","kg_termplanner_KGTermPlanner","KGTermPlanner","weekPlans","isLoadingCourses","isLoadingWeekPlans","updateWeekPlans","loadEDSCourses","edsclient","onNoteClick","weeks","firstWeek","weekMoment","w","credits","goals_viewmodel_ViewModel","subjects","sp","g","goal","atGoal","stGoal","finalGoal","strategies","future_abilities_viewmodel_FutureAbilitiesViewModel","formNames","capabilities","formName","years","columnHeaders","vtHts","row","abilityName","addedCapabs","cells","htHasValue","vtHasValue","capabilityName","cell","capabRows","future_abilities_table_FutureAbilitiesTable","FutureAbilitiesTable","loading","error_1","viewModel","rowSpan","colSpan","vtHt","col","goals_KSGoals","KSGoals","loadingStudyPlans","showTermGoals","goals_templateObject_1","goals_templateObject_2","goals_templateObject_3","goals_templateObject_4","goals_templateObject_5","goals_templateObject_6","LAST_STEP_SPRING","LAST_STEP_AUTUMN","getColumnHeaderFromCourse","ks_termplanner_repo_termPlannerRepoKS","KSTermPlannerRepo","viewmodel_ViewModel","dbWeekPlans","nowMoment","kedWeek_1","this_1","cellValues","lastStepWeek","lastStepKedWeek","lastSteps","completedSteps","termGoals","courses_1","columnHeader","termplanner_KSTermPlanner","KSTermPlanner","initialDate","loadingActiveCourses","loadingWeekPlans","flowId","tableElem","external_jQuery_default","keydown","is","nextTr","isUp","td","closest","tr","index","toArray","allTrs","trIndex","selectionStart","selectionEnd","val","eq","tabables","prevElement","nextElement_1","nextElement","loadActiveCourses","updateCell","columnName","stack","termplanner_templateObject_1","model","lastTrDatas","termplanner_templateObject_2","termplanner_templateObject_3","termplanner_templateObject_4","termplanner_templateObject_5","termplanner_templateObject_6","termplanner_templateObject_7","termplanner_templateObject_8","termplanner_templateObject_9","rtxts","renameable_text","rt","termplanner_templateObject_10","termplanner_templateObject_11","MINUTE","SECOND","day_view_event_DayViewEvent","dayStart","startMoment","endMoment","pos","zoom","htmlLink","top","diff","localeTimeOptions","hour","minute","localeStartTime","toLocaleTimeString","localeEndTime","position","left","maxHeight","overflow","day_view_event_templateObject_1","time_lines_TimeLines","dayEnd","hourPixels","startHour","endHour","hours","margin","day_view_DayView","events","isLastCall","crunchedEvents","eventIndex","overlaps","allOverlaps","prevOverlaps","overlap","round","cn","crunch_colliding_events_crunchCollidingEvents","hour_marker_HourMarker","ypos","padding","status_bar_StatusBar","WeekView","firstDay","numDays","dayDatas","day","dayDate","isToday","start","end","isBetween","fullDayEvents","date","startDate","endDate","border","toISOString","week_view_templateObject_1","week_view_templateObject_2","google_calendar_GoogleCalendar","GoogleCalendar","ensureInited","gapi","loadGapi","tokenExpiration","tokenResult","auth","setToken","access_token","expires_in","script","document","createElement","src","getElementsByTagName","appendChild","gaapi_loaded","listCalendars","calendarList","listEvents","calendarId","timeMin","timeMax","showDeleted","singleEvents","maxResults","orderBy","calendar_Calendar","Calendar","initialStartHour","initialEndHour","initialZoom","calendars","calendarsBeingLoaded","gcal","loadData","handleError","cal","summary","isPrimary","primary","isClassroomCalendar","isHolidayCalendar","shouldIncludeCalendar","endOf","navigateToPreviousWeek","navigateToNextWeek","eventSets","isSchedule","isHoliday","classNames","colorId","calendar_templateObject_1","week_view","MyCourses","updateHiddenCoursesState","_repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_2__","getCourseUrl","_access_control__WEBPACK_IMPORTED_MODULE_3__","LatestAssessments","_globals_KED_env__WEBPACK_IMPORTED_MODULE_3__","hasGrades","templateObject_3","templateObject_4","templateObject_5","templateObject_6","learningModules","learningPageUrls","components_components","component","latest_assessments","navigator","language","goals","termplanner","kg_termplanner","weekplanner","learning_tasks","my_courses","list_courses","testpage_TestPage","TestPage","selectedComponent","selectedLearningModule","selectedLearningModuleUrl","renderTestComponent","learningModuleTasks","componentArea","html","external_ReactDOM_","lm","choose_user"],"mappings":"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","file":"testpage.min.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp_name_\"] = window[\"webpackJsonp_name_\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([88,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = React;","\nexport function capitalizeFirst (str) {\n    for (let i=0, l=str.length; i<l; ++i) {\n        if (str.charCodeAt(i) < 0x2000) {\n            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);\n        }\n    }\n    return str;\n}\n\nexport function extend(obj, extension) {\n    if (typeof extension !== 'object') return obj;\n    Object.keys(extension).forEach(key => {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\n\nexport function clone<T,E> (obj : T, extension?: E) {\n    let clone = {};\n    Object.getOwnPropertyNames(obj).forEach(key => {\n        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));\n    });\n    if (extension) extend(clone, extension);\n    return clone as (T & E);\n}\n\nconst concat = [].concat;\nexport function flatten<T> (a : (T | T[])[]) {\n    return concat.apply([], a) as T[];\n}\n\nexport function compareProp(prop:string) {\n    return (a,b) => {\n        const aProp = a[prop], bProp = b[prop];\n        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;\n    }\n}\n\nexport function compareProps(props: string | string[], locales?: string | string[], options?: Intl.CollatorOptions) {\n    props = Array.isArray(props) ? props : [props];\n\n    const localeCompare = (a,b) =>\n        typeof a === 'string' ?\n            a.localeCompare(b, locales, options) :\n            a < b ? -1 : a > b ? 1 : 0;\n\n    return props\n        .map(prop => (a,b) => localeCompare(a[prop], b[prop]))\n        .reduce((cmp1, cmp2) =>\n            (a,b) => cmp1(a,b) || cmp2(a,b));\n}\n\nexport function L(text, ...args) {\n    let first = text[0];\n    return buildMessage(text, args);\n}\n\nfunction buildMessage (text, args) {\n    let rv = text[0];\n    for (let i=1, l=text.length; i<l; ++i) {\n        rv += args[i-1] + text[i];\n    }\n    return rv;\n}\n\nexport class TC<T> {\n    constructor(template: T) {\n        extend(this, template);\n    }\n}\n\nexport function dateTimeReviver (key, value) {\n    var a;\n    if (typeof value === 'string') {\n        a = /\\/Date\\((\\d*)\\)\\//.exec(value);\n        if (a) {\n            return new Date(+a[1]);\n        }\n    }\n    return value;\n}\n\nexport function showInfo (msg) {\n    var event = new CustomEvent('info', { 'detail': msg });\n    window.dispatchEvent(event);\n}\n\nexport function showError (errMsg: string | Error) {\n    const msg = typeof errMsg === 'string' ? errMsg : errMsg.message;\n    var event = new CustomEvent('customerror', { 'detail': msg });\n    console.error(errMsg);\n    window.dispatchEvent(event);\n}\n\nexport function maxLength(str: string, maxLen: number) {\n    return str.length > maxLen ?\n        str.substr(0, maxLen - 3) + \"...\" :\n        str;\n}\n\nexport function arrayToLookup<T>(a: T[], keyAccessor: (item: T) => string | number) {\n    const result : {[key: string] : T[]} = {};\n    for (let i=0, l=a.length; i<l; ++i) {\n        const item = a[i];\n        const key = keyAccessor(item);\n        let array = result[key];\n        if (array) array.push(item);\n        else result[key] = [item];\n    }\n    return result;\n}\n\nexport function arrayToMap<T>(a: T[], keyAccessor: (item: T) => string | number) {\n    const result : {[key: string] : T} = {};\n    for (let i=0, l=a.length; i<l; ++i) {\n        const item = a[i];\n        const key = keyAccessor(item);\n        result[key] = item;\n    }\n    return result;\n}\n\nexport function cherryPickProps<T> (obj: T, propsToPick: string[]): Partial<T> {\n    const result = {};\n    for (const param of propsToPick) {\n      if (param in obj) result[param] = obj[param];\n    }\n    return result as Partial<T>;\n}\n\nexport function distinct<T> (a: T[], keyAccessor: (item: T) => any) {\n    const map = arrayToMap(a, keyAccessor);\n    return Object.keys(map).map(key => map[key]);\n}\n","\nexport const KED_NAMESPACE = \"KED\";\n\ndeclare var KED: any;\n\nvar result = typeof KED === 'undefined' ? {} : KED;\n\nif (typeof window !== 'undefined' && typeof KED === 'undefined') {\n    window[KED_NAMESPACE] = result;\n}\n\nexport default result;\n","import {User, LearningModuleTasks} from '../contracts/ked-models';\nimport { KedBackendClient, BearerProvider } from 'kedbackend/client';\nimport {UserTask} from 'kedbackend/models';\nimport {KedRepo} from '../repos/ked-repo';\nimport {EdsClient} from '../apis/edsclient';\nimport KED from './ked';\n\nexport interface Env {\n    currentUser?: User;\n    learningModuleTasks?: LearningModuleTasks;\n    bearerProvider?: BearerProvider;\n    googleTokenProvider?: BearerProvider;\n    kedBackendClient?: KedBackendClient;\n    edsClient?: EdsClient;\n    userTasksRepo?;\n    hiddenCoursesRepo?;\n}\n\nif (!KED.env) KED.env = {};\n\nexport default KED.env as Env;\n","import moment from 'moment';\nimport { localMoment } from '../../globals/moment-sv-locale';\n\ntype Moment = moment.Moment;\n\nexport class WeekPlannerPersistedState {\n  static EXPIRATION_HOURS = 12;\n  static VERSION = 2;\n\n  user: string;\n  lastWrite: number;\n  weekDate: number;\n  openCourses: { [path: string]: boolean }\n\n  constructor (userOrCopy: string | WeekPlannerPersistedState) {\n    if (typeof userOrCopy === 'string') {\n      this.user = userOrCopy;\n      this.lastWrite = Date.now();\n      this.weekDate = localMoment().startOf('week').valueOf();\n      this.openCourses = {};\n    } else {\n      Object.assign(this, userOrCopy);\n    }\n  }\n\n  static async load(user: string) {\n    const cookie = localStorage.getItem('WeekPlannerPersistedState2');\n    const storedData = cookie && (JSON.parse(cookie) as WeekPlannerPersistedState);\n    const state = new WeekPlannerPersistedState(user);\n    if (storedData) Object.assign(state, storedData);\n\n    return state.user === user && !state.isExpired(moment()) ?\n      state : new WeekPlannerPersistedState(user);\n  }\n\n  async save() {\n    this.lastWrite = Date.now();\n    const json = JSON.stringify(this);\n    localStorage.setItem('WeekPlannerPersistedState2', json);\n  }\n\n  isExpired (asOf: Moment) {\n      return moment(this.lastWrite)\n        .isBefore(\n            asOf.add(\n                0-WeekPlannerPersistedState.EXPIRATION_HOURS, 'hours')\n        );\n  }\n}\n","import {KedRepo} from './ked-repo';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport env from '../globals/KED.env';\nimport { WeekPlannerPersistedState } from \"../components/weekplanner/weekplanner-persisted-state\";\nimport moment from 'moment';\nimport { createUUID, DocumentAccess } from 'kedbackend/client';\nimport { getAdjustedWeek, KEDWeek } from '../utils/weekutil';\n\nexport let userTasksRepo = env.userTasksRepo as UserTasksRepo;\n\nclass UserTasksRepo extends KedRepo<UserTask> {\n  persistedState: WeekPlannerPersistedState | null;\n\n  constructor() {\n    super({\n      getClient() { return env.kedBackendClient; },\n      optimistic: true,\n      table: \"usertasks\",\n      user: env.currentUser ? env.currentUser.mail : \"\",\n      getQueryOptions: async () => {\n        const userEmail = env.currentUser ? env.currentUser.mail : \"\";\n        if (!this.persistedState)\n          this.persistedState = await WeekPlannerPersistedState.load(userEmail);\n        const { weekDate } = this.persistedState;\n        const weekNumber = moment(weekDate).week();\n        const kedWeek = KEDWeek(moment(weekDate).year(), weekNumber);\n        /*const [from, to] = [moment(weekDate).startOf('week'), moment(weekDate).endOf('week')]\n          .map(m => m.toDate().getTime());*/\n        \n          return {\n            from: kedWeek.notBefore,\n            to: kedWeek.notAfter,\n            role: \"USER\",\n            include: [\"task\", \"course\"],\n            flags: [\"includeIdsOnly\"],\n          };\n        }\n    });\n    this.persistedState = null;\n  }\n\n  async updatePersistedState(stateChanges: Partial<WeekPlannerPersistedState>) {\n    Object.assign(this.persistedState, stateChanges);\n    await this.persistedState.save();\n    this.mem.notifySubscribers();\n  }\n\n  async setTaskDoneState(userTask: UserTask, done: boolean) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    const modifiedItem = Object.assign({}, userTask, {done});\n    if (optimistic) await this.mem.update(Object.assign({}, modifiedItem, {$meta: 'updating'}));\n    // Now make sure to change the state for other weeks as well:\n    const similarTasks = await client.list<UserTask>('usertasks', {\n      name: userTask.name,\n      role: \"USER\",\n      include: [\"task\",\"course\"],\n      flags: [\"includeIdsOnly\"],\n      from: moment(this.persistedState.weekDate).add(-3, 'weeks').valueOf(),\n      to: moment(this.persistedState.weekDate).add(3, 'weeks').valueOf()\n    }, {\n      cache: 'no-cache'\n    });\n    const identicalTasks = similarTasks.filter(t =>\n      t.courseName === userTask.courseName &&\n      t.learningGoal === userTask.learningGoal &&\n      (!userTask.task || t.task.map(t=>t.id).join('') === userTask.task.map(t=>t.id).join('')) &&\n      (!userTask.course || t.course.map(c=>c.id).join('') === userTask.course.map(c=>c.id).join('')));\n    await this.update(identicalTasks, t => t.done = done);\n  }\n\n  async setSubTaskDoneState (userTask: UserTask, subTaskId: string, done: boolean) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    await this.update([userTask],\n      t => t.subTasks && t.subTasks.filter(st => st.id === subTaskId)\n        .forEach(st => st.done = done));\n  }\n\n  async setWeekPlannerBoxOpen(courseName: string, isOpen: boolean) {\n    const openCourses = { ...this.persistedState.openCourses };\n    if (isOpen)\n      openCourses[courseName] = true;\n    else\n      delete openCourses[courseName];\n    await this.updatePersistedState({openCourses});\n  }\n\n  async changeWeek(weekDate: Date) {\n    let persistedState = this.persistedState;\n    if (!persistedState) {\n      persistedState = await WeekPlannerPersistedState.load(env.currentUser.mail);\n    }\n    const newPersisted = new WeekPlannerPersistedState(persistedState);\n    newPersisted.weekDate = moment(weekDate).startOf('week').valueOf();\n    newPersisted.save();\n    this.persistedState = newPersisted;\n    await this.mem.refreshFromServer();\n  }\n\n  subscribe(subscriber: (userTasks: UserTask[], persistedState: WeekPlannerPersistedState, weekTextsUT: UserTask) => void) {\n    const proxySubscriber = (userTasks: UserTask[]) => {\n      subscriber(\n        userTasks.filter(ut => !ut.weekTexts),\n        this.persistedState,\n        userTasks.filter(ut => !!ut.weekTexts)[0] || {\n          id: createUUID(),\n          dateTime: this.persistedState.weekDate,\n          weekTexts: {assessment:'', strategy:''},\n          acl: [\n            // Default ACL: Let user self have full control over this item:\n            new DocumentAccess(\"email\", env.currentUser.mail, \"S\"),\n            // Additional ACL: Let employees on same school have read access to it.\n            // This currently only applies to tasks that refer to course tasks (not own tasks!)\n            new DocumentAccess(\"schoolRole\", `${env.currentUser.school}/EMPLOYEE`, \"R\")\n          ].map(ac => ac.toString())\n        });\n    };\n    proxySubscriber[\"subscriber\"] = subscriber;\n    this.mem.subscribe(proxySubscriber);\n  }\n\n  unsubscribe(subscriber: (userTasks: UserTask[], persistedState: WeekPlannerPersistedState, weekTextsUT: UserTask) => void) {\n    this.mem.subscribers = this.mem.subscribers.filter (s => s[\"subscriber\"] !== subscriber);\n  }\n  \n}\n\nif (!userTasksRepo) {\n  userTasksRepo = env.userTasksRepo = new UserTasksRepo();\n  userTasksRepo.mem.ensureHasData();\n}\n","module.exports = jQuery;","import KED from './KED';\n\n/* This default configuration is used as a fallback.\nNormally both test pages and production pages will override these configrations\n*/\n/*const defaultConfiguration = {\n  // Environment\n  ENVIRONMENT: 'development' as 'production' | 'development' | 'test',\n  // Authentication Server:\n  KED_TOKEN_URL: 'https://kedauthtest.azurewebsites.net/token',\n  KED_TOKEN_PATH: '/api/token.Skript.portlet?sv.contenttype=application/json',\n  KED_CLIENT_ID: 'devclient',\n  KED_CLIENT_SECRET: '4fRdfQpWtJqjTWf',\n  // Services:\n  KED_API_URL: 'https://kedbackendtest.azurewebsites.net/api/',  \n  EDS_API_URL: 'https://edsportalowinapi.azurewebsites.net/api/'\n}*/\n\nexport interface IKedConfiguration {\n  ENVIRONMENT: 'production' | 'development' | 'test';\n  KED_TOKEN_URL: string;\n  KED_TOKEN_PATH: string;\n  KED_CLIENT_ID: string;\n  KED_CLIENT_SECRET: string;\n  KED_API_URL: string;\n  EDS_API_URL: string;\n};\n\nif (!KED.cfg) KED.cfg = {};\n\nexport default KED.cfg as IKedConfiguration;\n","export interface ParseQueryStringOptions {\n  toLower?: boolean;\n}\n\nexport function parseQueryString(locationSearch: string, options?: ParseQueryStringOptions): { [key: string]: string } {\n  const {toLower} = (options || {}) as ParseQueryStringOptions;\n  const result = {};\n  if (locationSearch && locationSearch.length > 1)\n    locationSearch.substr(1)\n      .split('&')\n      .map(part => part.split('=').map(s => decodeURIComponent(s.trim())))\n      .forEach(([key, value]) => result[toLower ? key.toLowerCase() : key] = value);\n  return result;\n}\n\nfunction encodeParams(params: {[key: string]:string}) {\n  return Object.keys(params).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`).join('&');\n}\n\nexport function generateQueryString(params: {[key: string]:string}) {\n  return \"?\" + encodeParams(params);\n}\n\nexport function parseHashQueryString(locationHash: string, options?: ParseQueryStringOptions) {\n  return parseQueryString(locationHash, options);\n}\n\nexport function generateHashQueryString(params: {[key: string]:string}) {\n  return \"#\" + encodeParams(params);\n}\n\nexport function splitUrlAndQuery (urlWithPossibleQuery: string) {\n  const pQuery = urlWithPossibleQuery.indexOf('?');\n  return pQuery >= 0 ?\n    [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :\n    [urlWithPossibleQuery, \"\"];\n}\n","import { User } from \"../contracts/ked-models\";\n\nexport default function getUserClaims (user: User) {\n  return [{\n    type: \"email\",\n    value: user.mail\n  },{\n    type: \"school\",\n    value: user.school\n  }].concat(user.roles.map(role => ({\n    type: \"role\",\n    value: role\n  }))).concat(user.roles.map(role => ({\n    type: \"schoolRole\",\n    value: user.school + \"/\" + role\n  })));\n}\n","import { AccessClaim, DocumentAccess, hasAccess as _hasAccess, AccessRight } from 'kedbackend/client';\nimport { Document } from 'kedbackend/models';\nimport getUserClaims from './get-user-claims';\nimport env from '../globals/KED.env';\nimport { parseQueryString, generateQueryString } from \"../utils/query-string\";\nexport { getUserClaims };\n\nexport const IMPERSONATION_QUERY_PARAMS = [\"user\",\"role\",\"school\",\"debug\",\"testVersion\",\"testversion\",\"schoolType\",\"schooltype\"];\n\nexport function hasAccess(doc: Document, requestedRight: AccessRight) {\n  var claims = getUserClaims(env.currentUser);\n  var result = _hasAccess(DocumentAccess.fromStringArray(doc.acl || []), claims, requestedRight);\n  //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);\n  return result;\n}\n\nexport function hasReadAccess(doc: Document) {\n  return hasAccess(doc, 'R');\n}\n\nexport function hasWriteAccess(doc: Document) {\n  return hasAccess(doc, 'W');\n}\n\nexport function hasShareAccess(doc: Document) {\n  return hasAccess(doc, 'S');\n}\n\nexport function isTeacherAtSchool(school: string) {\n  const isTeacher = env.currentUser.roles.some(role => role === 'EMPLOYEE' || role === 'ADMIN');\n  const belongsToSchool = (school||\"\").toLowerCase() === env.currentUser.school.toLowerCase();\n  return (isTeacher && belongsToSchool);\n}\n\nexport const impersonationEnv = {\n  actAs (options: {role, school, url?}) {\n    const {role, school, url} = options;\n    const currentQuery = parseQueryString(location.search);\n    const newQuery = {...currentQuery, role, school};\n    const newQueryString = generateQueryString(newQuery);\n    if (url) {\n      location.href = `${url}${newQueryString}`;\n    } else {\n      location.hash = \"#\";\n      location.search = newQueryString;\n    }\n  }\n}\n\nexport function actAs(options: {role, school, url?}) {\n  impersonationEnv.actAs(options);\n}\n\nexport function preserveImpersonationQuery (url: string, query: {[name: string] : string}) {\n  const currentQuery = parseQueryString(location.search);\n  const newQuery = {...query};\n  for (const param of IMPERSONATION_QUERY_PARAMS) {\n    if (currentQuery[param]) newQuery[param] = currentQuery[param];\n  }\n  const newQueryString = generateQueryString(newQuery);\n  return `${url}${newQueryString}`;\n}\n","import * as React from 'react';\n\nexport const Spinner = ()=> <span><i className=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i>&nbsp;</span>;\n","\nexport function createUUID() {\n  // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\n  var d = Date.now();\n  var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    var r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n  });\n  return uuid;\n}\n\nexport function avoidSimultanousCalls<T,A>(method: (...args:A[])=>Promise<T>) : (...args:A[])=>Promise<T> {\n  let ongoingPromise: Promise<T> = null;\n  return function() {\n      if (!ongoingPromise) {\n          ongoingPromise = method.apply(this, arguments).then(result=>{\n              ongoingPromise = null;\n              return result;\n          });\n      }\n      return ongoingPromise;\n  }\n}\n","import moment from 'moment';\nimport { Term, AcademicYear } from '../contracts/ked-models';\n\nexport interface SchoolMoment {\n  academicYear: AcademicYear;\n  term: Term;\n  week?: number;\n}\n\nexport function getFirstAndLastWeekOfTerm(term: Term) {\n  return term === 'AT' ?\n    [32, 51] :\n    [1, 25];\n}\n\nexport function getTermStartAndEnd(now: moment.Moment) : moment.Moment[] {\n  return now.month() >= 7 ? // 7 = August in JS Dates and in moment as well!\n    [moment(new Date(now.year(), 7, 1)), moment(new Date(now.year(), 11, 31))] : // aug1 - dec31\n    [moment(new Date(now.year(), 0, 1)), moment(new Date(now.year(), 6, 31))]; // jan1 - july31\n}\n\nexport function getSchoolMoment(m: moment.Moment): SchoolMoment {\n  const thisYear = m.year();\n  const isAutumn = m.month() >= 7;\n  const [autumnYear, springYear] = isAutumn ?\n    [thisYear, thisYear + 1] :\n    [thisYear - 1, thisYear];\n  const academicYear = '' + autumnYear + '/' + springYear;\n  const term = isAutumn ? 'AT' : 'ST';\n  const week = m.week();\n  return { academicYear, term, week };\n}\n\nexport function addYear(aYear: AcademicYear, numYearsToAdd: number): AcademicYear {\n  return aYear.split('/')\n    .map(yearStr => parseInt(yearStr) + numYearsToAdd)\n    .map(year => '' + year)\n    .join('/');\n}\n\nexport function nextAcademicYear(aYear: AcademicYear): AcademicYear {\n  return addYear(aYear, 1);\n}\n\nexport function prevAcademicYear(aYear: AcademicYear): AcademicYear {\n  return addYear(aYear, -1);\n}\n","import {BearerPersistentStorage, BearerTokenInfo} from '../ked-backend-client';\n\nexport class BearerStorageSessionStorage implements BearerPersistentStorage {\n    save(id: string, tokenInfo: BearerTokenInfo) {\n        sessionStorage.setItem(\"bearer-\" + id, JSON.stringify(tokenInfo));\n    }\n\n    load(id: string): Promise<BearerTokenInfo> {\n        try {\n            const json = sessionStorage.getItem(\"bearer-\" + id);\n            return Promise.resolve(json ? JSON.parse(json) : {token: null, expires: 0});\n        } catch (ex) {\n            return Promise.resolve({token: null, expires: 0});\n        }\n    }\n}\n","import { Task } from '../../KED.Backend.API/schema';\n\nexport default function migrateTask(task: Task) {\n    if (!task.resources) task.resources = [];\n}\n","import * as model from '../../KED.Backend.API/schema';\nimport migrateCourse from './migrate-course';\nimport migrateTask from './migrate-task';\n\nexport default function migrate(doc, table: string, graphs?: string[]) {\n  switch (table) {\n    case \"courses\":\n      migrateCourse(doc, graphs);\n      break;\n    case \"tasks\":\n      migrateTask(doc);\n      break;\n  }\n}\n","import { Course } from '../../KED.Backend.API/schema';\nimport migrateTask from './migrate-task';\n\nexport default function migrateCourse(course: Course, graphs?: string[]) {\n  if (!course.modules) course.modules = [];\n  course.modules.forEach(module => {\n    if (!module.resources) {\n      module.resources = [];\n    }\n    if (!module.taskIds) {\n      module.taskIds = [];\n    }\n  });\n\n  if (!course.responsibleTeachers) {\n    course.responsibleTeachers = []\n  }\n\n  // Earlier wrong spelling of resources\n  if ('resourses' in (course as any) && !('resources' in (course as any))) {\n    course.resources = (course as any).resourses;\n    delete (course as any).resourses;\n  }\n  if (!course.resources) {\n    course.resources = [];\n  }\n\n  if (graphs) {\n    graphs.forEach(label => {\n      switch (label) {\n        case 'tasks':\n          course.tasks.forEach(task => migrateTask(task));\n          break;\n      }\n    });\n  }\n}\n","import { KedBackendClient } from '../ked-backend-client';\nimport migrate from './migrate';\n\nexport const KedModelMigratorMixin = (client: KedBackendClient) => {\n    if ((client as any).__migrator_mixed_in) return;\n    (client as any).__migrator_mixed_in = true;\n    \n    const get = client.get;\n    const list = client.list;\n\n    client.get = function (table, id, options) {\n        const include = options && options.include;\n        return get.apply(this, arguments).then(result => {\n            migrate(result, table, include && include.toString().split(','));\n            return result;\n        });\n    }\n\n    client.list = function (table, options) {\n        const include = options && options.include;\n        return list.apply(this, arguments).then(result => {\n            result.forEach(doc => migrate(doc, table, include && include.toString().split(',')));\n            return result;\n        });\n    }\n\n    return client;\n}\n\n","import { KedBackendClient, BearerProvider, BearerTokenInfo, IsomorphicEnv } from '../ked-backend-client';\nimport { BearerStorageSessionStorage } from \"./bearer-storage-sessionstorage\";\nimport { avoidSimultanousCalls } from '../ked-backend-client/utils';\nimport { KedModelMigratorMixin } from '../ked-model-migrator';\nKedModelMigratorMixin(KedBackendClient.prototype);\n\nexport const storage = new BearerStorageSessionStorage();\n\nconst timeOfPageLoad = Date.now();\n\nexport class WebServerBearerProvider implements BearerProvider {\n    tokenInfo: BearerTokenInfo;\n    wantsRedirect: boolean;\n\n    constructor (\n        public tokenPath: string,\n        public tokenResponseMapper: (responseText: string) => BearerTokenInfo,\n        public tokenId: string)\n    {\n        this.tokenInfo = {token: null, expires: 0};\n        this.getBearer = avoidSimultanousCalls(this.getBearer.bind(this));\n        this.refreshBearer = avoidSimultanousCalls(this.refreshBearer.bind(this));\n    }\n\n    async getBearer() {\n        if (!this.tokenInfo.token) {\n            if (this.tokenId) this.tokenInfo = await storage.load(this.tokenId);\n        }\n        if (this.tokenInfo.expires < Date.now()) {\n            await this.refreshBearer();\n        }\n        return this.tokenInfo;\n    }\n\n    async refreshBearer() {\n        const res = await fetch(this.tokenPath, {\n            headers: {Accept: \"text/plain; application/json\"},\n            redirect: 'manual',\n            cache: 'no-cache',\n            credentials: \"same-origin\"\n        });\n        if (res.status === 302 || (!res.status && res.type === \"opaqueredirect\")) {\n            // User session timed out and server wants to redirect entire page to login page\n            // Time to reload current page to force a redirect of the entire page instead for\n            // just redirecting to /api/token or whatever.\n            if (Date.now() - timeOfPageLoad > 60000) {// prohibit endless loop of reloading self.\n                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.\n                console.log(\"Redirect wanted. Reload page.\")\n                window.location.reload(true);\n            }\n        }\n        if (res.status != 200) throw new Error(\"HTTP\"+res.status + \" \" + await res.text());\n        this.tokenInfo = this.tokenResponseMapper(await res.text());\n        storage.save(this.tokenId, this.tokenInfo);\n        return this.tokenInfo;\n    }\n}\n\nexport const isomorphic = {fetch: fetch.bind(self), btoa: btoa.bind(self)};\n\nexport class KedBackendClientWeb extends KedBackendClient {\n    constructor(\n        apiBaseUrl: string,\n        providerOrTokenPath: string | BearerProvider,\n        options?: {\n            tokenResponseMapper?: (responseText: string) => BearerTokenInfo,\n            tokenId?: string\n        })\n    {\n        const bearerProvider = typeof providerOrTokenPath !== 'string' ?\n            providerOrTokenPath :\n            new WebServerBearerProvider(\n                providerOrTokenPath,\n                (options && options.tokenResponseMapper) || (x=>({token: x, expires: Date.now() + 59 * 60 * 60})),\n                options && options.tokenId);\n        super(isomorphic, bearerProvider, apiBaseUrl);\n    }\n}\n","/*\ndeclare var Buffer; // node built-in\n\n\nfunction basicAuthHeader(username, password) {\n    return \"Basic \" + new Buffer(username + \":\" + password).toString(\"base64\");\n}\n*/\n\nimport {IsomorphicEnv} from './isomorphic-env';\nimport { createUUID } from \"./utils\";\n\nexport interface BearerTokenInfo {\n    token: string;\n    expires: number;\n}\n\nexport interface BearerProvider {\n    getBearer(): Promise<BearerTokenInfo>;\n    refreshBearer(): Promise<BearerTokenInfo>;\n    wantsRedirect?: boolean;\n}\n\nexport class RestClient {\n    authHeader?: string;\n    tokenInfo?: BearerTokenInfo;\n    bearerProvider?: BearerProvider;\n    fetchOptions: RequestInit;\n\n    constructor(\n        public isomorphic: IsomorphicEnv,\n        public baseUrl: string,\n        public options: {\n            username?,\n            password?,\n            bearer?,\n            bearerProvider?: BearerProvider\n        },\n    ) {\n        this.fetchOptions = {mode: 'cors'};\n        this.authHeader = options.bearer ?\n            \"Bearer \" + options.bearer :\n            options.username ?\n                \"Basic \" + isomorphic.btoa(options.username + \":\" + (options.password || \"\")) :\n                null;\n        this.bearerProvider = options.bearerProvider || null;\n    }\n\n    async fetch(path: string, method: string, headers, query?, fetchOptions?: RequestInit): Promise<Response> {\n        if (fetchOptions && fetchOptions.cache === 'no-cache') {\n            // Workaround for back-button not respecting cache control in Chrome/Opera.\n            // Append a query parameter to force a cache entry\n            query = {...query, nocache: createUUID()}\n        }\n        const queryStr = query && Object.keys(query).map(key =>\n            encodeURIComponent(key) +\n            \"=\" +\n            encodeURIComponent(query[key]))\n            .join('&');\n\n        let {authHeader, tokenInfo, bearerProvider} = this;\n\n        // {username, password or bearer} not specified in options, but bearerProvider specified:\n        if (!authHeader && !tokenInfo && bearerProvider) {\n            this.tokenInfo = tokenInfo = await bearerProvider.getBearer();\n        }\n        // Either because we've just specified bearerProvider in options, OR, we've got a 401\n        // in earlier response with www-authenticate: Bearer, and we had a BearerProvider,\n        // so we saved the tokenInfo. Now use it regardless of whether username,password or bearer was given\n        // to options in constructor:\n        if (tokenInfo) {\n            if (tokenInfo.expires < Date.now()) {\n                console.log(\"Token expired. Refresh it:\");\n                this.tokenInfo = tokenInfo = await bearerProvider.refreshBearer();\n            }\n            authHeader = \"Bearer \" + tokenInfo.token;            \n        }\n\n        // In one way or another, we've concluded an Authorization header to use:\n        if (authHeader) {\n            headers.Authorization = authHeader;\n        }\n\n        const url = this.baseUrl + path + (queryStr ? \"?\" + queryStr : \"\");\n        let res: Response = await this.isomorphic.fetch(url, { ...this.fetchOptions, headers, method, ...fetchOptions });\n        if (res.status == 401 && this.bearerProvider) {\n            const wwwauth = res.headers.get(\"www-authenticate\");\n            console.log(`Got ${res.status} from ${this.baseUrl + path}`);\n            if (wwwauth && /Bearer/i.test(wwwauth)) {\n                this.tokenInfo = await this.bearerProvider.refreshBearer();\n                headers.Authorization = \"Bearer \" + this.tokenInfo.token;\n                res = await this.isomorphic.fetch(url, { ...this.fetchOptions, headers, method, ...fetchOptions });\n            }\n        }\n        return res;\n    }\n\n    get(path: string, query?, fetchOptions?: RequestInit) {\n        return this.fetch(path, \"GET\", { Accept: \"application/json; text/plain\" }, query, fetchOptions);\n    }\n\n    post(path: string, data, fetchOptions?: RequestInit): Promise<Response> {\n        return this.fetch(path, \"POST\", {\n            \"Content-Type\": \"application/json\",\n            \"Accept\": \"application/json\"\n        }, null, {...fetchOptions, body: JSON.stringify(data)});\n    }\n\n    delete(path: string, query?, body?, fetchOptions?: RequestInit) {\n        return this.fetch(path, \"DELETE\", { Accept: \"application/json; text/plain\" }, query, {...fetchOptions, body});\n    }\n}\n","module.exports = ReactDOM;","\nexport const KED_NAMESPACE = \"KED\";\n\ndeclare var KED: any;\n\nvar result = typeof KED === 'undefined' ? {} : KED;\n\nif (typeof window !== 'undefined' && typeof KED === 'undefined') {\n    window[KED_NAMESPACE] = result;\n}\n\nexport default result;\n","import {BearerProvider, RestClient, BearerTokenInfo} from './restclient';\nimport {IsomorphicEnv} from './isomorphic-env';\nimport {TokenQuery} from './token-query';\nimport {avoidSimultanousCalls} from './utils';\n\nexport interface BearerPersistentStorage {\n    save(id: string, tokenInfo: BearerTokenInfo);\n    load(id: string) : Promise<BearerTokenInfo>;\n}\n\nexport class KedBearerProvider implements BearerProvider {\n    tokenInfo: BearerTokenInfo;\n    client: RestClient;\n    \n    constructor (\n        public isomorphic: IsomorphicEnv,\n        public storage: BearerPersistentStorage,\n        public tokenId:string,\n        public clientId: string,\n        public clientSecret: string,\n        public tokenUrl: string,\n        public tokenQuery: TokenQuery)\n    {\n        this.tokenInfo = {token: null, expires: 0};\n        this.client = new RestClient(isomorphic, \"\", {\n            username: this.clientId,\n            password: this.clientSecret\n        });\n        this.getBearer = avoidSimultanousCalls(this.getBearer.bind(this));\n        this.refreshBearer = avoidSimultanousCalls(this.refreshBearer.bind(this));\n    }\n\n    async getBearer(): Promise<BearerTokenInfo> {\n        const {token, expires} = this.tokenInfo;\n        if (token && expires >= Date.now()) return this.tokenInfo;\n        try {\n            this.tokenInfo = await this.storage.load(this.clientId + \"/\" + this.tokenId);\n            if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now()) return this.tokenInfo;\n            await this.refreshBearer();\n            return this.tokenInfo;\n        } catch (e) {\n            await this.refreshBearer();\n            return this.tokenInfo;\n        }\n    }\n\n    async refreshBearer(): Promise<BearerTokenInfo> {\n        let res: Response;\n        for (let retries=0;retries<6;++retries) {\n            console.log(`Retrieving token for ${this.tokenId}`);\n            res = await this.client.get(this.tokenUrl, this.tokenQuery, {cache: 'reload'});\n            if (res.status !== 200) {\n                console.warn(`Got ${res.status} ${res.statusText}`);\n                continue;\n            }\n            this.tokenInfo = {token: await res.text(), expires: Date.now() + 59 * 60 * 1000};\n            console.log(`Got token for ${this.tokenId}: ${JSON.stringify(this.tokenInfo)}`);\n            this.storage.save(this.clientId + \"/\" + this.tokenId, this.tokenInfo);\n            return this.tokenInfo;\n        }\n        throw new Error(\"Failed to retrieve token for \" + JSON.stringify(this.tokenId));\n    }\n}\n","export interface AccessClaim {\n  type: string;\n  value: string;\n}\n\nexport type AccessRight = 'R' | 'W' | 'S';\n\nexport class DocumentAccess {\n  constructor(\n    public accessClaimType: string,\n    public accessClaimValue: string,\n    public right: AccessRight\n  ) { }\n\n  static fromString(ac: string) {\n    if (!ac) return null;\n    var split = ac.split(':');\n    if (split.length < 3) throw new Error(\"Invalid access string: \" + ac);\n    var claimType = DocumentAccess.unescape(split[0]);\n    var claimValue = DocumentAccess.unescape(split[1]);\n    var right = split[2];\n    if (right !== 'R' && right !== 'W' && right !== 'S')\n      throw new Error(\"Invalid access string: \" + ac);\n    return new DocumentAccess(\n      claimType,\n      claimValue,\n      right);\n  }\n\n  static escape(accessComponent: string) {\n    return accessComponent.replace(/\\%/g, \"%25\").replace(/\\:/g, \"%3A\");\n  }\n\n  static unescape(accessComponent: string) {\n    return accessComponent.replace(/\\%3A/g, \":\").replace(/\\%25/g, \"%\");\n  }\n\n  toString() {\n    return DocumentAccess.escape(this.accessClaimType) + \":\" +\n      DocumentAccess.escape(this.accessClaimValue) + \":\" +\n      this.right;\n  }\n\n  static fromStringArray(acl: string[]) {\n    return acl\n      .map(ac => DocumentAccess.fromString(ac))\n      .filter(ac => ac);\n  }\n\n  static toStringArray(acl: DocumentAccess[]) {\n    return acl.map(ac => ac.toString());\n  }\n}\n\nexport function hasAccess(acl: DocumentAccess[], userClaims: AccessClaim[], requestedRight: AccessRight) {\n  if (userClaims.some(claim => claim.type === 'role' && claim.value === \"ADMIN\"))\n    return true;\n\n  return acl.some(a =>\n    userClaims.some(c =>\n      a.accessClaimType === c.type &&\n      a.accessClaimValue === c.value && (\n        (a.right === 'R' && requestedRight === 'R') ||\n        (a.right === 'W' && ['R','W'].indexOf(requestedRight) >= 0) ||\n        (a.right === 'S'))));\n}\n","\nexport class HttpError extends Error {\n    constructor (public code: number, public message: string) {\n      super(\"HTTP\" + code + \" \" + message)\n      this.name = \"http\" + code;\n    }\n}\n","import {RestClient, BearerProvider, BearerTokenInfo} from './restclient';\nexport {BearerProvider, BearerTokenInfo};\nexport {BearerPersistentStorage} from './ked-bearer-provider';\nexport {createUUID} from './utils';\nexport {KedBearerProvider} from './ked-bearer-provider';\nimport {IsomorphicEnv} from './isomorphic-env';\nexport {IsomorphicEnv};\nexport {TokenQuery} from './token-query';\nexport * from './access-control';\nimport {HttpError} from './http-error';\nexport {HttpError}\n\nexport interface ListOptions {\n    from?: number,\n    to?: number,\n    include?: string | string[],\n    role?: string | string[],\n    hasEdgesTo?: string | string[],\n    hasEdgesFrom?: string | string[],\n    ids?: string[],\n    name?: string,\n    tags?: string | string[],\n    flags?: QueryFlag[],\n    cacheBust?: string | number\n};\n\nexport type QueryFlag = 'idsOnly' | 'includeIdsOnly' | 'idsAndNamesOnly' | 'includeIdsAndNamesOnly'; // | 'otherFlag' | 'thirdFlag';...\n\nexport class KedBackendClient {\n    http: RestClient;\n\n    constructor (\n        isomorphic: IsomorphicEnv,\n        bearerProvider: BearerProvider,\n        baseUrl: string)\n    {\n        this.http = new RestClient(\n            isomorphic,\n            baseUrl,\n            {bearerProvider});\n    }\n\n    async getMyClaims(table?: string, fetchOptions?: RequestInit) : Promise<any> // TODO: Specify what you get here\n    {\n        const res = await this.http.get(\"me/claims/\" + (table ||\"\"), null, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async get<T = any>(table, id, options?: {include?: string | string[]}, fetchOptions?: RequestInit) : Promise<T> {\n        const res = await this.http.get(`${table}/${id}`, options, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }    \n\n    async list<T = any>(table: string, options?: ListOptions, fetchOptions?: RequestInit) : Promise<T[]>\n    {\n        const res = await this.http.get(`${table}`, options, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async batch(reqs: MutationRequest[], fetchOptions?: RequestInit) : Promise<BatchResponse> {\n        // Reorder operations so that 'add's come first and 'delete's come last:\n        reqs = reqs.slice().sort((req1, req2) =>\n            req1.op === 'add' ? -1 : req2.op === 'add' ? 1 : \n            req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0);\n        const res = await this.http.post(`batch`, reqs, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async do(scopeFn: (r:BatchRunner)=>void) : Promise<BatchResponse> {\n        const runner = new BatchRunner();\n        scopeFn(runner);\n        return await this.batch(runner.mutationRequests);\n    }\n\n    async deleteRealm(realm: string) : Promise<number> {\n        const res = await this.http.delete(\"realms/\" + realm);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    add(table:string, doc) {\n        return this.do(r=>r.add(table, doc));\n    }\n    put(table:string, doc) {\n        return this.do(r=>r.put(table, doc));\n    }\n    delete (table:string, id:string) {\n        return this.do(r=>r.delete(table, id));\n    }\n    share(table:string, id:string, acl: string[]) {\n        return this.do(r=>r.share(table, id, acl));\n    }\n    unshare (table:string, id:string, acl: string[]) {\n        return this.do(r=>r.unshare(table, id, acl));\n    }\n    link (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        return this.do(r=>r.link(sourceTable, sourceId, targetTable, targetId, label));\n    }\n    link2 (sourceTable:string, sourceId:string, targetId:string, label:string) {\n        return this.do(r=>r.link2(sourceTable, sourceId, label, targetId));\n    } \n    unlink (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        return this.do(r=>r.unlink(sourceTable, sourceId, targetTable, targetId, label));\n    }\n    unlink2 (sourceTable:string, sourceId:string, targetId:string, label:string) {\n        return this.do(r=>r.unlink2(sourceTable, sourceId, label, targetId));\n    }\n}\n\nexport class BatchRunner {\n    mutationRequests: MutationRequest[];\n\n    constructor() {\n        this.mutationRequests = [];\n    }\n\n    add (table:string, doc) {\n        this.mutationRequests.push({op: 'add', table, doc});\n        return this;\n    }\n    put (table:string, doc) {\n        doc = {...doc};\n        delete doc.acl; // Forbidden to send acl with put() calls.\n        this.mutationRequests.push({op: 'put', table, doc});\n        return this;\n    }\n    delete (table:string, id:string) {\n        this.mutationRequests.push({op: 'delete', table, id});\n        return this;\n    }\n    share (table:string, id:string, acl:string[]) {\n        this.mutationRequests.push({op: 'share', table, id, acl});\n        return this;\n    }\n    unshare (table:string, id:string, acl:string[]) {\n        this.mutationRequests.push({op: 'unshare', table, id, acl});\n        return this;\n    }\n    link (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        this.mutationRequests.push({op: 'link', sourceTable, sourceId, targetTable, targetId, label});\n        return this;\n    }\n    link2 (sourceTable:string, sourceId:string, label:string, targetId:string) {\n        this.mutationRequests.push({op: 'link', sourceTable, sourceId, targetId, label});\n    }\n    unlink (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        this.mutationRequests.push({op: 'unlink', sourceTable, sourceId, targetTable, targetId, label});\n        return this;\n    }\n    unlink2 (sourceTable:string, sourceId:string, label:string, targetId:string) {\n        this.mutationRequests.push({op: 'unlink', sourceTable, sourceId, targetId, label});\n        return this;\n    }\n}\n\nexport interface AddRequest {\n    op: 'add';\n    table: string;\n    doc: {id?: string, acl?: string[], name?: string, dateTime?: number};\n}\n\nexport interface PutRequest {\n    op: 'put';\n    table: string;\n    doc: {id: string, name?: string, dateTime?: number};\n}\n\nexport interface DeleteRequest {\n    op: 'delete';\n    table: string;\n    id: string;\n}\n\nexport interface ShareRequest {\n    op: 'share';\n    table: string;\n    id: string;\n    acl: string[];\n}\n\nexport interface UnshareRequest {\n    op: 'unshare';\n    table: string;\n    id: string;\n    acl: string[];\n}\n\nexport interface LinkRequest {\n    op: 'link';\n    sourceTable: string;\n    sourceId: string;\n    targetTable?: string;\n    targetId: string;\n    label: string;\n}\n\nexport interface UnlinkRequest {\n    op: 'unlink';\n    sourceTable: string;\n    sourceId: string;\n    targetTable?: string;\n    targetId: string;\n    label: string;\n}\n\nexport type MutationRequest =\n    AddRequest |\n    PutRequest |\n    DeleteRequest |\n    ShareRequest |\n    UnshareRequest |\n    LinkRequest |\n    UnlinkRequest;\n\nexport interface BatchResponse {\n    newEtags: {[id:string] : string};\n}\n\n","import {EDSCourse} from '../../contracts/eds';\n\nexport const courses: {courses: EDSCourse[]} =\n\n{\n    \"courses\": [\n        // Test data for Gymnasium students (made-up!)\n        {\n            \n            \"courseId\": \"2070d120-30ad-49e9-89c3-9c584a6cfa29\",\n            \"periodName\": \"HT2017\",\n            \"periodGoalGrade\": \"A\",\n            \"name\": \"Naturkunskap 1b\",\n            \"shortName\": \"XXX\",\n            \"courseSteps\": []\n        },\n        // Test data once retrieved from EDS test API for ground-school students:\n        {\n            \"courseId\": \"2070d120-30ad-49e9-89c3-9c584a6cfa2c\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"A\",\n            \"name\": \"Engelska\",\n            \"shortName\": \"EN\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"61f02bc7-1a0d-4b80-9bf1-07b6280379db\",\n                    \"name\": \"1. Lära känna varandra\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903600)\\/\"\n                },\n                {\n                    \"stepId\": \"a34c07c7-3932-4f64-87f9-feb5646db3db\",\n                    \"name\": \"10. En saga\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903740)\\/\"\n                },\n                {\n                    \"stepId\": \"e931f2bb-5727-4d99-b9e5-1bababfbc2e9\",\n                    \"name\": \"11. Det här är jag\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903757)\\/\"\n                },\n                {\n                    \"stepId\": \"ab823339-90ac-4b7f-a895-869d25cef504\",\n                    \"name\": \"12. Jag och min familj\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903770)\\/\"\n                },\n                {\n                    \"stepId\": \"53e00313-4980-4ab2-84ff-abe80ecd72d2\",\n                    \"name\": \"13. Jag och mina vänner\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903787)\\/\"\n                },\n                {\n                    \"stepId\": \"828796e9-84ad-4496-aa78-7850dd5bb23a\",\n                    \"name\": \"14. Jag och min fritid\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903803)\\/\"\n                },\n                {\n                    \"stepId\": \"31e08f37-4ec5-4366-9af6-bca5b9070198\",\n                    \"name\": \"15. The Blog\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111904117)\\/\"\n                },\n                {\n                    \"stepId\": \"4f88e9a3-9b36-47af-9686-d28b00ca98fc\",\n                    \"name\": \"16. Sport\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474888651180)\\/\"\n                },\n                {\n                    \"stepId\": \"abb57443-be68-48b7-a719-3454afbf3daa\",\n                    \"name\": \"17. Musik\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1477656328037)\\/\"\n                },\n                {\n                    \"stepId\": \"964f7ac3-8cf7-4042-912f-58ffb6812ddb\",\n                    \"name\": \"18. Vykort\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3002e95c-8de0-4914-a754-0773a18606bf\",\n                    \"name\": \"19. Läsa noveller\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d8708a56-e4fb-4ad3-84ef-bb40481eaf80\",\n                    \"name\": \"2. Veckans aktiviteter\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903613)\\/\"\n                },\n                {\n                    \"stepId\": \"46915f18-288c-44df-b224-1852d221b6ca\",\n                    \"name\": \"20. Summer camp\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"db22d300-0126-4a32-950d-aaf2f7142627\",\n                    \"name\": \"21. Hus och hem\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"68111c18-e610-45c0-b290-9dd3cede1e48\",\n                    \"name\": \"22. Sightseeing\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4c84dd89-66f2-4ea1-bce8-3fde1724dcc9\",\n                    \"name\": \"23. Vid matbordet\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1488205880703)\\/\"\n                },\n                {\n                    \"stepId\": \"75943640-f031-41da-8495-9d87b5804a3e\",\n                    \"name\": \"24. Traditioner\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"72021bc2-0ea8-4d39-87fa-11cc976e9c9f\",\n                    \"name\": \"25. Staying with a host family\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"574e1626-cad3-4220-8ba7-b443f03830b4\",\n                    \"name\": \"26. Det engelska språket\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"50a3682e-057d-45b1-81b5-e2eaa8b6d16b\",\n                    \"name\": \"27. Skolan och framtidsdrömmar\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"15a47a71-989a-4348-8fcb-a10683d263ec\",\n                    \"name\": \"28. Identitet\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5717f099-477f-433d-b10a-c2bf0dfe6f8e\",\n                    \"name\": \"29. Att läsa en bok\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"0443638f-a546-40d8-a533-e2d12abef609\",\n                    \"name\": \"3. Fira ett speciellt tillfälle\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903630)\\/\"\n                },\n                {\n                    \"stepId\": \"54ff6488-f0ae-4fb6-b4e4-0f29d9274b23\",\n                    \"name\": \"30. The World Today\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"2ab8a527-cd74-4847-97a6-79f629e22e84\",\n                    \"name\": \"31. Entertainment\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1b5d42ff-9615-439a-9ae2-89779040bf91\",\n                    \"name\": \"32. Interview\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"29ffc098-d26d-4f3b-a295-b5f065923bf2\",\n                    \"name\": \"33. Filmed books\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4d5fe734-9af9-42b8-8c50-920c9a450bc1\",\n                    \"name\": \"34. See the film\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"dd87c548-4a3a-4a62-9114-70ec7e713aee\",\n                    \"name\": \"35. Write a bestseller\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1fb5ce80-faf0-465c-9be8-c9bc722297bb\",\n                    \"name\": \"36. The English-speaking World\",\n                    \"shortName\": \"36\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f0007f75-0d1f-48c7-8f19-bb2e9f2c5377\",\n                    \"name\": \"37. Poetry\",\n                    \"shortName\": \"37\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"addebfcc-5b3c-4360-b819-0de0269a5e2d\",\n                    \"name\": \"38. Rhetoric\",\n                    \"shortName\": \"38\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"23c16db5-d435-49d3-8daa-c2b6433366b7\",\n                    \"name\": \"39. An important issue\",\n                    \"shortName\": \"39\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"e4d22285-735a-4bab-8884-ca5b736ebb88\",\n                    \"name\": \"4. Åka någonstans\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903647)\\/\"\n                },\n                {\n                    \"stepId\": \"4c489a2b-ee79-4f89-9818-787632abfba8\",\n                    \"name\": \"40. Write a speech\",\n                    \"shortName\": \"40\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"9667976c-83ab-4b9e-8a76-d330983c28f5\",\n                    \"name\": \"41. Changing world\",\n                    \"shortName\": \"41\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6bb14af9-9094-4938-be2d-2725a931895c\",\n                    \"name\": \"42. An organization\",\n                    \"shortName\": \"42\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"fe313a1a-dc5c-4890-b11e-b8e109db689b\",\n                    \"name\": \"43. The written word\",\n                    \"shortName\": \"43\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f1a592ec-6095-4ae4-9b9e-ebd527c18a2a\",\n                    \"name\": \"44. Communication\",\n                    \"shortName\": \"44\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5f6a5e15-462b-40ab-981b-b93e5fc0ee22\",\n                    \"name\": \"45. Giving a lecture\",\n                    \"shortName\": \"45\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"8c9b57c1-cf05-4465-84b2-68cf353b1075\",\n                    \"name\": \"5. Min semester\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903660)\\/\"\n                },\n                {\n                    \"stepId\": \"1bd11f36-6438-40b5-ad4c-4b02b6f481d0\",\n                    \"name\": \"6. Låt oss prata om det\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903677)\\/\"\n                },\n                {\n                    \"stepId\": \"d49c08ee-c0e6-4599-b79f-5efd811fe33c\",\n                    \"name\": \"7. Jag är en turist\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903693)\\/\"\n                },\n                {\n                    \"stepId\": \"2def3414-de65-46c0-8f48-f8aa18be7b7c\",\n                    \"name\": \"8. Vänner över hela världen\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903707)\\/\"\n                },\n                {\n                    \"stepId\": \"ea8ff1a0-4bad-43ac-b328-62dff3e4d08e\",\n                    \"name\": \"9. Hjältar och kända personer\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903723)\\/\"\n                }\n            ]\n        },\n        {\n            \"courseId\": \"9d129e6a-9557-4849-a53f-416725502895\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"C\",\n            \"name\": \"Matematik\",\n            \"shortName\": \"MA\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"f1af6c2c-799a-4a3d-9985-c423940e91c0\",\n                    \"name\": \"1. Tal och mönster\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815917)\\/\"\n                },\n                {\n                    \"stepId\": \"4a34c53d-93d0-4247-ba19-9ce9dbed6de5\",\n                    \"name\": \"10. Lägesmått och diagram\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816200)\\/\"\n                },\n                {\n                    \"stepId\": \"0816a2b0-3aa7-41a9-bc39-971ccc7bd79c\",\n                    \"name\": \"11. Räknesätt\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1476103754013)\\/\"\n                },\n                {\n                    \"stepId\": \"fdc90a9c-b06a-48b1-9781-606c230c425c\",\n                    \"name\": \"12. Geometri\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1481279716607)\\/\"\n                },\n                {\n                    \"stepId\": \"bfd77c92-6636-45fa-9002-d813beaa56c3\",\n                    \"name\": \"13. Rymdgeometri\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1489669353170)\\/\"\n                },\n                {\n                    \"stepId\": \"58a619a1-b99a-487b-bbd5-abd31a903e5a\",\n                    \"name\": \"14. Räknemetoder och algebra\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"55b88760-22aa-452a-8a57-131346669aad\",\n                    \"name\": \"15. Problemet\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"47f16476-ea47-40a2-a073-7ac4b36c4bf0\",\n                    \"name\": \"16. Delen och det hela\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"704e3d5b-fce7-409b-b989-340b2d7b2e18\",\n                    \"name\": \"17. Geometri och vinklar\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"db5693ea-48ef-44ce-8107-be9915ef5256\",\n                    \"name\": \"18. Funktioner\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f9250c97-d932-4bf6-989e-204c0ef582c9\",\n                    \"name\": \"19. Proportionalitet\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d0411b1d-c9b4-452f-9fb6-ea7206755ecd\",\n                    \"name\": \"2. Längd och räknesätt\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815930)\\/\"\n                },\n                {\n                    \"stepId\": \"616b742e-b175-45c3-a926-fda3e4d8af80\",\n                    \"name\": \"20. Förflyttningsgraf\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f8a9b467-6ba6-4d9a-8174-87e369062621\",\n                    \"name\": \"21. Likformighet\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"8fe483d7-b78b-4d9d-9402-15d57da05832\",\n                    \"name\": \"22. Bråk, sannolikhet och kombinatorik\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7eb39090-6461-4ce4-b008-dd98f8a57679\",\n                    \"name\": \"23. Negativa tal, procentsatser och förändringsfaktor\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"34cb3911-3a78-4773-a823-2f9054a9a925\",\n                    \"name\": \"24. Algebra och ekvationer\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"49abad1a-dd4b-4b0b-8d1f-752796723ca1\",\n                    \"name\": \"25. Lotteriet\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6756d8bc-e31a-4139-8d95-8f47916a361b\",\n                    \"name\": \"26. Geometriska samband\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"0f0efee5-e617-4bca-b84e-e50e32aac90b\",\n                    \"name\": \"27. Rymdgeometri\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"de4e12d1-f678-4b1a-ac7b-5d62cdaeb52d\",\n                    \"name\": \"28. Storheter och proportionella samband\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"80323de8-fe66-4750-bb2e-d0dbabbb3dac\",\n                    \"name\": \"29. Funktioner och grafer\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"68894968-8a16-497a-8b97-711df61fca71\",\n                    \"name\": \"3. Tal och enheter\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815947)\\/\"\n                },\n                {\n                    \"stepId\": \"fa32d170-ab25-466d-91a8-a88f955cc5bc\",\n                    \"name\": \"30. Förpackning\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4c31e00f-aeda-409f-8583-9805c0bb4f7f\",\n                    \"name\": \"31. Negativa tal och statistik\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"691bb48b-070d-4227-8fb6-2edce2fc6be4\",\n                    \"name\": \"32. Bråk\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"320481da-e417-4c52-af23-0076b694794d\",\n                    \"name\": \"33. Procent och förändringsfaktor\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f3a4338d-504e-4092-9610-ef2775b5b411\",\n                    \"name\": \"34. Potenser\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f43d7931-158c-4759-b7be-b14cf68c939a\",\n                    \"name\": \"35. Solsystemet\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"8931fc26-693a-41bd-8040-e01a6d22b2b5\",\n                    \"name\": \"36. Ekvationer och algebra\",\n                    \"shortName\": \"36\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"94370d70-dcbd-4eef-baf1-e92f6680b966\",\n                    \"name\": \"37. Funktioner och grafer\",\n                    \"shortName\": \"37\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ab0535df-68cc-4c10-86eb-afba3e199d0a\",\n                    \"name\": \"38. Geometri\",\n                    \"shortName\": \"38\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4ba66c7a-7d8f-4576-aefa-c09397b99db0\",\n                    \"name\": \"39. Sannolikhet\",\n                    \"shortName\": \"39\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c4e12bc8-1428-4d1b-a273-e947fa0574f3\",\n                    \"name\": \"4. Multiplikation och division\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815963)\\/\"\n                },\n                {\n                    \"stepId\": \"0b75ce2b-89de-432a-9eee-d6a7b74b6f38\",\n                    \"name\": \"40. Chokladfabriken\",\n                    \"shortName\": \"40\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"dba4a055-c143-4bd4-b436-3eb508ebe658\",\n                    \"name\": \"41. Genrella lösningsmetoder\",\n                    \"shortName\": \"41\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"db193873-0a8c-4073-8618-99c5a56f710b\",\n                    \"name\": \"42. Avancerad ekvationslösning\",\n                    \"shortName\": \"42\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"357ee123-1d77-4568-8fa1-78b5662e12b3\",\n                    \"name\": \"43. Problemlösning\",\n                    \"shortName\": \"43\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"015cdd58-7b31-4a89-a9fe-cd0bb45e7434\",\n                    \"name\": \"44. Avancerad problemlösning\",\n                    \"shortName\": \"44\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"785e12ac-4a71-4acf-bf40-27652faf20ff\",\n                    \"name\": \"45. Vad är matematik?\",\n                    \"shortName\": \"45\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6372cdb6-91cf-4f0f-ac9c-8578c00760ff\",\n                    \"name\": \"5. Form och storlek\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815977)\\/\"\n                },\n                {\n                    \"stepId\": \"c781e529-fefa-43ce-99fb-d232585a1e1a\",\n                    \"name\": \"6. Tid och räknesätt\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815993)\\/\"\n                },\n                {\n                    \"stepId\": \"5df2975c-f84e-4620-abe9-5c47ebcb0f90\",\n                    \"name\": \"7. Bråk och decimaltal\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816007)\\/\"\n                },\n                {\n                    \"stepId\": \"9cbb966f-32df-48cf-be77-5e00d466d63a\",\n                    \"name\": \"8. Procent och bråk\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816023)\\/\"\n                },\n                {\n                    \"stepId\": \"b1b59f38-63c6-428a-a512-220b7d838e5f\",\n                    \"name\": \"9. Sannolikhet och bråk\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816040)\\/\"\n                }\n            ]\n        },\n        {\n            \"courseId\": \"cfdc5bc0-ea41-4683-b941-d980de4e82a5\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"D\",\n            \"name\": \"Spanska, språkval\",\n            \"shortName\": \"M2SP\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"16bb0ce6-60ac-4937-8e60-dd633cd7c5f0\",\n                    \"name\": \"1. Första mötet\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1476255771933)\\/\"\n                },\n                {\n                    \"stepId\": \"f3504ab6-386c-42d2-882b-668719f329b5\",\n                    \"name\": \"10. Turist\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d2de4e01-44dd-4ba7-a69f-075450c627a7\",\n                    \"name\": \"11. Skolan\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"58e4d577-05f5-4071-8745-a41571df3019\",\n                    \"name\": \"12. Fritiden\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d8a079f9-3fef-4fbc-b868-6b050e3832d1\",\n                    \"name\": \"13. Stämma träff\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d62f63a1-3806-4650-b6a9-354eccd056b9\",\n                    \"name\": \"14. Sport och musik\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"b475dc9d-e694-4eb9-8c78-b150494dfe84\",\n                    \"name\": \"15. Presentera dig själv\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"009c68f6-db7e-44a3-bc5c-d1e2e78d327c\",\n                    \"name\": \"16. När och fjärran\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"a124f250-2fb7-4b57-b2bc-b72e0e8fd21a\",\n                    \"name\": \"17. Mat och traditioner\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ec6ccef4-58b5-4111-b152-8a7a7f546bb8\",\n                    \"name\": \"18. Planera en resa\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ec96d506-112e-4b38-8946-6f19130bd741\",\n                    \"name\": \"19. Etikett och regler\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"0b52b5e6-bbc7-4c78-815c-efc30fa984af\",\n                    \"name\": \"2. Min familj\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1488368769260)\\/\"\n                },\n                {\n                    \"stepId\": \"e05c674b-1097-4646-ac47-1d8c4342a343\",\n                    \"name\": \"20. Resan\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f6f8cffb-69ae-4148-81fa-35e1f984f836\",\n                    \"name\": \"21. Boende\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"aee9167c-2f65-4f8d-a94b-684458c300bc\",\n                    \"name\": \"22. Familjeliv\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"115f28de-fe33-435e-a7fb-36fea0a37cce\",\n                    \"name\": \"23. Bostadsläge\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d5e8b9e2-b84e-4af7-8b20-e37896dec41d\",\n                    \"name\": \"24. Min stad\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c2f15857-a682-4b02-8d00-ec042858e799\",\n                    \"name\": \"25. Presentera någon annan\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1bc87327-1e3f-42f6-b839-e9b385200149\",\n                    \"name\": \"26. Media\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"36f23967-f30b-4cbc-a69c-4191094e182d\",\n                    \"name\": \"27. En tv-kväll\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"32ead07a-fa58-4770-ac20-3a31f27069cf\",\n                    \"name\": \"28. Tidningar\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"598d7b7e-97b6-4ff3-b7a7-8f5c45c164cd\",\n                    \"name\": \"29. Film\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"12e8d03b-7d80-434c-9201-7f852f5c114c\",\n                    \"name\": \"3. Fler siffror, månader och väder\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"98f0825e-e200-43f4-9f4b-866bb50d28dd\",\n                    \"name\": \"30. Tidningen\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"956757b9-979f-4d12-be01-8b30970b603e\",\n                    \"name\": \"31. Min framtid\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c2003358-0ce9-409b-82fa-e7a0bff891fc\",\n                    \"name\": \"32. Ung i framtiden\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1c1ca040-f96d-46af-862b-a978698e2745\",\n                    \"name\": \"33. Insändare\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"64f620bb-8c77-4de2-88e2-feaa21f4c41e\",\n                    \"name\": \"34. På gymnasiet\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4c3c19eb-0447-47cf-bb72-8d1176118c71\",\n                    \"name\": \"35. Framtiden\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c3779788-030e-46f3-89a7-a15015931a51\",\n                    \"name\": \"4. Det här är jag\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"a6628c06-443a-481d-96fc-c019800e8e4e\",\n                    \"name\": \"5. Boken\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f34e1dee-1dd3-4bcd-89b4-f0ba6638c65c\",\n                    \"name\": \"6. På café\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"9ffb3665-0e3a-423a-af93-c5006a2a4839\",\n                    \"name\": \"7. Att handla\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"63e62432-ba1e-4f96-911c-52bd756c803e\",\n                    \"name\": \"8. I staden\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3c93cf1d-2e82-452b-9333-16b336fdda6d\",\n                    \"name\": \"9. På hotellet\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                }\n            ]\n        },\n        {\n            \"courseId\": \"3cc7c710-63fb-49bd-8dc5-b95be6374122\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"C\",\n            \"name\": \"Svenska\",\n            \"shortName\": \"SV\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"379585a4-f602-4086-920d-d506d2e93fed\",\n                    \"name\": \"1. Min bästa sak\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179490)\\/\"\n                },\n                {\n                    \"stepId\": \"5d90747a-d5ff-4c12-818c-d301e4cf2405\",\n                    \"name\": \"10. Quizkampen\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179630)\\/\"\n                },\n                {\n                    \"stepId\": \"fb271830-5368-43dc-b911-3d65af082e26\",\n                    \"name\": \"11. Ta kontakt\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179647)\\/\"\n                },\n                {\n                    \"stepId\": \"bf7a93a6-24af-4d01-8839-aa4f3f6b438d\",\n                    \"name\": \"12. Samla fakta och presentera\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179660)\\/\"\n                },\n                {\n                    \"stepId\": \"2a712108-e5d7-4ffb-a55f-80ff195ea946\",\n                    \"name\": \"13. Påverka och uttrycka åsikter\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179943)\\/\"\n                },\n                {\n                    \"stepId\": \"94b5abaa-0471-4ab4-be3c-c0b0d4098609\",\n                    \"name\": \"14. Språk i Sverige\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1475049857367)\\/\"\n                },\n                {\n                    \"stepId\": \"e0169353-8ac0-4fcd-8a45-4cfffc5fe55e\",\n                    \"name\": \"15. Min förebild\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1480951054357)\\/\"\n                },\n                {\n                    \"stepId\": \"e12c8fa6-8aaa-4598-8e6f-5c6d318163db\",\n                    \"name\": \"16. Förstå, minnas och lära\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1490605558217)\\/\"\n                },\n                {\n                    \"stepId\": \"1a19c53b-36f0-4309-adfd-26a307b43dbd\",\n                    \"name\": \"17. Använda språket i olika sammanhang\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"31aa5b91-59d0-41db-ab2e-0bdec6342dfe\",\n                    \"name\": \"18. Sammanfatta och presentera\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"48747057-835d-40fd-811f-dde4fd48f3a0\",\n                    \"name\": \"19. Den moderna ungdomen\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4708aedf-3b7d-4ec0-80c9-769de4cdda9b\",\n                    \"name\": \"2. Författare\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179507)\\/\"\n                },\n                {\n                    \"stepId\": \"4258123d-d122-4058-8120-9de7d1fb3d66\",\n                    \"name\": \"20. Att vara ungdom idag\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3d94e56d-9d38-4d3c-a3cb-d4f2d13814c9\",\n                    \"name\": \"21. Upplysningstiden och romantiken\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5d8c3d70-e996-4236-9326-982ed128340c\",\n                    \"name\": \"22. Realismen och modernismen\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"02037ab3-ffdf-4fe2-a172-26de404c58bc\",\n                    \"name\": \"23. Våga utanför ramarna\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7c376d37-0170-49ac-865d-5479d82ce806\",\n                    \"name\": \"24. Modern litteratur\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7131b28d-89d1-40f6-8d87-80fd0c15486d\",\n                    \"name\": \"25. Budskapet\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"30c876a6-48a7-4fc7-a49f-ad44bac3d4bb\",\n                    \"name\": \"26. Övertyga och påverka\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"97b328ea-3342-41d6-a1c5-91e9c1d17a08\",\n                    \"name\": \"27. Språkbruk genom tiderna\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"e4ec472d-b31c-4d20-886c-0162e1159e55\",\n                    \"name\": \"28. Tidningstexter\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"47ccf40e-28a1-4432-91ed-f3013eb97aa8\",\n                    \"name\": \"29. Samtala om texter\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6c89c307-adff-46b8-9d75-2ecb1fc714ce\",\n                    \"name\": \"3. Leka med ord\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179520)\\/\"\n                },\n                {\n                    \"stepId\": \"2145d4aa-60db-42f9-918b-49f3bf714786\",\n                    \"name\": \"30. Språkets möjligheter\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c211ba3d-b8fa-4c5c-bbe1-bcfea2a243b5\",\n                    \"name\": \"31. Dikt och diktanalys\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"fbeb356a-5c9d-4114-9a4b-9ac2325913d0\",\n                    \"name\": \"32. Berättarteknik i skönlitteratur\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4446df13-5bb8-4cf1-beb4-4d2b43bf97b8\",\n                    \"name\": \"33. Utveckla ditt skönlitterära skrivande\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"47e0c5bf-2898-4cc3-8119-2346d4c6c78f\",\n                    \"name\": \"34. Noveller\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3b072a72-9f2c-4439-b095-33edb5ae3276\",\n                    \"name\": \"35. Det fria ordet - En skönlitterär djupdykning\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"56a2b991-63f5-4f1c-8e48-1bc1f83fa9a9\",\n                    \"name\": \"36. Debatt och retorik\",\n                    \"shortName\": \"36\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7b0e633b-65b5-407d-8bdd-d77673d1be1f\",\n                    \"name\": \"37. Argumenterande texter\",\n                    \"shortName\": \"37\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d76356c9-2fdd-4845-aa7a-1bf54547a34e\",\n                    \"name\": \"38. Analysera tal\",\n                    \"shortName\": \"38\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"eb312838-f59b-4815-987f-d7f11973a95f\",\n                    \"name\": \"39. Tal\",\n                    \"shortName\": \"39\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"48559f29-37cb-451f-8f40-354101a413af\",\n                    \"name\": \"4. Skrivarskola\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179537)\\/\"\n                },\n                {\n                    \"stepId\": \"a054f1e2-b296-4185-b9b7-dac94f600ab3\",\n                    \"name\": \"40. Muntlig argumentation\",\n                    \"shortName\": \"40\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"2e5ff9f3-ac8e-4fea-abe2-a7534e64e25f\",\n                    \"name\": \"41. Modern lyrik\",\n                    \"shortName\": \"41\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ceed4cee-dd38-40b9-af97-43b0af244a41\",\n                    \"name\": \"42. Nobelpriset i litteratur\",\n                    \"shortName\": \"42\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"2df27363-1a57-4129-96dc-5e2a26dc0209\",\n                    \"name\": \"43. Analysmetod i akademiska uppsatser\",\n                    \"shortName\": \"43\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"71062f38-2874-4d6a-96b9-8128a10e3559\",\n                    \"name\": \"44. Litteratur som väckt debatt genom tiderna\",\n                    \"shortName\": \"44\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d0e40b55-4638-45fd-b9f3-924c68c673cc\",\n                    \"name\": \"45. Analysera vetenskapligt\",\n                    \"shortName\": \"45\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5954c057-cdc2-4293-bb9e-8b96ec27e04c\",\n                    \"name\": \"5. Min bästa sak på äventyr\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179553)\\/\"\n                },\n                {\n                    \"stepId\": \"5b9e5c30-c9de-4092-b7e6-0dbb4e3513ff\",\n                    \"name\": \"6. Faktatext\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179567)\\/\"\n                },\n                {\n                    \"stepId\": \"2b823257-8dad-4f6b-8f2b-539e4dae0bd4\",\n                    \"name\": \"7. Tal- och skriftspråk\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179583)\\/\"\n                },\n                {\n                    \"stepId\": \"28e73fd2-c40a-4319-8b93-ec0f1b658c81\",\n                    \"name\": \"8. Dikter\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179600)\\/\"\n                },\n                {\n                    \"stepId\": \"35a5926a-8cb3-4c9d-a7ef-714761935755\",\n                    \"name\": \"9. Olika texttyper\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179613)\\/\"\n                }\n            ]\n        }\n    ]\n}\n","import {EDSAssessment} from '../../contracts/eds';\n\nexport const assessments: {assessments: EDSAssessment[]} =\n\n{\n    \"assessments\": [\n      {\n        \"publishDateTime\": \"2017-08-28T09:05:43.16\",\n        \"text\": \"Testbedömning Engelsa 5\",\n        \"gradeName\": \"C\",\n        \"courseUnitName\": \"1. Ready, steady, go!\"\n      },\n      {\n        \"publishDateTime\": \"2017-08-28T08:59:21.253\",\n        \"text\": \"Testbedömning...\\r\\n/ Kim test\",\n        \"gradeName\": \"C\",\n        \"courseUnitName\": \"Tema 1\"\n      },\n      {\n        \"publishDateTime\": \"2017-08-10T09:43:36.797\",\n        \"text\": \"Test\",\n        \"gradeName\": \"D\",\n        \"courseUnitName\": \"Block 1\"\n      }\n    ]\n  }","import {EDSStudyPlan} from '../../contracts/eds';\n\nexport const studyPlans: {StudyPlans: EDSStudyPlan[]} =\n\n{\n    \"StudyPlans\": [\n        {\n            \"courseUnitName\": \"Hem- och konsumentkunskap\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Historia\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Fysik\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Geografi\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Matematik\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Samhällskunskap\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Engelska\",\n            \"finalGoalGrade\": \"A\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"A\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"B\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Religionskunskap\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Idrott och hälsa\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Biologi\",\n            \"finalGoalGrade\": \"D\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Svenska\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Teknik\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Bild\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Spanska, språkval\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Kemi\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"B\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Slöjd\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"B\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Musik\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        }\n    ]\n}","import { EDSCourse, EDSAssessment, EDSStudyPlan, EDSStudentFutureAbility } from '../contracts/eds';\nimport { RestClient } from 'kedbackend/js/dist/ked-backend-client/restclient';\nimport { IsomorphicEnv, BearerProvider, HttpError } from 'kedbackend/client';\nimport { SchoolMoment } from '../utils/school-moment';\nimport { SchoolTerm } from '../utils/school-term';\nimport { dateTimeReviver, L } from '../utils/utils';\nimport { courses } from './eds-stubdata/ActiveCourses';\nimport { assessments } from './eds-stubdata/LatestAssessments';\nimport { studyPlans } from './eds-stubdata/StudentGoals';\nimport env from '../globals/KED.env';\n//Gamla: const API_URL = \"https://test-dev-eds-cs.cloudapp.net/WebAPI/\";\n//NYA: const API_URL = \"https://edsportalowinapi.azurewebsites.net/api/\";\n\nfunction privatizingCacheBust () {\n  return {user: env.currentUser.mail};\n}\nexport class EdsClient {\n  http: RestClient;\n\n  constructor (\n    isomorphic: IsomorphicEnv,\n    baseUrl: string,\n    bearerProvider: BearerProvider\n  ) {\n    this.http = new RestClient (isomorphic, baseUrl, {bearerProvider});\n    this.getActiveCourses = avoidSimultanousCalls(this.getActiveCourses);\n    this.getLatestAssessments = avoidSimultanousCalls(this.getLatestAssessments);\n    this.getStudentGoals = avoidSimultanousCalls(this.getStudentGoals);\n    this.getStudentFutureAbilities = avoidSimultanousCalls(this.getStudentFutureAbilities);\n  }\n\n/**\n   * Retrieve active courses for current logged in student.\n   *\n   * @param courseCode Short-name of the course. Optional.\n   */\n  async getActiveCourses(q: {courseCode?: string, periodName: string}) {\n    try {\n      const query:any = privatizingCacheBust();\n      if (q) {\n        if (q.courseCode) query.CourseCode = q.courseCode;\n        if (q.periodName) query.PeriodName = q.periodName;\n      }\n      const res = await this.http.get(\"studentactivecourses\", query);\n      if (res.status != 200) throw new HttpError(res.status, await res.text());\n      const json = await res.json();\n      return json.courses as EDSCourse[];\n    } catch (ex) {\n      console.error(\"Error from EDS: \" + ex);\n      throw new Error(L`Kunde tyvärr inte ladda terminsmål eller avklarade steg från EDS. Försök igen senare...`);\n    }\n  }\n\n  /**\n   * Retrieve latest assessments for current logged in user.\n   * \n   * @param limit Optional limit\n   */\n  async getLatestAssessments(limit?: number) {\n    const query:any = privatizingCacheBust();\n    if (!isNaN(limit)) query.Count = limit;\n    const res = await this.http.get(\"studentassessments\", query);\n    if (res.status != 200) throw new HttpError(res.status, await res.text());\n    const json = await res.json();\n    return json.assessments as EDSAssessment[];    \n  }\n\n  /**\n   * Retrieve studyplans for current logged-in user\n   */\n  async getStudentGoals() {\n    const res = await this.http.get(\"studentgoals\", privatizingCacheBust());\n    if (res.status != 200) throw new HttpError(res.status, await res.text());\n    const json = await res.json();\n    return json.studentGoals as EDSStudyPlan[];    \n  }\n\n  async getStudentFutureAbilities() {\n    const res = await this.http.get(\"studentFutureAbilities\", privatizingCacheBust());\n    if (res.status != 200) throw new HttpError(res.status, await res.text());\n    const json = await res.json();\n    return json.studentFutureAbilities as EDSStudentFutureAbility[];\n  }\n}\n\nexport class EDSPeriod {\n  period: string;\n  term: 'AT' | 'ST';\n  year: number;\n  constructor (periodStringOrSchoolTerm: string | SchoolMoment) {\n    if (typeof periodStringOrSchoolTerm === 'string') {\n      this.period = periodStringOrSchoolTerm;\n      this.term = this.period.startsWith('HT') ? 'AT' : 'ST';\n      this.year = parseInt(this.period.substr(2));\n      if (isNaN(this.year)) throw new Error (`Invalid period: ${this.period}`);\n    } else {\n      const schoolTerm = new SchoolTerm(periodStringOrSchoolTerm);\n      this.period = (schoolTerm.term === 'AT' ? \"HT\" : \"VT\") + schoolTerm.year;\n      this.term = schoolTerm.term;\n      this.year = schoolTerm.year;\n    }\n  }\n\n  get schoolTerm () : SchoolTerm {\n    return new SchoolTerm({\n      academicYear: this.term === 'AT' ?\n        `${this.year}/${this.year + 1}` :\n        `${this.year-1}/${this.year}`,\n      term: this.term\n    });\n  }\n\n  toString() {\n    return this.period;\n  }\n\n  valueOf() {\n    return this.year + \":\" + (this.term === 'ST' ? \"1\" : \"2\");\n  }\n}\n\nexport function parseJsonDate_old (jsonDateStr: string) : Date {\n  const date = dateTimeReviver(\"\", jsonDateStr);\n  if (!(date instanceof Date)) throw new Error(\"Invalid JSON date string: \" + jsonDateStr);\n  return date;\n}\n\nexport class StubEdsClient implements EdsClient {\n  http: RestClient;\n\n  constructor () {\n    this.http = null;\n  }\n\n  async getActiveCourses(q?: { courseCode?: string; periodName?: string; }) {\n    let result = courses.courses;\n      if (q) {\n        if (q.courseCode) result = result.filter (c => c.shortName === q.courseCode);\n        if (q.periodName) result = result.filter(c => c.periodName === q.periodName);\n      }\n      return result;\n  }\n\n  async getLatestAssessments(limit?: number) {\n    return limit ?\n        assessments.assessments.slice(0, limit) :\n        assessments.assessments;\n  }\n\n  async getStudentGoals() {\n    return studyPlans.StudyPlans;\n  }\n\n  async getStudentFutureAbilities() {\n    return [] as EDSStudentFutureAbility[];\n  }  \n}\n\nfunction avoidSimultanousCalls<T,A>(method: (...args:A[])=>Promise<T>) : (...args:A[])=>Promise<T> {\n  let ongoingPromises: {[argsJson: string]: Promise<T>} = {};\n  return function() {\n    const argsJson = JSON.stringify([].slice.call(arguments));\n    if (!ongoingPromises[argsJson]) {\n      ongoingPromises[argsJson] = method.apply(this, arguments).then(result=>{\n        delete ongoingPromises[argsJson];\n        return result;\n      });\n    }\n    return ongoingPromises[argsJson];\n  }\n}\n","/* REFACTOR: Move this component outside coursebuilder!\n   This is a general-purpose component\n*/\n\nimport * as React from 'react';\n\ninterface Props {\n  title: string | JSX.Element;\n  className?: string;\n  headerClassName?: string;\n  contentClassName?: string;\n  headerOpen?: boolean;\n  onOpenClose?: (becameOpen: boolean) => void;\n  children;\n}\n\ninterface State {\n  headerOpen: boolean;\n}\n\nexport class OpenCloseBox extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      headerOpen: props.headerOpen || false\n    };\n  }\n\n  componentWillReceiveProps (nextProps: Props) {\n    if (nextProps.headerOpen !== this.props.headerOpen) {\n      this.setState({headerOpen: nextProps.headerOpen});\n    }\n  }\n\n  render() {\n    const { title, className, children, headerClassName, contentClassName } = this.props;\n    const { headerOpen } = this.state;\n\n    return <div className={(className||'') + \" openClose\" + (headerOpen ? \" open\" : \"\")}>\n      <div className={\"openHeader\" + (headerClassName ? \" \" + headerClassName : \"\")}\n        onClick={() => {\n          if (this.props.onOpenClose) this.props.onOpenClose(!this.state.headerOpen);\n          this.setState({ headerOpen: !this.state.headerOpen });\n        }} >\n        {title}\n      </div>\n      <div className={\"openContent\" + (contentClassName ? \" \" + contentClassName : \"\")}>\n        {children}\n      </div>\n    </div>;\n  }\n}\n","import moment, { Moment } from \"moment\";\n\nexport function KEDWeek (year: number, week: number) {\n  const m = moment(new Date(year, 1, 1)).locale('sv').week(week);\n  const res = {\n    year,\n    week,\n    notBefore: m.clone().startOf('week').add(-2, 'days').toDate().getTime(),\n    notAfter: m.clone().startOf('week').add(5, 'days').toDate().getTime()\n  };\n  return res;\n}\n\nexport function getAdjustedWeek(m: Moment) {\n  const clone = m.clone().locale('sv');\n  return m.weekday() >= 5 ? // Lördag 00:00 / Söndag 00:00?\n      m.week() + 1 : // Tillhör nästa vecka\n      m.week();\n}\n\n/*export function getWeekLimits (m: Moment) {\n  const clonedSwedish = m.clone().locale('sv');\n  const limits = {\n    notBefore: clonedSwedish.startOf('week').add(-2, 'days'),\n    notAfter: clonedSwedish.startOf('week').add(5, 'days')\n  };\n}\n*/\n","import * as React from 'react';\nimport { L } from '../../utils/utils';\nimport $ from 'jquery';\n\ninterface Props {\n    text: string;\n    tag?: 'input' | 'textarea'\n    eager?: boolean;\n    onChange: (newName: string) => void;\n    placeholder?: string; // If text is empty, this will be the placeholder\n    clickAdvertiseText?: string;\n    maxChars?: number;\n    readOnly?: boolean;\n}\n\ninterface State {\n    editMode: boolean;\n    runtimeStyle: Object;\n    text: string | null;\n}\n\n/** \n * Makes a text element (such as an A or P tag) possible to replace with an input element of the same CSS style, for example by clicking on it.\n * \n*/\nexport class RenameableText extends React.Component<Props,State> {\n    label: HTMLElement;\n    input: HTMLInputElement | HTMLTextAreaElement;\n\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            editMode: false,\n            runtimeStyle: null,\n            text: props.text || \"\"\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (this.props.text !== nextProps.text) {\n            this.setState({text: nextProps.text || \"\"});\n        }\n    }\n\n    render() {\n        const text = this.state.text || \"\";\n        return <div\n                className={\"renameable-text\" + (text ? \"\" : \" unnamed\") + (this.props.readOnly ? \" disabled\" : \"\")}\n                tabIndex={!this.state.editMode && 0}\n                onFocus={(e)=>{this.rename()}}\n                style={{width: \"100%\"}}\n            >\n            <div\n                ref={label => this.label = label}                \n                style={{\n                    display: this.state.editMode ? 'none' : ''\n                }}\n            >\n                {text || this.props.clickAdvertiseText}\n            </div>\n            {this.props.tag === 'textarea' ?\n                <textarea ref={input => this.input = input}\n                    maxLength={this.props.maxChars}\n                    style={{...this.state.runtimeStyle, display: this.state.editMode ? '' : 'none'}}\n                    onFocus={ev=>$(ev.target).select()}\n                    onBlur={this.onBlur.bind(this)}\n                    value={text}\n                    onKeyDown={this.onKeyDown.bind(this)}\n                    onChange={this.onChange.bind(this)}\n                    tabIndex={this.state.editMode && 0}\n                    placeholder={this.props.placeholder}\n                /> : \n                <input ref={input => this.input = input}\n                    type=\"text\"\n                    maxLength={this.props.maxChars}\n                    style={{...this.state.runtimeStyle, display: this.state.editMode ? '' : 'none'}}\n                    onFocus={ev=>$(ev.target).select()}\n                    onBlur={this.onBlur.bind(this)}\n                    value={text}\n                    onKeyDown={this.onKeyDown.bind(this)}\n                    onChange={this.onChange.bind(this)}\n                    tabIndex={this.state.editMode ? 0 : undefined}\n                    placeholder={this.props.placeholder}\n                />\n            }\n        </div>\n    }\n\n    onKeyDown(e: KeyboardEvent) {\n        if (e.keyCode === 27) { // ESC\n            this.input.value = this.props.text || \"\";\n            this.input.blur();\n            e.stopPropagation();\n        } else if (e.keyCode === 13) { // ENTER\n            this.propagateOnChange(this.input.value);\n            this.setState({ editMode: false, text: this.input.value });\n        }\n    }\n\n    onBlur(e: Event) {\n        this.propagateOnChange(this.input.value);\n        this.setState({ editMode: false, text: this.input.value });\n    }\n\n    propagatedOnChange: string;\n\n    propagateOnChange(newValue) {\n        if (this.propagatedOnChange != newValue) {\n            this.propagatedOnChange = newValue;\n            this.props.onChange(newValue);\n        }\n    }\n\n    onChange(e: Event) {\n        this.setState({ text: this.input.value });\n        if (this.props.eager) this.propagateOnChange(this.input.value);\n    }\n\n    rename(txt?: string) {\n        if (this.state.editMode || this.props.readOnly) return;\n        txt = txt || this.state.text || \"\";\n        const label = $(this.label);\n        this.setState({\n            text: txt,\n            editMode: true,\n            runtimeStyle: {\n                textAlign: label.css('textAlign'),\n                fontSize: label.css('font-size'),\n                paddingTop: label.css('paddingTop'),\n                paddingBottom: label.css('paddingBottom'),\n                paddingLeft: label.css('paddingLeft'),\n                paddingRight: label.css('paddingRight'),\n                marginTop: label.css('marginTop'),\n                marginBottom: label.css('marginBottom'),\n                marginLeft: label.css('marginLeft'),\n                marginRight: label.css('marginRight'),\n                borderRadius: label.css('borderRadius'),\n                backgroundColor: label.css('backgroundColor'),\n                lineHeight: label.css('lineHeight'),\n                fontWeight: label.css('fontWeight'),\n                outLine: 0,\n                borderStyle: 'none',\n                height: \"100%\",\n                width: \"100%\",\n                boxSizing: \"border-box\",\n            }\n        }, ()=>$(this.input).focus());\n    }\n}\n","import { KedRepo } from './ked-repo';\nimport { UserHiddenCourse, School, Course } from 'kedbackend/models';\nimport env from '../globals/KED.env';\nimport { EDSCourse } from '../contracts/eds';\nimport { showError, flatten, compareProp, arrayToMap } from '../utils/utils';\nimport { createUUID } from 'kedbackend/client';\nimport { EDSPeriod } from '../apis/edsclient';\nimport { getSchoolMoment } from '../utils/school-moment';\nimport moment from 'moment';\nexport let hiddenCoursesRepo = env.hiddenCoursesRepo as HiddenCoursesRepo;\n\n\nexport interface CourseWithHiddenState {\n  id: string;\n  name: string;\n  description?: string;\n  visible: boolean;\n  defaultVisible: boolean;\n}\n\nexport type HiddenCoursesSubscriber = (courses: CourseWithHiddenState[]) => void;\n\nexport interface SubscriberOptions {\n  fullCourse: boolean;\n}\n\nclass HiddenCoursesRepo {\n  result: CourseWithHiddenState[] | null = null;\n  subscribers: {subscriber: HiddenCoursesSubscriber, options: SubscriberOptions}[] = [];\n  fullCourse: boolean = false;\n  kedCoursesPromise: Promise<Partial<Course>[]>;\n  edsCoursesPromise: Promise<EDSCourse[]>;\n  userHiddenCoursesPromise: Promise<UserHiddenCourse[]>;\n  kedRepo: KedRepo<UserHiddenCourse>;\n\n  constructor() {\n    this.kedRepo = new KedRepo<UserHiddenCourse>({\n      getClient: () => env.kedBackendClient,\n      optimistic: true,\n      table: \"userhiddencourses\",\n      user: env.currentUser ? env.currentUser.mail : \"\",\n      getQueryOptions: async () => ({role: \"USER\"}),\n    });\n\n    const initPromise = this.init();\n\n    Promise.all([\n      initPromise,\n      this.kedCoursesPromise,\n      this.edsCoursesPromise\n    ]).catch(err => showError(err));\n  }\n\n  async init() {\n    // Wait till we have a currentUser that is accurate also for impersonated users.\n    const bearerPromise = env.bearerProvider ? env.bearerProvider.getBearer() : Promise.resolve({});\n\n    // In parallell, we request:\n    //  1) KEDBackend: Schools.activeCourses\n    //  2) EDS.getActiveAcourses()\n    //  3) (via subscription): KEDBackend: userHiddenCourses\n\n    this.kedCoursesPromise = bearerPromise.then(()=>this.listKedCourses());\n    this.edsCoursesPromise = bearerPromise.then(()=>this.listEDSCourses());\n    let resolveUserHiddenCoursesPromise: (x: UserHiddenCourse[])=>void;\n    let userHiddenCoursesResolved = false;\n    this.userHiddenCoursesPromise = new Promise(resolve => resolveUserHiddenCoursesPromise = x => {\n      if (userHiddenCoursesResolved) {\n        this.userHiddenCoursesPromise = Promise.resolve(x);\n      } else {\n        userHiddenCoursesResolved = true;\n        resolve(x);\n      }\n    });\n    await bearerPromise;\n\n    this.kedRepo.mem.subscribe(async userHiddenCourses => {\n      // Change or initial value ready to be notified out.\n      // But first, check we have all the related data responses we need.\n      const [activeCourses, edsActiveCourses] = await Promise.all([\n        this.kedCoursesPromise, \n        this.edsCoursesPromise]);\n      \n      // Refine the three results into a single result\n      this.result = await this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses);\n      // Notify our subscribers:\n      this.subscribers.forEach(subscriber => this.notifySubscriber(subscriber.subscriber, subscriber.options));\n      resolveUserHiddenCoursesPromise(userHiddenCourses);\n    });\n  }\n\n  async listKedCourses() {\n    const fullCourse = this.fullCourse;\n    console.log(\"FullCourse: \"+ fullCourse);\n    const schools = await env.kedBackendClient.list<School>('schools', {\n      role: \"USER\", // Workaround from showing activated templates among courses of the school\n      name: env.currentUser.school,\n      include: \"activeCourses\",\n      flags: fullCourse ? [] : [\"includeIdsAndNamesOnly\"],\n      cacheBust: env.currentUser.username\n    });\n    const activeCourses = flatten(schools.map(school => school.activeCourses)).sort(compareProp(\"name\"))\n    return activeCourses;\n  }\n\n  listEDSCourses(): Promise<EDSCourse[] | null> {\n    const periodName = new EDSPeriod(getSchoolMoment(moment())).period;\n    return env.currentUser.roles.indexOf('EMPLOYEE') === -1 ?\n      // STUDENTs should, by default, only show courses that is listed in EDS\n      env.edsClient.getActiveCourses({periodName}) :\n      // EMPLOYEEs should, by default, show all courses on school - no need to query EDS\n      null;\n  }\n\n  async createCoursesList(\n    edsActiveCourses: EDSCourse[] | null,\n    userHiddenCourses: UserHiddenCourse[],\n    activeCourses: Partial<Course>[]) : Promise<CourseWithHiddenState[]>\n  {\n    const hiddenCoursesMap = arrayToMap(userHiddenCourses.filter(hc => !hc.show), hc => hc.name);\n    const visibleCoursesMap = arrayToMap(userHiddenCourses.filter(hc => hc.show), hc => hc.name);\n\n    const isStudent = env.currentUser.roles.some(role => role === 'STUDENT');\n\n    const edsCourseMap = edsActiveCourses ?\n      arrayToMap(edsActiveCourses, c => c.name.substr(0, 20)) :\n      {};\n\n    const result = await Promise.all(activeCourses.map(async ({id, name, description, modifiedBy}) => {\n\n      const edsCourse = edsCourseMap[name.substr(0, 20)];\n\n      const defaultVisible = isStudent ?\n        edsCourse != null : // Course name also listed in EDS\n        true; // Teachers not dependent on EDS listing\n\n      const visible = defaultVisible ?\n        !hiddenCoursesMap[id] : // Visible unless user has overridden that.\n        !!visibleCoursesMap[id]; // Hidden unless user has overridden that.\n      \n      if (!this.fullCourse && name.length >= 20) {\n        // name could be truncated. Resolve the full name.\n        if (edsCourse) {\n          // Resolve full course name from EDS.\n          name = edsCourse.name;\n        } else if (visible) {\n          // No EDS to fallback to. Unless we wanna print course name as \"THE Partial name\" + \"...\",\n          // we must query the full course here from kedbackend:\n          const fullCourse = await env.kedBackendClient.get(\"courses\", id);\n          name = fullCourse.name;\n        }\n      }\n\n      // Resolve description:\n      if (modifiedBy && modifiedBy.name && !description) {\n        description = `${modifiedBy.name}s version`;\n      }\n\n      return {\n        id,\n        name,\n        description,\n        visible,\n        defaultVisible\n      };\n    }));\n\n    return result;\n  }\n\n  async hideCourse(c: CourseWithHiddenState) {\n    const overrides = this.kedRepo.mem.items.filter(hc => hc.name === c.id);\n    if (c.defaultVisible) {\n      await this.kedRepo.insert([{\n        id: createUUID(),\n        name: c.id\n      }]);\n    } else {\n      await this.kedRepo.delete(overrides.map(ov => ov.id));      \n    }\n  }\n\n  async showCourse(c: CourseWithHiddenState) {\n    const overrides = this.kedRepo.mem.items.filter(hc => hc.name === c.id);\n    if (c.defaultVisible) {\n      await this.kedRepo.delete(overrides.map(ov => ov.id));\n    } else {\n      await this.kedRepo.insert([{\n        id: createUUID(),\n        name: c.id,\n        show: true\n      }]);\n    }\n  }\n\n  notifySubscriber = (subscriber: HiddenCoursesSubscriber, options: SubscriberOptions) => {\n    try {\n      subscriber(options.fullCourse ? this.result : this.result.filter(c => c.visible));\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  async subscribe (subscriber: HiddenCoursesSubscriber, options: SubscriberOptions) {\n    if (!this.fullCourse && options.fullCourse) {\n      // The subscriber demands full courses\n      // Need to query that before notifying\n      // Also affect state for future internal notification\n      this.fullCourse = options.fullCourse;\n      this.kedCoursesPromise = this.listKedCourses(); // Redo this call, now loading full courses\n      // Wait for all outstanding fetch() calls to complete:\n      const [activeCourses, edsActiveCourses, userHiddenCourses] = await Promise.all([\n        this.kedCoursesPromise, \n        this.edsCoursesPromise,\n        this.userHiddenCoursesPromise]);\n      // Assemble result:\n      this.result = await this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses);\n    }\n    await this.userHiddenCoursesPromise; // So we know that this.result is there.\n    this.notifySubscriber(subscriber, options);\n    this.subscribers.push({subscriber, options});\n  }\n\n  unsubscribe (subscriber: HiddenCoursesSubscriber) {\n    this.subscribers = this.subscribers.filter(s => s.subscriber !== subscriber);\n  }\n}\n\nif (!hiddenCoursesRepo) {\n  hiddenCoursesRepo = env.hiddenCoursesRepo = new HiddenCoursesRepo();\n}\n","import { Repo, RepoCommunicator} from './repo';\nimport { KedBackendClient, ListOptions, BatchRunner, createUUID } from 'kedbackend/client';\nimport { Document} from 'kedbackend/models';\n\nexport interface KedRepoOptions<T extends Document> {\n  getClient: ()=>KedBackendClient;\n  getQueryOptions: ()=>Promise<ListOptions>;\n  optimistic: boolean;\n  table: string;\n  user: string;\n}\n\nexport class KedRepo<T extends Document> {\n  mem: Repo<T>;\n  options: KedRepoOptions<T>;\n  \n  constructor(options: KedRepoOptions<T>) {\n    const {table, getClient, getQueryOptions} = options;\n    this.mem = new Repo<T>({query: async ()=>{\n      const queryOptions = await getQueryOptions();\n      return await getClient().list<T>(table, {\n        ...queryOptions,\n        cacheBust: this.getCacheBust()});\n    }});\n    this.options = options;\n  }\n\n  private getCacheBust() {\n    const {table, user} = this.options;\n    const cacheBust = localStorage.getItem('cache-bust-' + table + '-' + user);\n    return cacheBust || this.regenerateCacheBust();\n  }\n\n  private regenerateCacheBust() {\n    const {table, user} = this.options;\n    const cacheBust = createUUID();\n    localStorage.setItem('cache-bust-' + table + '-' + user, cacheBust);\n    return cacheBust;\n  }\n\n  async upsert(item: T, updater: (item: T) => void) {\n    if (!item.$etag) {\n      // Items without $etag cannot be retrieved from server, so it should be inserted.\n      const updatedItem = Object.assign({}, item);\n      updater(updatedItem);\n      return await this.insert([updatedItem]);\n    } else {\n      // We have an $etag, so we can expect it to live on the server.\n      // However, take care of the unlikely situation that it was deleted from server,\n      // and if so, insert it again.\n      await this.update([item], updater).catch(e => {\n        if (e.name === \"http404\" || e.name === \"http403\") {\n          const updatedItem = Object.assign({}, item);\n          updater(updatedItem);\n          return this.insert([updatedItem]);\n        }\n        return Promise.reject(e);\n      });\n    }\n  }\n\n  async update(items: T[], updater: (item: T) => void) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    const modifiedItems: T[] = items.map(item => {\n      const memRepoItem = this.mem.items.find(it => it.id === item.id);\n      item = Object.assign({}, memRepoItem || item);\n      updater(item);\n      return item;\n    });\n    if (optimistic) await this.mem.update(modifiedItems.map(x => Object.assign({}, x, {$meta: 'updating'})));\n    const res = await client.do (br => modifiedItems.forEach(item => br.put(table, item)))\n    .catch(e => e.name === \"http409\" ? // conflict\n      // Get a fresh version from server:\n      client.list<T>(table, {ids: items.map(item => item.id)}, {cache: 'no-cache'}).then(freshItems => {\n        // Update local version:\n        const modifiedItems = freshItems.map(freshItem => {\n          // Clone the fresh item\n          const modified = Object.assign({}, freshItem);\n          // Re-run the updater on the clone:\n          updater(modified);\n          return modified;\n        });\n        // Re-do the the put operation towards the server.\n        return client.do(br => modifiedItems.forEach(item => br.put(table, item)));\n      }) :\n      // Other unexpected error:\n      Promise.resolve(optimistic &&\n        this.mem.update(items)) // Undo optimistic update\n      .then(()=>{\n        return Promise.reject(e); // Reject with the error no matter.\n      }));\n    this.regenerateCacheBust();\n    modifiedItems.forEach(item => {\n      item.$etag = res.newEtags[item.id];\n      item.$meta = undefined;\n    });\n    await this.mem.update(modifiedItems); // Ensures new etag is is applied on next action.\n  }\n\n  stripGraphs (items: T[], graphs: string[]) {\n    return items.map(item => {\n      const clone = Object.assign({}, item);\n      graphs.forEach(graph => {\n        if (item[graph]) {\n          clone[graph] = (item[graph] as {id:string}[]).map (doc => ({id: doc.id}));\n        }\n      });\n      return clone;\n    });\n  }\n\n  async insert(items: T[]) {\n    const {getClient, optimistic, table, getQueryOptions} = this.options;\n    const client = getClient();\n    const queryOptions = await getQueryOptions();\n    const graphs = [].concat(queryOptions.include);\n    // Give IDs to each item:\n    items = items.map(item => item.id ? item : Object.assign({}, item, {id: createUUID()}));\n    const stripped = this.stripGraphs(items, graphs);\n    if (optimistic) await this.mem.insert(stripped.map(x => Object.assign({}, x, {$meta: 'adding'})));\n    const br = new BatchRunner();\n    for (const item of stripped) {\n      // Also add links to all foreign related items:\n      for (const graph of graphs) {\n        const foreignItems: Document[] = item[graph];\n        if (foreignItems) {\n          foreignItems.forEach(doc => {\n            br.link2(table, item.id, graph, doc.id);\n          });\n        }\n      }\n      br.add(table, item);\n    }\n    const res = await client.batch(br.mutationRequests).catch(e => {\n      if (optimistic) this.mem.delete(items.map(item => item.id));\n      return Promise.reject(e);\n    })\n    this.regenerateCacheBust();\n    items.forEach(item => item.$etag = res.newEtags[item.id]);\n    if (optimistic)\n      await this.mem.update(items); // Update with new $etag.\n    else\n      await this.mem.insert(items);\n  }\n\n  async delete (ids: string[]) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    if (optimistic) await this.mem.update(ids\n      .map(id => this.mem.items.find(x => x.id === id))\n      .filter(x => x)\n      .map(x => Object.assign({}, x, {$meta: 'deleting'})));\n    const res = await client.do (br => ids.forEach(id => br.delete(table, id))).catch(async e => {\n      if (optimistic) {\n        await this.mem.update(ids\n          .map(id => this.mem.items.find(x => x.id === id))\n          .filter(x => x)\n          .map(x => {\n            x = Object.assign({}, x);\n            delete x.$meta;\n            return x;\n          }));\n      }\n      throw e;\n    });\n    this.regenerateCacheBust();\n    await this.mem.delete(ids);\n  }\n}\n","import moment from 'moment';\nimport { SchoolMoment, getSchoolMoment, addYear } from './school-moment';\nimport { AcademicYear, Term } from '../contracts/ked-models';\n\ntype Moment = moment.Moment;\n\nfunction isSchoolMoment(obj: Date | SchoolMoment): obj is SchoolMoment {\n  return 'academicYear' in obj;\n}\n\nexport class SchoolTerm {\n  academicYear: AcademicYear;\n  term: Term;\n\n  constructor(dateOrSchoolMoment: Date | SchoolMoment) {\n    const schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?\n      dateOrSchoolMoment : getSchoolMoment(moment(dateOrSchoolMoment));\n    this.academicYear = schoolMoment.academicYear;\n    this.term = schoolMoment.term;\n  }\n\n  get year() {\n    return parseInt(this.academicYear\n        .split('/')[this.term === 'AT' ? 0 : 1]);\n  }\n\n  nextTerm() {\n    return new SchoolTerm(this.term === 'AT' ?\n      {\n        term: 'ST',\n        academicYear: this.academicYear\n      } :\n      {\n        term: 'AT',\n        academicYear: addYear(this.academicYear, 1)\n      });\n  }\n\n  prevTerm() {\n    return new SchoolTerm(this.term === 'AT' ?\n      {\n        term: 'ST',\n        academicYear: addYear(this.academicYear, -1)\n      } :\n      {\n        term: 'AT',\n        academicYear: this.academicYear\n      });\n    \n  }\n\n  toLocaleString(locales: string[], shortYear?: boolean) {\n    let year = this.term === 'AT' ?\n      this.academicYear.split('/')[0]:\n      this.academicYear.split('/')[1];\n\n    if (shortYear)\n      year = year.substr(2);\n\n    for (let locale of locales) {\n      switch (locale.split('-')[0].split('_')[0].toLowerCase()) {\n        case 'en':\n          return `${this.term === 'AT' ? \"AT\" : \"ST\"} ${year}`;\n        case 'sv':\n          return `${this.term === 'AT' ? \"HT\" : \"VT\"} ${year}`;\n      }\n    }\n  }\n}\n","import * as React from 'react';\nimport { L } from \"../../../utils/utils\";\n\ninterface Props {\n  onClick,\n  className?,\n  style?,\n  title?\n};\n\nexport const RemoveItem = ({ onClick, className, style, title }: Props) =>\n\n  <div\n    title={title || L`Radera`}\n    className={\"removeItem \" + (className || \"\")}\n    onClick={onClick} style={style} />\n","import moment from 'moment';\n\nmoment.updateLocale('sv', {\n    months : 'januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december'.split('_'),\n    monthsShort : 'jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec'.split('_'),\n    weekdays : 'söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag'.split('_'),\n    weekdaysShort : 'sön_mån_tis_ons_tor_fre_lör'.split('_'),\n    weekdaysMin : 'sö_må_ti_on_to_fr_lö'.split('_'),\n    longDateFormat : {\n        LT : 'HH:mm',\n        LTS : 'HH:mm:ss',\n        L : 'YYYY-MM-DD',\n        LL : 'D MMMM YYYY',\n        LLL : 'D MMMM YYYY [kl.] HH:mm',\n        LLLL : 'dddd D MMMM YYYY [kl.] HH:mm',\n        lll : 'D MMM YYYY HH:mm',\n        llll : 'ddd D MMM YYYY HH:mm'\n    },\n    calendar : {\n        sameDay: '[Idag] LT',\n        nextDay: '[Imorgon] LT',\n        lastDay: '[Igår] LT',\n        nextWeek: '[På] dddd LT',\n        lastWeek: '[I] dddd[s] LT',\n        sameElse: 'L'\n    },\n    relativeTime : {\n        future : 'om %s',\n        past : 'för %s sedan',\n        s : 'några sekunder',\n        ss : '%d sekunder',\n        m : 'en minut',\n        mm : '%d minuter',\n        h : 'en timme',\n        hh : '%d timmar',\n        d : 'en dag',\n        dd : '%d dagar',\n        M : 'en månad',\n        MM : '%d månader',\n        y : 'ett år',\n        yy : '%d år'\n    },\n    dayOfMonthOrdinalParse: /\\d{1,2}(e|a)/,\n    ordinal : function (number) {\n        var b = number % 10,\n            output = (~~(number % 100 / 10) === 1) ? 'e' :\n            (b === 1) ? 'a' :\n            (b === 2) ? 'a' :\n            (b === 3) ? 'e' : 'e';\n        return number + output;\n    },\n    week : {\n        dow : 1, // Monday is the first day of the week.\n        doy : 4  // The week that contains Jan 4th is the first week of the year.\n    }\n});\n\nexport const localMoment = function () {\n    return moment.apply(this, arguments).locale('sv');\n}\n","import * as React from 'react';\n\ninterface Props {\n  visible: boolean;\n  text: string;\n  className?: string;\n  onConfirm: ()=>void;\n  onCancel: ()=>void;\n}\n\nexport function Confirmation (props: Props) {\n  return <div\n    className={`confirmation-box ${props.className}${props.visible ? \" visible\" : \"\"}`}>\n    <p>{props.text}</p>\n    <button onClick={()=>props.onConfirm()}>OK</button>\n    <button onClick={()=>props.onCancel()}>Avbryt</button>\n  </div>;\n}\n","import * as React from 'react';\nimport { Course, CourseModule, Task, UserTask } from 'kedbackend/models';\nimport env from '../../../globals/KED.env';\nimport { WeekPlannerPersistedState } from \"../../weekplanner/weekplanner-persisted-state\";\nimport moment from 'moment';\nimport { createUUID, BatchRunner, DocumentAccess } from 'kedbackend/client';\nimport { userTasksRepo } from '../../../repos/user-tasks-repo';\nimport { arrayToMap, L } from '../../../utils/utils';\nimport { Spinner } from '../../course-builder/sub-components/spinner';\nimport { Confirmation } from './confirmation';\n\ninterface Props {\n  learningTasks: LearningModuleTask[]\n}\n\ninterface State {\n  weekDate: number;\n  userTasks: UserTask[];\n  confirmations: string[];\n}\n\nexport interface LearningModuleTask {\n  id: string;\n  name: string;\n  url: string;\n  /** courseName\n   * For KG: courseName\n   * For KS: Subject name\n   */\n  courseName: string;\n  /** learningGoal\n   * For KG: module name or learning goal of the task\n   * For KS/step-course: course name\n   * For KS/theme-course: learning goal\n   */\n  learningGoal: string;\n  /** Step\n   * Only present in KS/step-course\n   */\n  step?: number;\n  /** task\n   * Only for courses built by coursebuilder\n   */\n  task?: Task;\n  /** course\n   * Only for courses built by coursebuilder\n   */\n  course?: Course;\n}\n\nexport class TaskList extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      userTasks: [],\n      weekDate: Date.now(),\n      confirmations: []\n    }\n    this.onChange = this.onChange.bind(this);    \n  }\n\n  onChange (userTasks: UserTask[], persisted: WeekPlannerPersistedState) {\n    if (persisted.weekDate !== this.state.weekDate) {\n      this.setState({\n        confirmations: []\n      })\n    }\n    this.setState({\n      userTasks,\n      weekDate: persisted.weekDate\n    });\n  }\n\n  componentDidMount() {\n    userTasksRepo.subscribe(this.onChange);\n  }\n\n  componentWillUnmount() {\n    userTasksRepo.unsubscribe(this.onChange);\n  }\n\n  async toggleTask (learningTask: LearningModuleTask) {\n    const userTasks = this.state.userTasks.filter(ut => {\n      return learningTask.task ?\n        ut.task && ut.task.some(t => t.id === learningTask.id) :\n        ut.siteVisionPageId === learningTask.id;\n    });\n    const {weekDate} = this.state;\n    \n    if (userTasks.length === 0) {\n      // No task matches this learningModuleTask - not present in weekplanner.\n      let latestTimeStamp = Math.max.apply(\n        Math.max,\n        [weekDate].concat(this.state.userTasks.map(t => t.dateTime)));\n\n      const userTask: UserTask = {\n        id: createUUID(),\n        courseName: learningTask.courseName,\n        dateTime: latestTimeStamp + 2000,\n        learningGoal: learningTask.learningGoal,\n        name: learningTask.name,\n        url: learningTask.url,\n        acl: [\n          // Default ACL: Let user self have full control over this item:\n          new DocumentAccess(\"email\", env.currentUser.mail, \"S\"),\n          // Additional ACL: Let employees on same school have read access to it.\n          // This currently only applies to tasks that refer to course tasks (not custom tasks!)\n          new DocumentAccess(\"schoolRole\", `${env.currentUser.school}/EMPLOYEE`, \"R\")\n        ].map(ac => ac.toString())\n      };\n      if (learningTask.task && learningTask.task.deadline) {\n        userTask.deadline = learningTask.task.deadline;\n      }\n      if (learningTask.task && learningTask.course) {\n        userTask.task = [learningTask.task];\n        userTask.course = [learningTask.course];\n      } else {\n        userTask.siteVisionPageId = learningTask.id;\n      }\n      if (learningTask.step) {\n        userTask.step = learningTask.step;\n      }\n      await Promise.all([\n        userTasksRepo.setWeekPlannerBoxOpen(learningTask.courseName, true),\n        userTasksRepo.insert([userTask])]);\n    } else {\n      // Already present in weekplanner. It's time to delete those that matched us.\n      await userTasksRepo.delete(userTasks.map(t => t.id));\n    }\n    \n  }\n\n  render() {\n    const {learningTasks} = this.props;\n    const userTasks = arrayToMap(this.state.userTasks, ut => ut.task && ut.task.length > 0 ?\n      ut.task.map(t => t.id)[0] : // course-builder tasks looked up by id\n      ut.siteVisionPageId ? ut.siteVisionPageId : // non-course-builder tasks\n      ut.url);\n    const {confirmations} = this.state;\n    const weekPlannerWeek = moment(this.state.weekDate).week();\n    const currentWeek = moment().week();\n    const forWeekString = weekPlannerWeek === currentWeek ? \"\" :\n    weekPlannerWeek === currentWeek + 1 ? L`för nästa vecka (v${weekPlannerWeek})` :\n    weekPlannerWeek === currentWeek - 1 ? L`för förra veckan (v${weekPlannerWeek})` :\n    L`för vecka ${weekPlannerWeek}`;\n\n    return <div className=\"taskContainer\">\n      {learningTasks.map((learningTask, idx) => {\n        const taskLookupId = learningTask.id;\n        const userTask = userTasks[taskLookupId] || {$meta: 'deleted'} as Partial<UserTask>; // No exist = $meta: 'deleted'\n        const isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting';\n        const selected = userTask.$meta !== 'deleted' && userTask.$meta !== 'deleting';\n        const describedAction = selected ?\n                  L`Ta bort uppgiften från egen veckoplanering ${forWeekString}` :\n                  L`Lägg till uppgiften i egen veckoplanering ${forWeekString}`;\n        const confirmationVisible =\n          confirmations.some(tid => taskLookupId === tid);\n\n        return <div key={learningTask.id}><div key={taskLookupId} className=\"align-horizontal\">\n          <div className=\"horizontalItem top\">\n              <div\n                className={`selectedBox${selected ? ' selected' : ''}`}\n                style={isWorking ? {opacity: 0.5}: {}}\n                onClick={()=>!isWorking && weekPlannerWeek === currentWeek ?\n                  this.toggleTask(learningTask) :\n                  confirmationVisible ? \n                    this.setState({confirmations: confirmations.filter(tid => tid !== taskLookupId)}) :\n                    this.setState({confirmations: [...confirmations].concat(taskLookupId)})}\n                title={describedAction}>\n              </div>\n          </div>\n          <div className=\"horizontalItem top\">\n            <a href={learningTask.url}>{learningTask.name}</a>\n          </div>\n        </div>\n        <Confirmation\n            visible={confirmationVisible}\n            text={describedAction}\n            onConfirm={()=>{\n              this.toggleTask(learningTask);\n              this.setState({confirmations: confirmations.filter(tid => tid !== taskLookupId)});\n            }}\n            onCancel={()=>{\n              this.setState({confirmations: confirmations.filter(tid => tid !== taskLookupId)});\n            }} />\n        </div>\n        }\n      )}\n    </div>\n  }\n}\n","import { User } from '../contracts/ked-models';\nimport { parseQueryString } from '../utils/query-string';\nimport env from '../globals/KED.env';\n\nexport class Features {\n  EditUserTasksViaPenOnly?: boolean;\n  SubTasks?: boolean;\n  AssignmentTasks?: boolean;\n\n  constructor () {\n    const user = env.currentUser!;\n    const query = parseQueryString(location.search, {toLower: true});\n    const features = ((query.features||'').split(',') as string[])\n      .map(feature => feature.toLowerCase()); // Can be used on forwards...\n\n    this.EditUserTasksViaPenOnly =\n      user.schoolType !== 'Grundskolor' && query.schooltype !== \"Grundskolor\";\n    this.SubTasks =\n      user.schoolType !== 'Grundskolor' && query.schooltype !== \"Grundskolor\";\n    this.AssignmentTasks = !!query.testversion;\n  }\n}\n","\n\nexport interface RepoCommunicator<T extends {id: string}> {\n  query(): Promise<T[]>;\n}\n\ntype Subscriber<T> = (items:T[]) => any;\n\nexport class Repo<T extends {id: string}> {\n  listPromise: Promise<void>;\n  items: T[];\n  subscribers: Subscriber<T>[];\n\n  constructor(public comm: RepoCommunicator<T>) {\n    this.listPromise = null;\n    this.items = null;\n    this.subscribers = [];\n  }\n\n  subscribe(subscriber: Subscriber<T>) {\n    return this.ensureHasData().then(()=>{\n      subscriber(this.items);\n      this.subscribers.push(subscriber);\n    });\n  }\n\n  unsubscribe(subscriber: Subscriber<T>) {\n    this.subscribers = this.subscribers.filter (s => s !== subscriber);\n  }\n\n  notifySubscribers() {\n    this.subscribers.forEach(s => s(this.items));\n  }\n\n  ensureHasData() {\n    if (!this.listPromise) this.refreshFromServer();\n    return this.listPromise;\n  }\n\n  refreshFromServer() {\n    this.listPromise = this.comm.query().then(items => {\n      this.items = items;\n      this.notifySubscribers();\n    });\n    return this.listPromise;\n  }\n  \n  async update(item: T | T[]) {\n    await this.ensureHasData();\n    const items = Array.isArray(item) ? item : [item];\n    this.items = this.items.map(it => {\n      const item = items.find(({id}) => it.id === id);\n      return item ?\n        Object.assign({}, item) :\n        it;\n    });\n    this.notifySubscribers();\n  }\n\n  insert(item: T | T[]) {\n    return this.ensureHasData().then(()=>{\n      this.items = this.items.concat(item);\n      this.notifySubscribers();\n    });\n  }\n\n  delete(id: string | string[]) {\n    const ids = Array.isArray(id) ? id : [id];\n    return this.ensureHasData().then(()=>{\n      this.items = this.items.filter(it => !ids.some(id => it.id === id));\n      this.notifySubscribers();\n    });\n  }\n}\n","import * as React from 'react';\nimport { RemoveItem } from '../course-builder/sub-components/remove-item';\nimport { findDOMNode } from 'react-dom';\nimport $ from 'jquery';\n\ninterface Props {\n  dialogs: React.Component[];\n  popDialog: ()=>void;\n}\n\nexport class Dialogs extends React.Component<Props> {\n  lastDiv: HTMLDivElement | null;\n\n  constructor(props: Props) {\n    super(props);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.lastDiv !== null && prevProps.dialogs.length > this.props.dialogs.length) {\n      // A dialog was closed. Now focus the last dialog:\n      $(findDOMNode(this.lastDiv)).find(':input').first().focus();\n    }\n  }\n\n  render () {\n    this.lastDiv = null;\n    const {dialogs, popDialog} = this.props;\n    $('body').attr('aria-disabled', dialogs.length > 0);\n    $('body').css('overflow', dialogs.length > 0 ? 'hidden' : 'auto');\n\n    return dialogs.length > 0 && <div>\n      {dialogs.map((dialog, idx) => {\n        let div: HTMLDivElement;\n        function onKeyPress(ev: React.KeyboardEvent<HTMLDivElement>) {\n          if (ev.which === 13 && (!ev.target || (ev.target as HTMLElement).tagName !== 'TEXTAREA')) {\n            $(findDOMNode(div)).find('.btn-default').click();\n          }\n          ev.stopPropagation();\n        }\n        function onKeyDown(ev) {\n          if (ev.which === 27) { // Escape\n            popDialog();\n            ev.stopPropagation();\n            return;\n          }\n          if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S\n            const domNode = findDOMNode(div);\n            ev.preventDefault();\n            const defaultButton = $(domNode).find('.btn-default');\n            defaultButton.click();\n            ev.stopPropagation();\n          }\n        }\n        return <div key={idx}>\n      <div className=\"darken\" />\n      <div className=\"modal-page-wrap\">\n        <div className=\"modal-page\" ref={elem => {\n          div = elem;\n          if (idx === dialogs.length - 1) this.lastDiv = elem;\n        }}\n            tabIndex={0}\n            aria-disabled={idx < dialogs.length - 1}\n            onKeyPress={onKeyPress}\n            onKeyDown={onKeyDown}>\n          {dialog}\n          <RemoveItem onClick={popDialog} />\n          <div className=\"stopFloats\"></div>\n        </div>\n      </div>\n    </div>})}\n  </div>;\n  }\n}\n","export function courseNameToCssClass(cssPrefix: string, courseName: string) {\n  return `${cssPrefix}${courseName.substr(0,3).toLowerCase()}`;\n}\n","import {User} from '../../contracts/ked-models';\n\nexport const users : User[] = [{\n    displayName: \"Administratör\",\n    mail: \"vemendo@kedschools.com\",\n    roles: ['ADMIN','EMPLOYEE'],\n    school: 'KED',\n    username: \"admin\"\n},{\n    displayName: \"David\",\n    mail: \"david.fahlander@vemendo.se\",\n    roles: ['ADMIN','EMPLOYEE'],\n    school: 'KED',\n    username: \"david\"\n},{\n    displayName: \"Test-Live-Elev1\",\n    mail: \"ubw6757@edu.kunskapsgymnasiet.se\",\n    roles: ['STUDENT'],\n    school: 'Uppsala',\n    username: \"ubw6757@edu.kunskapsgymnasiet.se\"\n},{\n    displayName: \"Test-Live-Elev2\",\n    mail: \"ums4302@edu.kunskapsgymnasiet.se\",\n    roles: ['STUDENT'],\n    school: 'Uppsala',\n    username: \"ums4302@edu.kunskapsgymnasiet.se\"\n},{\n    displayName: \"Test-Live-Elev3\",\n    mail: \"uhh3460@edu.kunskapsgymnasiet.se\",\n    roles: ['STUDENT'],\n    school: 'Uppsala',\n    username: \"uhh3460@edu.kunskapsgymnasiet.se\"\n},{\n    displayName: \"Test-Live-Elev4(fel goals issue)\",\n    mail: \"umt6826@edu.kunskapsskolan.se\",\n    roles: [\"STUDENT\"],\n    school: \"Uppsala\",\n    username: \"umt6826@edu.kunskapsskolan.se\"\n},{\n    displayName: \"Test-Live-Elev5(future abilities)\",\n    mail: \"ujg3833@edu.kunskapsskolan.se\",\n    roles: [\"STUDENT\"],\n    school: \"Uppsala\",\n    username: \"ujg3833@edu.kunskapsskolan.se\"\n},{\n    displayName: \"Test-Live-Elev6(future abilities)\",\n    mail: \"ujt1363@edu.kunskapsskolan.se\",\n    roles: [\"STUDENT\"],\n    school: \"Uppsala\",\n    username: \"ujt1363@edu.kunskapsskolan.se\"\n},{\n    displayName: \"Test-Live-Lärare1\",\n    mail: \"rickard.albertsson@kunskapsgymnasiet.se\",\n    roles: ['EMPLOYEE'],\n    school: 'Uppsala',\n    username: \"rickard.albertsson@kunskapsgymnasiet.se\"\n},{\n    displayName: \"EDSTestUserGymnasium\",\n    mail: \"uhh3200@edu.kunskapsgymnasiet.se\",\n    //mail: \"UHH3200@EDU.KUNSKAPSGYMNASIET.SE\",\n    roles: [\"STUDENT\"],\n    username: \"EDSTestUser1\",\n    school: \"KED\",\n    schoolType: \"Gymnasium\"\n},{\n    displayName: \"vemendo.elev@kedschools.com\",\n    mail: \"vemendo.elev@kedschools.com\",\n    roles: [\"STUDENT\"],\n    username: \"vemendo.elev@kedschools.com\",\n    school: \"KED\",\n    schoolType: \"Gymnasium\"\n},{\n    displayName: \"Medarbetare Nacka\",\n    mail: \"medarbetare.nacka@kunskapsskolan.se\",\n    roles: [\"EMPLOYEE\"],\n    username: \"medarbetare.nacka/KS\",\n    school: \"Nacka\",\n    schoolType: \"Grundskolor\"\n},{\n    displayName: \"Medarbetare Globen\",\n    mail: \"medarbetare.globen@kunskapsgymnasiet.se\",\n    roles: [\"EMPLOYEE\"],\n    username: \"medarbetare.globen/KS\",\n    school: \"Globen\",\n    schoolType: \"Gymnasium\"\n},{\n    displayName: \"Elev Globen\",\n    mail: \"elev.globen@edu.kunskapsgymnasiet.se\",\n    schoolGrade: 2,\n    roles: ['STUDENT'],\n    username: \"elev.globen\",\n    school: \"Globen\",\n    schoolType: \"Gymnasium\"\n},{\n    displayName: \"Elev Borås\",\n    mail: \"elev.boras@edu.kunskapsskolan.se\",\n    schoolGrade: 7,\n    roles: ['STUDENT'],\n    username: \"elev.boras\",\n    school: \"Borås\",\n    schoolType: \"Grundskolor\"\n},{\n    displayName: \"Elev Borlänge\",\n    mail: \"elev.borlange@edu.kunskapsskolan.se\",\n    schoolGrade: 9,\n    roles: ['STUDENT'],\n    username: 'elev.borlange/KS',\n    school: 'Borlänge',\n    schoolType: \"Gymnasium\"\n},{\n    displayName: \"Roll-lös\",\n    mail: \"none@kunskapsskolan.se\",\n    username: \"none\",\n    roles: []\n}];\n\n","import { UserTask } from \"kedbackend/models\";\n\nexport function getTaskType (userTask: UserTask) : 'courseBuilderTask' | 'siteVisionTask' | 'customTask' {\n  return userTask.course && userTask.task && userTask.course.length > 0 && userTask.task.length > 0 ?\n    'courseBuilderTask' :\n    userTask.siteVisionPageId ?\n      'siteVisionTask' :\n      'customTask';\n}\n","import * as React from 'react';\nimport { UserTask, Task, UserSubTask } from 'kedbackend/models';\nimport { OpenCloseBox } from '../utility-components/open-close-box';\nimport { L } from '../../utils/utils';\nimport { preserveImpersonationQuery } from '../../access-control';\nimport { courseNameToCssClass } from '../calendar/course-name-to-css-class';\nimport { getTaskType } from './get-task-type';\nimport moment from 'moment';\nimport { VirtualLearningGoal } from './refiner';\nimport { Features } from '../../features';\n\nexport interface UserTasksBoxProps {\n  courseName: string;\n  learningGoals: VirtualLearningGoal[],\n  viewCourseUrl: string;\n  openCourses?: { [path: string]: boolean };\n  setIsOpen?: (courseName: string, isOpen: boolean) => void;\n  setTaskDone?: (task: UserTask, done: boolean) => void;\n  setSubTaskDone: (task: UserTask, subTask: UserSubTask, done: boolean) => void;\n  addOwnTask?: (courseName: string, learningGoalName: string) => void;\n  editTask: (task: UserTask) => void;\n  editSubTask: (task: UserTask, subTask: UserSubTask) => void;\n  removeLearningGoal: (lg: VirtualLearningGoal)=>void;\n};\n\nexport class UserTasksBox extends React.Component<UserTasksBoxProps> {\n  constructor(props: UserTasksBoxProps) {\n    super(props);\n  }\n\n  render() {\n    const {\n      courseName,\n      learningGoals\n    } = this.props;\n    const isOpen = !!this.props.openCourses[courseName];\n    const features = new Features();\n\n    return <OpenCloseBox\n      title={<h5>{courseName || L`Egna lärandemål`}</h5>}\n      headerOpen={isOpen}\n      className={courseName && courseNameToCssClass('wp-course-', courseName)}\n      onOpenClose={becameOpen => this.props.setIsOpen(courseName, becameOpen)}>\n      {learningGoals.map(lg =>\n        <div key={lg.name} className=\"learningGoalContainer\">\n          {lg.step && <div className=\"stepIndicator\">{lg.step}</div>}\n          <div className=\"align-horizontal\">\n            <div className=\"learningGoalText horizontalItem top\">{lg.name}</div>\n            <div className=\"horizontalItem\">\n              &nbsp;<a\n                className=\"trash\"\n                href=\"#\"\n                title=\"Ta bort lärandemålet och dess uppgifter\"\n                onClick={ev=>{\n                  ev.preventDefault();\n                  this.props.removeLearningGoal(lg);\n                }}\n              >\n                <i className=\"fa fa-trash\" />\n              </a>\n            </div>\n          </div>\n\n          <div className=\"learningGoalTasks\">\n            <div className=\"taskContainer\">\n              {lg.tasks.map(userTask => {\n                const isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting' || userTask.$meta === 'updating';\n\n                const taskType = getTaskType(userTask);\n                const expired = moment(userTask.deadline).startOf('day') < moment().startOf('day');\n\n                return <div key={userTask.id} style={isWorking ? { opacity: 0.5 } : {}}>\n                  <div className=\"align-horizontal\">\n                    <div className=\"horizontalItem top\">\n                      <div className={\"checkBox\" + (userTask.done ? \" checked\" : \"\")}\n                        onClick={ev => !isWorking && this.props.setTaskDone(userTask, !userTask.done)}>\n                      </div>\n                    </div>\n                    <div className=\"horizontalItem top\">\n                      {taskType === 'courseBuilderTask' ?\n                        <a href={getTaskUrl(userTask, this.props.viewCourseUrl)}>{userTask.name}</a> :\n                        taskType === 'siteVisionTask' ?\n                          <a href={userTask.url}>{userTask.name}</a> :\n                          <a\n                            className={features.EditUserTasksViaPenOnly && !userTask.url ? \"link-less\": \"\"}\n                            onClick={features.EditUserTasksViaPenOnly ?\n                              undefined :\n                              ev=>{\n                                ev.preventDefault();\n                                this.props.editTask(userTask);\n                              }}\n                            href={userTask.url}\n                            target={(userTask.url+'').toLowerCase().startsWith(location.host.toLowerCase()) ?\n                              \"_self\" :\n                              \"_blank\"}\n                          >{userTask.name}</a>}\n                      {userTask.deadline && <div className={\"dateSet\" + (expired ? ' expired' : '')}>\n                        <i title={moment(userTask.deadline).format(\"YYYY-MM-DD\")} className=\"fa fa-calendar\" aria-hidden=\"true\"\n                          /*style={{cursor: 'pointer'}} */\n                          onClick={()=>{}}></i>\n                      </div>}\n                    </div>\n                    {\n                      features.EditUserTasksViaPenOnly ?\n                      <div className=\"horizontalItem top taskEdit\">\n                        <a className=\"editItem\" onClick={() => this.props.editTask(userTask)} />\n                      </div> : undefined\n                    }\n                  </div>\n                  {userTask.subTasks && <div className=\"subtasks\">\n                    {userTask.subTasks.map(subTask =>\n                      <div key={subTask.id} >\n                        <div className=\"horizontalItem top\">\n                          <div\n                            className={\"checkBox\" + (subTask.done ? \" checked\" : \"\")}\n                            onClick={ev =>\n                              !isWorking &&\n                              this.props.setSubTaskDone(userTask, subTask, !subTask.done)}>\n                          </div>\n                        </div>\n                        <div className=\"horizontalItem top\">\n                          <a\n                            href={subTask.url || undefined}\n                            target={(userTask.url+'').toLowerCase().startsWith(location.host.toLowerCase()) ?\n                            \"_self\" :\n                            \"_blank\"}\n                            className={\n                              subTask.url ?\n                                undefined :\n                                'link-less'\n                          }>{subTask.name}</a>\n                        </div>\n                        <div className=\"horizontalItem top taskEdit\">\n                          <a className=\"editItem\" onClick={() => this.props.editSubTask(userTask, subTask)} />\n                        </div>\n                      </div>)}\n                  </div>}\n                </div>\n              })}\n            </div>\n          </div>\n\n          <div className=\"learningGoalTools\">\n            <div className=\"btn addOwnGoal\"\n              onClick={() => this.props.addOwnTask(this.props.courseName, lg.name)}>\n              <i className=\"fa fa-plus\" aria-hidden=\"true\"></i> {L`Eget arbetsmål`}\n            </div>\n          </div>\n          <br />\n        </div>\n      )}\n    </OpenCloseBox>\n  }\n}\n\nfunction getTaskUrl(userTask: UserTask, viewCourseUrl: string) {\n  if (userTask.course && userTask.course.length > 0 && userTask.task && userTask.task.length > 0) {\n    const courseUrl = preserveImpersonationQuery(viewCourseUrl, { courseId: userTask.course[0].id });\n    return `${courseUrl}#/task/${userTask.task[0].id}`;\n  }\n  return userTask.url;\n}\n","import * as React from 'react';\n\ninterface Props {\n  learningGoal?: string;\n  onSave: (learningGoal: string) => void;\n}\n\ninterface State {\n  learningGoal: string;\n}\n\nexport class AddCustomGoal extends React.Component<Props,State> {\n  constructor (props: Props) {\n    super(props)\n    this.state = {\n      learningGoal: props.learningGoal || ''\n    }\n  }\n\n  render() {\n    const {learningGoal} = this.state;\n    const {onSave} = this.props;\n\n    return <div>\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n          <h2>Lägg till eget lärandemål</h2>\n          <hr />\n          <div className=\"align-horizontal\">\n            <div className=\"horizontalItem top\">Mål:</div>\n            <div className=\"horizontalItem top\">\n              <input type=\"text\" tabIndex={1} size={50} autoFocus\n                value={learningGoal}\n                onChange={e => this.setState({learningGoal: e.target.value})} />\n            </div>\n            <div className=\"horizontalItem top spaced\" />\n          </div>\n          <br /></div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        <button\n          tabIndex={1}\n          className=\"btn btn-large btn-default\"\n          onClick={()=>onSave(learningGoal)}>Spara</button>\n      </div>\n    </div>\n  }\n}\n\n","import * as React from 'react';\n\ninterface Props {\n  label: any;\n  children: any;\n}\n\nfunction findId(node) {\n  const recucheck = new Set();\n  return (function findId(node){\n    if (typeof node === 'string') return null;\n    if (recucheck.has(node)) {\n      debugger;\n      return;\n    }\n    recucheck.add(node);\n    if (node.props) {\n      if (node.props.id) return node.props.id;\n      if (node.props.children) {\n        return findId(node.props.children);\n      }\n      return;\n    }\n    if (node.length) {\n      for (let i=0;i<node.length; ++i) {\n        const child = node[i];\n        if (child) {\n          const childId = findId(child);\n          if (childId) return childId;\n          //console.log(child);\n        }\n      }\n    }\n  })(node);\n}\n\nexport class FormField extends React.Component<Props> {\n  constructor (props: Props) {\n    super(props);\n  }\n\n  render() {\n    return <>\n        <label className=\"kclabel\" htmlFor={findId(this.props.children)}>{this.props.label}</label>\n        {this.props.children}\n    </>\n  }\n}\n","import * as React from 'react';\nimport { FormField } from './form-field';\n\ninterface Props {\n  label: any;\n  id: string;\n  value: string;\n  placeholder?: string;\n  autoFocus?: boolean;\n  children?;\n  onChange: (value: string) => void;\n}\n\nexport class TextInput extends React.Component<Props> {\n  constructor (props: Props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <FormField label={this.props.label}>\n        <div className=\"align-horizontal\">\n          <div className=\"horizontalItem top\">\n            <input type=\"text\" autoFocus={this.props.autoFocus} id={this.props.id} size={35} value={this.props.value}\n              onChange={ev => this.props.onChange(ev.target.value)}\n              placeholder={this.props.placeholder} />\n          </div>\n          {!!this.props.children && <div className=\"horizontalItem\">\n            {this.props.children}\n          </div>}\n        </div>\n      </FormField>\n    );\n  }\n}\n\n","import * as React from 'react';\nimport { FormField } from './form-field';\n\ninterface Props {\n  label: any;\n  id: string;\n  value: string;\n  placeholder?: string;\n  autoFocus?: boolean;\n  rows?: number;\n  children?;\n  onChange: (value: string) => void;\n}\n\nexport class TextAreaFormField extends React.Component<Props> {\n  constructor (props: Props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <FormField label={this.props.label}>\n        <div className=\"align-horizontal\">\n          <div className=\"horizontalItem top\">\n            <textarea autoFocus={this.props.autoFocus} id={this.props.id} cols={35} rows={this.props.rows || 5} value={this.props.value}\n              onChange={ev => this.props.onChange(ev.target.value)}\n              placeholder={this.props.placeholder} />\n          </div>\n          {!!this.props.children && <div className=\"horizontalItem\">\n            {this.props.children}\n          </div>}\n        </div>\n      </FormField>\n    );\n  }\n}\n\n","import * as React from 'react';\nimport { TextInput } from '../utility-components/form-field-text-input';\nimport { TextAreaFormField } from '../utility-components/form-field-textarea';\n\ninterface Props {\n  isTask: boolean\n  onSave: (name: string, description: string, url: string) => void;\n}\n\ninterface State {\n  name: string;\n  description: string;\n  url: string;\n}\n\nexport class AddCustomTask extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props)\n    this.state = {\n      name: '',\n      description: '',\n      url: ''\n    }\n  }\n\n  render() {\n    const { name, description, url } = this.state;\n    const { isTask, onSave } = this.props;\n\n    return <div>\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n        <h2>Lägg till eget arbetsmål</h2>\n        <hr />\n        <TextInput\n          label=\"Namn\"\n          id=\"AddCustomTask:name\"\n          placeholder=\"Ange namn...\"\n          value={name}\n          autoFocus\n          onChange={name => this.setState({name})} />\n\n        <TextAreaFormField\n          rows={7}\n          label=\"Beskrivning\"\n          id=\"AddCustomTask:description\"\n          placeholder=\"Lägg till en beskrivning...\"\n          value={description}\n          onChange={description=>this.setState({description})} />\n\n        <TextInput\n          label=\"Länk\"\n          id=\"AddCustomTask:url\"\n          placeholder=\"http://www...\"\n          value={url}\n          onChange={name => this.setState({url})} />\n\n      </div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        <button\n          tabIndex={1}\n          className=\"btn btn-large btn-default\"\n          onClick={() => onSave(name, description, url)}>Spara</button>\n      </div>\n    </div>\n  }\n}\n\n","import * as React from 'react';\nimport { TextInput } from '../utility-components/form-field-text-input';\nimport { TextAreaFormField } from '../utility-components/form-field-textarea';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport { userTasksRepo } from '../../repos/user-tasks-repo';\nimport { createUUID } from 'kedbackend/client';\n\ntype Props = {\n  // Edit Mode\n  mode: 'add';\n  userTask: UserTask;\n  closeDialog;\n} | {\n  mode: 'edit';\n  userTask: UserTask;\n  subTask: UserSubTask;\n  closeDialog: ()=>void;\n}\n\ninterface State {\n  name: string;\n  description: string;\n  url: string;\n}\n\nexport class AddOrEditSubTask extends React.Component<Props,State> {\n  constructor (props: Props) {\n    super(props);\n    if (props.mode === 'edit') {\n      const {subTask} = props;\n      this.state = {\n        name: subTask.name || '',\n        description: subTask.description || '',\n        url: subTask.url || ''\n      };\n    } else {  \n      this.state = {\n        name: '',\n        description: '',\n        url: ''\n      };\n    }\n  }\n\n  save() {\n    // Update repo:\n    const {props} = this;\n    const {userTask, closeDialog} = props;\n    const {name, description, url} = this.state;\n    if (props.mode === 'edit') {\n      // Edit existing:\n      userTasksRepo.update([userTask], ut => {\n        const {subTasks} = ut;\n        if (subTasks) {\n          ut.subTasks = subTasks.map(st =>\n            st.id === props.subTask.id ? {...st, name, description, url} :\n            {...st}\n          );\n        }\n      });\n    } else {\n      // Create new task\n      const newSubTask = {\n        id: createUUID(),\n        name,\n        description,\n        url\n      };\n\n      // Update repo:\n      userTasksRepo.update([userTask], ut => {\n        if (!ut.subTasks) {\n          ut.subTasks = [];\n        }\n        ut.subTasks = ut.subTasks.concat(newSubTask);\n      });\n    }\n\n    // Close dialog\n    closeDialog();    \n  }\n\n  delete() {\n    // Update repo:\n    const props = this.props;  \n    if (props.mode !== 'edit') {\n      throw new Error(\"Can only delete in edit mode\");\n    }\n    userTasksRepo.update([props.userTask], ut => {\n      if (ut.subTasks) {\n        ut.subTasks = ut.subTasks.filter(t => t.id !== props.subTask.id);\n      }\n    });\n\n    // Close dialog:\n    props.closeDialog();\n  }\n\n  render() {\n    const {name, description, url} = this.state;\n    const {props} = this;\n    const isEditMode = props.mode === 'edit';\n    \n    return <>\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n        <h2>{isEditMode ? 'Redigera underuppgift' : 'Lägg till underuppgift'}</h2>\n        <hr />\n        <TextInput\n          autoFocus\n          label=\"Underuppgiftens namn\"\n          id=\"AddUserSubTask:name\"\n          placeholder=\"\"\n          value={this.state.name}\n          onChange={name => this.setState({name})}\n            />\n        <TextAreaFormField\n          label=\"Beskrivning\"\n          id=\"AddUserSubTask:description\"\n          rows={7}\n          placeholder=\"\"\n          value={this.state.description}\n          onChange={description => this.setState({description})}\n            />\n        <TextInput\n          label=\"Länk\"\n          id=\"AddUserSubTask:url\"\n          placeholder=\"\"\n          value={this.state.url}\n          onChange={url => this.setState({url})}\n            />\n        <br />\n      </div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        {\n          props.mode === 'edit' && <button className=\"btn btn-warning btn-large pull-right\"\n          onClick={ev => this.delete()}>\n          {\"Ta bort underuppgift\"}</button>}\n        <button\n          tabIndex={1}\n          className=\"btn btn-large btn-default\"\n          onClick={()=>this.save()}>Spara</button>\n      </div>\n    </>\n  }\n}\n\n","import * as React from 'react';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport { RenameableText } from '../utility-components/renameable-text';\nimport { L } from '../../utils/utils';\nimport { getTaskType } from './get-task-type';\nimport ReactDatePicker, { ReactDatePickerProps } from 'react-datepicker';\nimport '../../globals/moment-sv-locale';\nimport {TextInput} from '../utility-components/form-field-text-input';\nimport moment from 'moment';\nimport { FormField } from '../utility-components/form-field';\nimport { AddOrEditSubTask } from './add-or-edit-sub-task';\nimport { createUUID } from 'kedbackend/client';\nimport update from 'react-addons-update';\nimport { userTasksRepo } from '../../repos/user-tasks-repo';\nimport { TextAreaFormField } from '../utility-components/form-field-textarea';\n\ninterface Props {\n  userTask: UserTask;\n  onUpdate: (updater: (userTask: UserTask) => void) => void;\n  onDelete: (userTaskId: string) => void;\n  openDialog: (dialog) => void;\n  closeDialog: ()=>void;\n}\n\ninterface State {\n  userTask: UserTask;\n  name: string;\n  description?: string;\n  deadline?: string;\n  url: string;\n  subTasks?: UserSubTask[];\n  showCalendar?: boolean;\n}\n\nexport class EditUserTask extends React.Component<Props,State> {\n  datePicker: any;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      userTask: props.userTask,\n      name: props.userTask.name,\n      description: props.userTask.description,\n      url: props.userTask.url,\n      deadline: props.userTask.deadline,\n      subTasks: props.userTask.subTasks\n    }\n    this.onUserTasksChanged = this.onUserTasksChanged.bind(this);\n  }\n\n  componentDidMount() {\n    userTasksRepo.subscribe(this.onUserTasksChanged);\n  }\n\n  onUserTasksChanged(userTasks: UserTask[]) {\n    const myUserTask = userTasks.find(ut => ut.id === this.props.userTask.id);\n    if (!myUserTask) {\n      this.props.closeDialog();\n      return;\n    }\n    this.setState({\n      userTask: myUserTask,\n      subTasks: myUserTask.subTasks\n    });\n  }\n\n  componentWillUnmount() {\n    userTasksRepo.unsubscribe(this.onUserTasksChanged);\n  }\n\n  isModified() {\n    // Don't count subtask changes! They live their own life and is maintained\n    // in add-or-edit-sub-task.tsx. Reason: User would expect added /edited subtasks\n    // to be persisted right away. May click away this dialog.\n    // Also reason: Can invoke that dialog by itself from other components. From WeekPlanner\n    // when clicking the subtask for example!\n\n    const {deadline, description, name, url, userTask} = this.state;\n    return (\n      deadline !== userTask.deadline ||\n      description !== userTask.description ||\n      name !== userTask.name ||\n      url !== userTask.url);\n  }\n\n  addSubTask(): any {\n    this.props.openDialog(<AddOrEditSubTask\n      mode=\"add\"\n      userTask={this.state.userTask}\n      closeDialog={this.props.closeDialog}\n    />);\n  }\n\n  editSubTask(subTask: UserSubTask) {\n    this.props.openDialog(<AddOrEditSubTask\n      mode=\"edit\"\n      subTask={subTask}\n      userTask={this.state.userTask}\n      closeDialog={this.props.closeDialog}\n    />);\n  }\n  \n  render() {\n    const { name, description, url, deadline, subTasks, showCalendar, userTask } = this.state;\n    const { id, courseName } = userTask;\n    const { onUpdate, onDelete } = this.props;\n    const isModified = this.isModified();\n\n    const taskType = getTaskType(userTask);\n    const isCustomTask = taskType === 'customTask';\n    const expired = moment(userTask.deadline) < moment();\n\n    return <div className=\"editTaskDialog sv-html-portlet sv-portlet sv-skip-spacer\">\n      <h2>{isCustomTask ? `Redigera arbetsmål` : `Redigera uppgift`}</h2>\n      <hr />\n      <TextInput\n        autoFocus\n        label={isCustomTask ? \"Arbetsmålets namn\" : \"Uppgiftens namn\"}\n        id=\"EditUserTask:name\"\n        placeholder={isCustomTask ? \"Vad ska du göra?\" : \"Ange uppgiftens namn...\"}\n        value={name}\n        onChange={name => this.setState({name})} />\n      \n      {isCustomTask && <>\n        <TextAreaFormField\n          rows={5}\n          label=\"Beskrivning\"\n          id=\"EditUserTask:description\"\n          placeholder=\"Lägg till en beskrivning...\"\n          value={description}\n          onChange={description=>this.setState({description})} />\n\n        <TextInput\n          label=\"Länk\"\n          id=\"EdutUserTask:url\"\n          placeholder=\"http(s)://...\"\n          value={url}\n          onChange={url => this.setState({url})} >\n\n        </TextInput></>}\n\n        <FormField label=\"Ange deadline\">\n          {(deadline || showCalendar) ?\n            <div className=\"align-horizontal\">\n              <div className=\"horizontalItem top\">\n                <ReactDatePicker ref={elem => this.datePicker = elem}\n                  id=\"EditUserTask:deadline\"\n                  selected={deadline && moment(deadline)}\n                  autoFocus={showCalendar}\n                  dateFormat=\"YYYY-MM-DD\"\n                  className={expired ? \"expired\" : undefined}\n                  locale={\"sv\"}\n                  popperPlacement={isCustomTask ? \"top-start\" : \"bottom-start\"}\n                  onBlur={()=>this.setState({showCalendar: false})}\n                  onChange={value=>{\n                    this.setState({\n                      deadline: value && value.format(\"YYYY-MM-DD\"),\n                      showCalendar: false\n                    });\n                  }}\n                />\n              </div>\n              <div className=\"horizontalItem top\">\n                <a className=\"deleteDate\" href=\"#\" title=\"Ta bort deadline\" onClick={ev=>{\n                  ev.preventDefault();\n                  this.setState({deadline: null, showCalendar: false});\n                }}></a>\n              </div>\n            </div> :\n            <div className=\"top\" ref={()=>{this.datePicker = null}}>\n                <a className=\"btn\" onClick={ev => {\n                  if (this.datePicker) {\n                    this.datePicker.setOpen(true);\n                  }\n                  this.setState({\n                    showCalendar: true\n                  });\n                }}>\n                <i className=\"fa fa-calendar\" aria-hidden=\"true\"></i> Ange deadline...\n              </a>              \n            </div>}\n        </FormField>\n      <FormField label=\"Underuppgifter\">\n        <div className=\"learningGoalTasks\">\n          <div className=\"taskContainer\">\n\n              {subTasks && subTasks.map(subTask => <div key={subTask.id} className=\"align-horizontal\">\n                <div className=\"horizontalItem top\"><a\n                  onClick={()=>this.editSubTask(subTask)}\n                  href=\"#\">{subTask.name}</a></div>\n              </div>)}\n          </div>\n        </div>\n        <div className=\"align-horizontal\">\n          <div className=\"top\">\n            <button id=\"EditUserTask:addSubTask\" className=\"btn\"\n              onClick={()=>this.addSubTask()}>\n              <i className=\"fa fa-plus\" aria-hidden=\"true\"></i> Lägg till underuppgift\n            </button>\n          </div>\n        </div>\n      </FormField>\n      <div className=\"divider large\" />\n      <div className=\"align-horizontal\">\n        <div className=\"horizontalButton top\">\n          <button tabIndex={1}\n            className=\"btn btn-default\"\n            onClick={()=>{\n              isModified ? onUpdate(userTask => {\n                userTask.name = name;\n                userTask.description = description;\n                userTask.url = url;\n                userTask.deadline = deadline;\n              }) : this.props.closeDialog();\n            }}> Spara </button>\n        </div>\n        <div className=\"horizontalButton top\">\n          <button tabIndex={1}\n            className=\"btn\"\n            onClick={()=>{\n              this.props.closeDialog();\n            }}> Avbryt </button>\n        </div>\n        <div className=\"confirm top pull-right\">\n          <button\n            tabIndex={1}\n            className=\"btn btn-warning\"\n            onClick={()=>{\n              onDelete(id);\n            }}>{isCustomTask ?\n              \" Ta bort arbetsmål\" :\n              \" Ta bort den här uppgiften\"\n          }</button>\n        </div>\n      </div>\n                  \n      {/*<div className=\"btn btn-warning btn-large pull-right\" onClick={ev => onDelete(id)}>\n        {L`Ta bort arbetsmål`}</div>\n      {isModified &&\n        <div\n          className=\"btn btn-large btn-default\"\n          tabIndex={0}\n          onClick={()=>onUpdate(userTask => {\n            userTask.name = name;\n            userTask.description = description;\n            userTask.url = url;\n          })}> Spara</div>}*/}\n    </div>\n  }\n}\n\n","\nexport class PendingJob {\n  private timeoutId = null;\n  private cancelled = false;\n  private pending = false;\n  private isJobExecuting = false;\n  private jobCallback: ()=>Promise<any>;\n  \n  constructor(callback: ()=>Promise<any>) {\n    this.jobCallback = callback;\n  }\n\n  triggerChange(throttle: number): any {\n    if (this.cancelled) return;\n    this.pending = true;\n    if (this.timeoutId !== null)\n      clearTimeout(this.timeoutId);\n    this.timeoutId = setTimeout(()=>this.launchJob(), throttle);\n  }\n\n  stop() {\n    if (this.timeoutId !== null)\n      clearTimeout(this.timeoutId);\n    this.timeoutId = null;\n    this.cancelled = true;\n  }\n\n  private async launchJob() {\n    if (this.cancelled) return;\n    if (!this.pending) return;\n    if (this.isJobExecuting) return;\n    this.timeoutId = null;\n    try {\n      this.isJobExecuting = true;\n      this.pending = false;\n      await this.jobCallback();\n    } finally {\n      this.isJobExecuting = false;\n    }\n    if (this.pending)\n      await this.launchJob();\n  }\n}\n","import * as React from 'react';\nimport { UserTasksBox } from './user-tasks-box';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport { createUUID, HttpError } from \"kedbackend/client\";\nimport { refine, VirtualLearningGoal } from './refiner';\nimport env from '../../globals/KED.env';\nimport { userTasksRepo } from '../../repos/user-tasks-repo';\nimport { L, compareProp } from '../../utils/utils';\nimport moment from 'moment';\n//import { CustomGoal } from '../../contracts/ked-models';\nimport { TSON } from '../../utils/tson';\nimport { WeekPlannerPersistedState } from './weekplanner-persisted-state';\nimport { RemoveItem } from '../course-builder/sub-components/remove-item';\nimport { Dialogs } from '../utility-components/dialogs';\nimport { AddCustomGoal } from './add-custom-goal';\nimport { AddCustomTask } from './add-custom-task';\nimport { EditUserTask } from './edit-user-task';\nimport { Spinner } from '../course-builder/sub-components/spinner';\nimport { OpenCloseBox } from '../utility-components/open-close-box';\nimport { PendingJob } from '../../utils/pending-job';\nimport { AddOrEditSubTask } from './add-or-edit-sub-task';\nimport { getAdjustedWeek, KEDWeek } from '../../utils/weekutil';\n\ninterface Props {\n  viewCourseUrl: string;\n}\n\ninterface State {\n  weekDate: number;\n  dialogs: any[];\n  userTasks: UserTask[];\n  openCourses: { [path: string]: boolean }\n  strategy?: string;\n  assessment?: string;\n  weekTextsUT: UserTask | null;\n  saving: boolean;\n  isLoading: boolean;\n}\n\nexport class WeekPlanner extends React.Component<Props,State> {\n  weekTextsSavingJob: PendingJob;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      userTasks: [],\n      weekDate: Date.now(),\n      openCourses: {},\n      dialogs: [],\n      saving: false,\n      weekTextsUT: null,\n      isLoading: true\n    }\n    this.onChange = this.onChange.bind(this);\n    this.weekTextsSavingJob = new PendingJob(()=>this.saveWeekTexts());\n  }\n\n  componentDidMount() {\n    userTasksRepo.subscribe(this.onChange);\n  }\n\n  componentWillUnmount() {\n    userTasksRepo.unsubscribe(this.onChange);\n    this.weekTextsSavingJob.stop();\n  }\n\n  onChange(userTasks: UserTask[], persisted: WeekPlannerPersistedState, weekTextsUT: UserTask) {\n    const newState : Partial<State> = {\n      userTasks,\n      weekDate: persisted.weekDate,\n      openCourses: persisted.openCourses,\n      weekTextsUT,\n      isLoading: false\n    }\n    if (!this.state.weekTextsUT || (weekTextsUT.dateTime !== this.state.weekTextsUT.dateTime)) {\n      // Changing week. Reset to new week's values\n      newState.strategy = weekTextsUT.weekTexts.strategy;\n      newState.assessment = weekTextsUT.weekTexts.assessment;\n    }\n    this.setState(newState as any); // React's use of Pick instead of Partial makes things complex here.\n  }\n\n  isWeekTextsEdited() {\n    const { strategy, assessment, weekTextsUT } = this.state;\n    return !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy || assessment !== weekTextsUT.weekTexts.assessment);\n  }\n\n  private async saveWeekTexts() {\n    console.log(\"Saving texts...\");\n    const { strategy, assessment, weekTextsUT } = this.state;\n    if (this.isWeekTextsEdited()) {\n      await userTasksRepo.upsert(weekTextsUT, ut => {\n        ut.weekTexts = { strategy, assessment };\n      });\n    }\n  }\n\n  prevWeek() {\n    //this.saveWeekTexts();\n    userTasksRepo.changeWeek(moment(this.state.weekDate).add(-1, 'week').toDate());\n  }\n\n  nextWeek() {\n    //this.saveWeekTexts();\n    userTasksRepo.changeWeek(moment(this.state.weekDate).add(1, 'week').toDate());\n  }\n\n  openDialog(dialog) {\n    this.setState({ dialogs: [...this.state.dialogs, dialog] });\n  }\n\n  openAddGoalDialog() {\n    this.openDialog(<AddCustomGoal\n      onSave={async (learningGoal: string) => {\n        if (!learningGoal) throw new Error (L`Lärandemålet kan inte vara tomt`);\n        if (!this.state.saving) {\n          this.setState({ saving: true });\n          try {\n            await this.addCustomGoal(learningGoal);\n          } finally {\n            this.setState({ saving: false });\n          }\n          this.closeDialog();\n        }\n      }} />);\n  }\n\n  openAddOwnTaskDialog(courseName: string, learningGoalName: string) {\n    this.openDialog(<AddCustomTask\n      isTask={!courseName}\n      onSave={async (name: string, description: string, url: string) => {\n        if (!name) throw new Error (L`Namnet kan inte vara tomt`);\n        if (!this.state.saving) {\n          this.setState({ saving: true });\n          try {\n            await this.addCustomTask(courseName, learningGoalName, name, description, url);\n          } finally {\n            this.setState({ saving: false });\n          }\n          this.closeDialog();\n        }\n      }} />);\n  }\n\n  editTask(userTask: UserTask) {\n    this.openDialog(<EditUserTask\n      userTask={userTask}\n      onUpdate={async (updater: (ut: UserTask) => void) => {\n        const test = {...userTask};\n        updater(test);\n        if (!test.name) throw new Error (L`Namnet får inte vara tomt`);\n        this.closeDialog();\n        await userTasksRepo.update([userTask], updater);\n      }}\n      onDelete={async id => {\n        this.closeDialog();\n        await userTasksRepo.delete([id]);\n      }}\n      openDialog={dialog=>this.openDialog(dialog)}\n      closeDialog={()=>this.closeDialog()}\n    />);\n  }\n\n  editSubTask(userTask: UserTask, subTask: UserSubTask) {\n    this.openDialog(<AddOrEditSubTask\n      mode=\"edit\"\n      userTask={userTask}\n      subTask={subTask}\n      closeDialog={()=>this.closeDialog()}\n    />);\n  }\n\n  closeDialog() {\n    this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });\n  }\n\n\n\n  async addCustomGoal(learningGoal: string) {\n    let latestTimeStamp = Math.max.apply(\n      Math.max,\n      [this.state.weekDate].concat(this.state.userTasks.map(t => t.dateTime)));\n\n    await userTasksRepo.insert([{\n      id: createUUID(),\n      learningGoal,\n      dateTime: latestTimeStamp + 2000\n    }]);\n\n    await userTasksRepo.setWeekPlannerBoxOpen(\"\", true);\n  }\n\n  async removeLearningGoal(learningGoal: VirtualLearningGoal) {\n    if (learningGoal.tasks.length > 0) {\n      if (!confirm(`Ta bort lärandemål samt ${learningGoal.tasks.length} uppgifter?`)) {\n        return;\n      }\n    }\n    await userTasksRepo.delete(learningGoal.allTasks.map(t => t.id));\n  }\n\n  async addCustomTask(courseName: string, learningGoal: string, name: string, description: string, url: string) {\n    let latestTimeStamp = Math.max.apply(\n      Math.max,\n      [this.state.weekDate].concat(this.state.userTasks.map(t => t.dateTime)));\n\n    /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>\n      ut.name == null &&\n      !ut.courseName &&\n      ut.learningGoal === learningGoal);\n\n    if (emptyLearningGoalPlaceholder) {\n      // Hijack learning-goal placeholder and make it the real task.\n      // This will make the learning goal disappear once this task\n      // is deleted.\n      await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {\n        Object.assign(ut, { name, description, url });\n      });\n    } else {*/\n      // Add another task to same learning-goal\n      await userTasksRepo.insert([{\n        id: createUUID(),\n        dateTime: latestTimeStamp + 2000,\n        courseName,\n        learningGoal,\n        name,\n        description,\n        url\n      }]);\n    //}\n  }\n\n  setIsOpen(courseName: string, isOpen: boolean) {\n    userTasksRepo.setWeekPlannerBoxOpen(courseName, isOpen);\n  }\n\n  async setTaskDone(task: UserTask, done: boolean) {\n    await userTasksRepo.setTaskDoneState(task, done);\n  }\n\n  async setSubTaskDone(task: UserTask, subTask: UserSubTask, done: boolean) {\n    await userTasksRepo.setSubTaskDoneState(task, subTask.id, done);\n  }\n\n  async copyFromPreviousWeek() {\n    const { userTasks, openCourses, weekDate } = this.state;\n    const prevWeekNo = getAdjustedWeek (moment(weekDate).add(-1, 'week'));\n    const prevKEDWeek = KEDWeek(moment(weekDate).year(), prevWeekNo);\n    // Read last week's goals and tasks\n    let prevTasks = await env.kedBackendClient.list<UserTask>(\"usertasks\", {\n      from: prevKEDWeek.notBefore,\n      to: prevKEDWeek.notAfter,\n      role: \"USER\",\n      include: [\"task\", \"course\", \"acl\"],\n      flags: [\"includeIdsOnly\"]\n    });\n    prevTasks = prevTasks\n      .filter(prevTask => !prevTask.done)  // Don't copy done tasks\n      .filter(prevTask => !!prevTask.name) // Don't copy empty learning goals\n      .filter(prevTask => !userTasks.some(taskOfCurrentWeek =>\n        taskOfCurrentWeek.name === prevTask.name &&\n        taskOfCurrentWeek.learningGoal === prevTask.learningGoal &&\n        taskOfCurrentWeek.courseName === prevTask.courseName)); // Ignore identical tasks (already copied)\n\n    // Now create copies but place them in the current week.\n    let latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(userTasks.map(t => t.dateTime)));\n\n    const copies = prevTasks.sort(compareProp(\"dateTime\")).map(task => {\n      const copy: UserTask = { ...task, dateTime: latestTimeStamp += 1000 };\n      copy.id = createUUID();\n      if (copy.subTasks) {\n        copy.subTasks = copy.subTasks.filter(st => !st.done);\n      }\n      delete copy.$etag;\n      return copy;\n    });\n\n    // Store it\n    await userTasksRepo.insert(copies);\n  }\n\n  render() {\n    const weekNumber = moment(this.state.weekDate).week();\n    //console.log(\"Weekydate: \"  + new Date(this.state.weekDate) + \" which is week no \" + weekNumber);\n    const currentWeek = moment().week();\n    const taskSets = refine(this.state.userTasks);\n    const { dialogs, weekTextsUT, strategy, assessment, isLoading } = this.state;\n    const isSaving = weekTextsUT && (weekTextsUT.$meta === 'adding' || weekTextsUT.$meta === 'updating');\n    const isStrategyEdited = !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy);\n    const isAssessmentEdited = !!weekTextsUT && (assessment !== weekTextsUT.weekTexts.assessment);\n    const enableSaveButton = !isSaving && (isStrategyEdited || isAssessmentEdited);\n    return <div>\n      <div className={`ked_boxed weekPlanner${weekNumber === currentWeek ? \" currentWeek\" : \"\"}`}\n        onKeyDown={ev => {\n          if (ev.which === 83 && ev.ctrlKey) {\n            ev.preventDefault();\n            if (!isSaving && this.isWeekTextsEdited()) {\n              this.weekTextsSavingJob.triggerChange(0);\n            }\n          }\n        }}>\n        <div className={`weekSelect`}>\n          <div className=\"horizontalItem\">\n            <p>{L`Vecka ${weekNumber}`}</p>\n          </div>\n          <div className=\"horizontalItem\">\n            <div className=\"btn-group\">\n              <button className=\"btn\" onClick={() => this.prevWeek()}>\n                <i className=\"fa fa-angle-left\" aria-hidden=\"true\"></i>\n              </button>\n              <button className=\"btn\" onClick={() => this.nextWeek()}>\n                <i className=\"fa fa-angle-right\" aria-hidden=\"true\"></i>\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <h4>{L`Loggbok`}</h4>\n        {taskSets.length > 0 && <hr />}\n\n        {taskSets.map(props =>\n          <UserTasksBox\n            key={props.courseName}\n            {...props}\n            courseName={props.courseName}\n            learningGoals={props.learningGoals}\n            viewCourseUrl={this.props.viewCourseUrl}\n            openCourses={this.state.openCourses}\n            addOwnTask={(courseName: string, learningGoalName: string) => this.openAddOwnTaskDialog(courseName, learningGoalName)}\n            setIsOpen={this.setIsOpen.bind(this)}\n            setTaskDone={this.setTaskDone.bind(this)}\n            setSubTaskDone={this.setSubTaskDone.bind(this)}\n            editTask={task => this.editTask(task)}\n            editSubTask={(task, subTask) => this.editSubTask(task, subTask)}\n            removeLearningGoal={lg => this.removeLearningGoal(lg)} />)}\n\n        <hr />\n\n        {isLoading ? <Spinner /> : <div>\n          <div className=\"btn\" onClick={ev => this.openAddGoalDialog()}>\n            <i className=\"fa fa-list-alt\" aria-hidden=\"true\"></i> {L`Eget lärandemål`}\n\n          </div>\n          <div className=\"btn\" onClick={ev => this.copyFromPreviousWeek()}>\n            <i className=\"fa fa-clone\" aria-hidden=\"true\"></i> {L`Kopiera ej klara från föregående vecka`}\n          </div>\n          <OpenCloseBox\n            title={<h5>{L`Strategi & Utvärdering`}</h5>}\n            headerOpen={this.state.openCourses[\"StratUtv\"]}\n            onOpenClose={becameOpen => this.setIsOpen(\"StratUtv\", becameOpen)}\n          >\n            <h3>Strategi</h3>\n            <p>Hur jag ska göra för att lära mig.</p>\n            <hr/>\n            <textarea\n              className=\"weekplanner-textarea\"\n              value={strategy}\n              onChange={ev => {\n                this.setState({strategy: ev.target.value});\n                this.weekTextsSavingJob.triggerChange(500);\n              }} />\n\n            <h3>Utvärdering</h3>\n            <p>Reflektion kring din arbetsinsats och dina valda strategier under veckan.\n              Utvärdera i förhållande till dina mål.</p>\n            <hr/>\n            <textarea\n              className=\"weekplanner-textarea\"\n              value={assessment}\n              onChange={ev => {\n                this.setState({assessment: ev.target.value})\n                this.weekTextsSavingJob.triggerChange(500);\n              } }/>\n            <div\n              className=\"btn\"\n              tabIndex={0}\n              style={enableSaveButton ? {} : {opacity: 0.5}}\n              onClick={()=>!isSaving && this.weekTextsSavingJob.triggerChange(0)}>\n                <i className=\"fa fa-floppy-o\" aria-hidden=\"true\" />\n                  {enableSaveButton ? \" Spara\" : \" Sparad\"}\n            </div>\n        </OpenCloseBox>\n\n        </div>}\n      </div>\n      <Dialogs\n        dialogs={dialogs}\n        popDialog={() => {\n            this.setState(\n              ({dialogs}) => ({ dialogs: dialogs.slice(0, dialogs.length - 1) }));\n          }\n        } />\n    </div>\n  }\n}\n","import { UserTask } from 'kedbackend/models';\nimport { UserTasksBoxProps } from './user-tasks-box';\nimport { arrayToMap, arrayToLookup, compareProp, L } from \"../../utils/utils\";\n\nexport interface VirtualLearningGoal {\n  name: string;\n  allTasks: UserTask[];\n  step?: number;\n  url?: string;\n  tasks: UserTask[];\n}\n\nexport function refine(tasks: UserTask[]) {\n  const result = [] as Partial<UserTasksBoxProps>[];\n  const mapper = {} as { [name: string]: UserTasksBoxProps };\n  const tasksPerCourse = arrayToLookup(tasks, t => t.courseName || '');\n  for (const courseName of Object.keys(tasksPerCourse).sort().filter(x => x).concat(tasksPerCourse[''] ?\n    [''] : [])) {\n    const courseTasks = tasksPerCourse[courseName] || tasksPerCourse[''];\n    const tasksPerLearningGoal = arrayToLookup(courseTasks, t => t.learningGoal);\n    const resultLearningGoals: VirtualLearningGoal[] = [];\n    for (const learningGoal of Object.keys(tasksPerLearningGoal)) {\n      const lgTasks = tasksPerLearningGoal[learningGoal].sort(compareProp(\"dateTime\"));\n      const learningGoalTask = lgTasks\n        .filter(t => t.name == null) // If name is undefined or null, this represents a learning goal\n        [0];\n      const url = learningGoalTask && learningGoalTask.url;\n      resultLearningGoals.push({\n        name: learningGoal,\n        allTasks: lgTasks,\n        url,\n        step: lgTasks.map(t => t.step).filter(step => step)[0],\n        tasks: lgTasks.filter(t => t.name)\n      });\n    }\n    result.push({\n      courseName,\n      learningGoals: resultLearningGoals\n    });\n  }\n  return result;\n}\n","import env from '../globals/KED.env';\nimport cfg from '../globals/KED.cfg';\nimport { KedBackendClientWeb } from 'kedbackend/clientweb';\n\nenv.kedBackendClient = new KedBackendClientWeb (\n  cfg.KED_API_URL,\n  env.bearerProvider);\n\n","import { parseQueryString, generateQueryString, splitUrlAndQuery } from \"../utils/query-string\";\nimport { KedBackendClientWeb, WebServerBearerProvider, isomorphic, storage } from 'kedbackend/clientweb';\nimport { BearerProvider, KedBearerProvider } from 'kedbackend/client';\nimport cfg from '../globals/KED.cfg';\nimport env from '../globals/KED.env';\nimport { User } from \"../contracts/ked-models\";\nimport { IMPERSONATION_QUERY_PARAMS } from \"../access-control/index\";\nimport { cherryPickProps } from \"../utils/utils\";\n\nfunction getMergedTokenPath(tokenPath: string, locationSearch: string, scopes: string[]) {\n  // Merge configured query params of token path with params given to current page\n  const currentQuery = parseQueryString(locationSearch);\n  const impersonationProps = cherryPickProps(currentQuery, IMPERSONATION_QUERY_PARAMS);\n  const [tokenPathWithoutQuery, tokenQueryString] = splitUrlAndQuery(tokenPath);\n  const tokenPathQuery = parseQueryString(tokenQueryString);\n  return tokenPathWithoutQuery + generateQueryString({\n    ...tokenPathQuery,\n    ...impersonationProps,\n    scopes: scopes.join(',')\n  });\n}\n\nfunction getTokenId(mergedTokenPath: string, userEmail: string) {\n  return mergedTokenPath + \"/\" + userEmail;\n}\n\nfunction saveUserInfo(user: User, tokenId: string) {\n  env.currentUser = user;\n  sessionStorage.setItem(\"userInfo\" + tokenId, JSON.stringify(user));\n}\n\nfunction loadUserInfo(tokenId: string) {\n  const storedSessionUser = sessionStorage.getItem(\"userInfo\" + tokenId);\n  if (storedSessionUser) {\n    env.currentUser = JSON.parse(storedSessionUser);\n  }\n}\n\nfunction createBearerProvider(mergedTokenPath: string, userEmail: string) {\n  const tokenId = getTokenId(mergedTokenPath, userEmail);\n  return new WebServerBearerProvider(mergedTokenPath, responseText => {\n    const res = JSON.parse(responseText) as { ok: boolean, error?: string, token?: string, user?: User };\n    if (!res.ok) throw new Error(res.error);\n    if (res.user) {\n      saveUserInfo(res.user, tokenId);\n    }\n    return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };\n  }, tokenId);\n}\n\nfunction createGoogleTokenProvider(mergedTokenPath: string, userEmail: string) {\n  const tokenId = getTokenId(mergedTokenPath, userEmail);\n  return new WebServerBearerProvider(mergedTokenPath, responseText => {\n    const res = JSON.parse(responseText) as { ok: boolean, error?: string, token?: string, user?: User };\n    if (!res.ok) throw new Error(res.error);\n    return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };\n  }, tokenId);\n}\n\nfunction createTestTokenProvider(tokenUrl: string, user: User, scopes: string[]) {\n  return new KedBearerProvider(\n    isomorphic,\n    storage,\n    tokenUrl + user.mail + location.search,\n    cfg.KED_CLIENT_ID,\n    cfg.KED_CLIENT_SECRET,\n    tokenUrl, {\n      email: user.mail.toLowerCase(),\n      roles: user.roles,\n      school: user.school,\n      schoolType: user.schoolType,\n      scopes\n    });\n}\n\n// env.currentUser.mail is set by SiteVision server initially.\n// A response from /api/token may change the mail attribute of the current\n// user, so env.currentUser.mail may be different after getting a response.\n// However, the initial value is valuable always in order to distinguish the case\n// when one normal user logs out and another user logs in.\nconst initialUserEmail = env.currentUser && env.currentUser.mail; // Initial value of mail. May change.\nif (initialUserEmail) {\n  // KED\n  if (cfg.KED_TOKEN_PATH) {\n    //\n    //\n    // Production / SiteVision proxied /api/token to request tokens from:\n    //\n    //\n    const mergedTokenPath = getMergedTokenPath(\n      cfg.KED_TOKEN_PATH,\n      location.search, [\n        \"kedbackend\",\n        \"EDS\",\n      ]);\n    env.bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);\n    loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));\n\n    // Google\n    const googleMergedPath = getMergedTokenPath(\n      cfg.KED_TOKEN_PATH,\n      location.search, [\n        \"https://www.googleapis.com/auth/calendar.readonly\",\n      ]);\n    env.googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);\n  } else if (cfg.KED_TOKEN_URL && cfg.KED_CLIENT_ID && cfg.KED_CLIENT_SECRET) {\n    //\n    //\n    // Test - go directly to KEDAUTH server to retrieve tokens\n    //\n    //\n    env.bearerProvider = createTestTokenProvider(cfg.KED_TOKEN_URL, env.currentUser, [\n      \"kedbackend\",\n      \"EDS\",\n    ]);\n    env.googleTokenProvider = createTestTokenProvider(cfg.KED_TOKEN_URL + \"/google\", env.currentUser, [\n      \"https://www.googleapis.com/auth/calendar.readonly\",\n    ]);\n  } else {\n    throw new Error(`Missing configuration parameter KED_TOKEN_PATH`);\n  }\n}\n","import * as React from 'react';\nimport { Course, School, UserHiddenCourse } from 'kedbackend/models';\nimport env from '../../globals/KED.env';\nimport { showError, flatten, compareProp, showInfo, L } from \"../../utils/utils\";\nimport { createUUID } from 'kedbackend/client';\nimport { Spinner } from \"../course-builder/sub-components/spinner\";\nimport { parseQueryString, generateQueryString } from \"../../utils/query-string\";\nimport { preserveImpersonationQuery } from '../../access-control/index';\nimport { hiddenCoursesRepo, CourseWithHiddenState } from '../../repos/hidden-courses-repo';\n\ninterface Props {\n  viewCourseUrl?: string;\n}\n\ninterface State {\n  isLoading: boolean\n  courses: CourseWithHiddenState[]\n  headerOpen: boolean\n}\n\nexport class ListCourses extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      courses: [],\n      headerOpen: false\n    };\n    this.updateHiddenCourses = this.updateHiddenCourses.bind(this);\n  }\n\n  componentWillMount() {\n    hiddenCoursesRepo.subscribe(this.updateHiddenCourses, {fullCourse: true});\n  }\n\n  componentWillUnmount() {\n    hiddenCoursesRepo.unsubscribe(this.updateHiddenCourses);\n  }\n\n  updateHiddenCourses(courses: CourseWithHiddenState[]) {\n    this.setState({courses, isLoading: false});\n  }\n\n  async hideCourse(course: CourseWithHiddenState) {\n    showInfo(L`Sparar...`);\n    await hiddenCoursesRepo.hideCourse(course);\n    showInfo(\"\");\n  }\n\n  async showCourse(course: CourseWithHiddenState) {\n    showInfo(L`Sparar...`);\n    await hiddenCoursesRepo.showCourse(course);\n    showInfo(\"\");\n  }\n\n  render() {\n    if (this.state.isLoading) return <Spinner />;\n    const {courses} = this.state;\n    const visibleCourses = courses.filter(course => course.visible);\n    const hiddenCourses = courses.filter(course => !course.visible);\n    const query = parseQueryString(location.search);\n    const viewCourseUrl = this.props.viewCourseUrl || \"\";\n\n    return <div className=\"ked_boxed\">\n      <h3>Skolans kurser</h3>\n      <div className=\"taskContainer odd-even\">\n        {visibleCourses.map(course =>\n          <div className=\"studentCourse\" key={course.id}>\n            <div className=\"align-horizontal\">\n              <div className=\"horizontalItem top pull-right\">\n                <a className=\"hideItem\" onClick={() => this.hideCourse(course)} />\n              </div>\n              <div className=\"horizontalItem top\">\n                <a href={preserveImpersonationQuery(viewCourseUrl, {courseId: course.id})}>{course.name}</a>\n              </div>\n            </div>\n            <div className=\"horizontalItem top\">\n              <p className=\"small\">{course.description}</p>\n            </div>\n          </div>)}\n      </div>\n\n      <div className={\"openClose\" + (this.state.headerOpen ? \" open\" : \"\")}>\n        <div className=\"openHeader\" onClick={() => this.setState({ headerOpen: !this.state.headerOpen })}>\n          <h5>Dolda kurser</h5>\n        </div>\n        <div className=\"openContent\">\n          <div className=\"taskContainer odd-even\">\n            {hiddenCourses.map(course => \n            <div className=\"studentCourse\" key={course.id}>\n              <div className=\"align-horizontal\">\n                <div className=\"horizontalItem top pull-right\">\n                  <a className=\"showItem\" onClick={() => this.showCourse(course)}></a>\n                </div>\n                <a href={generateQueryString({...query, courseId: course.id})}>{course.name}</a>\n              </div>\n              <div className=\"horizontalItem top\">\n                <p className=\"small\">{course.description}</p>\n              </div>\n            </div>)}\n          </div>\n        </div>\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { LearningModuleTask, TaskList } from './task-list';\n\ninterface Props {\n  commonTasks: LearningModuleTask[]\n  learningGoals: LearningGoal[]\n}\n\nexport interface LearningGoal {\n  name: string;\n  learningTasks: LearningModuleTask[];\n}\n\nexport class LearningGoalsList extends React.Component<Props> {\n  render() {\n    const {commonTasks, learningGoals} = this.props;\n    return <div>{learningGoals.map(lg => <div key={lg.name}>\n      <h5>{lg.name}</h5>\n      <TaskList learningTasks={lg.learningTasks} />\n    </div>)}\n    {commonTasks.length > 0 && <div>\n      {learningGoals.length > 0 && <h5>Övergripande</h5>}\n      <TaskList learningTasks={commonTasks} />\n    </div>}\n    </div>;\n  }\n}","import env from '../globals/KED.env';\nimport cfg from '../globals/KED.cfg';\nimport { isomorphic } from 'kedbackend/clientweb';\nimport { EdsClient } from '../apis/edsclient';\n\nenv.edsClient = new EdsClient (\n  isomorphic,\n  cfg.EDS_API_URL,\n  env.bearerProvider);\n\n","import * as React from 'react';\nimport { users } from '../data/users';\n\nexport function ChooseUser() {\n  let select;\n  return <div className=\"sv-layout\">\n    <h2>Välj användare</h2>\n    <table className=\"login-table\"><thead><tr>\n      <th>Namn</th>\n      <th>Roller</th>\n      <th>E-post</th>\n      <th>Skola</th>\n    </tr></thead>\n      <tbody>\n        {users.map(({ username, displayName, mail, school, roles }) =>\n          <tr key={mail} onClick={() => location.search = `?user=${username}`}>\n            <td>{displayName}</td>\n            <td style={roles.length === 0 ? { fontStyle: 'italic' } : {}}>{roles.length === 0 ? \"saknar roller\" : roles.join(', ')}</td>\n            <td>{mail}</td>\n            <td style={school ? {} : { fontStyle: 'italic' }}>{school || \"saknar skola\"}</td>\n          </tr>\n        )}\n      </tbody></table>\n  </div>\n};\n","var map = {\n\t\"./en-au\": 47,\n\t\"./en-au.js\": 47,\n\t\"./en-ca\": 46,\n\t\"./en-ca.js\": 46,\n\t\"./en-gb\": 45,\n\t\"./en-gb.js\": 45,\n\t\"./en-ie\": 44,\n\t\"./en-ie.js\": 44,\n\t\"./en-nz\": 43,\n\t\"./en-nz.js\": 43,\n\t\"./sv\": 42,\n\t\"./sv.js\": 42\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\tvar module = __webpack_require__(id);\n\treturn module;\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error('Cannot find module \"' + req + '\".');\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 58;","/* These scripts assume some of the global vars have already been set:\n  * KED.cfg\n  * KED.env.currentUser\n\n  The rest will be set here (client side)\n*/\nimport './set-bearer-providers';\nimport './set-ked-backend-client';\nimport './set-eds-client';\n","import cfg from '../globals/KED.cfg';\nimport env from '../globals/KED.env';\n\n/* Contains ENV-based config, replaced using rollup-plugin-replace by its corresponding\n * ENV-variables.\n *\n * See \n*/\ndeclare var process;\n\ncfg.ENVIRONMENT = process.env.ENVIRONMENT; // \"production\", \"development\" or \"test\"\ncfg.KED_TOKEN_PATH = null ; // Must be null in test environment for set-bearer-providers.ts to work accordingly!\ncfg.KED_TOKEN_URL = process.env.KED_TOKEN_URL; // \"https://kedauthtest.azurewebsites.net/token\"\ncfg.KED_CLIENT_ID = process.env.KED_CLIENT_ID; // \"devclient\", \"testclient\", \"...\"\ncfg.KED_CLIENT_SECRET = process.env.KED_CLIENT_SECRET;\ncfg.KED_API_URL = process.env.KED_API_URL; // \"https://kedbackendtest.azurewebsites.net/api/\"\ncfg.EDS_API_URL = process.env.EDS_API_URL; // \"https://edsportalowinapi.azurewebsites.net/api/\"\n\nimport { users } from './data/users';\nimport { parseQueryString } from '../utils/query-string';\nconst username = parseQueryString (location.search).user;\nif (username) {\n  const user = users.find(u => u.username === username);\n  if (user) {\n    env.currentUser = user;\n  }\n}\n\nconst { role, school } = parseQueryString(location.search);\nif (env.currentUser) {\n  if (role) {\n    env.currentUser.roles = role.split(',');\n  }\n  if (school) {\n    env.currentUser.school = school;\n  }\n}\n","import * as React from 'react';\nimport { getLearningGoalsAndTasks, KedLearningGoalsData } from '../../apis/ked-learninggoals';\nimport { LearningModuleTask, TaskList } from '../course-viewer/subcomponents/task-list';\nimport { flatten } from '../../utils/utils';\nimport { LearningGoal, LearningGoalsList } from '../course-viewer/subcomponents/learning-goals-list';\n\ninterface Props {\n  apiPath: string; // \"/4.5667c63115ed6c03790a4c8c/12.1f95a67a15ee31ea1c4447b2.json\"\n  pageId: string; // sv.PageContext.pageId\n}\n\ninterface State {\n  data: KedLearningGoalsData | null\n}\n\nexport class LearningTasks extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      data: null\n    }\n  }\n\n  async componentDidMount() {\n    const data = await getLearningGoalsAndTasks(\n      this.props.apiPath,\n      this.props.pageId);\n\n    this.setState({ data });\n  }\n\n  render() {\n    if (!this.state.data) return <div></div>;\n    const { moduleName, subject, commonTasks, learningGoals, step } = this.state.data;\n    //const step = undefined; // moduleName.toLowerCase().startsWith(\"steg \") && parseInt(moduleName.substr(5));\n    const commonTasksList: LearningModuleTask[] =\n      commonTasks.map(task => ({\n        id: task.id,\n        name: task.name,\n        url: task.url,\n        courseName: subject.name,\n        learningGoal: step && learningGoals.length > 0 ? `${moduleName} - övergripande` : moduleName\n      }));\n      \n    const learningGoalsList: LearningGoal[] = learningGoals.map(learningGoal => ({\n      name: learningGoal.name,\n      learningTasks: learningGoal.tasks.map(task => ({\n        id: task.id,\n        name: task.name,\n        url: task.url,\n        courseName: subject.name,\n        learningGoal: learningGoal.name\n      }))\n    }));\n\n    if (step) {\n      commonTasksList.forEach(task => task.step = step);\n      learningGoalsList.forEach(lg => lg.learningTasks.forEach(task => task.step = step));\n    }\n\n    return <LearningGoalsList\n      commonTasks={commonTasksList}\n      learningGoals={learningGoalsList} />;\n  }\n}\n","\nexport interface KedLearningGoalsData {\n  moduleName: string\n  subject: {\n    name: string\n    course: {\n      name: string\n      url: string\n    }\n  }\n  step?: number\n  commonTasks: KedLearningTask[]\n  learningGoals: KedLearningGoal[]\n}\n\nexport interface KedLearningTask {\n  id: string;\n  name: string;\n  url: string;\n}\n\nexport interface KedLearningGoal {\n  name: string;\n  tasks: KedLearningTask[];\n}\n\nexport async function getLearningGoalsAndTasks(apiPath: string, pageId: string) {\n  const res = await fetch (`${apiPath}?nodeID=${pageId}`, {credentials: \"same-origin\"});\n  const data = await res.json();\n  return data as KedLearningGoalsData;\n}\n","import {KedRepo} from './ked-repo';\nimport { KGTermPlannerWeekPlan } from 'kedbackend/models';\nimport env from '../globals/KED.env';\nimport { getTermStartAndEnd } from '../utils/school-moment';\nimport moment from 'moment';\n\nclass KGTermPlannerRepo extends KedRepo<KGTermPlannerWeekPlan> {\n  constructor() {\n    const now = Date.now();\n    const [termStart, termEnd] = getTermStartAndEnd(moment(now));\n    super({\n      getClient() { return env.kedBackendClient; },\n      optimistic: true,\n      table: \"weekplans\",\n      user: env.currentUser ? env.currentUser.mail : \"\",\n      getQueryOptions: async ()=>{\n        return {\n          from: termStart.valueOf(),\n          to: termEnd.valueOf(),\n          role: \"USER\"\n        }\n      }\n    });\n  }\n}\n\nexport const termPlannerRepo = new KGTermPlannerRepo();\n\n","import * as React from 'react';\nimport { KGTermPlannerWeekPlan, KGTermPlannerWeekPlanEntry } from 'kedbackend/models';\nimport {termPlannerRepo} from '../../repos/kg-termplanner-repo';\nimport { createUUID } from 'kedbackend/client';\n\ninterface Props {\n  weekNumber: number;\n  weekDate: number;\n  courseName: string;\n  weekPlan?: KGTermPlannerWeekPlan;\n  note?: KGTermPlannerWeekPlanEntry;\n  closeDialog: ()=>void;\n}\n\ninterface State {\n  description: string;\n  color: string;\n}\n\nexport class WeekNoteDialog extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      description: props.note ? props.note.description : '',\n      color: props.note ? props.note.color : 'yellow'\n    }\n  }\n\n  async delete() {\n    const { weekNumber, weekDate, courseName, weekPlan, note, closeDialog } = this.props;\n    const { description, color} = this.state;\n\n    closeDialog();\n\n    if (Object.keys(weekPlan.plans).length === 1) {\n      await termPlannerRepo.delete([weekPlan.id]);\n    } else {\n      await termPlannerRepo.update([weekPlan], wp => {\n        delete wp.plans[courseName]\n      });\n    }\n  }\n\n  async save() {\n    const { weekNumber, weekDate, courseName, weekPlan, note, closeDialog } = this.props;\n    const { description, color} = this.state;\n\n    closeDialog();\n\n    if (weekPlan) {\n      await termPlannerRepo.update([weekPlan], wp => wp.plans[courseName] = {description, color});\n    } else {\n      const plans = {};\n      plans[courseName] = {description, color};\n      await termPlannerRepo.insert([{\n        id: createUUID(),\n        dateTime: weekDate,\n        plans\n      }]);\n    }\n  }\n\n  render() {\n    const { weekNumber, courseName, weekPlan, note } = this.props;\n    const { description, color } = this.state;\n    return <div>\n      <div>\n        <h2>Händelse för vecka {weekNumber} och {courseName}</h2>\n        <hr />\n        <div className=\"align-table\">\n          <div>Beskrivning:</div>\n          <div className=\"fullWidth\">\n            <textarea autoFocus value={description} onChange={ev => this.setState({description: ev.target.value})} />\n          </div>\n        </div>\n        <div className=\"align-table\">\n          <div>Färg:</div>\n          <div>\n            <select value={color} onChange={ev => this.setState({color: ev.target.value})}>\n              <option value=\"yellow\">Gul</option>\n              <option value=\"yellowLight\">Ljusgul</option>\n              <option value=\"cyan\">Grön</option>\n              <option value=\"cyanLight\">Ljusgrön</option>\n              <option value=\"purple\">Lila</option>\n              <option value=\"purpleLight\">Ljuslila</option>\n              <option value=\"red\">Röd</option>\n              <option value=\"redLight\">Rosa</option>\n            </select>\n          </div>\n        </div>\n      </div>\n      <div>\n        <button tabIndex={1} className=\"btn btn-large btn-default\" onClick={()=>this.save()}>Spara</button>\n        {note && <a tabIndex={1} className=\"btn btn-warning btn-large pull-right\" onClick={()=>this.delete()}>Ta bort</a>}\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport env from '../../globals/KED.env';\nimport { EDSCourse, EDSStudyPlan } from '../../contracts/eds';\nimport { EDSPeriod } from '../../apis/edsclient';\nimport { getSchoolMoment, getFirstAndLastWeekOfTerm, getTermStartAndEnd } from '../../utils/school-moment';\nimport moment from 'moment';\nimport { Spinner } from '../course-builder/sub-components/spinner';\nimport { KGTermPlannerWeekPlan, KGTermPlannerWeekPlanEntry } from 'kedbackend/models';\nimport { Dialogs } from '../utility-components/dialogs';\nimport { WeekNoteDialog } from './week-note-dialog';\nimport { termPlannerRepo } from '../../repos/kg-termplanner-repo';\nimport { distinct } from '../../utils/utils';\nimport { KEDWeek } from '../../utils/weekutil';\n\ninterface Props {\n}\n\ninterface State {\n  now: Date,\n  courses: EDSCourse[];\n  weekPlans: KGTermPlannerWeekPlan[];\n  isLoadingCourses: boolean;\n  isLoadingWeekPlans: boolean;\n  dialogs: any[];\n  //goals: EDSStudyPlan[];\n}\n\nexport class KGTermPlanner extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    const now = new Date();\n    this.state = {\n      now,\n      courses: [],\n      weekPlans: [],\n      isLoadingCourses: true,\n      isLoadingWeekPlans: true,\n      dialogs: []\n      //goals: []\n    }\n    this.updateWeekPlans = this.updateWeekPlans.bind(this);\n  }\n\n  componentDidMount() {\n    this.loadEDSCourses();\n    termPlannerRepo.mem.subscribe(this.updateWeekPlans);\n  }\n\n  componentWillUnmount() {\n    termPlannerRepo.mem.unsubscribe(this.updateWeekPlans);\n  }\n\n  updateWeekPlans(weekPlans: KGTermPlannerWeekPlan[]) {\n    this.setState({weekPlans, isLoadingWeekPlans: false});\n  }\n\n  async loadEDSCourses() {\n    try {\n      const schoolMoment = getSchoolMoment(moment(this.state.now));\n      const periodName = new EDSPeriod(schoolMoment).period;\n      const courses = distinct(await env.edsClient.getActiveCourses({periodName}), course => course.name);\n      //console.log(\"courses:\" + JSON.stringify(courses, null, 2));\n      this.setState({ courses });\n    } finally {\n      this.setState({ isLoadingCourses: false });\n    }\n  }\n\n  onNoteClick(weekNumber: number, weekDate: number, courseName: string, weekPlan?: KGTermPlannerWeekPlan, note?: KGTermPlannerWeekPlanEntry) {\n    this.openDialog(<WeekNoteDialog\n      weekNumber={weekNumber}\n      weekDate={weekDate}\n      courseName={courseName}\n      weekPlan={weekPlan}\n      note={note}\n      closeDialog={()=>this.closeDialog()} />);\n  }\n\n  openDialog(dialog) {\n    this.setState({ dialogs: [...this.state.dialogs, dialog] });\n  }\n\n  closeDialog() {\n    this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });\n  }\n\n  render() {\n    const { courses, now, isLoadingCourses, isLoadingWeekPlans, weekPlans, dialogs } = this.state;\n    const isLoading = isLoadingCourses || isLoadingWeekPlans;\n\n    const weeks: { weekNumber: number, weekDate: number, weekPlan: KGTermPlannerWeekPlan }[] = [];\n    const schoolMoment = getSchoolMoment(moment(now));\n    const [termStart, termEnd] = getTermStartAndEnd(moment(now));\n    const [firstWeek, lastWeek] = getFirstAndLastWeekOfTerm(schoolMoment.term);\n\n    for (let weekMoment = termStart.clone().startOf('week');\n      weekMoment.valueOf() < termEnd.valueOf();\n      weekMoment = weekMoment.clone().add(1, 'week').startOf('week'))\n    {\n      const weekNumber = weekMoment.week();\n      const kedWeek = KEDWeek(weekMoment.year(), weekNumber);\n      if (weekNumber >= firstWeek && weekNumber <= lastWeek) {\n        const weekPlan = weekPlans.filter(wp =>\n          wp.dateTime >= kedWeek.notBefore &&\n          wp.dateTime <= kedWeek.notAfter)[0];\n\n        weeks.push({\n          weekNumber,\n          weekDate: weekMoment.clone().startOf('week').valueOf(),\n          weekPlan\n        });\n      }\n    }\n\n    return <div className=\"ked_boxed termPlanContainer\">\n      <h4>\n        Terminsplanering\n       </h4>\n      <hr />\n      {isLoading ?\n        <Spinner /> : courses.length === 0 ? <div>\n          Terminsplaneraren aktiveras när du skrivits in på dina kurser\n          </div> : <table className=\"smallFont\">\n            <thead>\n              <tr>\n                <th className=\"nowrap\">Vecka</th>\n                {/*goals.map(({courseUnitId, courseUnitName}) =>\n                  <th key={courseUnitId} className=\"termCourseHeader\">\n                    <div className=\"termCourseText\">{courseUnitName}</div></th>)*/}\n                {\n                  courses.map((c, idx) => <th key={idx} className=\"termCourseHeader\">\n                    <div className=\"termCourseText\">{c.name}</div></th>)\n                }\n              </tr>\n            </thead>\n            <tbody>\n              {weeks.map((w, idx) => \n                <tr key={idx} className={idx % 2 && 'tableOdd'}>\n                  <td>{w.weekNumber}</td>\n                  {courses.map((c,idx) => {\n                    const note = w.weekPlan && w.weekPlan.plans[c.name];\n                    return <td\n                      key={idx}\n                      className=\"courseNote\"\n                      title={note && note.description}\n                      onClick={()=>this.onNoteClick(w.weekNumber, w.weekDate, c.name, w.weekPlan, note)}>\n                      <div\n                        className={`note${note ? ` noted note-color-${note.color}` : ''}`}\n                      />\n                    </td>}\n                  )}\n                </tr>\n              )}\n            </tbody>\n            <tfoot>\n              <tr>\n                <th key=\"points\">Poäng</th>\n                {courses.map((c, idx) => <th key={idx} className=\"stepCell\">{c.credits}</th>)}\n              </tr>\n              <tr>\n                <th>Betygsmål</th>\n                {/*goals.map(g =>\n                <th className=\"stepCell\">{g.periodGoals.filter(pg => pg.periodName ===  period.period)\n                  .map(pg=>pg.gradeName)[0] || g.finalGoalGrade}</th>)*/}\n                {courses.map((c, idx) =>\n                  <th key={idx} className=\"stepCell\">{c.periodGoalGrade}</th>)}\n              </tr>\n            </tfoot>\n          </table>}\n          <Dialogs\n        dialogs={dialogs}\n        popDialog={() => this.setState({ dialogs: dialogs.slice(0, dialogs.length - 1) })} />\n          \n    </div>\n  }\n}","import {EDSStudyPlan} from '../../contracts/eds';\nimport { EDSPeriod } from '../../apis/edsclient';\n\nexport class ViewModel {\n    subjects: Array<{\n        name: string;\n        atGoal: string;\n        stGoal: string;\n        finalGoal: string;\n        strategies: string;\n    }>;\n\n    constructor (studyPlans: EDSStudyPlan[]) {\n        this.subjects = studyPlans.map(sp => {\n            const periodGoals = sp.periodGoals\n                .map(g => ({period: new EDSPeriod(g.periodName), goal: g.gradeName}));\n            return {\n                name: sp.courseUnitName,\n                atGoal: periodGoals.filter (({period})=> period.term === 'AT').map(({goal}) => goal)[0],\n                stGoal: periodGoals.filter (({period})=> period.term === 'ST').map(({goal}) => goal)[0],\n                finalGoal: sp.finalGoalGrade,\n                strategies: sp.strategyText\n            };\n        });\n    }\n}\n","import { EDSStudentFutureAbility } from '../../contracts/eds';\nimport { flatten } from '../../utils/utils';\n\ntype AbilityCell = { type: 'ability', name: string };\ntype CapabCell = { type: 'capability', name: string };\ntype TermCell = { type: 'term', selected: boolean };\ntype Cell = AbilityCell | CapabCell | TermCell;\n\nexport class FutureAbilitiesViewModel {\n  columnHeaders: {name: string, type: string}[];\n  vtHts: string[];\n  capabRows: Cell[][];\n\n  constructor(data: EDSStudentFutureAbility[]) {\n    // Will build the total years\n    const formNames: {[name: string]: true} = {};\n    data.forEach(a => a.capabilities.forEach(c => formNames[c.formName] = true));\n    const years = Object.keys(formNames);\n    \n    // columnHeaders\n    this.columnHeaders = [{\n      name: \"Framtidsförmåga\",\n      type: \"header\"\n    }, {\n      name: \"Område\",\n      type: \"header\"\n    }].concat(years.map(year => ({\n      name: year,\n      type: 'year'\n    })));\n\n    // vtHts\n    this.vtHts = flatten(years.map(year => [\"HT\", \"VT\"]));\n\n    // cababRows\n    const rows: Cell[][] = [];\n    data.forEach(a => {\n      let row: Cell[] = [{type: 'ability', name: a.abilityName}];\n      const addedCapabs : {[name: string]: true} = {};\n      a.capabilities.forEach(c => {\n        const cells: TermCell[] = [\n          {type: 'term', selected: c.htHasValue !== false},\n          {type: 'term', selected: c.vtHasValue !== false}\n        ];\n        //if (c.htHasValue || c.vtHasValue) debugger;\n\n        if (!addedCapabs[c.capabilityName]) {\n          //if (!isFirstCapability) rows.push(row);\n          if (row.length > 1) {\n            rows.push(row);\n            row = [];\n          }\n          addedCapabs[c.capabilityName] = true;\n          row.push({type: 'capability', name: c.capabilityName});\n          cells.forEach(cell => row.push(cell));\n        } else if (row) {\n          //addedCapabs[c.capabilityName].concat(cells);\n          cells.forEach(cell => row.push(cell));\n        }\n      });\n      if (row) rows.push(row);\n    });\n\n    this.capabRows = rows;\n  }\n}","import * as React from 'react';\nimport { EDSStudentFutureAbility } from '../../contracts/eds';\nimport env from '../../globals/KED.env';\nimport { flatten } from '../../utils/utils';\nimport { FutureAbilitiesViewModel } from './future-abilities-viewmodel';\n\ninterface State {\n  loading: boolean,\n  data: EDSStudentFutureAbility[],\n  error: string | null\n}\n\nexport class FutureAbilitiesTable extends React.Component<{}, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      data: [],\n      error: null\n    };\n  }\n\n  componentWillMount() {\n    this.load();\n  }\n\n  async load() {\n    this.setState({ loading: true });\n    try {\n      const data = await env.edsClient.getStudentFutureAbilities();\n      this.setState({ data });\n    } catch (error) {\n      this.setState({ error });\n    }\n    this.setState({ loading: false });\n  }\n\n  render() {\n    const viewModel = new FutureAbilitiesViewModel (this.state.data);\n    const {columnHeaders, vtHts, capabRows} = viewModel;\n\n    return <div>\n      <h5>Framtidsförmågor</h5>\n      <div className=\"partialEditStudyPlanViewMode\">\n        <table style={{ width: '100%' }} className=\"smallFont\">\n          <thead>\n            <tr>{columnHeaders.map(({ name, type }, i) =>\n              type === 'header' ?\n                <th key={i} rowSpan={2}>{name}</th> :\n                <th key={i} colSpan={2}>{name}</th>)}</tr>\n            <tr className=\"header\">\n              {vtHts.map((vtHt, i) => <th key={i}>{vtHt}</th>)}\n            </tr>\n          </thead>\n          <tbody>\n            {capabRows.map((row, i) => <tr key={i} className={(Math.floor(i/3) % 2) && 'tableOdd'}>\n              {row.map((col, i) => col.type === 'ability' ?\n                <td key={i} rowSpan={3} className=\"goalsSubject\">{col.name}</td> :\n                col.type === 'capability' ?\n                  <td key={i} className=\"goalsSubject\">{col.name}</td> :\n                  col.selected ?\n                    <td key={i} className=\"edsSelected\"><div className=\"markedItem\"></div></td> :\n                    <td key={i} />)}\n            </tr>)}\n          </tbody>\n        </table>\n      </div>\n    </div>;\n  }\n}","import * as React from 'react';\nimport { L } from '../../utils/utils';\nimport { ViewModel } from './goals-viewmodel';\nimport env from '../../globals/KED.env';\nimport { EDSStudyPlan } from '../../contracts/eds';\nimport { FutureAbilitiesTable } from './future-abilities-table';\n\ninterface State {\n  loadingStudyPlans: boolean,\n  studyPlans: EDSStudyPlan[],\n  error: string | null\n}\n\nexport class KSGoals extends React.Component<{}, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loadingStudyPlans: false,\n      studyPlans: [],\n      error: null\n    }\n  }\n\n  componentWillMount() {\n    this.load();\n  }\n\n  async load() {\n    this.setState({loadingStudyPlans: true});\n    try {\n      const studyPlans = await env.edsClient.getStudentGoals();\n      this.setState({studyPlans});\n    } catch (error) {\n      this.setState({error});\n    }\n    this.setState({loadingStudyPlans: false});\n  }\n\n  render() {\n    const viewModel = new ViewModel(this.state.studyPlans);\n    const showTermGoals =\n       (''+env.currentUser.schoolType).toLowerCase() !== \"gymnasium\";\n\n    return <div className=\"ked_boxed\">\n      <h4>\n        {L`Mål`}\n      </h4>\n      <hr />\n      <table className=\"smallFont\">\n        <thead>\n          <tr>\n            <th>{L`Ämne`}</th>\n            {showTermGoals && <th>{L`HT`}</th>}\n            {showTermGoals && <th>{L`VT`}</th>}\n            <th>{L`Slutmål`}</th>\n            <th>{L`Strategier`}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {viewModel.subjects.map((s, i) =>\n          <tr key={s.name} className={i % 2 && \"tableOdd\"}>\n            <td className=\"goalsSubject\">{s.name}</td>\n            {showTermGoals && <td className=\"goalsTerm\">{s.atGoal}</td>}\n            {showTermGoals && <td className=\"goalsTerm\">{s.stGoal}</td>}\n            <td className=\"goalsEnd\">{s.finalGoal}</td>\n            <td>{s.strategies}</td>\n          </tr>\n          )}\n        </tbody></table>\n        <div className=\"divider\" />\n        <FutureAbilitiesTable />\n    </div>\n  }\n}\n","import {Term} from '../../contracts/ked-models';\nimport {EDSCourse} from '../../contracts/eds';\n\nexport function getFirstAndLastWeek(term: Term) {\n  return term === 'AT' ?\n    [33, 50] :  // This is a guess! Need data! Should be possible to get from skola24?\n    [2, 23];    // This is a guess! Need data!\n}\n\nexport const LAST_STEP_SPRING = 28; // Week 28 is in summer. Use it as placeholder for \"last step\"\nexport const LAST_STEP_AUTUMN = 52; // Week must be valid. Use it as placeholder for \"last step\"\n\n/**\n * Note that this function is tightly coupled to the swedish school.\n */\nexport function findCourseFromColumnHeader(\n  courses: EDSCourse[],\n  columnHeader: string) : EDSCourse | null\n{\n  switch (columnHeader) {\n    case 'M.spr': return courses\n      .filter(course => course.shortName !== 'MA' && course.shortName.startsWith('M'))[0] || null;\n    case 'Ma': return courses.filter(c => c.shortName === \"MA\")[0] || null;\n    case 'Sv/SvA': return courses.filter(c => c.shortName.startsWith(\"SV\"))[0] || null;\n    case 'Eng': return courses.filter(c => c.shortName === \"EN\")[0] || null;\n  }\n  return null;\n}\n\n/**\n * Note that this function is tightly coupled to the swedish school.\n */\nexport function getColumnHeaderFromCourse(course: EDSCourse) : string\n{\n  const shortName = course.shortName;\n  if (shortName === \"MA\") return 'Ma';\n  if (shortName === \"EN\") return 'Eng';\n  if (shortName.startsWith(\"SV\")) return 'Sv/SvA';\n  if (shortName.startsWith(\"M\")) return 'M.spr';\n  return null;\n}\n","import { KedRepo } from './ked-repo';\nimport { KSTermPlannerWeekPlan } from 'kedbackend/models';\nimport env from '../globals/KED.env';\nimport { getTermStartAndEnd } from '../utils/school-moment';\nimport moment from 'moment';\n\nclass KSTermPlannerRepo extends KedRepo<KSTermPlannerWeekPlan> {\n  now: number;\n\n  async nextTerm() {\n    this.now = moment(this.now).add(6, 'months').valueOf();\n    await this.mem.refreshFromServer();\n  }\n\n  async prevTerm() {\n    this.now = moment(this.now).add(-6, 'months').valueOf();\n    await this.mem.refreshFromServer();\n  }\n\n  constructor() {\n    super({\n      getClient() { return env.kedBackendClient; },\n      optimistic: true,\n      table: \"weekplans-ks\",\n      user: env.currentUser ? env.currentUser.mail : \"\",\n      getQueryOptions: async () => {\n        const [termStart, termEnd] = getTermStartAndEnd(moment(this.now || Date.now()));\n        return {\n          from: termStart.valueOf(),\n          to: termEnd.valueOf(),\n          role: \"USER\"\n        }\n      }\n    });\n    this.now = Date.now();    \n  }\n}\n\nexport const termPlannerRepoKS = new KSTermPlannerRepo();\n","import { KSTermPlannerWeekPlan } from 'kedbackend/models';\nimport { EDSCourse } from '../../contracts/eds';\nimport { EDSPeriod } from '../../apis/edsclient';\nimport { Term } from '../../contracts/ked-models';\nimport {\n  findCourseFromColumnHeader,\n  LAST_STEP_SPRING,\n  LAST_STEP_AUTUMN,\n  getColumnHeaderFromCourse,\n  getFirstAndLastWeek\n} from './termplanner-utils';\nimport { getTermStartAndEnd, getFirstAndLastWeekOfTerm, getSchoolMoment } from '../../utils/school-moment';\nimport moment from 'moment';\nimport { createUUID } from 'kedbackend/client';\nimport { termPlannerRepoKS } from '../../repos/ks-termplanner-repo';\nimport { KEDWeek } from '../../utils/weekutil';\n\nexport class ViewModel {\n  weekPlans: KSTermPlannerWeekPlan[];\n  lastSteps: KSTermPlannerWeekPlan;\n  completedSteps: { [columnHeaderAndstep: string]: true };\n  termGoals: { [columnHeader: string]: string };\n  year: number;\n\n  constructor(\n    dbWeekPlans: KSTermPlannerWeekPlan[],\n    courses: EDSCourse[]) {\n    const nowMoment = moment(termPlannerRepoKS.now);\n    const schoolMoment = getSchoolMoment(nowMoment);\n    const [termStart, termEnd] = getTermStartAndEnd(nowMoment);\n    const [firstWeek, lastWeek] = getFirstAndLastWeekOfTerm(schoolMoment.term);\n    this.year = termStart.year();\n    //\n    // weekPlans\n    //\n    this.weekPlans = [];\n    //let currentCompletedSteps: { [columnHeader: string]: string } = {};\n    for (let weekMoment = termStart.clone().startOf('week');\n      weekMoment.valueOf() < termEnd.valueOf();\n      weekMoment = weekMoment.clone().add(1, 'week').startOf('week'))\n    {\n      const weekNumber = weekMoment.week();\n      if (weekNumber >= firstWeek && weekNumber <= lastWeek) {\n        const kedWeek = KEDWeek(weekMoment.year(), weekNumber);\n        const weekPlan = dbWeekPlans.filter(wp =>\n          wp.dateTime >= kedWeek.notBefore &&\n          wp.dateTime <= kedWeek.notAfter)[0];\n\n        this.weekPlans.push({\n          ...weekPlan || {},\n          id: weekPlan ? weekPlan.id : createUUID(),\n          dateTime: weekPlan ? weekPlan.dateTime : weekMoment.valueOf(),\n          cellValues: weekPlan ? weekPlan.cellValues : {},\n          weekNumber\n        });\n      }\n    }\n\n    //\n    // lastSteps\n    //\n    const lastStepWeek = firstWeek > LAST_STEP_SPRING ? LAST_STEP_AUTUMN : LAST_STEP_SPRING;\n    const lastStepKedWeek = KEDWeek(termStart.year(), lastStepWeek);\n    this.lastSteps = dbWeekPlans.filter(wp =>\n        wp.dateTime >= lastStepKedWeek.notBefore &&\n        wp.dateTime <= lastStepKedWeek.notAfter)[0] || {\n      id: createUUID(),\n      dateTime: moment(nowMoment).clone().week(lastStepWeek).startOf('week').valueOf(),\n      cellValues: {},\n      weekNumber: lastStepWeek\n    };\n\n    this.completedSteps = {};\n    this.termGoals = {};\n    for (const course of courses) {\n      const columnHeader = getColumnHeaderFromCourse(course);\n      //\n      // completedSteps\n      //\n      for (const step of course.courseSteps) {\n        if (step.isCompleted) {\n          this.completedSteps[columnHeader + step.shortName] = true;\n          /*const weekPlans = findWeekPlansByStep(this.weekPlans, step.ShortName);\n          weekPlans.forEach(weekPlan => {\n              this.completedSteps[weekPlan.week + columnHeader] = true;\n          })*/\n        }\n      }\n      //\n      // termGoals\n      //\n      this.termGoals[columnHeader] = course.periodGoalGrade;\n    }\n  }\n}\n\nfunction findWeekPlansByStep(weekPlans: KSTermPlannerWeekPlan[], step: string): KSTermPlannerWeekPlan[] {\n  return weekPlans.filter(wp => Object.keys(wp.cellValues).map(column => wp.cellValues[column] === step));\n}\n","import * as React from 'react';\nimport { SchoolTerm } from '../../utils/school-term';\nimport moment from 'moment';\nimport $ from 'jquery';\nimport { getSchoolMoment } from '../../utils/school-moment';\nimport { L } from '../../utils/utils';\nimport {Term} from '../../contracts/ked-models';\nimport {EDSPeriod} from '../../apis/edsclient';\nimport {EDSCourse} from '../../contracts/eds';\nimport {getFirstAndLastWeek, LAST_STEP_AUTUMN, LAST_STEP_SPRING} from './termplanner-utils';\nimport {ViewModel} from './viewmodel';\nimport {RenameableText} from '../utility-components/renameable-text';\nimport {tableWalk} from '../../utils/table-walk';\nimport env from '../../globals/KED.env';\nimport { KSTermPlannerWeekPlan } from 'kedbackend/models';\nimport { termPlannerRepoKS } from '../../repos/ks-termplanner-repo';\n\ninterface Props {\n  initialDate: Date;\n  locale: string;\n}\n\ninterface State {\n  schoolTerm: SchoolTerm;\n  weekPlans: KSTermPlannerWeekPlan[];\n  activeCourses: EDSCourse[];\n  loadingWeekPlans: boolean;\n  loadingActiveCourses: boolean;\n  error: Error | null;\n}\n\n\nexport class KSTermPlanner extends React.Component<Props,State> {\n  table: HTMLTableElement;\n  flowId: number;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      schoolTerm: new SchoolTerm(props.initialDate),\n      activeCourses: [],\n      weekPlans: [],\n      error: null,\n      loadingActiveCourses: false,\n      loadingWeekPlans: false\n    }\n    this.flowId = 1;\n    this.updateWeekPlans = this.updateWeekPlans.bind(this);\n  }\n\n  componentWillMount() {\n    this.load(this.state.schoolTerm);\n  }\n\n  componentDidMount() {\n    tableWalk($(this.table));\n    termPlannerRepoKS.mem.subscribe(this.updateWeekPlans);\n  }\n\n  componentWillUnmount() {\n    termPlannerRepoKS.mem.unsubscribe(this.updateWeekPlans);\n  }  \n\n  updateWeekPlans(weekPlans: KSTermPlannerWeekPlan[]) {\n    this.setState({weekPlans, loadingWeekPlans: false});\n  }\n\n  load(schoolTerm: SchoolTerm) {\n    const flowId = ++this.flowId;\n    this.setState({\n      schoolTerm,\n      //loadingWeekPlans: true,\n      loadingActiveCourses: true\n    });\n    /*this.loadWeekPlans(schoolTerm).then(weekPlans => {\n      if (this.flowId === flowId) {\n        this.setState({weekPlans, loadingWeekPlans: false});\n      }\n    }).catch(error => {\n      if (this.flowId === flowId) {\n        this.setState({loadingWeekPlans: false, error});  \n      }\n    });*/\n    this.loadActiveCourses(schoolTerm).then(activeCourses => {\n      if (this.flowId === flowId) {\n        this.setState({activeCourses, loadingActiveCourses: false});\n      }\n    }).catch(error => {\n      if (this.flowId === flowId) {\n        this.setState({loadingActiveCourses: false, error});  \n      }\n    });\n  }\n\n  async loadActiveCourses(schoolTerm: SchoolTerm) {\n    const periodName = new EDSPeriod(schoolTerm).period;\n    const activeCourses = await env.edsClient.getActiveCourses({periodName});\n    return activeCourses;\n  }\n\n  async updateCell (weekPlan: KSTermPlannerWeekPlan, columnName: string, newValue: string) {\n    try {\n      weekPlan.cellValues[columnName] = newValue;\n      return await termPlannerRepoKS.upsert (weekPlan, wp => wp.cellValues[columnName] = newValue);\n    } catch (error) {\n      console.error(error.stack || error);\n      this.setState({error: L`För tillfället problem att spara data. Dina ändringar sparades inte.`});\n    }\n  }\n\n  render() {\n    const model = new ViewModel(\n      this.state.weekPlans,\n      this.state.activeCourses);\n\n    const {completedSteps, lastSteps, termGoals, weekPlans} = model;\n    const courseColumns = [\"M.spr\", \"Ma\", \"Sv/SvA\", \"Eng\"];\n    const lastTrDatas = [];\n\n    return <div className={\n        \"termplanner\" + \n        (this.state.loadingWeekPlans ? \" loading-weekplans\" : \"\") +\n        (this.state.loadingActiveCourses ? \" loading-courses\" : \"\")\n      }>\n      <div className=\"ked_boxed\">\n        <div className=\"weekSelect\">\n          <div className=\"horizontalItem\">\n            <p>{this.state.schoolTerm.toLocaleString([this.props.locale], true)}</p>\n          </div>\n          <div className=\"horizontalItem\">\n            <div className=\"btn-group\">\n              <button className=\"btn\" onClick={() => {\n                  this.load(this.state.schoolTerm.prevTerm());\n                  termPlannerRepoKS.prevTerm();\n              }\n              }>\n                <i className=\"fa fa-angle-left\" aria-hidden=\"true\"></i>\n              </button>\n              <button className=\"btn\" onClick={() => {\n                this.load(this.state.schoolTerm.nextTerm())\n                termPlannerRepoKS.nextTerm();\n              }\n              }>\n                <i className=\"fa fa-angle-right\" aria-hidden=\"true\"></i>\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <h4>\n          {L`Terminsplanering`}\n        </h4>\n        <hr />\n        <table className=\"smallFont termplanner-table\" ref={table => this.table = table} style={{\n        }}>\n          <thead>\n            <tr>\n              <th className=\"nowrap\">{L`Vecka`}</th>\n              <th className=\"nowrap\">{L`M.spr`}</th>\n              <th className=\"nowrap\">{L`Ma`}</th>\n              <th className=\"nowrap\">{L`Sv/SvA`}</th>\n              <th className=\"nowrap\">{L`Eng`}</th>\n              <th className=\"nowrap\">{L`Kurs`}</th>\n              <th>{L`Kommentar`}</th></tr>\n          </thead>\n          <tbody>\n            {model.weekPlans.map((weekPlan, i) => {\n              const {cellValues, dateTime, weekNumber} = weekPlan;\n              const week = weekNumber;\n              let rtxts = [];\n              return <tr key={model.year + ':' + week} className={i % 2 ? \"tableOdd\" : \"\"}>\n              <td>{week}</td>\n              <td className={\"stepCell\" + (completedSteps[\"M.spr\" + cellValues[\"M.spr\"]] ? \" completedStep\" : \"\")}\n                onClick={()=>rtxts[0].rename()}>\n                <RenameableText\n                  ref={rt=>rtxts.push(rt)}\n                  tag=\"input\"\n                  text={cellValues[\"M.spr\"]}\n                  onChange={this.updateCell.bind(this, weekPlan, \"M.spr\")}\n                  readOnly={this.state.loadingWeekPlans}\n                />\n              </td>\n              <td className={\"stepCell\" + (completedSteps[\"Ma\" + cellValues[\"Ma\"]] ? \" completedStep\" : \"\")}\n                onClick={()=>rtxts[1].rename()}>\n                <RenameableText\n                  ref={rt=>rtxts.push(rt)}\n                  text={cellValues[\"Ma\"]}\n                  onChange={this.updateCell.bind(this, weekPlan, \"Ma\")}\n                  readOnly={this.state.loadingWeekPlans}\n                />\n              </td>\n              <td className={\"stepCell\" + (completedSteps[\"Sv/SvA\" + cellValues[\"Sv/SvA\"]] ? \" completedStep\" : \"\")}\n                onClick={()=>rtxts[2].rename()}>\n                <RenameableText\n                  ref={rt=>rtxts.push(rt)}\n                  text={cellValues[\"Sv/SvA\"]}\n                  onChange={this.updateCell.bind(this, weekPlan, \"Sv/SvA\")}\n                  readOnly={this.state.loadingWeekPlans}\n                />\n              </td>\n              <td className={\"stepCell\" + (completedSteps[\"Eng\" + cellValues[\"Eng\"]] ? \" completedStep\" : \"\")}\n                onClick={()=>rtxts[3].rename()}>\n                <RenameableText\n                  ref={rt=>rtxts.push(rt)}\n                  text={cellValues[\"Eng\"]}\n                  onChange={this.updateCell.bind(this, weekPlan, \"Eng\")}\n                  readOnly={this.state.loadingWeekPlans}\n                />\n              </td>\n              <td className=\"courseCell\"\n                onClick={()=>rtxts[4].rename()}>\n                <RenameableText\n                  ref={rt=>rtxts.push(rt)}\n                  text={cellValues[\"Kurs\"]}\n                  onChange={this.updateCell.bind(this, weekPlan, \"Kurs\")}\n                  readOnly={this.state.loadingWeekPlans}\n                />\n              </td>\n              <td onClick={()=>rtxts[5].rename()}>\n                <RenameableText\n                  ref={rt=>rtxts.push(rt)}\n                  text={cellValues[\"Kommentar\"]}\n                  tag=\"textarea\"\n                  onChange={this.updateCell.bind(this, weekPlan, \"Kommentar\")} />\n              </td></tr>\n            }\n            )}\n          </tbody>\n          <tfoot>\n            <tr>\n              <th>{L`Slutsteg`}</th>\n              <th className=\"stepCell\" onClick={()=>lastTrDatas[0].rename()}>\n                <RenameableText\n                  ref={rt => lastTrDatas.push(rt)}\n                  text={lastSteps.cellValues[\"M.spr\"]}\n                  onChange={this.updateCell.bind(this, model.lastSteps, \"M.spr\")}\n                  readOnly={this.state.loadingWeekPlans}\n               />\n              </th>\n              <th className=\"stepCell\" onClick={()=>lastTrDatas[1].rename()}>\n                <RenameableText\n                  ref={rt => lastTrDatas.push(rt)}\n                  text={lastSteps.cellValues[\"Ma\"]}\n                  onChange={this.updateCell.bind(this, model.lastSteps, \"Ma\")}\n                  readOnly={this.state.loadingWeekPlans}\n                />\n              </th>\n              <th className=\"stepCell\" onClick={()=>lastTrDatas[2].rename()}>\n                <RenameableText\n                  ref={rt => lastTrDatas.push(rt)}\n                  text={lastSteps.cellValues[\"Sv/SvA\"]}\n                  onChange={this.updateCell.bind(this, model.lastSteps, \"Sv/SvA\")}\n                  readOnly={this.state.loadingWeekPlans}\n                 />\n              </th>\n              <th className=\"stepCell\" onClick={()=>lastTrDatas[3].rename()}>\n                <RenameableText\n                  ref={rt => lastTrDatas.push(rt)}\n                  text={lastSteps.cellValues[\"Eng\"]}\n                  onChange={this.updateCell.bind(this, model.lastSteps, \"Eng\")}\n                  readOnly={this.state.loadingWeekPlans}\n                />\n              </th>\n              <th>-</th>\n              <th></th>              \n            </tr>\n            <tr>\n              <th>{L`Terminsmål`}</th>\n              <th className=\"stepCell\">{termGoals[\"M.spr\"]}</th>\n              <th className=\"stepCell\">{termGoals[\"Ma\"]}</th>\n              <th className=\"stepCell\">{termGoals[\"Sv/SvA\"]}</th>\n              <th className=\"stepCell\">{termGoals[\"Eng\"]}</th>\n              <th>-</th>\n              <th>{this.state.error && <p className=\"error\">{''+this.state.error}</p>}</th>\n            </tr>\n          </tfoot>\n          </table>\n      </div>\n    </div>\n      }\n}\n","import $ from 'jquery';\n\nexport function tableWalk(tableElem: HTMLTableElement) {\n    $(tableElem).keydown(ev => {\n        const target = $(ev.target);\n\n        if (ev.which === 13 && !target.is('textarea')) {\n            var tabables = $(tableElem)\n                .find('[tabIndex=0]:visible:not([type=checkbox])').toArray() as any[];\n\n            var i = tabables.indexOf(ev.target);\n            if (i !== -1) {\n                var nextElement = tabables[(i + 1) % tabables.length];\n                $(nextElement).focus();\n            }\n        } else if (ev.which == 38 || ev.which == 40) { // up or down\n            var isUp = (ev.which == 38);\n            var td = target.closest('td,th');\n            var tr = td.closest('tr');\n            var index = tr.children().toArray().indexOf(td[0]);\n            let allTrs = $(tableElem).find('tr').toArray();\n            let trIndex = allTrs.indexOf(tr[0]);\n            var nextTr;\n            if (isUp && trIndex > 0 && (!target.is('textarea') || target[0].selectionStart === 0)) {\n                nextTr = $(allTrs[trIndex - 1]);\n            } else if (!isUp && trIndex > -1 && trIndex < allTrs.length - 1 && (!target.is('textarea') || target[0].selectionEnd === target.val().length)) {\n                nextTr = $(allTrs[trIndex + 1]);\n            }\n            if (nextTr) {\n                nextTr.children().eq(index).find('[tabIndex=0]').focus();\n                ev.stopPropagation();\n                ev.preventDefault();\n            }\n        } else if (ev.which === 37 || ev.which === 39) { // left or right\n            if (target.is(':input')) {\n                const {selectionStart, selectionEnd, value} = target[0];\n                if (selectionStart === selectionEnd) {\n                    var tabables = $(tableElem)\n                        .find('[tabIndex=0]:visible:not([type=checkbox])').toArray() as any[];\n\n                    var i = tabables.indexOf(ev.target);\n                    if (i !== -1 && i > 0 && ev.which === 37 && selectionStart === 0) { // left\n                        let prevElement = tabables[i - 1];\n                        $(prevElement).focus();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                    } else if (i !== -1 && i < tabables.length - 1 && ev.which === 39 && selectionEnd === value.length) { // right\n                        let nextElement = tabables[i + 1];\n                        $(nextElement).focus();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                    }\n                }\n            }\n        }\n    });\n}\n","\nexport const SECOND = 1000;\nexport const MINUTE = SECOND * 60;\nexport const HOUR = MINUTE * 60;\n\n","import * as React from 'react';\nimport moment from 'moment';\nimport {MINUTE} from '../../utils/constants';\nimport {L} from '../../utils/utils';\n\ninterface Props {\n    id: string,\n    dayStart,\n    startMoment: moment.Moment,\n    endMoment: moment.Moment,\n    text: string,\n    location: string,\n    description: string,\n    width: number,\n    pos: number,\n    locale: string,\n    zoom: number,\n    htmlLink: string,\n    className: string\n}\n\nexport default function DayViewEvent ({\n    id,\n    dayStart,\n    startMoment,\n    endMoment,\n    text,\n    location,\n    description,\n    width,\n    pos,\n    locale,\n    zoom,\n    htmlLink,\n    className\n}: Props) {\n    const top = (moment(startMoment).diff(dayStart) / MINUTE) * zoom;\n    const height = (moment(endMoment).diff(startMoment) / MINUTE) * zoom;\n    const localeTimeOptions = {hour: 'numeric', minute: '2-digit'};\n    const localeStartTime = startMoment.toDate().toLocaleTimeString(locale, localeTimeOptions);\n    const localeEndTime = endMoment.toDate().toLocaleTimeString(locale, localeTimeOptions);\n\n    return <div className={\"dayviewevent \" + className} style={{\n        position:'absolute',\n        boxSizing: 'border-box',\n        top,\n        left: (pos || 0) + \"%\",\n        width: (width || 100) + '%',\n        height,\n        maxHeight: height,\n        overflow: 'hidden'}}\n\n        title={`${localeStartTime} - ${localeEndTime} ${text}` +\n            (location ?\n                \"\\n\" + L`Plats: ${location}` :\n                \"\" ) +\n            (description ?\n                \"\\n\" + description :\n                \"\" )\n        }\n        >\n        <a className=\"event-title\" href={htmlLink} target=\"calendar-event\">\n            {text}\n        </a>\n        <p className=\"event-period\">\n            {localeStartTime} - {localeEndTime}\n        </p>\n        {location &&\n            <p className=\"event-location\">\n                {location}\n            </p>\n        }\n        {description &&\n            <p className=\"event-description\">\n                {description}\n            </p>\n        }\n    </div>;\n}\n","import * as React from 'react';\nimport moment from 'moment';\n\nexport default function TimeLines ({dayStart, dayEnd, zoom}) {\n    const hourPixels = 60 * zoom;\n    const startHour = moment(dayStart).hour();\n    const endHour = moment(dayEnd).hour();\n\n    const hours = [];\n    for (let hour = startHour; hour <= endHour; ++hour) {\n        hours.push(hour);\n    }\n\n    return <div>\n        {hours.map(hour => \n            <div key={hour} className=\"timeline\" style={{\n                width: '100%',\n                boxSizing: 'border-box',\n                margin: `${hourPixels / 2}px 0 0 0`,\n                height: hourPixels / 2\n        }} /> )}\n    </div>;\n}\n","import * as React from 'react';\nimport moment from 'moment';\nimport DayViewEvent from './day-view-event';\nimport TimeLines from './time-lines';\nimport {MINUTE} from '../../utils/constants';\nimport {crunchCollidingEvents} from './crunch-colliding-events';\nimport { StudentCalendarEvent } from './models';\n\ninterface Props {\n    dayStart: moment.Moment;   // Milliseconds at start of the day (for example 08:00 the day)\n    dayEnd: moment.Moment;     // Milliseconds at end of the day (for example 17:00 the day)\n    events: StudentCalendarEvent[],     // Events to show\n    locale: string,\n    zoom: number,\n    isLastCall: boolean\n}\n\nexport default function DayView ({\n    dayStart,   // Milliseconds at start of the day (for example 08:00 the day)\n    dayEnd,     // Milliseconds at end of the day (for example 17:00 the day)\n    events,     // Events to show\n    locale,\n    zoom,\n    isLastCall\n}: Props) {\n    const height = (moment(dayEnd).diff(dayStart) / MINUTE) * zoom;\n\n    const crunchedEvents = crunchCollidingEvents(events, isLastCall);\n\n    return (\n        <div className=\"dayview\" style={{\n            top: 0,\n            height,\n            maxHeight: height,\n            position: 'relative',\n            overflow: 'hidden'\n        }}>\n\n            <TimeLines dayStart={dayStart} dayEnd={dayEnd} zoom={zoom} />\n\n            {crunchedEvents.map (ev => <DayViewEvent\n                key={ev.id}\n                id={ev.id}\n                className={ev.className}\n                dayStart={dayStart}\n                startMoment={ev.startMoment}\n                endMoment={ev.endMoment}\n                text={ev.text}\n                location={ev.location}\n                description={ev.description}\n                width={ev.width}\n                pos={ev.pos}\n                locale={locale}\n                zoom={zoom}\n                htmlLink={ev.htmlLink}\n            />)}\n        </div>\n    );\n}\n\n","import moment from 'moment';\nimport { flatten, distinct, compareProp } from '../../utils/utils';\nimport { StudentCalendarEvent } from './models';\n\ninterface EventMeta {\n  index?: number,\n  prevOverlaps?: StudentCalendarEvent[]  \n}\n\nexport function crunchCollidingEvents (\n  events: StudentCalendarEvent[],\n  isLastCall?: boolean)\n: StudentCalendarEvent[]\n{\n  const result: (StudentCalendarEvent & EventMeta)[] = [];\n  events.forEach((event, eventIndex) => {\n      const overlaps = result.filter(x => x.startMoment && x.endMoment &&\n          (x.startMoment <= event.startMoment) &&\n          (x.endMoment > event.startMoment));\n      let allOverlaps = overlaps.concat(flatten (overlaps.map(o => o.prevOverlaps)));\n      allOverlaps = distinct(allOverlaps, o => o.index);\n      allOverlaps.sort(compareProp(\"startMoment\"));\n      let width;// = Math.round(100 / Math.max((allOverlaps.length + 1), 1));\n      let pos = 0;\n      allOverlaps.forEach((overlap, i) => {\n        if (i % 4 === 0) {\n          width = Math.max(25, Math.round(100 / Math.max(allOverlaps.length - i + 1, 1)));\n          pos = 0;\n        }\n        overlap.width = width;\n        overlap.className = (overlap.className || \"\").split(' ')\n          .filter(cn => cn !== 'splitted')\n          .concat(\"splitted\")\n          .join(' '),\n        overlap.pos = pos;\n        pos += width;\n      });\n      result.push({\n        ...event,\n        index: eventIndex,\n        pos: pos,\n        width,\n        className: width < 100 ?\n          (event.className ? event.className + \" splitted\" : \"splitted\") :\n          event.className,\n        prevOverlaps: allOverlaps\n      });\n      /*if (isLastCall && moment(event.start).day() === 1) {\n        if (/Sve2/.test(event.text)) {\n          debugger;\n        }\n        if (/Franska/.test(event.text)) {\n          debugger;\n        }\n        if (/Tyska/.test(event.text)) {\n          debugger;\n        }\n        if (/spansk/.test(event.text)) debugger;\n        if (/Eng6/.test(event.text)) debugger;\n      }*/\n  });\n  return result;\n}\n","import * as React from 'react';\nimport moment from 'moment';\n\nexport default function HourMarker ({startHour, endHour, locale, zoom}) {\n    const hourPixels = 60 * zoom;\n\n    const hours = [];\n    for (let hour = startHour; hour <= endHour; ++hour) {\n        hours.push(hour);\n    }\n\n    return <div className=\"hourmarker\" style={{\n        position: 'relative',\n        left: 0,\n        top: 0,\n        overflow: 'visible',\n        height: (endHour - startHour) * hourPixels\n    }}>\n      {hours.map((hour, i) => {\n        const ypos = i * hourPixels;\n        return <span key={hour}><div style={{\n                position: 'absolute',\n                left: 0,\n                top: ypos,\n                marginTop: '-4px', // CSS!\n                padding: 0\n            }}>\n                {moment().hour(hour).minute(0).toDate().toLocaleString(locale, {hour: \"2-digit\", minute: \"2-digit\"})}\n            </div>\n            {/*<div className=\"hourline\"\n                style={{\n                    backgroundColor: '#eeeeF2', // CSS!\n                    position: 'absolute',\n                    left: '24px',\n                    width: '6px',\n                    margin: 0,\n                    padding: 0,\n                    height: '1px',\n                    top: ypos\n                }}\n            />\n            {hour < endHour && <div className=\"halvhourline\"\n                style={{\n                    backgroundColor: '#eeeeF2', // CSS!\n                    position: 'absolute',\n                    left: '26px',\n                    width: '4px',\n                    margin: 0,\n                    padding: 0,\n                    height: '1px',\n                    top: ypos + (hourPixels / 2) + 1\n            }} /> } */}\n        </span>;\n    })}</div>;\n}\n","import * as React from 'react';\n\nexport default function StatusBar ({status, error}) {\n    if (!status && !error) return null;\n    return <div className=\"statusbar\">\n        {error ?\n            <p className=\"error\">{''+error}</p> :\n            <p className=\"status\">{status}</p>}\n    </div>\n}\n","import * as React from 'react';\nimport moment from 'moment';\nimport DayView from './day-view';\nimport HourMarker from './hour-marker';\nimport {capitalizeFirst, clone, L} from '../../utils/utils';\nimport StatusBar from './status-bar';\nimport { StudentCalendarEvent, DayData } from './models';\n\ninterface Props {\n    firstDay: moment.Moment,  // {moment} The day to start with (normally a monday)\n    startHour: number, // {number} The hour to start on\n    endHour: number,   // {number} The hour to end rendering per day\n    numDays: number,   // {number} Number of days, normally 5.\n    events: StudentCalendarEvent[],    // Array of events to display in the week.\n    locale: string,    // Locale to use for showing week days and hour marks.\n    zoom: number,      // {number} Zoom where 1 means that 1 minute = 1 pixel.  \n    status?: string,\n    error?: Error\n}\n\nexport default class WeekView extends React.Component<Props> {\n    render () {\n        // Props:\n        const {\n            firstDay,  // {moment} The day to start with (normally a monday)\n            startHour, // {number} The hour to start on\n            endHour,   // {number} The hour to end rendering per day\n            numDays,   // {number} Number of days, normally 5.\n            events,    // Array of events to display in the week.\n            locale,    // Locale to use for showing week days and hour marks.\n            zoom,      // {number} Zoom where 1 means that 1 minute = 1 pixel.  \n            status,\n            error\n        } = this.props;\n\n        // Prepare DayView datas \n        const dayDatas: DayData[] = [];\n        let day = moment(firstDay);\n        for (let i=0;i<numDays; ++i) {\n            const dayStart = moment(day).hour(startHour);\n            const dayEnd = moment(day).hour(endHour);\n            const dayDate = moment(day).format('YYYY-MM-DD');\n            const isToday = moment(dayStart).startOf(\"day\").valueOf() === moment().startOf(\"day\").valueOf();\n            dayDatas.push({\n                name: capitalizeFirst(dayStart.toDate().toLocaleString(locale, {\n                    weekday: 'long',\n                    day:'numeric',\n                    month: 'short'})),\n                dayStart,\n                dayEnd,\n                isToday,\n                events: events.filter(event =>\n                    event.start && event.end && event.start.dateTime && event.end.dateTime &&\n                    (moment(event.start.dateTime).isBetween(dayStart, dayEnd) ||\n                     moment(event.end.dateTime).isBetween(dayStart, dayEnd)))\n                     // Change start / end to directly point to the dateTime\n                     .map(event => clone(event, {startMoment: moment(event.start.dateTime), endMoment: moment(event.end.dateTime)}))\n                     .sort((a,b) => a.startMoment.valueOf > b.startMoment.valueOf ? 1 : a.startMoment < b.startMoment ? -1 : 0),\n                fullDayEvents: events.filter(event =>\n                    // Verify that it is a full-day-event\n                    event.start && event.end && event.start.date && event.end.date &&\n                    // Verify it applies to current day\n                    (event.start.date <= dayDate && event.end.date > dayDate)) \n                     // Change start / end to directly point to the date object\n                    .map(event => clone(event, {\n                        startDate: event.start.date,\n                        endDate: event.end.date}))\n            });\n            day = moment(day) // clone it\n                .add(1, 'days'); // Add another day\n        }\n\n        // Render\n        return <div className=\"vemendo-weekview\">\n          <table><tbody>\n            <tr>\n                <td style={{border: 0}}></td>\n                {dayDatas.map(d => <td key={d.dayStart.toISOString()} className={d.isToday ? \"today\" : null}>\n                    <p className=\"dayname\">{d.name}</p>\n                </td>)}\n            </tr><tr>\n                <td style={{border: 0}}><p className=\"week-number\">{L`V${moment(firstDay).week()}`}</p></td>\n                {dayDatas.map(day =>\n                    <td key={day.dayStart.toISOString()} className={day.isToday ? \"today\" : null}>\n                        {day.fullDayEvents.map(({id, text, location, description, htmlLink, className}) =>\n                            <div key={id} className={\"dayviewevent full-day \" + className}\n                                title={`${text}` + (location ?\n                                    \"\\n\" + L`Plats: ${location}` :\n                                    \"\") +\n                                    (description ?\n                                        \"\\n\" + description :\n                                        \"\")}\n                            >\n                                <a className=\"event-title\" href={htmlLink} target=\"calendar-event\">\n                                    {text}\n                                </a>\n                                {location &&\n                                    <p className=\"event-location\">\n                                        {location}\n                                    </p>\n                                }\n                                {description &&\n                                    <p className=\"event-description\">\n                                        {description}\n                                    </p>                                \n                                }\n                            </div>\n                        )}\n                    </td>\n                )}\n            </tr><tr>\n            <td style={{border: 0}}>\n                <HourMarker\n                    startHour={startHour}\n                    endHour={endHour}\n                    locale={locale}\n                    zoom={zoom} />\n            </td>\n                {dayDatas.map(day => <td key={day.dayStart.toISOString()} className={day.isToday ? \"today\" : null}><DayView\n                    key={day.dayStart.toISOString()}\n                    dayStart={day.dayStart}\n                    dayEnd={day.dayEnd}\n                    events={day.events}\n                    locale={locale}\n                    zoom={zoom}\n                    isLastCall={status == ''} /> </td>)}\n            </tr>\n            {\n                (status || error) && (!error || error.name !== \"UnauthorizedError\") &&\n                    //\n                    // Show status / error\n                    //\n                    <tr><td style={{border: 0}}></td><td style={{border: 0}} colSpan={numDays}>\n                        <StatusBar status={status} error={error} />\n                    </td></tr>\n            }\n          </tbody></table>\n        </div>\n    }\n}","/// <reference path=\"../../typings-gapi/gapi.client.calendar-v3/gapi.client.calendar.d.ts\" />\nimport env from '../globals/KED.env';\n//const SCOPES = [\"https://www.googleapis.com/auth/calendar.readonly\"];\n\n/*global gapi */\n\nexport class GoogleCalendar {\n  tokenExpiration: Date;\n\n  async ensureInited() {\n    // Load GAPI\n    if (typeof gapi === 'undefined') await this.loadGapi();\n    // Set token\n    if (!this.tokenExpiration || this.tokenExpiration < new Date()) {\n      const tokenResult = await env.googleTokenProvider.getBearer();\n      this.tokenExpiration = new Date(tokenResult.expires);\n      gapi.auth.setToken({\n        access_token: tokenResult.token,\n        error: null,\n        expires_in: '' + (tokenResult.expires - Date.now()),\n        state: \"https://www.googleapis.com/auth/calendar.readonly\"\n      });\n    }\n    // Load Calendar API\n    await gapi.client.load('calendar', 'v3');\n  }\n\n  loadGapi() {\n    return new Promise((resolve, reject) => {\n      if (typeof gapi !== 'undefined') return resolve();\n      const script = document.createElement('script');\n      script.src = \"https://apis.google.com/js/client.js?onload=gaapi_loaded\";\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\n      (window as any).gaapi_loaded = resolve;\n    });\n  }\n\n  // https://stackoverflow.com/questions/21168688/google-oauth2-using-externally-generated-access-token-with-js-client-library\n  // https://developers.google.com/api-client-library/javascript/reference/referencedocs#gapiclientsettokentokenobject\n  /*gapi.auth.setToken({\n      access_token: 'accessToken?',\n      expires_in: \"3600\",\n      state: \"https://www.googleapis.com/auth/calendar.readonly\"\n  })*/\n\n  async listCalendars() {\n    await this.ensureInited();\n    try {\n      const res = await gapi.client.calendar.calendarList.list({});\n      // TODO: What is the normal res.status? 200? Throw if not 200?\n      return res.result.items;\n    } catch (err) {\n      // TODO: Parse out error from err (which is an object!)\n      throw err.error; // Is this correct? Test!\n    }\n  }\n\n  async listEvents({ calendarId, timeMin, timeMax }) {\n    await this.ensureInited();\n    try {\n      const res = await gapi.client.calendar.events.list({\n        'calendarId': calendarId || 'primary',\n        'timeMin': timeMin && (new Date(timeMin)).toISOString(),\n        'timeMax': timeMax && (new Date(timeMax)).toISOString(),\n        'showDeleted': false,\n        'singleEvents': true,\n        'maxResults': 2500,\n        'orderBy': 'startTime'\n      });\n      // TODO: Check res.status same way as above!\n      return res.result.items;\n    } catch (err) {\n      throw err.error;// Is this correct? Test!\n    }\n  }\n}\n","import * as React from 'react';\nimport WeekView from './week-view';\nimport {GoogleCalendar} from '../../apis/google-calendar';\nimport moment from 'moment';\nimport {clone, flatten, L} from '../../utils/utils';\nimport StatusBar from './status-bar';\nimport {courseNameToCssClass} from './course-name-to-css-class';\nimport {shouldIncludeCalendar} from './should-include-calendar';\nimport { localMoment } from '../../globals/moment-sv-locale';\n\ninterface Props {\n    locale: string;\n    //firstDay: moment.Moment;\n    numDays: number;\n    initialStartHour: number;\n    initialEndHour: number;\n    initialZoom: number;\n}\n\ninterface State {\n    firstDay: moment.Moment,\n    startHour: number,\n    endHour: number,\n    zoom: number,\n    calendars: {[calendarId: string]: {\n        calendar: gapi.client.calendar.CalendarListEntry,\n        events: gapi.client.calendar.Event[] }},\n    calendarsBeingLoaded: string[],\n    status: string,\n    error: Error | null \n}\n\nexport class Calendar extends React.Component<Props, State> {\n    gcal: GoogleCalendar;\n\n    constructor (props) {\n        super(props);\n        // Props\n        const firstDay = localMoment().startOf('week').weekday(0);\n        const {\n            initialStartHour,\n            initialEndHour,\n            initialZoom\n        } = this.props;\n        \n        // State\n        this.state = {\n            firstDay: firstDay,\n            startHour: initialStartHour,\n            endHour: initialEndHour,\n            zoom: initialZoom,\n            calendars: {},\n            calendarsBeingLoaded: [],\n            status: 'Loading calendars... (authenticating...)',\n            error: null\n        };\n\n        this.gcal = new GoogleCalendar();\n\n        // Start calling on Google API right away. Store promise in property.\n        this.gcal.ensureInited().then(()=>{\n            return this.loadData(firstDay);\n        }).catch (error => {\n            this.handleError(error);\n        });\n    }\n\n    handleError(error) {\n        if (!error) error = \"Unknown error\";\n        this.setState({error});\n        console.error (error.stack || error); // Keep!\n    }\n\n    loadData(firstDay) {\n        // Props\n        const {numDays} = this.props;\n        \n        this.setState({\n            firstDay,\n            calendars: {},\n            calendarsBeingLoaded: [],\n            error: null,\n            status: 'Loading calendars... (listing...)'\n        });\n\n        // Important to return the Promise so that caller will catch any error.\n        return this.gcal.listCalendars().then(calendars => {\n            // Ignore the \"week numbers\" calendar as we already include week numbers in our view\n            calendars = calendars.filter(cal => shouldIncludeCalendar(cal));\n            //!/Week Numbers/ig.test(c.summary)\n\n            //console.log(calendars.map(c => ({bgColor: c.backgroundColor, primary: c.primary, summary: c.summary, x: c})));\n            // Calendars Successfully listed.\n            this.setState({\n                calendarsBeingLoaded: calendars.map(c=>c.id),\n                status: `Load calendar events...`\n            });\n\n            return Promise.all(calendars.map(calendar => this.gcal.listEvents({\n                calendarId: calendar.id,\n                timeMin: moment(firstDay).startOf('day'),\n                timeMax: moment(firstDay).add(numDays, 'days').endOf('day')\n            }).then(events => {\n                /*if (calendar.description === \"Synchronized\" || calendar.summary === 'schema') {\n                    console.log(events);\n                }*/\n                // Successfully loaded all events from one particular calendar.\n                // Now remove this calendar from 'calendarsBeingLoaded'\n                const calendarsBeingLoaded =\n                    this.state.calendarsBeingLoaded.filter(id => id !== calendar.id);\n\n                // Add the loaded calendar to the state. To do this, first clone it and then set it.\n                // This is needed because it is a sub property. If it was a direct property on this.state\n                // react would automatically do the merge.\n                const calendars = clone(this.state.calendars);\n                // Append the recently loaded calendar and its events\n                calendars[calendar.id] = {calendar, events};\n                /*const ev = events.filter(ev => JSON.stringify(ev).indexOf(\"Hämta post\") !== -1)\n                    .map(ev => ({ev, calendar}));\n                if (ev.length > 0) debugger;*/\n                // Update state accordingly. This will trigger a rendering of the loaded calendar.\n                // TODO: (not nescessarily) Add some sort of debounce / throttling in case multiple calendar events load fast.\n                this.setState({\n                    calendars,\n                    calendarsBeingLoaded,\n                    status: calendarsBeingLoaded.length === 0 ?\n                      `` : // Empty status means everything is done!\n                      `Load calendar events...`\n                });\n            })));\n        });\n    }\n\n    navigateToPreviousWeek() {\n        this.loadData(moment(this.state.firstDay).add(-1, \"week\")).catch(error => {\n            this.handleError(error);\n        });\n    }\n\n    navigateToNextWeek() {\n        this.loadData(moment(this.state.firstDay).add(1, \"week\")).catch(error => {\n            this.handleError(error);\n        });\n    }\n\n    render () {\n        // Props\n        const { numDays, locale } = this.props;\n        \n        // State\n        const {\n            firstDay,\n            startHour,\n            endHour,\n            zoom,\n            calendars,\n            status,\n            error\n        } = this.state;\n\n        const eventSets = Object.keys(calendars)\n            .map(calendarId => calendars[calendarId])\n            .map(({calendar, events}) => {\n                const isSchedule = calendar.summary === 'Skolschema' && calendar.description === \"Synchronized\";\n                const isHoliday = /holiday/.test(calendar.id);\n                const isClassRoom = /classroom/.test(calendar.id);\n\n                const classNames = [];\n                if (calendar.colorId) classNames.push(\"gcal-palette-\" + calendar.colorId);\n                if (isSchedule) classNames.push(\"course-event\");\n                if (isHoliday) classNames.push(\"holiday-event\");\n                // Map Google Calendar events to our own format:\n                return events.map(event => ({\n                    id: event.id,\n                    start: event.start,\n                    end: event.end,\n                    text: event.summary,\n                    location: event.location,\n                    description: event.description,\n                    //bgColor: calendar.backgroundColor,\n                    //fgColor: calendar.foregroundColor,\n                    htmlLink: event.htmlLink,\n                    className: (isSchedule && event.summary ?\n                        classNames.concat(courseNameToCssClass('course-event-', event.summary)) :\n                        classNames).join(\" \")\n                }))\n            });\n                \n        const events = flatten(eventSets);\n\n        // Else, render the WeekView now. Any error should be displayed as red status\n        return <div style={{position: 'relative', top: 0, left: 0}}>\n            <div className=\"btn-toolbar week-navigation\" >\n                {/*<div className=\"btn-group\">\n                    <button className=\"btn\">\n                        {L`Idag`}\n                    </button>\n                </div>*/}\n                <div className=\"btn-group\">\n                    <button className=\"btn\" onClick={()=>this.navigateToPreviousWeek()}>\n                        <i className=\"fa fa-angle-left\" aria-hidden=\"true\"></i>\n                    </button>\n                    <button className=\"btn\" onClick={()=>this.navigateToNextWeek()}>\n                        <i className=\"fa fa-angle-right\" aria-hidden=\"true\"></i>\n                    </button>\n                </div>\n                <div className=\"btn-group\">\n                    {L`Vecka ${moment(firstDay).week()}, ${moment(firstDay).year()}`}\n                </div>\n            </div>\n            <WeekView\n                locale={locale}\n                firstDay={firstDay}\n                startHour={startHour}\n                endHour={endHour}\n                numDays={numDays}\n                zoom={zoom}\n                events={events}\n                status={status}\n                error={error}\n            />\n        </div>\n    }\n}\n","/// <reference path=\"../../../typings-gapi/gapi.client.calendar-v3/gapi.client.calendar.d.ts\" />\n\n/* Calendars to show:\n\n    summary: \"Matsedel\",\n    summary: \"Skolschema\",\n    primary: true\n    id.includes('classroom')\n    id.includes('holiday')\n*/\n\n\nexport function shouldIncludeCalendar (cal: gapi.client.calendar.CalendarListEntry) {\n  const summary = cal.summary || \"\";\n  const isPrimary = !!cal.primary;\n  const isClassroomCalendar = /classroom/ig.test(cal.id);\n  const isHolidayCalendar = /holiday/ig.test(cal.id);\n\n  return (\n    isPrimary ||\n    isClassroomCalendar ||\n    isHolidayCalendar ||\n    ///matsedel/ig.test(summary) ||\n    /schema/ig.test(summary)\n  );\n}\n","import * as React from 'react';\nimport { Course, UserHiddenCourse, School } from 'kedbackend/models';\nimport { hiddenCoursesRepo, CourseWithHiddenState } from '../../repos/hidden-courses-repo';\nimport env from '../../globals/KED.env';\nimport { flatten, compareProp, arrayToMap, arrayToLookup } from '../../utils/utils';\nimport { preserveImpersonationQuery } from '../../access-control';\n\nexport interface Props {\n  viewCourseUrl: string;\n}\n\nexport interface State {\n  courses: CourseWithHiddenState[];\n  isLoading: boolean;\n  error?: Error;\n}\n\nexport class MyCourses extends React.Component<Props,State> {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      courses: [],\n      isLoading: true\n    }\n    this.updateHiddenCoursesState = this.updateHiddenCoursesState.bind(this);\n  }\n\n  componentDidMount() {\n    hiddenCoursesRepo.subscribe(this.updateHiddenCoursesState, {fullCourse: false});\n  }\n\n  updateHiddenCoursesState(courses: CourseWithHiddenState[]) {\n    this.setState({courses, isLoading: false});\n  }\n\n\n  componentWillUnmount() {\n    hiddenCoursesRepo.unsubscribe(this.updateHiddenCoursesState);\n  }\n\n  getCourseUrl(courseId: string) {\n    return preserveImpersonationQuery(this.props.viewCourseUrl, { courseId });\n  }\n\n  render() {\n    const {viewCourseUrl} = this.props;\n    const {isLoading, error, courses } = this.state;\n    const visibleCourses = this.state.courses.filter(c => c.visible);\n\n    return (\n      <>\n        {isLoading ? (\n          <li className=\"lvl2 header\">\n            <a>Laddar...</a>\n          </li>\n        ) : error ? (\n          <li className=\"lv12\">\n            <a>Kunde inte ladda kurser.</a>\n          </li>\n         ) : (\n          visibleCourses.map(({name, id}) => (\n            <li key={id} className=\"lvl2\">\n              <a href={this.getCourseUrl(id)}>{name}</a>\n            </li>\n          )\n        ))\n        }\n\t\t\t</>\n    );\n  }\n}","import * as React from 'react';\nimport { L } from '../../utils/utils';\nimport { EDSAssessment } from '../../contracts/eds';\nimport env from '../../globals/KED.env';\n\ninterface Props {\n  limit?: number;\n  locale: string;\n}\n\ninterface State {\n  loading: boolean,\n  assessments: EDSAssessment[],\n  error: string | null\n}\n\nexport class LatestAssessments extends React.Component<Props,State> {\n  constructor (props: Props) {\n    super(props);\n    this.state = {\n      assessments: [],\n      error: null,\n      loading: false\n    }\n  }\n\n  componentWillMount() {\n    this.load();\n  }\n\n  async load() {\n    this.setState({loading: true});\n    try {\n      const assessments = await env.edsClient.getLatestAssessments(this.props.limit);\n      this.setState({assessments});\n    } catch (error) {\n      this.setState({error});\n    }\n    this.setState({loading: false});    \n  }\n\n  render() {\n    const hasGrades = this.state.assessments.some(a => !!a.gradeName);\n    return <div className=\"ked_boxed\">\n      <div className=\"weekSelect\">\n        <div className=\"horizontalItem\">\n\n        </div>\n        <div className=\"horizontalItem\">\n\n        </div>\n      </div>\n\n      <h4>{L`Senaste bedömningar`}</h4>\n      <hr />\n      <table className=\"smallFont\">\n        <thead>\n          <tr>\n            <th className=\"nowrap\">{L`Datum`}</th>\n            <th className=\"nowrap\">{L`Kurs`}</th>\n            <th className=\"nowrap\">{L`Del`}</th>\n            {hasGrades && <th className=\"nowrap\">{L`Betyg`}</th>}\n            <th className=\"nowrap\" colSpan={2}>{L`Bedömningar`}</th>\n          </tr>\n        </thead>\n\n        <tbody>\n          {this.state.assessments.map((a, i) => \n            <tr key={i} className={i % 2 && \"tableOdd\"}>\n              <td>{a.publishDateTime.substr(0, 10)}</td>\n              <td className=\"amneCell\">{a.courseName}</td>\n              <td className=\"delCell\">{a.courseUnitName}</td>\n              {hasGrades && <td>{a.gradeName}</td>}\n              <td><pre>{a.text}</pre></td>\n            </tr>\n          )}\n        </tbody></table>\n    </div>;\n  }\n}\n","import { LearningModuleTasks } from '../../contracts/ked-models';\n\nexport const learningModules: LearningModuleTasks[] = [{\n    moduleName: \"Steg 22\",\n    subject: {\n        name: \"Spanska\",\n        course: {\n            name: \"Spanska\",\n            url: \"/steg/spanska.4.4ae4e9d2159ef4e0120ad6d3.html\"\n        }\n    },\n    commonTasks: [],\n    learningGoals: [{\n        name: \"Aktiviteter i hemmet\",\n        tasks: [{\n            name: \"Aktiviteter i hemmet hos en peruansk familj\",\n            url: \"/steg/spanska/block5/steg22/uppgifter/aktiviteterihemmet/aktiviteterihemmethosenperuanskfamilj.4.4ae4e9d2159ef4e0120adb40.html\"\n        }, {\n            name: \"Uppgift till aktiviteter i hemmet\",\n            url: \"/steg/spanska/block5/steg22/uppgifter/aktiviteterihemmet/uppgifttillaktiviteterihemmet.4.4ae4e9d2159ef4e0120af887.html\"\n        }]\n    }, {\n        name: \"Familjeliv\",\n        tasks: [{\n            name: \"Vad pågår i din familj nu?\",\n            url: \"/steg/spanska/block5/steg22/uppgifter/familjeliv/vadpagaridinfamiljnu.4.4ae4e9d2159ef4e0120b25e9.html\"\n        }, {\n            name: \"Uppgift familjeliv\",\n            url: \"/steg/spanska/block5/steg22/uppgifter/familjeliv/uppgiftfamiljeliv.4.4ae4e9d2159ef4e0120af73a.html\"\n        }]\n    }, {\n        name: \"Samtal om familjeliv\",\n        tasks: [{\n            name: \"Samtalsdokument familjeliv\",\n            url: \"/steg/spanska/block5/steg22/uppgifter/samtalomfamiljeliv/samtalsdokumentfamiljeliv.4.4ae4e9d2159ef4e01209fe03.html\"\n        }, {\n            name: \"Samtalskarta-familjeliv\",\n            url: \"/steg/spanska/block5/steg22/uppgifter/samtalomfamiljeliv/samtalskartafamiljeliv.4.4ae4e9d2159ef4e0120af6fd.html\"\n        }]\n    }\n    ]\n}, {\n    moduleName: \"Teknik\",\n    subject: {\n        name: \"Teknik\",\n        course: {\n            name: \"Tråd 5\",\n            url: \"/kurser/arskurs8/trad5.19.2d4f4005159f895477a15cc.html\"\n        }\n    },\n    commonTasks: [{\n        name: \"Tryck \",\n        url: \"/kurser/arskurs8/trad5/forberedelse/teknik/uppgifter/tryck.4.4ae4e9d2159ef4e01209dcde.html\"\n    }, {\n        name: \"Diskussionsfrågor till industriella revolutionen\",\n        url: \"/kurser/arskurs8/trad5/forberedelse/teknik/uppgifter/diskussionsfragortillindustriellarevolutionen.4.4ae4e9d2159ef4e0120a6fab.html\"\n    }, {\n        name: \"Hur fungerar en ångmaskin\",\n        url: \"/kurser/arskurs8/trad5/forberedelse/teknik/uppgifter/hurfungerarenangmaskin.4.4ae4e9d2159ef4e0120a1309.html\"\n    }, {\n        name: \"Ångmaskinens betydelse\",\n        url: \"/kurser/arskurs8/trad5/forberedelse/teknik/uppgifter/angmaskinensbetydelse.4.4ae4e9d2159ef4e0120a3deb.html\"\n    }],\n    learningGoals: [{\n        name: \"Identifiera och analysera ångmaskinen utifrån ändamålsenlighet och funktion,\"\n    }, {\n        name: \"använda teknikområdets begrepp och uttrycksform\"\n    }, {\n        name: \"värdera konsekvenser av ångmaskinen för individ, samhälle och miljö, och\"\n    }, {\n        name: \"analysera drivkrafter bakom teknikutveckling runt ångmaskinen och hur tekniken har förändratsöver tid.\"\n    }]\n}]\n\n","export const learningPageUrls = [\n  \"testdata/learning-tasks/amnesintegrerad.json\",\n  \"testdata/learning-tasks/loopad.json\",\n  \"testdata/learning-tasks/steg-larandemal.json\",\n  \"testdata/learning-tasks/steg-matte.json\",\n  \"testdata/learning-tasks/vanlig-kurs.json\"\n];\n","import * as React from 'react';\nimport moment from 'moment';\nimport { Calendar } from '../components/calendar';\nimport { KSGoals } from '../components/ks-goals/goals';\nimport { LatestAssessments } from '../components/latest-assessments/latest-assessments';\nimport { KGTermPlanner } from '../components/kg-termplanner';\nimport { KSTermPlanner } from '../components/ks-termplanner2/termplanner';\nimport env from '../globals/KED.env';\nimport { WeekPlanner } from '../components/weekplanner';\nimport { LearningTasks } from '../components/learning-tasks';\nimport { MyCourses } from '../components/my-courses/my-courses';\nimport { ListCourses } from '../components/list-courses/list-courses';\n\nexport const components = {\n  LatestAssessments: {\n    component: LatestAssessments,\n    props: () => ({\n      locale: navigator.language,\n      limit: 15\n    })\n  },\n  KSGoals: {\n    component: KSGoals,\n    props: () => ({\n\n    })\n  },\n  KSTermPlanner: {\n    component: KSTermPlanner,\n    props: () => ({\n      initialDate: new Date(),\n      userEmail: env.currentUser.mail,\n      locale: 'sv'\n    })\n  },\n  KGTermPlanner: {\n    component: KGTermPlanner,\n    props: () => ({})\n  },\n  WeekPlanner: {\n    component: WeekPlanner,\n    props: () => ({\n      viewCourseUrl: 'http://svt.se'\n    })\n  },\n  Calendar: {\n    component: Calendar,\n    props: () => ({\n      locale: \"sv\",\n      firstDay: moment().startOf('week').weekday(0),\n      numDays: 5,\n      initialStartHour: 7,\n      initialEndHour: 18,\n      initialZoom: 0.75\n    })\n  },\n  /*CourseOverview: {\n    component: CourseOverview,\n    props: ()=>({\n      locale: navigator.language,\n    })\n  },*/\n  LearningTasks: {\n    component: LearningTasks,\n    props: () => ({\n      apiPath: localStorage.getItem('selectedLearningModuleUrl'),\n      pageId: \"dummy\"\n    })\n  },\n  MyCourses: {\n    component: MyCourses,\n    props: ()=> ({\n      viewCourseUrl: 'https://kg-test.sitevision.se/courseviewer'\n    })\n  },\n  ListCourses: {\n    component: ListCourses,\n    props: () => ({\n      viewCourseUrl: 'https://kg-test.sitevision.se/courseviewer'\n    })\n  }\n};\n","// <Initialization>\nimport './configure'; // Emulate server-side script\nimport '../global-setters/set-all'; // Client-side initialization\n// </Initialization>\n\nimport env from '../globals/KED.env';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { User } from '../contracts/ked-models';\nimport { learningModules } from './data/learningModules';\nimport { learningPageUrls } from './data/learningModules2';\nimport { users } from './data/users';\nimport { WeekPlanner } from '../components/weekplanner';\nimport { components } from './components';\nimport $ from 'jquery';\nimport moment from 'moment';\nimport {KedBackendClientWebTest} from 'kedbackend/clientwebtest';\nimport { ChooseUser } from './utils/choose-user';\n\ninterface State {\n  selectedComponent: string,\n  selectedLearningModule: number,\n  selectedLearningModuleUrl: string\n}\n\nexport default class TestPage extends React.Component<{},State> {\n  componentArea: HTMLElement;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedComponent: localStorage.getItem(\"selectedComponent\") || Object.keys(components)[0],\n      selectedLearningModule: parseInt(localStorage.getItem(\"selectedLearningModule\") || \"0\"),\n      selectedLearningModuleUrl: localStorage.getItem(\"selectedLearningModuleUrl\") || \"\"\n    }\n  }\n\n  componentDidUpdate() {\n    console.log(\"component did update\")\n    this.renderTestComponent();\n  }\n\n  componentDidMount() {\n    this.renderTestComponent();\n  }\n\n  renderTestComponent() {\n    env.learningModuleTasks = learningModules[this.state.selectedLearningModule];\n    $(this.componentArea).html(\"\");\n\n    if (env.currentUser) {\n      ReactDOM.render((React as any).createElement(\n        components[this.state.selectedComponent].component,\n        components[this.state.selectedComponent].props(),\n        null), this.componentArea);\n    }\n  }\n\n  render() {\n    return env.currentUser ? <div className=\"test-page\">\n      <div className=\"header\">\n        <div className=\"test-selects\">\n          <form>\n            <h4>\n              Testsida för komponenter till nya startsidan\n            </h4>\n            <table><tbody><tr>\n            <td><label htmlFor=\"testComponent\">Komponent</label></td>\n            <td><select id=\"testComponent\" value={this.state.selectedComponent} onChange={ev => {\n              this.setState({ selectedComponent: ev.target.value });\n              localStorage.setItem(\"selectedComponent\", ev.target.value);\n              window.location.reload();\n            }}>\n              {Object.keys(components).map(c => <option key={c} value={c}>{c}</option>)}\n            </select>\n            </td></tr>\n\n            {this.state.selectedComponent === 'LearningGoalsAndTasks' && <tr><td><label htmlFor=\"testLearningModule\">Kursmodul</label></td>\n            <td><select id=\"testLearningModule\" value={this.state.selectedLearningModule} onChange={\n              ev => {\n                localStorage.setItem(\"selectedLearningModule\", ev.target.value);\n                window.location.reload();\n              }\n            }>\n              {learningModules.map((lm, i) =>\n                <option key={i} value={i}>{\n                  lm.subject.course.name + \"/\" +\n                  lm.subject.name + \"/\" +\n                  lm.moduleName}</option>)\n              }\n            </select></td></tr>}\n            {this.state.selectedComponent === 'LearningTasks' && <tr><td><label htmlFor=\"testLearningModuleUrl\">Kursmodul</label></td>\n            <td><select id=\"testLearningModuleUrl\" value={this.state.selectedLearningModuleUrl} onChange={\n              ev => {\n                localStorage.setItem(\"selectedLearningModuleUrl\", ev.target.value);\n                window.location.reload();\n              }\n            }>\n              {learningPageUrls.map((url, i) =>\n                <option key={i} value={url}>{url}</option>)\n              }\n            </select></td></tr>}\n            </tbody>\n            </table>\n          </form>\n        </div>\n      </div>\n      <hr />\n      <div className=\"componentRow\">\n        <div className=\"componentArea\" ref={div => this.componentArea = div}>\n        </div>\n        <div className=\"week-planner\">\n          {this.state.selectedComponent === 'LearningTasks' &&\n            <WeekPlanner viewCourseUrl=\"http://www.svt.se/nyheter\" />\n          }\n        </div>\n      </div>\n    </div> : <ChooseUser />\n  }\n}\n"],"sourceRoot":""}