{"version":3,"sources":["webpack://[name]/webpack/bootstrap","webpack://[name]/../kedbackend/js/ked-backend-client-web/bearer-storage-sessionstorage.ts","webpack://[name]/../kedbackend/js/ked-backend-client-web/index.ts","webpack://[name]/../kedbackend/js/ked-backend-client/access-control.ts","webpack://[name]/../kedbackend/js/ked-backend-client/http-error.ts","webpack://[name]/../kedbackend/js/ked-backend-client/index.ts","webpack://[name]/../kedbackend/js/ked-backend-client/ked-bearer-provider.ts","webpack://[name]/../kedbackend/js/ked-backend-client/restclient.ts","webpack://[name]/../kedbackend/js/ked-backend-client/utils.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/index.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate-course.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate-task.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate.ts","webpack://[name]/./node_modules/moment/locale sync sv|en","webpack://[name]/./src/access-control/get-user-claims.ts","webpack://[name]/./src/access-control/index.ts","webpack://[name]/./src/components/course-builder/courses/business-logic.ts","webpack://[name]/./src/components/course-builder/courses/course-banner.tsx","webpack://[name]/./src/components/course-builder/courses/course-module-list.tsx","webpack://[name]/./src/components/course-builder/courses/course-module.tsx","webpack://[name]/./src/components/course-builder/courses/create-new.tsx","webpack://[name]/./src/components/course-builder/courses/edit-course.tsx","webpack://[name]/./src/components/course-builder/courses/index.tsx","webpack://[name]/./src/components/course-builder/courses/inner-edit-course.tsx","webpack://[name]/./src/components/course-builder/courses/list-course-templates.tsx","webpack://[name]/./src/components/course-builder/index.tsx","webpack://[name]/./src/components/course-builder/modal-pages/edit-resource.tsx","webpack://[name]/./src/components/course-builder/modal-pages/edit-task.tsx","webpack://[name]/./src/components/course-builder/modal-pages/edit-workflow-link.tsx","webpack://[name]/./src/components/course-builder/schools/edit-school.tsx","webpack://[name]/./src/components/course-builder/schools/editable-school-list.tsx","webpack://[name]/./src/components/course-builder/schools/index.tsx","webpack://[name]/./src/components/course-builder/schools/new-school.tsx","webpack://[name]/./src/components/course-builder/sub-components/editable-resource-list.tsx","webpack://[name]/./src/components/course-builder/sub-components/editable-task-list.tsx","webpack://[name]/./src/components/course-builder/sub-components/editable-teacher-list.tsx","webpack://[name]/./src/components/course-builder/sub-components/editable-workflow-link.tsx","webpack://[name]/./src/components/course-builder/sub-components/knowledge-matrix.tsx","webpack://[name]/./src/components/course-builder/sub-components/remove-item.tsx","webpack://[name]/./src/components/course-builder/sub-components/school-courses.tsx","webpack://[name]/./src/components/course-builder/sub-components/select-related-docs.tsx","webpack://[name]/./src/components/course-builder/sub-components/spinner.tsx","webpack://[name]/./src/components/course-builder/sub-components/weighted-items-table.tsx","webpack://[name]/./src/components/course-builder/subjects/index.tsx","webpack://[name]/./src/components/course-builder/subjects/show-subject.tsx","webpack://[name]/./src/components/course-builder/subjects/uploaded-subject.tsx","webpack://[name]/./src/components/course-builder/utils.ts","webpack://[name]/./src/components/utility-components/open-close-box.tsx","webpack://[name]/./src/components/utility-components/renameable-text.tsx","webpack://[name]/./src/components/utility-components/wysiwyg/actions-sv.ts","webpack://[name]/./src/components/utility-components/wysiwyg/actions.ts","webpack://[name]/./src/components/utility-components/wysiwyg/exec.ts","webpack://[name]/./src/components/utility-components/wysiwyg/image-edit-actions.ts","webpack://[name]/./src/components/utility-components/wysiwyg/index.tsx","webpack://[name]/./src/components/utility-components/wysiwyg/wash-html.ts","webpack://[name]/./src/contracts/ked-models.ts","webpack://[name]/./src/elements/KEDAppCourseBuilder/app.coursebuilder.client.tsx","webpack://[name]/./src/elements/KEDAppCourseBuilder/webpack-entry.ts","webpack://[name]/./src/features/features.ts","webpack://[name]/./src/features/index.ts","webpack://[name]/./src/global-setters/set-bearer-providers.ts","webpack://[name]/./src/global-setters/set-ked-backend-client.ts","webpack://[name]/./src/globals/KED.cfg.ts","webpack://[name]/./src/globals/KED.env.ts","webpack://[name]/./src/globals/KED.ts","webpack://[name]/./src/globals/ked.ts","webpack://[name]/./src/repos/repo.ts","webpack://[name]/./src/repos/school-courses.ts","webpack://[name]/./src/utils/cached-response.ts","webpack://[name]/./src/utils/error-success-feedback.tsx","webpack://[name]/./src/utils/keep-session-alive.ts","webpack://[name]/./src/utils/query-string.ts","webpack://[name]/./src/utils/utils.ts","webpack://[name]/external \"jQuery\"","webpack://[name]/external \"React\"","webpack://[name]/external \"ReactDOM\""],"names":[],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;AACvC;;;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjIA;AAAA;IAAA;IAaA,CAAC;IAZG,0CAAI,GAAJ,UAAK,EAAU,EAAE,SAA0B;QACvC,cAAc,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC;IACtE,CAAC;IAED,0CAAI,GAAJ,UAAK,EAAU;QACX,IAAI,CAAC;YACD,IAAM,IAAI,GAAG,cAAc,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE,CAAC,CAAC;YACpD,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAC,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,EAAC,CAAC,CAAC;QAChF,CAAC;QAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACV,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,EAAC,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,EAAC,CAAC,CAAC;QACtD,CAAC;IACL,CAAC;IACL,kCAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfwG;AAC3B;AACV;AACN;AAC9D,iFAAqB,CAAC,oEAAgB,CAAC,SAAS,CAAC,CAAC;AAE3C,IAAM,OAAO,GAAG,IAAI,0FAA2B,EAAE,CAAC;AAEzD,IAAM,cAAc,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;AAElC;IAII,iCACW,SAAiB,EACjB,mBAA8D,EAC9D,OAAe;QAFf,cAAS,GAAT,SAAS,CAAQ;QACjB,wBAAmB,GAAnB,mBAAmB,CAA2C;QAC9D,YAAO,GAAP,OAAO,CAAQ;QAEtB,IAAI,CAAC,SAAS,GAAG,EAAC,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,EAAC,CAAC;QAC3C,IAAI,CAAC,SAAS,GAAG,uFAAqB,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAClE,IAAI,CAAC,aAAa,GAAG,uFAAqB,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAC9E,CAAC;IAEK,2CAAS,GAAf;;;;;;6BACQ,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,EAArB,wBAAqB;6BACjB,IAAI,CAAC,OAAO,EAAZ,wBAAY;wBAAE,SAAI;wBAAa,qBAAM,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;;wBAAjD,GAAK,SAAS,GAAG,SAAgC,CAAC;;;6BAEpE,KAAI,CAAC,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,GAAnC,wBAAmC;wBACnC,qBAAM,IAAI,CAAC,aAAa,EAAE;;wBAA1B,SAA0B,CAAC;;4BAE/B,sBAAO,IAAI,CAAC,SAAS,EAAC;;;;KACzB;IAEK,+CAAa,GAAnB;;;;;4BACgB,qBAAM,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE;4BACpC,OAAO,EAAE,EAAC,MAAM,EAAE,8BAA8B,EAAC;4BACjD,QAAQ,EAAE,QAAQ;4BAClB,KAAK,EAAE,UAAU;4BACjB,WAAW,EAAE,aAAa;yBAC7B,CAAC;;wBALI,GAAG,GAAG,SAKV;wBACF,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,IAAI,KAAK,gBAAgB,CAAC,CAAC,CAAC,CAAC;4BACvE,gFAAgF;4BAChF,iFAAiF;4BACjF,8CAA8C;4BAC9C,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,cAAc,GAAG,KAAK,CAAC,CAAC,CAAC;gCACtC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,CAAC,oEAAoE;gCAC/F,OAAO,CAAC,GAAG,CAAC,+BAA+B,CAAC;gCAC5C,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;4BACjC,CAAC;wBACL,CAAC;6BACG,IAAG,CAAC,MAAM,IAAI,GAAG,GAAjB,wBAAiB;6BAAY,KAAK;wBAAC,WAAM,GAAC,GAAG,CAAC,MAAM,GAAG,GAAG;wBAAG,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAA1D,MAAM,cAAI,KAAK,WAAC,MAA0B,SAAgB,MAAC,CAAC;;wBACnF,SAAI;wBAAa,SAAI,CAAC,mBAAmB;wBAAC,qBAAM,GAAG,CAAC,IAAI,EAAE;;wBAA1D,GAAK,SAAS,GAAG,aAAI,GAAqB,SAAgB,EAAC,CAAC;wBAC5D,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;wBAC3C,sBAAO,IAAI,CAAC,SAAS,EAAC;;;;KACzB;IACL,8BAAC;AAAD,CAAC;;AAEM,IAAM,UAAU,GAAG,EAAC,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC,CAAC;AAE3E;IAAyC,uCAAgB;IACrD,6BACI,UAAkB,EAClB,mBAA4C,EAC5C,OAGC;QANL,iBAeC;QAPG,IAAM,cAAc,GAAG,OAAO,mBAAmB,KAAK,QAAQ,CAAC,CAAC;YAC5D,mBAAmB,CAAC,CAAC;YACrB,IAAI,uBAAuB,CACvB,mBAAmB,EACnB,CAAC,OAAO,IAAI,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAC,IAAE,QAAC,EAAC,KAAK,EAAE,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAC,CAAC,EAAhD,CAAgD,CAAC,EACjG,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC;QACpC,0BAAM,UAAU,EAAE,cAAc,EAAE,UAAU,CAAC,SAAC;;IAClD,CAAC;IACL,0BAAC;AAAD,CAAC,CAjBwC,oEAAgB,GAiBxD;;;;;;;;;;;;;;;;ACtED;AAAA;IACE,wBACS,eAAuB,EACvB,gBAAwB,EACxB,KAAkB;QAFlB,oBAAe,GAAf,eAAe,CAAQ;QACvB,qBAAgB,GAAhB,gBAAgB,CAAQ;QACxB,UAAK,GAAL,KAAK,CAAa;IACvB,CAAC;IAEE,yBAAU,GAAjB,UAAkB,EAAU;QAC1B,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;YAAC,MAAM,CAAC,IAAI,CAAC;QACrB,IAAI,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC1B,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;YAAC,MAAM,IAAI,KAAK,CAAC,yBAAyB,GAAG,EAAE,CAAC,CAAC;QACtE,IAAI,SAAS,GAAG,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QAClD,IAAI,UAAU,GAAG,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QACnD,IAAI,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;QACrB,EAAE,CAAC,CAAC,KAAK,KAAK,GAAG,IAAI,KAAK,KAAK,GAAG,IAAI,KAAK,KAAK,GAAG,CAAC;YAClD,MAAM,IAAI,KAAK,CAAC,yBAAyB,GAAG,EAAE,CAAC,CAAC;QAClD,MAAM,CAAC,IAAI,cAAc,CACvB,SAAS,EACT,UAAU,EACV,KAAK,CAAC,CAAC;IACX,CAAC;IAEM,qBAAM,GAAb,UAAc,eAAuB;QACnC,MAAM,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;IACrE,CAAC;IAEM,uBAAQ,GAAf,UAAgB,eAAuB;QACrC,MAAM,CAAC,eAAe,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;IACrE,CAAC;IAED,iCAAQ,GAAR;QACE,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,GAAG;YACtD,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,GAAG;YAClD,IAAI,CAAC,KAAK,CAAC;IACf,CAAC;IAEM,8BAAe,GAAtB,UAAuB,GAAa;QAClC,MAAM,CAAC,GAAG;aACP,GAAG,CAAC,YAAE,IAAI,qBAAc,CAAC,UAAU,CAAC,EAAE,CAAC,EAA7B,CAA6B,CAAC;aACxC,MAAM,CAAC,YAAE,IAAI,SAAE,EAAF,CAAE,CAAC,CAAC;IACtB,CAAC;IAEM,4BAAa,GAApB,UAAqB,GAAqB;QACxC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,YAAE,IAAI,SAAE,CAAC,QAAQ,EAAE,EAAb,CAAa,CAAC,CAAC;IACtC,CAAC;IACH,qBAAC;AAAD,CAAC;;AAEK,mBAAoB,GAAqB,EAAE,UAAyB,EAAE,cAA2B;IACrG,EAAE,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,eAAK,IAAI,YAAK,CAAC,IAAI,KAAK,MAAM,IAAI,KAAK,CAAC,KAAK,KAAK,OAAO,EAAhD,CAAgD,CAAC,CAAC;QAC7E,MAAM,CAAC,IAAI,CAAC;IAEd,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,WAAC;QACf,iBAAU,CAAC,IAAI,CAAC,WAAC;YACf,QAAC,CAAC,eAAe,KAAK,CAAC,CAAC,IAAI;gBAC5B,CAAC,CAAC,gBAAgB,KAAK,CAAC,CAAC,KAAK,IAAI,CAChC,CAAC,CAAC,CAAC,KAAK,KAAK,GAAG,IAAI,cAAc,KAAK,GAAG,CAAC;gBAC3C,CAAC,CAAC,CAAC,KAAK,KAAK,GAAG,IAAI,CAAC,GAAG,EAAC,GAAG,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;gBAC3D,CAAC,CAAC,CAAC,KAAK,KAAK,GAAG,CAAC,CAAC;QAJpB,CAIoB,CAAC;IALvB,CAKuB,CAAC,CAAC;AAC7B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;AChED;IAA+B,6BAAK;IAChC,mBAAoB,IAAY,EAAS,OAAe;QAAxD,YACE,kBAAM,MAAM,GAAG,IAAI,GAAG,GAAG,GAAG,OAAO,CAAC,SAErC;QAHmB,UAAI,GAAJ,IAAI,CAAQ;QAAS,aAAO,GAAP,OAAO,CAAQ;QAEtD,KAAI,CAAC,IAAI,GAAG,MAAM,GAAG,IAAI,CAAC;;IAC5B,CAAC;IACL,gBAAC;AAAD,CAAC,CAL8B,KAAK,GAKnC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNwE;AAGtC;AACqB;AAIvB;AACM;AACrB;AAcjB,CAAC;AAIF;IAGI,0BACI,UAAyB,EACzB,cAA8B,EAC9B,OAAe;QAEf,IAAI,CAAC,IAAI,GAAG,IAAI,sDAAU,CACtB,UAAU,EACV,OAAO,EACP,EAAC,cAAc,kBAAC,CAAC,CAAC;IAC1B,CAAC;IAEK,sCAAW,GAAjB,UAAkB,KAAc,EAAE,YAA0B;;;;;4BAE5C,qBAAM,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,GAAG,CAAC,KAAK,IAAG,EAAE,CAAC,EAAE,IAAI,EAAE,YAAY,CAAC;;wBAA1E,GAAG,GAAG,SAAoE;6BAC5E,IAAG,CAAC,MAAM,IAAI,GAAG,GAAjB,wBAAiB;6BAAY,qDAAS;sCAAC,GAAG,CAAC,MAAM;wBAAE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAhD,MAAM,cAAI,qDAAS,aAAa,SAAgB,MAAC,CAAC;4BAClE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAvB,sBAAO,SAAgB,EAAC;;;;KAC3B;IAEK,8BAAG,GAAT,UAAmB,KAAK,EAAE,EAAE,EAAE,OAAuC,EAAE,YAA0B;;;;;4BACjF,qBAAM,IAAI,CAAC,IAAI,CAAC,GAAG,CAAI,KAAK,SAAI,EAAI,EAAE,OAAO,EAAE,YAAY,CAAC;;wBAAlE,GAAG,GAAG,SAA4D;6BACpE,IAAG,CAAC,MAAM,IAAI,GAAG,GAAjB,wBAAiB;6BAAY,qDAAS;sCAAC,GAAG,CAAC,MAAM;wBAAE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAhD,MAAM,cAAI,qDAAS,aAAa,SAAgB,MAAC,CAAC;4BAClE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAvB,sBAAO,SAAgB,EAAC;;;;KAC3B;IAEK,+BAAI,GAAV,UAAoB,KAAa,EAAE,OAAqB,EAAE,YAA0B;;;;;4BAEpE,qBAAM,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAG,KAAO,EAAE,OAAO,EAAE,YAAY,CAAC;;wBAA5D,GAAG,GAAG,SAAsD;6BAC9D,IAAG,CAAC,MAAM,IAAI,GAAG,GAAjB,wBAAiB;6BAAY,qDAAS;sCAAC,GAAG,CAAC,MAAM;wBAAE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAhD,MAAM,cAAI,qDAAS,aAAa,SAAgB,MAAC,CAAC;4BAClE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAvB,sBAAO,SAAgB,EAAC;;;;KAC3B;IAEK,gCAAK,GAAX,UAAY,IAAuB,EAAE,YAA0B;;;;;;wBAC3D,wEAAwE;wBACxE,IAAI,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,UAAC,IAAI,EAAE,IAAI;4BAChC,WAAI,CAAC,EAAE,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gCAChD,IAAI,CAAC,EAAE,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;wBADxD,CACwD,CAAC,CAAC;wBAClD,qBAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,YAAY,CAAC;;wBAAvD,GAAG,GAAG,SAAiD;6BACzD,IAAG,CAAC,MAAM,IAAI,GAAG,GAAjB,wBAAiB;6BAAY,qDAAS;sCAAC,GAAG,CAAC,MAAM;wBAAE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAhD,MAAM,cAAI,qDAAS,aAAa,SAAgB,MAAC,CAAC;4BAClE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAvB,sBAAO,SAAgB,EAAC;;;;KAC3B;IAEK,6BAAE,GAAR,UAAS,OAA8B;;;;;;wBAC7B,MAAM,GAAG,IAAI,WAAW,EAAE,CAAC;wBACjC,OAAO,CAAC,MAAM,CAAC,CAAC;wBACT,qBAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,gBAAgB,CAAC;4BAAhD,sBAAO,SAAyC,EAAC;;;;KACpD;IAEK,sCAAW,GAAjB,UAAkB,KAAa;;;;;4BACf,qBAAM,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,KAAK,CAAC;;wBAA/C,GAAG,GAAG,SAAyC;6BACjD,IAAG,CAAC,MAAM,IAAI,GAAG,GAAjB,wBAAiB;6BAAY,qDAAS;sCAAC,GAAG,CAAC,MAAM;wBAAE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAhD,MAAM,cAAI,qDAAS,aAAa,SAAgB,MAAC,CAAC;4BAClE,qBAAM,GAAG,CAAC,IAAI,EAAE;4BAAvB,sBAAO,SAAgB,EAAC;;;;KAC3B;IAED,8BAAG,GAAH,UAAI,KAAY,EAAE,GAAG;QACjB,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,EAAjB,CAAiB,CAAC,CAAC;IACzC,CAAC;IACD,8BAAG,GAAH,UAAI,KAAY,EAAE,GAAG;QACjB,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,EAAjB,CAAiB,CAAC,CAAC;IACzC,CAAC;IACD,iCAAM,GAAN,UAAQ,KAAY,EAAE,EAAS;QAC3B,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,MAAM,CAAC,KAAK,EAAE,EAAE,CAAC,EAAnB,CAAmB,CAAC,CAAC;IAC3C,CAAC;IACD,gCAAK,GAAL,UAAM,KAAY,EAAE,EAAS,EAAE,GAAa;QACxC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,EAAE,GAAG,CAAC,EAAvB,CAAuB,CAAC,CAAC;IAC/C,CAAC;IACD,kCAAO,GAAP,UAAS,KAAY,EAAE,EAAS,EAAE,GAAa;QAC3C,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,EAAE,GAAG,CAAC,EAAzB,CAAyB,CAAC,CAAC;IACjD,CAAC;IACD,+BAAI,GAAJ,UAAM,WAAkB,EAAE,QAAe,EAAE,WAAkB,EAAE,QAAe,EAAE,KAAY;QACxF,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAE,QAAQ,EAAE,KAAK,CAAC,EAA3D,CAA2D,CAAC,CAAC;IACnF,CAAC;IACD,gCAAK,GAAL,UAAO,WAAkB,EAAE,QAAe,EAAE,QAAe,EAAE,KAAY;QACrE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,KAAK,CAAC,WAAW,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,EAA/C,CAA+C,CAAC,CAAC;IACvE,CAAC;IACD,iCAAM,GAAN,UAAQ,WAAkB,EAAE,QAAe,EAAE,WAAkB,EAAE,QAAe,EAAE,KAAY;QAC1F,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,MAAM,CAAC,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAE,QAAQ,EAAE,KAAK,CAAC,EAA7D,CAA6D,CAAC,CAAC;IACrF,CAAC;IACD,kCAAO,GAAP,UAAS,WAAkB,EAAE,QAAe,EAAE,QAAe,EAAE,KAAY;QACvE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,WAAC,IAAE,QAAC,CAAC,OAAO,CAAC,WAAW,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,EAAjD,CAAiD,CAAC,CAAC;IACzE,CAAC;IACL,uBAAC;AAAD,CAAC;;AAED;IAGI;QACI,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;IAC/B,CAAC;IAED,yBAAG,GAAH,UAAK,KAAY,EAAE,GAAG;QAClB,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,KAAK,EAAE,KAAK,SAAE,GAAG,OAAC,CAAC,CAAC;QACpD,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,yBAAG,GAAH,UAAK,KAAY,EAAE,GAAG;QAClB,GAAG,gBAAO,GAAG,CAAC,CAAC;QACf,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,0CAA0C;QAC1D,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,KAAK,EAAE,KAAK,SAAE,GAAG,OAAC,CAAC,CAAC;QACpD,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,4BAAM,GAAN,UAAQ,KAAY,EAAE,EAAS;QAC3B,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,QAAQ,EAAE,KAAK,SAAE,EAAE,MAAC,CAAC,CAAC;QACtD,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,2BAAK,GAAL,UAAO,KAAY,EAAE,EAAS,EAAE,GAAY;QACxC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,OAAO,EAAE,KAAK,SAAE,EAAE,MAAE,GAAG,OAAC,CAAC,CAAC;QAC1D,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,6BAAO,GAAP,UAAS,KAAY,EAAE,EAAS,EAAE,GAAY;QAC1C,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,SAAS,EAAE,KAAK,SAAE,EAAE,MAAE,GAAG,OAAC,CAAC,CAAC;QAC5D,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,0BAAI,GAAJ,UAAM,WAAkB,EAAE,QAAe,EAAE,WAAkB,EAAE,QAAe,EAAE,KAAY;QACxF,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,MAAM,EAAE,WAAW,eAAE,QAAQ,YAAE,WAAW,eAAE,QAAQ,YAAE,KAAK,SAAC,CAAC,CAAC;QAC9F,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,2BAAK,GAAL,UAAO,WAAkB,EAAE,QAAe,EAAE,KAAY,EAAE,QAAe;QACrE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,MAAM,EAAE,WAAW,eAAE,QAAQ,YAAE,QAAQ,YAAE,KAAK,SAAC,CAAC,CAAC;IACrF,CAAC;IACD,4BAAM,GAAN,UAAQ,WAAkB,EAAE,QAAe,EAAE,WAAkB,EAAE,QAAe,EAAE,KAAY;QAC1F,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,QAAQ,EAAE,WAAW,eAAE,QAAQ,YAAE,WAAW,eAAE,QAAQ,YAAE,KAAK,SAAC,CAAC,CAAC;QAChG,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACD,6BAAO,GAAP,UAAS,WAAkB,EAAE,QAAe,EAAE,KAAY,EAAE,QAAe;QACvE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,QAAQ,EAAE,WAAW,eAAE,QAAQ,YAAE,QAAQ,YAAE,KAAK,SAAC,CAAC,CAAC;QACnF,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IACL,kBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7JwE;AAG3B;AAO9C;IAII,2BACW,UAAyB,EACzB,OAAgC,EAChC,OAAc,EACd,QAAgB,EAChB,YAAoB,EACpB,QAAgB,EAChB,UAAsB;QANtB,eAAU,GAAV,UAAU,CAAe;QACzB,YAAO,GAAP,OAAO,CAAyB;QAChC,YAAO,GAAP,OAAO,CAAO;QACd,aAAQ,GAAR,QAAQ,CAAQ;QAChB,iBAAY,GAAZ,YAAY,CAAQ;QACpB,aAAQ,GAAR,QAAQ,CAAQ;QAChB,eAAU,GAAV,UAAU,CAAY;QAE7B,IAAI,CAAC,SAAS,GAAG,EAAC,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,EAAC,CAAC;QAC3C,IAAI,CAAC,MAAM,GAAG,IAAI,sDAAU,CAAC,UAAU,EAAE,EAAE,EAAE;YACzC,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,QAAQ,EAAE,IAAI,CAAC,YAAY;SAC9B,CAAC,CAAC;QACH,IAAI,CAAC,SAAS,GAAG,oEAAqB,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAClE,IAAI,CAAC,aAAa,GAAG,oEAAqB,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAC9E,CAAC;IAEK,qCAAS,GAAf;;;;;;wBACU,KAAmB,IAAI,CAAC,SAAS,EAAhC,KAAK,aAAE,OAAO,cAAmB;wBACxC,EAAE,CAAC,CAAC,KAAK,IAAI,OAAO,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;4BAAC,MAAM,gBAAC,IAAI,CAAC,SAAS,EAAC;;;;wBAEtD,SAAI;wBAAa,qBAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC;;wBAA5E,GAAK,SAAS,GAAG,SAA2D,CAAC;wBAC7E,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;4BAAC,MAAM,gBAAC,IAAI,CAAC,SAAS,EAAC;wBACxF,qBAAM,IAAI,CAAC,aAAa,EAAE;;wBAA1B,SAA0B,CAAC;wBAC3B,sBAAO,IAAI,CAAC,SAAS,EAAC;;;wBAEtB,qBAAM,IAAI,CAAC,aAAa,EAAE;;wBAA1B,SAA0B,CAAC;wBAC3B,sBAAO,IAAI,CAAC,SAAS,EAAC;;;;;KAE7B;IAEK,yCAAa,GAAnB;;;;;;wBAEa,OAAO,GAAC,CAAC;;;6BAAC,QAAO,GAAC,CAAC;wBACxB,OAAO,CAAC,GAAG,CAAC,0BAAwB,IAAI,CAAC,OAAS,CAAC,CAAC;wBAC9C,qBAAM,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,UAAU,EAAE,EAAC,KAAK,EAAE,QAAQ,EAAC,CAAC;;wBAA9E,GAAG,GAAG,SAAwE,CAAC;wBAC/E,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC;4BACrB,OAAO,CAAC,IAAI,CAAC,SAAO,GAAG,CAAC,MAAM,SAAI,GAAG,CAAC,UAAY,CAAC,CAAC;4BACpD,MAAM,kBAAG;wBACb,CAAC;wBACD,SAAI;;wBAAqB,qBAAM,GAAG,CAAC,IAAI,EAAE;;wBAAzC,GAAK,SAAS,IAAI,QAAK,GAAE,SAAgB,EAAE,UAAO,GAAE,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,KAAC,CAAC;wBACjF,OAAO,CAAC,GAAG,CAAC,mBAAiB,IAAI,CAAC,OAAO,UAAK,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAG,CAAC,CAAC;wBAChF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;wBACtE,sBAAO,IAAI,CAAC,SAAS,EAAC;;wBAVG,EAAE,OAAO;;4BAYtC,MAAM,IAAI,KAAK,CAAC,+BAA+B,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;;;;KACnF;IACL,wBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;AC9DD;AAAA;;;;;;;EAOE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGmC;AAarC;IAMI,oBACW,UAAyB,EACzB,OAAe,EACf,OAKN;QAPM,eAAU,GAAV,UAAU,CAAe;QACzB,YAAO,GAAP,OAAO,CAAQ;QACf,YAAO,GAAP,OAAO,CAKb;QAED,IAAI,CAAC,YAAY,GAAG,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC;QACnC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;YAC9B,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;YAC5B,OAAO,CAAC,QAAQ,CAAC,CAAC;gBACd,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;gBAC/E,IAAI,CAAC;QACb,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc,IAAI,IAAI,CAAC;IACzD,CAAC;IAEK,0BAAK,GAAX,UAAY,IAAY,EAAE,MAAc,EAAE,OAAO,EAAE,KAAM,EAAE,YAA0B;;;;;;wBACjF,EAAE,CAAC,CAAC,YAAY,IAAI,YAAY,CAAC,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC;4BACpD,2EAA2E;4BAC3E,kDAAkD;4BAClD,KAAK,gBAAO,KAAK,IAAE,OAAO,EAAE,yDAAU,EAAE,GAAC;wBAC7C,CAAC;wBACK,QAAQ,GAAG,KAAK,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,aAAG;4BAChD,yBAAkB,CAAC,GAAG,CAAC;gCACvB,GAAG;gCACH,kBAAkB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;wBAF9B,CAE8B,CAAC;6BAC9B,IAAI,CAAC,GAAG,CAAC,CAAC;wBAEX,KAA0C,IAAI,EAA7C,UAAU,kBAAE,SAAS,iBAAE,cAAc,qBAAS;6BAG/C,EAAC,UAAU,IAAI,CAAC,SAAS,IAAI,cAAc,GAA3C,wBAA2C;wBAC3C,SAAI;wBAAyB,qBAAM,cAAc,CAAC,SAAS,EAAE;;wBAA7D,GAAK,SAAS,GAAG,SAAS,GAAG,SAAgC,CAAC;;;6BAM9D,SAAS,EAAT,wBAAS;6BACL,UAAS,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,GAA9B,wBAA8B;wBAC9B,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;wBAC1C,SAAI;wBAAyB,qBAAM,cAAc,CAAC,aAAa,EAAE;;wBAAjE,GAAK,SAAS,GAAG,SAAS,GAAG,SAAoC,CAAC;;;wBAEtE,UAAU,GAAG,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC;;;wBAG7C,yEAAyE;wBACzE,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;4BACb,OAAO,CAAC,aAAa,GAAG,UAAU,CAAC;wBACvC,CAAC;wBAEK,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,GAAG,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;wBAC/C,qBAAM,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,eAAO,IAAI,CAAC,YAAY,IAAE,OAAO,WAAE,MAAM,YAAK,YAAY,EAAG;;wBAA5G,GAAG,GAAa,SAA4F;6BAC5G,IAAG,CAAC,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,cAAc,GAAxC,wBAAwC;wBAClC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;wBACpD,OAAO,CAAC,GAAG,CAAC,SAAO,GAAG,CAAC,MAAM,eAAS,IAAI,CAAC,OAAO,GAAG,IAAI,CAAE,CAAC,CAAC;6BACzD,QAAO,IAAI,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,GAAlC,wBAAkC;wBAClC,SAAI;wBAAa,qBAAM,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE;;wBAA1D,GAAK,SAAS,GAAG,SAAyC,CAAC;wBAC3D,OAAO,CAAC,aAAa,GAAG,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;wBACnD,qBAAM,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,eAAO,IAAI,CAAC,YAAY,IAAE,OAAO,WAAE,MAAM,YAAK,YAAY,EAAG;;wBAAlG,GAAG,GAAG,SAA4F,CAAC;;4BAG3G,sBAAO,GAAG,EAAC;;;;KACd;IAED,wBAAG,GAAH,UAAI,IAAY,EAAE,KAAM,EAAE,YAA0B;QAChD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,8BAA8B,EAAE,EAAE,KAAK,EAAE,YAAY,CAAC,CAAC;IACpG,CAAC;IAED,yBAAI,GAAJ,UAAK,IAAY,EAAE,IAAI,EAAE,YAA0B;QAC/C,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,EAAE;YAC5B,cAAc,EAAE,kBAAkB;YAClC,QAAQ,EAAE,kBAAkB;SAC/B,EAAE,IAAI,eAAM,YAAY,IAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAE,CAAC;IAC5D,CAAC;IAED,2BAAM,GAAN,UAAO,IAAY,EAAE,KAAM,EAAE,IAAK,EAAE,YAA0B;QAC1D,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,QAAQ,EAAE,EAAE,MAAM,EAAE,8BAA8B,EAAE,EAAE,KAAK,eAAM,YAAY,IAAE,IAAI,UAAE,CAAC;IAClH,CAAC;IACL,iBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;AC9GK;IACJ,yGAAyG;IACzG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;IACnB,IAAI,IAAI,GAAG,sCAAsC,CAAC,OAAO,CAAC,OAAO,EAAE,WAAC;QAClE,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;QAC1C,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;QACvB,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IACxD,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,IAAI,CAAC;AACd,CAAC;AAEK,+BAAqC,MAAiC;IAC1E,IAAI,cAAc,GAAe,IAAI,CAAC;IACtC,MAAM,CAAC;QACH,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;YAClB,cAAc,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,IAAI,CAAC,gBAAM;gBACtD,cAAc,GAAG,IAAI,CAAC;gBACtB,MAAM,CAAC,MAAM,CAAC;YAClB,CAAC,CAAC,CAAC;QACP,CAAC;QACD,MAAM,CAAC,cAAc,CAAC;IAC1B,CAAC;AACH,CAAC;;;;;;;;;;;;;;;;ACtB+B;AAEzB,IAAM,qBAAqB,GAAG,UAAC,MAAwB;IAC1D,EAAE,CAAC,CAAE,MAAc,CAAC,mBAAmB,CAAC;QAAC,MAAM,CAAC;IAC/C,MAAc,CAAC,mBAAmB,GAAG,IAAI,CAAC;IAE3C,IAAM,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC;IACvB,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;IAEzB,MAAM,CAAC,GAAG,GAAG,UAAU,KAAK,EAAE,EAAE,EAAE,OAAO;QACrC,IAAM,OAAO,GAAG,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC;QAC3C,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,IAAI,CAAC,gBAAM;YACzC,wDAAO,CAAC,MAAM,EAAE,KAAK,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;YACjE,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC,CAAC,CAAC;IACP,CAAC;IAED,MAAM,CAAC,IAAI,GAAG,UAAU,KAAK,EAAE,OAAO;QAClC,IAAM,OAAO,GAAG,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC;QAC3C,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,IAAI,CAAC,gBAAM;YAC1C,MAAM,CAAC,OAAO,CAAC,aAAG,IAAI,+DAAO,CAAC,GAAG,EAAE,KAAK,EAAE,OAAO,IAAI,OAAO,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAA7D,CAA6D,CAAC,CAAC;YACrF,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC,CAAC,CAAC;IACP,CAAC;IAED,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;;;;;;;;;;;;;;;;AC1BwC;AAE3B,uBAAwB,MAAc,EAAE,MAAiB;IACrE,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC;QAAC,MAAM,CAAC,OAAO,GAAG,EAAE,CAAC;IACzC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,gBAAM;QAC3B,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;YACtB,MAAM,CAAC,SAAS,GAAG,EAAE,CAAC;QACxB,CAAC;QACD,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;YACpB,MAAM,CAAC,OAAO,GAAG,EAAE,CAAC;QACtB,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAAC,CAAC;QAChC,MAAM,CAAC,mBAAmB,GAAG,EAAE;IACjC,CAAC;IAED,sCAAsC;IACtC,EAAE,CAAC,CAAC,WAAW,IAAK,MAAc,IAAI,CAAC,CAAC,WAAW,IAAK,MAAc,CAAC,CAAC,CAAC,CAAC;QACxE,MAAM,CAAC,SAAS,GAAI,MAAc,CAAC,SAAS,CAAC;QAC7C,OAAQ,MAAc,CAAC,SAAS,CAAC;IACnC,CAAC;IACD,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;QACtB,MAAM,CAAC,SAAS,GAAG,EAAE,CAAC;IACxB,CAAC;IAED,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;QACX,MAAM,CAAC,OAAO,CAAC,eAAK;YAClB,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACd,KAAK,OAAO;oBACV,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,cAAI,IAAI,oEAAW,CAAC,IAAI,CAAC,EAAjB,CAAiB,CAAC,CAAC;oBAChD,KAAK,CAAC;YACV,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;AACH,CAAC;;;;;;;;;;;;;;;AClCa,qBAAsB,IAAU;IAC1C,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;QAAC,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;AAC7C,CAAC;;;;;;;;;;;;;;;;;ACH4C;AACJ;AAE3B,iBAAkB,GAAG,EAAE,KAAa,EAAE,MAAiB;IACnE,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;QACd,KAAK,SAAS;YACZ,+DAAa,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;YAC3B,KAAK,CAAC;QACR,KAAK,OAAO;YACV,6DAAW,CAAC,GAAG,CAAC,CAAC;YACjB,KAAK,CAAC;IACV,CAAC;AACH,CAAC;;;;;;;;;;;;ACbD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wE;;;;;;;;;;;;;;ACjCc,uBAAyB,IAAU;IAC/C,MAAM,CAAC,CAAC;YACN,IAAI,EAAE,OAAO;YACb,KAAK,EAAE,IAAI,CAAC,IAAI;SACjB,EAAC;YACA,IAAI,EAAE,QAAQ;YACd,KAAK,EAAE,IAAI,CAAC,MAAM;SACnB,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,cAAI,IAAI,QAAC;QAChC,IAAI,EAAE,MAAM;QACZ,KAAK,EAAE,IAAI;KACZ,CAAC,EAH+B,CAG/B,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,cAAI,IAAI,QAAC;QAClC,IAAI,EAAE,YAAY;QAClB,KAAK,EAAE,IAAI,CAAC,MAAM,GAAG,GAAG,GAAG,IAAI;KAChC,CAAC,EAHiC,CAGjC,CAAC,CAAC,CAAC;AACP,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBqG;AAExD;AACT;AACyC;AACrD;AAElB,IAAM,0BAA0B,GAAG,CAAC,MAAM,EAAC,MAAM,EAAC,QAAQ,EAAC,OAAO,EAAC,aAAa,EAAC,aAAa,EAAC,YAAY,EAAC,YAAY,CAAC,CAAC;AAE3H,mBAAoB,GAAa,EAAE,cAA2B;IAClE,IAAI,MAAM,GAAG,gEAAa,CAAC,wDAAG,CAAC,WAAW,CAAC,CAAC;IAC5C,IAAI,MAAM,GAAG,mEAAU,CAAC,gEAAc,CAAC,eAAe,CAAC,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,cAAc,CAAC,CAAC;IAC/F,kFAAkF;IAClF,MAAM,CAAC,MAAM,CAAC;AAChB,CAAC;AAEK,uBAAwB,GAAa;IACzC,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC7B,CAAC;AAEK,wBAAyB,GAAa;IAC1C,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC7B,CAAC;AAEK,wBAAyB,GAAa;IAC1C,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC7B,CAAC;AAEK,2BAA4B,MAAc;IAC9C,IAAM,SAAS,GAAG,wDAAG,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,WAAI,KAAK,UAAU,IAAI,IAAI,KAAK,OAAO,EAAvC,CAAuC,CAAC,CAAC;IAC9F,IAAM,eAAe,GAAG,CAAC,MAAM,IAAE,EAAE,CAAC,CAAC,WAAW,EAAE,KAAK,wDAAG,CAAC,WAAW,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;IAC5F,MAAM,CAAC,CAAC,SAAS,IAAI,eAAe,CAAC,CAAC;AACxC,CAAC;AAEM,IAAM,gBAAgB,GAAG;IAC9B,KAAK,YAAE,OAA6B;QAC3B,uBAAI,EAAE,uBAAM,EAAE,iBAAG,CAAY;QACpC,IAAM,YAAY,GAAG,4EAAgB,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACvD,IAAM,QAAQ,sDAAO,YAAY,IAAE,IAAI,QAAE,MAAM,WAAC,CAAC;QACjD,IAAM,cAAc,GAAG,+EAAmB,CAAC,QAAQ,CAAC,CAAC;QACrD,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACR,QAAQ,CAAC,IAAI,GAAG,KAAG,GAAG,GAAG,cAAgB,CAAC;QAC5C,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,QAAQ,CAAC,IAAI,GAAG,GAAG,CAAC;YACpB,QAAQ,CAAC,MAAM,GAAG,cAAc,CAAC;QACnC,CAAC;IACH,CAAC;CACF;AAEK,eAAgB,OAA6B;IACjD,gBAAgB,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AAClC,CAAC;AAEK,oCAAsC,GAAW,EAAE,KAAgC;IACvF,IAAM,YAAY,GAAG,4EAAgB,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IACvD,IAAM,QAAQ,sDAAO,KAAK,CAAC,CAAC;IAC5B,GAAG,CAAC,CAAgB,UAA0B,EAA1B,yDAA0B,EAA1B,wCAA0B,EAA1B,IAA0B;QAAzC,IAAM,KAAK;QACd,EAAE,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;YAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC;KAChE;IACD,IAAM,cAAc,GAAG,+EAAmB,CAAC,QAAQ,CAAC,CAAC;IACrD,MAAM,CAAC,KAAG,GAAG,GAAG,cAAgB,CAAC;AACnC,CAAC;;;;;;;;;;;;;;;;;;;;;AC5DiD;AAE5C,2CAA4C,MAAc;IAC9D,IAAM,qBAAqB,GAAG,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI;QAC7E,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;QACvB,MAAM,CAAC,MAAM,CAAC;IAChB,CAAC,EAAE,EAA4C,CAAC,CAAC;IAEjD,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,cAAI;QACvB,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,YAAE;YACnC,OAAO,qBAAqB,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,GAAG,CAAC,YAAE,IAAI,4BAAqB,CAAC,EAAE,CAAC,EAAzB,CAAyB,CAAC,CAAC;AACjF,CAAC;AAEK,iCAAkC,MAAc;IACpD,IAAM,YAAY,GAAG,EAAE,CAAC;IACxB,gGAAgG;IAChG,MAAM,CAAC,qBAAqB,CAAC,OAAO,CAAC,WAAC;QACpC,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;IAC5B,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,WAAC;QACxB,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;IAC5B,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,YAAE;QAC9B,YAAY,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;IAC7B,CAAC,CAAC,CAAC;IACH,0DAA0D;IAClD,wBAAK,CAAY;IACzB,KAAK,CAAC,OAAO,CAAC,cAAI;QAChB,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,YAAE;YACnC,OAAO,YAAY,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,WAAC;YACtB,OAAO,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,YAAE;YAC5B,OAAO,YAAY,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,YAAY,CAAC;AACtB,CAAC;AAEK,qBAAuB,MAAc;IACzC,2BAA2B,MAAc;QACvC,IAAM,OAAO,GAA2B,EAAE,CAAC;QAC3C,MAAM,CAAC,4DAAO,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAM,IAAI,aAAM,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAM;YACnE,EAAE,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;gBACpB,IAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,MAAM,EAAf,CAAe,CAAC,CAAC;gBACrD,MAAM,CAAC,sDAAC,yNAA2C,EAAS,IAAG,KAAZ,IAAI,CAAC,IAAI,EAAI;YAClE,CAAC;YACD,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;QACzB,CAAC,CAAC,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,EAAD,CAAC,CAAC,EAN2B,CAM3B,CAAC,CAAC,CAAC;IACtB,CAAC;IAED,0BAA0B,MAAc;QACtC,IAAM,QAAQ,GAAyB,EAAE,CAAC;QAC1C,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,cAAI;YAC1B,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;gBACb,EAAE,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;oBACvB,MAAM,CAAC,sDAAC,6NAAsC,EAAuB,YAAW,EAAS,IAAG,KAA9C,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAW,IAAI,CAAC,IAAI,EAAI;gBAC/F,CAAC;gBACD,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;YAC5B,CAAC;QACH,CAAC,CAAC,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,EAAD,CAAC,CAAC,CAAC;IACpB,CAAC;IAED,6BAA6B,MAAc;QACzC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAE,gBAAM,IAAI,aAAM,CAAC,IAAI,KAAK,EAAE,EAAlB,CAAkB,CAAC,IACvD,sDAAC,iMAA4C,KAAC;IAClD,CAAC;IAED,iCAAiC,MAAc;QAC7C,IAAM,WAAW,GAA2B,EAAE,CAAC;QAC/C,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAM;YAC9B,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,IAAI,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAC5C,MAAM,CAAC,sDAAC,qLAAoB,EAAW,oCAA0B,KAArC,MAAM,CAAC,IAAI,EAA2B;YACpE,CAAC;YACD,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC;gBAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;QACnD,CAAC,CAAC;IACJ,CAAC;IAED,IAAM,MAAM,GAAG,4DAAO,CAAC;QACrB,iBAAiB,CAAC,MAAM,CAAC;QACzB,gBAAgB,CAAC,MAAM,CAAC;QACxB,mBAAmB,CAAC,MAAM,CAAC;QAC3B,uBAAuB,CAAC,MAAM,CAAC;KAChC,CAAC,CAAC;IAEH,MAAM,CAAC,MAAM,CAAC,MAAM,CAAE,gBAAM,IAAI,aAAM,EAAN,CAAM,CAAC,CAAC;AAC1C,CAAC;AAGK,uBAAyB,MAAc;IAC3C,IAAM,MAAM,GAA2B,EAAE,CAAC;IAC1C,aAAa,EAAU,EAAE,IAAU;QACjC,IAAM,IAAI,GAAG,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;QAC7C,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAClB,CAAC;IACD,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,cAAI;QACvB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,WAAC,IAAI,UAAG,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,CAAC,EAAf,CAAe,CAAC,CAAC;QAC7C,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,WAAC,IAAI,UAAG,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,CAAC,EAAf,CAAe,CAAC,CAAC;QAClD,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,YAAE,IAAI,UAAG,CAAC,EAAE,EAAE,IAAI,CAAC,EAAb,CAAa,CAAC,CAAC;IACpD,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,MAAM,CAAC;AAChB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;AC5G8B;AACgD;AAGP;AACpB;AACL;AAEJ;AAuB3C,IAAM,cAAc,GAAG;IACrB,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,sDAAC,yHAAQ,MAAE,KAAK,EAAE,UAAU,EAAE;IACvD,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,sDAAC,iIAAO,MAAE,KAAK,EAAE,WAAW,EAAE;CAEzD;AAED,IAAM,iBAAiB,GAAG;IACxB,EAAE,IAAI,EAAE,eAAe,EAAE,IAAI,EAAE,sDAAC,qIAAc,MAAE,KAAK,EAAE,cAAc,EAAE;IACvE,EAAE,IAAI,EAAE,aAAa,EAAE,IAAI,EAAE,sDAAC,6HAAU,MAAE,KAAK,EAAE,EAAE,EAAE;IACrD,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE;YAAM,2DAAG,SAAS,EAAC,oBAAoB,iBAAa,MAAM,GAAK;wBAAgB,EAAE,KAAK,EAAE,4CAA4C,EAAE;CACjK;AAGD,qBAA2B,EAAmC,EAAE,IAAuB,EAAE,MAAc,EAAE,UAAkB;;;;;;oBACzH,EAAE,CAAC,eAAe,EAAE,CAAC;oBACrB,EAAE,CAAC,cAAc,EAAE,CAAC;oBACd,KAAK,GAAG,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC;oBAChC,GAAG,GAAG,IAAI,CAAC;oBACT,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;yBAC5C,MAAK,CAAC,MAAM,GAAG,CAAC,GAAhB,wBAAgB;oBACZ,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;oBACtB,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC;wBAChC,8DAAS,CAAC,sDAAC,iNAA0C,KAAC,CAAC;wBACvD,MAAM,gBAAC;oBACT,CAAC;oBACK,qBAAM,gEAAiB,CAAC,IAAI,CAAC;;oBAAnC,GAAG,GAAG,SAA6B,CAAC;;;wCAE3B,CAAC;;;;;oCACF,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;yCAClB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAAjC,wBAAiC;oCAE7B,qBAAM,IAAI,OAAO,CAAC,iBAAO,IAAI,WAAI,CAAC,WAAW,CAAC,OAAO,CAAC,EAAzB,CAAyB,CAAC;;oCAD7D,MAAM;oCACN,GAAG,GAAG,SAAuD,CAAC;;;;;;oBAJzD,CAAC,GAAG,CAAC;;;yBAAE,EAAC,GAAG,KAAK,CAAC,MAAM;kDAAvB,CAAC;;;;;oBAAwB,EAAE,CAAC;;;oBAQvC,EAAE,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC,CAAC;wBAChB,8DAAS,CAAC,sDAAC,iNAA0C,KAAC,CAAC;wBACvD,MAAM,gBAAC;oBACT,CAAC;oBACD,cAAc,CAAC,MAAM,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;;;;;CAC/C;AAEK,wBACJ,MAAc,EACd,UAAkB,EAClB,IAAuB,EACvB,GAAW;IAEX,IAAM,OAAO,GAAG,oEAAU,EAAE,CAAC;IAC7B,IAAI,CAAC,MAAM,CAAC;QACV,OAAO,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE;QAC1B,MAAM,EAAE;YACN,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,OAAO;oBACX,GAAG;oBACH,GAAG,EAAE;wBACH,aAAa;wBACb,gBAAc,wDAAG,CAAC,WAAW,CAAC,MAAM,gBAAa;qBAClD;oBACD,KAAK,EAAE,KAAK;iBACb,CAAC;SACH;KACF,CAAC,CAAC;AACL,CAAC;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA8DE;AAEK,IAAM,YAAY,GAAG,UAAC,KAAY;IAC/B,uBAAK,EAAE,6BAAU,EAAE,iBAAI,EAAE,qBAAM,EAAE,6BAAU,EAAE,uCAAe,EAAE,6BAAU,CAAW;IAC3F,IAAM,OAAO,GAAG,wDAAG,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,WAAI,KAAK,OAAO,EAAhB,CAAgB,CAAC,CAAC;IACrE,IAAI,SAAS,GAAG,iBAAiB,CAAC;IAClC,EAAE,CAAC,CAAC,OAAO,CAAC;QAAC,SAAS,GAAG,cAAc,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IAE1D,MAAM,CAAC,6DAAK,SAAS,EAAC,iCAAiC;QACrD,6DAAK,SAAS,EAAC,uCAAuC;YACpD,6DAAK,SAAS,EAAC,6CAA6C;gBACzD,eAAe,IAAI,mEAAQ,+DAED,eAAe,sCAE3C,CAAS;gBACR,6DAAK,SAAS,EAAC,YAAY,EACzB,UAAU,EAAE,MAAM,IAAI,gDAAS,EAC/B,MAAM,EAAE,MAAM,IAAI,CAAC,YAAE,IAAI,kBAAW,CAAC,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,UAAU,CAAC,EAAzC,CAAyC,CAAC;oBACnE;wBACE,gEAAK,KAAK,CAAM,CACd;oBACJ,6DAAK,SAAS,EAAC,cAAc;wBAC3B,6DAAK,SAAS,EAAC,kBAAkB;4BAC/B,6DAAK,SAAS,EAAC,kBAAkB,GAAO;4BACxC,6DAAK,SAAS,EAAC,gBAAgB;gCAC7B,gEACG,SAAS,CAAC,GAAG,CAAC,cAAI,IAAI,QAAC;oCACtB,IAAI;oCACJ,QAAQ,EAAE,UAAU,KAAK,IAAI,CAAC,IAAI;oCAClC,QAAQ,EAAE,KAAK,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC;oCACvD,UAAU,EAAE,CAAC,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oCACrD,YAAY,EAAE,IAAI,CAAC,KAAK;iCACzB,CAAC,EANqB,CAMrB,CAAC,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,QAAQ,IAAI,CAAC,CAAC,YAAY,IAAI,CAAC,CAAC,UAAU,EAA5C,CAA4C,CAAC,CAAC,GAAG,CAAC,UAAC,EAAsD;wCAApD,cAAI,EAAE,sBAAQ,EAAE,sBAAQ,EAAE,8BAAY,EAAE,0BAAU;oCACrH,MAAM,CAAC,4DACL,GAAG,EAAE,IAAI,CAAC,IAAI,EACd,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,EACvC,OAAO,EAAE,QAAQ,IAEhB,QAAQ,CAAC,CAAC;wCACT,+DAAI,IAAI,CAAC,IAAI,CAAK,CAAC,CAAC;wCACpB,YAAY,IAAI,UAAU,CAAC,CAAC;4CAC1B,UAAU,IAAI,iBAAiB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;gDAClD,2DAAG,IAAI,EAAE,UAAU,IAAI,YAAY,IAAG,IAAI,CAAC,IAAI,CAAK,CAAC,CAAC;gDACtD,oDAAC,qDAAI,IAAC,EAAE,EAAE,YAAY,IAAG,IAAI,CAAC,IAAI,CAAQ,CAAC,CAAC;4CAC9C,+DAAI,IAAI,CAAC,IAAI,CAAK,CACnB,CAAC;gCACR,CAAC,CAAC,CACC,CACD,CACF,CACF,CACF,CACF,CACF,CACF;AACR,CAAC;;;;;;;;;;;;;;;;;;;;;;;;ACtN8B;AACS;AAEO;AAIS;AAWxD;IAAsC,0EAA4B;IAIhE,0BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,KAAI,CAAC,KAAK,GAAG,EACZ;;IACH,CAAC;IAED,oCAAS,GAAT;QACE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,EAAC,OAAO,EAAE,EAAC,KAAK,EAAE,CAAC;wBACxC,IAAI,EAAE,cAAc;wBACpB,EAAE,EAAE,oEAAU,EAAE;wBAChB,SAAS,EAAE,EAAE;wBACb,OAAO,EAAE,EAAE;qBACK;iBACjB,EAAC,EAAC,CAAC,CAAC;IACP,CAAC;IAED,4CAAiB,GAAjB;QACU,8BAAM,CAAgB;QAC9B,IAAM,WAAW,GAAG,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,EAAJ,CAAI,CAAC,CAAC;QACxE,MAAM,CAAC,WAAW;aAEf,GAAG,CAAC,YAAE,IAAI,aAAM,CAAC,OAAO,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC,EAArC,CAAqC,CAAC;aAEhD,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,CAAC,EAAH,CAAG,CAAC;aAEhB,MAAM,CAAE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,WAAW,CAAC,IAAI,CAAC,YAAE,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC,EAApC,CAAoC,CAAC,CAAC,CAAC;IAC/E,CAAC;IAEK,kCAAO,GAAb,UAAe,QAAgB,EAAE,SAAiB;;;;;;wBACxC,MAAM,GAAK,IAAI,CAAC,KAAK,OAAf,CAAgB;wBACxB,cAAc,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;wBAC1C,WAAW,GAAG,cAAc,CAAC,SAAS,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,QAAQ,EAAjB,CAAiB,CAAC,CAAC;wBAC/D,cAAc,GAAG,WAAW,GAAG,SAAS,CAAC;wBAC/C,EAAE,CAAC,CAAC,cAAc,GAAG,CAAC,IAAI,cAAc,IAAI,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC;4BAClE,+BAA+B;4BAC/B,MAAM,gBAAC;wBACT,CAAC;wBACK,uBAAuB,GAAG,cAAc,CAAC,cAAc,CAAC,CAAC;wBACzD,WAAW,GAAG,cAAc,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,EAAJ,CAAI,CAAC,CAAC;wBAClD,WAAW,CAAC,cAAc,CAAC,GAAG,QAAQ,CAAC;wBACvC,WAAW,CAAC,WAAW,CAAC,GAAG,uBAAuB,CAAC,EAAE,CAAC;wBAChD,aAAa,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,CAAC;wBACzD,qBAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC;gCAC3B,WAAW,EAAE,EAAC,IAAI,EAAE,WAAW,EAAC;6BACjC,CAAC;;wBAFF,SAEE,CAAC;wBAEG,UAAU,GAAgB,6DAAW,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;wBACxE,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;4BACf,IAAI,CAAC;gCACH,MAAM,CAAC,QAAQ,CAAC,EAAC,GAAG,EAAE,aAAa,EAAC,CAAC,CAAC,CAAC,0DAA0D;gCACjG,UAAU,CAAC,cAAc,CAAC,EAAC,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,EAAC,CAAC,CAAC;4BAClE,CAAC;4BAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gCACX,mFAAmF;gCACnF,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;gCACrC,UAAU,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;4BAClC,CAAC;wBACH,CAAC;;;;;KACF;IAED,iCAAM,GAAN;QAAA,iBAoBC;QAnBO,mBAAoD,EAAlD,kBAAM,EAAE,cAAI,EAAE,kDAAsB,CAAe;QAC3D,IAAM,WAAW,GAAG,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,EAAJ,CAAI,CAAC,CAAC;QACxE,IAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAEhD,MAAM,CAAC,6DAAK,SAAS,EAAC,4BAA4B,EAAC,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,KAAK,GAAG,IAAI,EAAjB,CAAiB;YAC9E,cAAc,CAAC,GAAG,CAAC,gBAAM,IAAI,2DAAC,oEAAqB,IAClD,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,IAAI,EAAlC,CAAkC,EAC/C,GAAG,EAAE,MAAM,CAAC,EAAE,EACd,MAAM,EAAE,MAAM,EACd,MAAM,EAAE,MAAM,EACd,SAAS,EAAE,mBAAS,IAAI,YAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,SAAS,CAAC,EAAlC,CAAkC,EAC1D,iBAAiB,EAAE,cAAI,YAAI,CAAC,iBAAiB,EAAE,EAAxB,CAAwB,EAC/C,IAAI,EAAE,IAAI,EACV,sBAAsB,EAAE,sBAAsB,GAC7C,EAT2B,CAS3B,CAAC;YACJ,6DAAK,SAAS,EAAC,eAAe,EAAC,OAAO,EAAE,cAAI,YAAI,CAAC,SAAS,EAAE,EAAhB,CAAgB,+BAEtD,CACF;IACR,CAAC;IACH,uBAAC;AAAD,CAAC,CArFqC,+CAAe,GAqFpD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvG8B;AAIiD;AACR;AAC/B;AAEiC;AACf;AAEP;AAEO;AACe;AAgB1E,IAAM,wBAAwB,GAAG,CAAC;QAChC,UAAU,EAAE,EAAE;QACd,IAAI,EAAE,EAAE;QACR,IAAI,EAAE,EAAE;QACR,IAAI,EAAE,EAAE;KACT,CAAC,CAAC;AAEH;IAA2C,+EAA4B;IACrE,+BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,KAAK,GAAG;YACX,oBAAoB,EAAE,KAAK;SAC5B;;IACH,CAAC;IAED,8CAAc,GAAd;QACQ,mBAA6B,EAA5B,kBAAM,EAAE,kBAAM,CAAe;QACpC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,EAAlB,CAAkB,CAAC,CAAC;IAC3D,CAAC;IAED,mDAAmB,GAAnB;QACQ,mBAA6B,EAA5B,kBAAM,EAAE,kBAAM,CAAe;QACpC,IAAM,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,EAAE,CAAC;QACtD,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,EAAlB,CAAkB,CAAC,CAAC;IAC3D,CAAC;IAED,4CAAY,GAAZ,UAAa,aAAa;QACjB,8BAAM,CAAe;QAC5B,IAAM,aAAa,GAAG,0DAAM,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;QACpD,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,EAAE,OAAO,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC,EAAE,aAAa,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IACtF,CAAC;IAED;;;MAGE;IACF,2CAAW,GAAX,UAAa,IAAU,EAAE,iBAAuC;QAC9D,sCAAsC;QACtC,IAAM,aAAa,GAAO,EAAE,CAAC;QAC7B,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;QAClD,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACtB,qCAAqC;QACrC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAI,IAAI,CAAC,EAAE,EAAf,CAAe,CAAC,CAAC,CAAC,CAAC;YACxD,aAAa,CAAC,KAAK,GAAG,EAAC,KAAK,EAAE,CAAC,IAAI,CAAC,EAAC,CAAC;QACxC,CAAC;QACD,IAAM,cAAc,sDAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,kBAAkB,IAAI,EAAE,CAAC,CAAC,CAAC;QACzE,EAAE,CAAC,CAAC,iBAAiB,CAAC;YAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,iBAAiB,CAAC;QACnE,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAC1C,aAAa,CAAC,OAAO,GAAG,EAAE,CAAC;QAC3B,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,GAAG;YACnC,OAAO,EAAE,EAAC,IAAI,EAAE,OAAO,EAAC;YACxB,kBAAkB,EAAE,EAAC,IAAI,EAAE,cAAc,EAAC;SAC3C,CAAC;QACF,gBAAgB;QAChB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;IACxC,CAAC;IAED,6CAAa,GAAb,UAAe,IAAU;QACvB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC;YAAC,MAAM,IAAI,KAAK,CAAC,sDAAC,mLAAoC,EAAO,EAAE,KAAT,OAAO,EAAG,CAAC;QACjF,IAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,EAAhB,CAAgB,CAAC,CAAC;QAC3E,EAAE,CAAC,CAAC,SAAS,IAAI,CAAC,CAAC,CAAC,CAAC;YACnB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,EAAC,KAAK,EAAE,EAAC,OAAO,EAAE,CAAC,CAAC,SAAS,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,EAAC,EAAC,CAAC,CAAC;QACrE,CAAC;IACH,CAAC;IAED,gDAAgB,GAAhB,UAAkB,MAAc,EAAE,aAA4B;QAC5D,IAAM,cAAc,sDAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,kBAAkB,IAAI,EAAE,CAAC,CAAC,CAAC;QACzE,cAAc,CAAC,MAAM,CAAC,GAAG,aAAa,CAAC;QACvC,IAAI,CAAC,YAAY,CAAC,EAAC,kBAAkB,EAAE,EAAC,IAAI,EAAE,cAAc,EAAC,EAAC,CAAC,CAAC;IAClE,CAAC;IAED,6CAAa,GAAb,UAAe,EAAU;QACvB,2CAA2C;QAC3C,iEAAiE;QACjE,uEAAuE;QACvE,IAAI,CAAC,YAAY,CAAC;YAChB,OAAO,EAAE,EAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,aAAG,IAAI,UAAG,KAAK,EAAE,EAAV,CAAU,CAAC,EAAC;YACpE,kBAAkB,EAAE;gBAClB,MAAM,EAAE,wBAAc;oBACpB,IAAM,IAAI,sDAAO,cAAc,CAAC,CAAC;oBACjC,OAAO,IAAI,CAAC,EAAE,CAAC,CAAC;oBAChB,MAAM,CAAC,IAAI,CAAC;gBACd,CAAC;aACF;SACF,CAAC,CAAC;IACL,CAAC;IAED,8CAAc,GAAd,UAAgB,EAAU,EAAE,IAAU;QACpC,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACtD,EAAE,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,CAAC;YAChB,8DAAS,CAAC,sDAAC,yLAAwC,KAAC,CAAC;YACrD,MAAM,CAAC;QACT,CAAC;QACD,IAAM,aAAa,GAAG;YACpB,8BAA8B;YAC9B,OAAO,EAAE,EAAC,OAAO,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC,EAAC;YAC3C,kBAAkB,EAAE;gBAClB,MAAM,EAAE,wBAAc;oBACpB,IAAM,IAAI,sDAAO,cAAc,CAAC,CAAC;oBACjC,OAAO,IAAI,CAAC,EAAE,CAAC,CAAC;oBAChB,MAAM,CAAC,IAAI,CAAC;gBACd,CAAC;aACF;SACF;QACD,IAAM,aAAa,GAAG,0DAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;QAC/D,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC;YACrB,kCAAkC;YAClC,OAAO,EAAE,EAAE,OAAO,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC,EAAE,aAAa,CAAC,CAAC,EAAE;YACvD,oCAAoC;YACpC,8DAA8D;YAC9D,+DAA+D;YAC/D,uCAAuC;YACvC,KAAK,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAC;SACrD,CAAC,CAAC;IACL,CAAC;IAED,sCAAM,GAAN;QAAA,iBA4GC;QA3GO,mBAA6D,EAA3D,kBAAM,EAAE,cAAI,EAAE,kBAAM,EAAE,kDAAsB,CAAgB;QACpE,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAC1C,IAAM,kBAAkB,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;QACtD,IAAI,kBAAkB,CAAC;QAEvB,IAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClD,IAAI,IAAI,GAAG,CAAC,CAAC;QACb,IAAM,gBAAgB,GAAG,CAAC,IAAI,CAAC,CAAC;QAChC,IAAM,cAAc,GAAG,CAAC,IAAI,CAAC,CAAC;QAC9B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC;YACxB,gBAAgB,CAAC,IAAI,CAAC,EAAE,GAAE,IAAI,CAAC,CAAC;YAChC,cAAc,CAAC,IAAI,CAAC,EAAE,GAAE,EAAE,IAAI,CAAC,CAAC;QAClC,CAAC;QAED,MAAM,CAAC,6DAAK,SAAS,EAAC,yBAAyB,EAAC,KAAK,EAAE,EAAC,QAAQ,EAAE,UAAU,EAAC;YAC3E;gBAAI,oDAAC,kFAAc,IAAC,KAAK,EAAE,IAAI,EAC7B,kBAAkB,EAAC,oBAAe,EAClC,QAAQ,EAAE,GAAG,EACb,IAAI,EAAE,MAAM,CAAC,IAAI,EACjB,QAAQ,EAAE,iBAAO,IAAI,mBAAY,CAAC,EAAC,IAAI,EAAE,EAAC,IAAI,EAAE,OAAO,EAAC,EAAC,CAAC,EAArC,CAAqC,GAAI,CAC3D;YACL,6DAAK,SAAS,EAAC,yBAAyB;gBACtC,6DAAK,SAAS,EAAC,uBAAuB;oBACpC,4EAAiB,CACb;gBACN,6DAAK,SAAS,EAAC,uBAAuB;oBACpC,gEAAQ,KAAK,EAAE,MAAM,CAAC,SAAS,IAAI,IAAI,EACrC,QAAQ,EAAE,YAAE,IAAI,mBAAY,CAAC,EAAC,SAAS,EAAE;gCACvC,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC;oCAC9B,SAAS,CAAC,CAAC;oCACX,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;6BAC5B;yBACF,CAAC,EALgB,CAKhB,IACC,gBAAgB,CAAC,GAAG,CAAC,WAAC,IAAI,uEAAQ,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,IAAG,CAAC,CAAU,EAAtC,CAAsC,CAAC,CAC3D,CACL;gBACN,6DAAK,SAAS,EAAC,uBAAuB;oBACpC,2EAAgB,CACZ;gBACN,6DAAK,SAAS,EAAC,uBAAuB;oBACpC,gEAAQ,KAAK,EAAE,MAAM,CAAC,OAAO,IAAI,IAAI,EACnC,QAAQ,EAAE,YAAE,IAAI,mBAAY,CAAC,EAAC,OAAO,EAAE;gCACrC,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC;oCAC9B,SAAS,CAAC,CAAC;oCACX,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;6BAC5B;yBACF,CAAC,EALgB,CAKhB,IACC,cAAc,CAAC,GAAG,CAAC,WAAC,IAAI,uEAAQ,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,IAAG,CAAC,CAAU,EAAtC,CAAsC,CAAC,CACzD,CACL,CACF;YACN,4FAAkC;YAClC,oDAAC,mEAAO,IACN,OAAO,EAAE;oBACP,MAAM;oBACN,QAAQ;oBACR,WAAW;oBACX,eAAe;oBACf,UAAU;oBACV,UAAU;oBACV,OAAO;oBACP,OAAO;oBACP,MAAM;oBACN,MAAM;oBACN,OAAO;iBAAC,EACV,cAAc,EAAE,8EAAe,EAC/B,IAAI,EAAE,MAAM,CAAC,gBAAgB,EAC7B,QAAQ,EAAE,cAAI;oBACZ,YAAY,CAAC,EAAC,gBAAgB,EAAE,EAAC,IAAI,EAAE,IAAI,EAAC,EAAC,CAAC;gBAChD,CAAC,GAAI;YAEP,4EAAkB;YAClB,oDAAC,mFAAgB,IACf,OAAO,EAAE,MAAM,CAAC,OAAO,EACvB,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,EAC7C,MAAM,EAAE,MAAM,EACd,MAAM,EAAE,MAAM,EACd,IAAI,EAAE,IAAI,EACV,sBAAsB,EAAE,sBAAsB,EAC9C,WAAW,EAAE,UAAC,IAAU,EAAE,iBAAgC,IAAK,YAAI,CAAC,WAAW,CAAC,IAAI,EAAE,iBAAiB,CAAC,EAAzC,CAAyC,EACxG,aAAa,EAAE,UAAC,IAAU,IAAK,YAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAxB,CAAwB,EACvD,0BAA0B,EAAE,UAAC,MAAc,EAAE,aAA4B;oBACvE,YAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,aAAa,CAAC;gBAA5C,CAA4C,EAC9C,aAAa,EAAE,UAAC,EAAU,IAAK,YAAI,CAAC,aAAa,CAAC,EAAE,CAAC,EAAtB,CAAsB,EACrD,cAAc,EAAE,UAAC,EAAU,EAAE,IAAU,IAAK,YAAI,CAAC,cAAc,CAAC,EAAE,EAAE,IAAI,CAAC,EAA7B,CAA6B,GAAI;YAE/E,gFAAsB;YACtB,2DAAG,SAAS,EAAC,WAAW,4FAAgF;YACxG,oDAAC,2FAAoB,IACnB,SAAS,EAAE,MAAM,CAAC,SAAS,EAC3B,QAAQ,EAAE,0BAAgB,IAAI,mBAAY,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE,CAAC,EAA7C,CAA6C,EAC3E,IAAI,EAAE,IAAI,GAAI;YAChB,6DAAK,KAAK,EAAE,EAAC,QAAQ,EAAE,UAAU,EAAE,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAC;gBACjD,kBAAkB,GAAG,CAAC,IAAI;oBACzB,2DAAG,SAAS,EAAC,kCAAkC,iBACjC,MAAM,EAClB,OAAO,EAAE,cAAI,YAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,EAAxB,CAAwB,GAAI;wBAAQ;gBACpD,kBAAkB,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI;oBACjD,2DAAG,SAAS,EAAC,oCAAoC,iBACnC,MAAM,EAClB,OAAO,EAAE,cAAI,YAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,EAAvB,CAAuB,GAAI;wBAAQ;gBACpD,oDAAC,sEAAU,IACT,KAAK,EAAC,iBAAiB,EACvB,KAAK,EAAE,EAAC,OAAO,EAAE,cAAc,EAAC,EAChC,OAAO,EAAE,cAAI,cAAO,CAAC,sDAAC,8IAAiB,EAAW,GAAG,KAAd,MAAM,CAAC,IAAI,EAAI,IAAI,IAAI,CAAC,MAAM,CAAC,EAAC,OAAO,EAAE,EAAC,OAAO,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,EAAC,EAAC,CAAC,EAAlG,CAAkG,GAAI,CACjH,CACF;IACR,CAAC;IACH,4BAAC;AAAD,CAAC,CA5N0C,+CAAe,GA4NzD;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjQ8B;AACgB;AACiE;AAErE;AACH;AACY;AACa;AAkBjE;IAAqC,yEAA4B;IAC/D,yBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAOb;QANC,KAAI,CAAC,KAAK,GAAG;YACX,aAAa,EAAE,IAAI;YACnB,kBAAkB,EAAE,IAAI;YACxB,OAAO,EAAE,IAAI;YACb,gBAAgB,EAAE,EAAE;SACrB;;IACH,CAAC;IAED,2CAAiB,GAAjB;QACE,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,sDAAS,CAAC,CAAC;IAC/B,CAAC;IAEK,8BAAI,GAAV;;;;;;wBACE,6DAAQ,CAAC,eAAe,CAAC,CAAC;wBACT,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAU,UAAU,EAAE,EAAE,OAAO,EAAE,iBAAiB,EAAE,CAAC;;wBAA/F,QAAQ,GAAG,SAAoF;wBAC/F,OAAO,GAAG,4DAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,eAAe,EAAjB,CAAiB,CAAC,CAAC,CAAC,IAAI,CAAC,gEAAW,CAAC,MAAM,CAAC,CAAC,CAAC;wBAClF,aAAa,GACjB,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;wBAC7C,6DAAQ,CAAC,EAAE,CAAC,CAAC;wBACb,IAAI,CAAC,QAAQ,CAAC,EAAE,aAAa,iBAAE,CAAC,CAAC;;;;;KAClC;IAEK,wCAAc,GAApB,UAAqB,EAAU;;;;;4BACN,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAS,SAAS,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;;wBAAzF,cAAc,GAAG,SAAwE;wBACzF,aAAa,GAAG,cAAc;6BACjC,MAAM,CAAC,gBAAM,IAAI,aAAM,CAAC,MAAM,EAAb,CAAa,CAAC;6BAC/B,GAAG,CAAC,UAAC,EAAkD;gCAAhD,UAAE,EAAE,kBAAM,EAAE,4BAAW,EAAE,wBAAS,EAAE,0BAAU;4BACpD,EAAE,CAAC,CAAC,WAAW,CAAC;gCAAC,WAAW,GAAG,8DAAS,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;4BAC1D,IAAI,mBAAmB,GAAG,WAAW;gCACnC,CAAC,SAAS,CAAC,CAAC,CAAI,SAAS,CAAC,IAAI,cAAW,CAAC,CAAC;oCAC3C,UAAU,IAAO,UAAU,CAAC,IAAI,cAAW,CAAC,CAAC;4BAC/C,MAAM,CAAC;gCACL,EAAE;gCACF,IAAI,EAAE,MAAM,KAAK,UAAU,CAAC,CAAC;oCAC3B,WAAW,CAAC,CAAC,CAAC,gBAAc,WAAa,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;oCACrD,MAAM,WAAM,8DAAS,CAAC,mBAAmB,EAAE,EAAE,CAAG;gCACrD,MAAM;6BACP,CAAC;wBACJ,CAAC,CAAC,CAAC,IAAI,CAAC,gEAAW,CAAC,MAAM,CAAC,CAAC,CAAC;wBACzB,kBAAkB,GAAG,aAAa,CAAC,MAAM,CAAC,gBAAM,IAAI,aAAM,CAAC,MAAM,KAAK,UAAU,EAA5B,CAA4B,CAAC,CAAC;wBAClF,WAAW,GAAG,aAAa,CAAC,MAAM,CAAC,gBAAM,IAAI,aAAM,CAAC,MAAM,KAAK,UAAU,EAA5B,CAA4B,CAAC,CAAC;wBAC3E,OAAO,GACR,kBAAkB;4BACrB,EAAE,EAAE,MAAE,IAAI,EAAE,KAAK,EAAE;2BAChB,WAAW,CAAC,CAAC;wBAClB,IAAI,CAAC,QAAQ,CAAC;4BACZ,OAAO;4BACP,kBAAkB,EAAE,EAAE;4BACtB,gBAAgB,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE;yBAChC,CAAC,CAAC;;;;;KACJ;IAED,gCAAM,GAAN;QAAA,iBAsEC;QArEO,mBAA6E,EAA3E,gCAAa,EAAE,0CAAkB,EAAE,oBAAO,EAAE,sCAAgB,CAAgB;QACpF,MAAM,CAAC,6DAAK,KAAK,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE;YAC/B,oDAAC,2DAAY,IACX,KAAK,EAAE,sDAAC,qIAAc,MACtB,UAAU,EAAC,eAAe,EAC1B,MAAM,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GAC1C;YACF,6DAAK,SAAS,EAAC,kBAAkB;gBAC/B,6DAAK,SAAS,EAAC,uCAAuC;oBACpD,6DAAK,SAAS,EAAC,uDAAuD;wBACpE,6DAAK,SAAS,EAAC,uDAAuD;4BAEpE,6DAAK,SAAS,EAAC,iCAAiC;gCAC9C,6DAAK,SAAS,EAAE,sCAAsC;oCACpD,6DAAK,SAAS,EAAC,2CAA2C;wCACxD,gFAAsB;wCACtB,+DAAM;wCACN,6DAAK,SAAS,EAAC,yBAAyB;4CACtC,6DAAK,SAAS,EAAC,oBAAoB;gDACjC,0FAA0B,CACtB,CACF;wCACN,6DAAK,SAAS,EAAC,yBAAyB;4CACtC,6DAAK,SAAS,EAAC,oBAAoB,IAChC,CAAC,aAAa,CAAC,CAAC;gDACf;oDAAK,oDAAC,+DAAO,OAAG;oDAAA,gEAAQ,QAAQ,QAAC,KAAK,EAAC,EAAE;wDAAC,yEAAmB,CAAS,CAAM,CAAC,CAAC;gDAC9E,gEACE,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,kBAAkB,EACpC,QAAQ,EAAE,YAAE,IAAI,YAAI,CAAC,cAAc,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,sDAAS,CAAC,EAArD,CAAqD,IAEpE,aAAa,CAAC,GAAG,CAAC,gBAAM;oDACvB,uEAAQ,GAAG,EAAE,MAAM,CAAC,EAAE,EAAE,KAAK,EAAE,MAAM,CAAC,EAAE,IAAG,MAAM,CAAC,IAAI,CAAU;gDAAhE,CAAgE,CACjE,CACM,CACP,CACF;wCACL,OAAO,IAAI,6DAAK,SAAS,EAAC,yBAAyB;4CAClD,6DAAK,SAAS,EAAC,oBAAoB;gDACjC,+FAA0B,CACtB,CACF;wCACL,OAAO,IAAI,6DAAK,SAAS,EAAC,yBAAyB;4CAClD,6DAAK,SAAS,EAAC,oBAAoB;gDACjC,gEAAQ,KAAK,EAAE,gBAAgB,EAAE,QAAQ,EAAE,YAAE,IAAI,YAAI,CAAC,QAAQ,CAAC;wDAC7D,gBAAgB,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK;qDAClC,CAAC,EAF+C,CAE/C,IACC,OAAO,CAAC,GAAG,CAAC,gBAAM;oDACjB,uEAAQ,GAAG,EAAE,MAAM,CAAC,EAAE,EAAE,KAAK,EAAE,MAAM,CAAC,EAAE,IAAG,MAAM,CAAC,IAAI,CAAU;gDAAhE,CAAgE,CACjE,CACM,CACL,CACF;wCACN,+DAAM;wCAAA,+DAAM;wCACX,OAAO,IAAI,gBAAgB,IAAI,oDAAC,qDAAI,IACnC,EAAE,EAAE,mCAAiC,IAAI,CAAC,KAAK,CAAC,gBAAkB,EAClE,SAAS,EAAC,eAAe,YACd,CACT,CACF;gCACN,6DAAK,SAAS,EAAC,uBAAuB;oCACpC,oDAAC,4EAAa,OAAG,CACb,CACF,CAEF,CACF,CACF,CACF,CACF;IACR,CAAC;IACH,sBAAC;AAAD,CAAC,CA9HoC,+CAAe,GA8HnD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvJ8B;AACS;AAC4C;AAEb;AAC5B;AACI;AACO;AAEb;AAC6I;AAE3H;AAEmC;AACnD;AACS;AACgB;AACC;AAErE,IAAM,OAAO,GAAG,yDAAG,CAAC,WAAW,KAAK,YAAY,CAAC,CAAC;IAChD,sDAAS,CAAC,CAAC,CAAC,IAAI,CAAC;AAsBnB,IAAM,wBAAwB,GAC5B,sDAAC,mRAA2E,KAAC;AAE/E,IAAM,aAAa,GAAU;IAC3B,UAAU,EAAE,IAAI;IAChB,YAAY,EAAE,IAAI;IAClB,MAAM,EAAE,IAAI;IACZ,gBAAgB,EAAE,EAAE;IACpB,cAAc,EAAE,KAAK;IACrB,IAAI,EAAE,eAAe;CACtB,CAAC;AAEF;IAAgC,oEAA4B;IA+C1D,oBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAcb;QAbC,KAAI,CAAC,KAAK,sDAAO,aAAa,CAAC,CAAC;QAChC,KAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACrC,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC3C,KAAI,CAAC,WAAW,GAAG,CAAC,CAAC;QACrB,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC3C,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjD,KAAI,CAAC,oBAAoB,GAAG,KAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjE,KAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtB,KAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,EAAE,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC;YAAC,KAAI,CAAC,KAAK,sDACrB,KAAI,CAAC,KAAK,IACb,IAAI,EAAE,KAAK,CAAC,IAAI,GACjB,CAAC;;IACJ,CAAC;IAvDD,qCAAgB,GAAhB,UAAkB,KAAqB;QACrC,MAAM,CAAC,IAAI,CAAC,SAAS,kDAAE,cAAc,EAAE,IAAI,IAAK,KAAK,EAAE,CAAC;IAC1D,CAAC;IAED,4CAAuB,GAAvB,UAAyB,KAAqB;QAC5C,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IAC/B,CAAC;IAED,8BAAS,GAAT,UAAW,KAAqB;QAAhC,iBA8BC;QA7BC,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;YACjB,CAAC;gBACC,EAAE;gBACF,sEAAsE;gBACtE,iBAAiB;gBACjB,EAAE;gBACI,qBAA+B,EAA9B,gBAAK,EAAE,oBAAO,CAAiB;gBACtC,IAAM,aAAW,GAAG,EAAE,CAAC;gBACvB,OAAO,CAAC,OAAO,CAAC,gBAAM,IAAI,aAAM,CAAC,OAAO,CAAC,OAAO,CAAC,YAAE,IAAI,oBAAW,CAAC,EAAE,CAAC,GAAG,IAAI,EAAtB,CAAsB,CAAC,EAApD,CAAoD,CAAC,CAAC;gBAChF,IAAM,mBAAmB,GAAG,KAAK,CAAC,MAAM,CAAC,WAAC,IAAI,oBAAW,CAAC,CAAC,CAAC,EAAE,CAAC,EAAjB,CAAiB,CAAC,CAAC;gBACjE,IAAM,cAAc,sDAAO,KAAK,CAAC,MAAM,CAAC,CAAC;gBACzC,cAAc,CAAC,KAAK,GAAG,mBAAmB,CAAC;gBAC3C,KAAK,sDAAO,KAAK,IAAE,MAAM,EAAE,cAAc,GAAC,CAAC;YAC7C,CAAC;QACH,CAAC;QAED,+DAA+D;QAC/D,+DAA+D;QAC/D,wCAAwC;QACxC,IAAI,UAAU,GAAG,KAAK,CAAC,UAAU,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;QAC3D,IAAM,MAAM,GAAG,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;QACjD,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YACf,IAAM,YAAY,GAAG,UAAU,CAAC,SAAS,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,KAAI,CAAC,KAAK,CAAC,EAAE,EAAtB,CAAsB,CAAC,CAAC;YACvE,UAAU,GAAG,0DAAM,CAAC,UAAU,EAAE,EAAC,OAAO,EAAE,CAAC,CAAC,YAAY,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC;YACxE,KAAK,sDAAO,KAAK,CAAC,CAAC;YACnB,KAAK,CAAC,UAAU,GAAG,UAAU,CAAC;QAChC,CAAC;QAED,MAAM,CAAC,IAAI,OAAO,CAAC,iBAAO,IAAI,wBAAM,QAAQ,aAAC,cAAI,YAAc,EAAd,CAAc,EAAE,OAAO,CAAC,EAA3C,CAA2C,CAAC,CAAC;IAC7E,CAAC;IAmBD,uCAAkB,GAAlB;QACE,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QAC3B,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QACnD,MAAM,CAAC,gBAAgB,CAAC,cAAc,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QAC3D,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;IACrE,CAAC;IAED,yCAAoB,GAApB;QACE,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QACtD,MAAM,CAAC,mBAAmB,CAAC,cAAc,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QAC9D,QAAQ,CAAC,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;QACtE,wEAAyB,CAAC,EAAE,CAAC,CAAC;IAChC,CAAC;IAED,8CAAyB,GAAzB,UAA0B,SAAgB;QACxC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;YACpC,EAAE,CAAC,CAAC,SAAS,CAAC,EAAE,KAAK,IAAI,CAAC,KAAK,CAAC,EAAE,IAAI,SAAS,CAAC,UAAU,KAAK,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;gBACrF,IAAI,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC;YACvC,CAAC;QACH,CAAC;QACD,EAAE,CAAC,CAAC,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;YACvC,IAAI,CAAC,uBAAuB,CAAC,EAAC,IAAI,EAAE,SAAS,CAAC,IAAI,EAAC,CAAC,CAAC;QACvD,CAAC;IACH,CAAC;IAED,uCAAkB,GAAlB,UAAmB,SAAgB,EAAE,SAAgB;QACnD,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;YACpB,IAAM,UAAU,GAAmB,6DAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAChE,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;gBACf,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC,qBAAqB,EAAE,CAAC,GAAG,CAAC;YAC5D,CAAC;QACH,CAAC;QAED,EAAE,CAAC,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;YAClC,mCAAmC;YACnC,uFAAuF;YACvF,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,KAAK,SAAS,CAAC,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU,KAAK,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;gBACrF,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YAC7B,CAAC;QACH,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;YAC3D,wEAAyB,CAAC,SAAS,CAAC,CAAC;QACvC,CAAC;IACH,CAAC;IAEK,qCAAgB,GAAtB,UAAuB,UAAkB;;;;;;wBACvC,6DAAQ,CAAC,0BAA0B,CAAC,CAAC;wBACpB,qBAAM,yDAAU,CAAC,UAAU,EAAE,EAAC,oBAAoB,EAAE,IAAI,EAAC,CAAC;;wBAArE,QAAQ,GAAG,SAA0D;wBACrE,MAAM,GAAG,kEAAmB,CAAC,IAAI,CAAC,GAAG,EAAE,EAAE,QAAQ,EAAE,wDAAG,CAAC,WAAW,CAAC,CAAC;wBAC1E,MAAM,CAAC,EAAE,GAAG,oEAAU,EAAE,CAAC;wBACzB,MAAM,CAAC,QAAQ,GAAG,UAAU,CAAC;wBAC7B,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC;wBACtB,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC;wBAC1B,MAAM,CAAC,aAAa,GAAO,MAAM,CAAC,aAAa,QAAC,CAAC;wBACjD,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAW,CAAC,CAAC;wBAC9D,QAAQ,GAAG,wDAAG,CAAC,WAAW,CAAC,MAAM,CAAC;wBACxC,MAAM,CAAC,MAAM,GAAG,QAAQ,CAAC;wBACzB,MAAM,CAAC,WAAW,GAAG,EAAE,CAAC;wBACxB,MAAM,CAAC,mBAAmB,GAAG,EAAE,CAAC;wBAChC,MAAM,CAAC,GAAG,GAAG;4BACX,aAAa;4BACb,gBAAc,QAAQ,gBAAa,CAAC,qEAAqE;yBAC1G,CAAC;wBACF,OAAO,MAAM,CAAC,KAAK,CAAC;wBACpB,OAAO,MAAM,CAAC,SAAS,CAAC;wBACxB,OAAO,MAAM,CAAC,WAAW,CAAC;wBAC1B,OAAO,MAAM,CAAC,UAAU,CAAC;wBACzB,OAAO,MAAM,CAAC,YAAY,CAAC;wBAC3B,OAAO,MAAM,CAAC,WAAW,CAAC;wBAC1B,OAAO,MAAM,CAAC,aAAa,CAAC;wBAC5B,OAAO,MAAM,CAAC,mBAAmB,CAAC;wBAClC,OAAO,MAAM,CAAC,kBAAkB,CAAC;wBACjC,qBAAM,IAAI,CAAC,gBAAgB,CAAC,EAAE,MAAM,UAAE,UAAU,EAAE,IAAI,EAAE,YAAY,EAAE,QAAQ,EAAE,CAAC;;wBAAjF,SAAiF,CAAC;wBAClF,6DAAQ,CAAC,EAAE,CAAC,CAAC;;;;;KACd;IAEK,yBAAI,GAAV;;;;;wBACE,wEAAyB,CAAC,EAAE,CAAC,CAAC;6BAC1B,IAAI,CAAC,KAAK,CAAC,EAAE,EAAb,wBAAa;wBACf,qBAAM,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;;wBAA5C,SAA4C,CAAC;;;6BACpC,IAAI,CAAC,KAAK,CAAC,UAAU,EAArB,wBAAqB;wBAC9B,qBAAM,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;;wBAAlD,SAAkD,CAAC;;4BAEnD,MAAM,IAAI,KAAK,CAAC,sDAAC,2NAAoD,KAAC,CAAC;;;;;KAE1E;IAEK,uCAAkB,GAAxB,UAAyB,QAAgB;;;;;;wBACvC,6DAAQ,CAAC,aAAa,CAAC,CAAC;wBACT,qBAAM,yDAAU,CAAC,QAAQ,CAAC;;wBAAnC,MAAM,GAAG,SAA0B;wBACzC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,mBAAmB,CAAC;4BAAC,MAAM,CAAC,mBAAmB,GAAG,EAAE,CAAC;wBACjE,qBAAM,IAAI,CAAC,uBAAuB,CAAC,EAAE,MAAM,UAAE,UAAU,EAAE,MAAM,EAAE,CAAC;;wBAAlE,SAAkE,CAAC;wBACnE,6DAAQ,CAAC,EAAE,CAAC,CAAC;;;;;KACd;IAEK,2BAAM,GAAZ,UAAa,aAAa;;;;4BACxB,qBAAM,IAAI,CAAC,gBAAgB,CAAC,EAAE,MAAM,EAAE,0DAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,aAAa,CAAC,EAAE,CAAC;;wBAAjF,SAAiF,CAAC;;;;;KACnF;IAEK,iCAAY,GAAlB;;;;;;wBACE,6DAAQ,CAAC,mBAAmB,CAAC,CAAC;wBACxB,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC;wBACxC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC;wBACtC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;wBAEd,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAS,SAAS,EAAE;gCAClE,UAAU,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;6BAC5B,CAAC;;wBAFI,QAAQ,GAAG,SAEf;wBACI,EAAE,GAAG,IAAI,6DAAW,EAAE,CAAC;wBAC7B,GAAG,CAAC,OAA8B,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ;4BAAvB,WAAW;4BACpB;;;;+BAIG;yBACJ;wBAED,EAAE,CAAC,MAAM,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;wBAC/B,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,KAAK,CAAC,EAAE,CAAC,gBAAgB,CAAC;;wBAArD,SAAqD,CAAC;wBACtD,EAAE,CAAC,CAAC,YAAY,KAAK,wDAAG,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC;4BAC5C,0EAAmB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;wBACvC,CAAC;wBACD,6DAAQ,CAAC,EAAE,CAAC,CAAC;wBACb,QAAQ,CAAC,IAAI,GAAG,eAAe,CAAC;;;;;KACjC;IAEK,yBAAI,GAAV;;;;;;wBACE,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC;4BAAC,MAAM,gBAAC;;;;wBAExB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;wBACrB,qBAAM,IAAI,CAAC,KAAK,EAAE;;wBAAlB,SAAkB,CAAC;;;;wBAEf,YAAY,GAAG,KAAG,IAAI,KAAG,CAAC,OAAO,CAAC,CAAC,CAAC,KAAG,CAAC,OAAO,CAAC,CAAC,CAAC,sDAAC,6LAAgC,KAAC;wBACxF,EAAE,CAAC,CAAC,KAAG,CAAC,CAAC,CAAC;4BACR,EAAE,CAAC,CAAC,KAAG,CAAC,IAAI,KAAK,SAAS,IAAI,KAAG,CAAC,IAAI,KAAK,SAAS,IAAI,KAAG,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC;gCAC/E,wCAAwC;gCACxC,YAAY,GAAG,sDAAC,uSAAgF,KAAC;4BACnG,CAAC;4BAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAG,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC;gCAClC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC;oCAC/B,YAAY,GAAG,sDAAC,6SAAwF,KAAC;gCAC3G,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC;oCAChC,YAAY,GAAG,sDAAC,yPAAqC,EAAsB,wDAA+C,EAAwB,EAAE,KAA/F,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAA+C,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAE,CAAC;4BACzJ,CAAC;wBACH,CAAC;wBACD,8DAAS,CAAC,YAAY,CAAC,CAAC;wBACxB,wEAAyB,CAAC,OAAO,CAAC,CAAC;;;wBAEnC,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;;;;;;KAEzB;IAEa,0BAAK,GAAnB;;;;;;wBACQ,KAAuC,IAAI,CAAC,KAAK,EAA/C,MAAM,cAAE,UAAU,kBAAE,YAAY,mBAAgB;wBAClD,gCAAgC,GAAG,0FAAiC,CAAC,MAAM,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;wBAEhG,6DAAQ,CAAC,sDAAC,+HAAW,KAAC,CAAC;wBACnB,cAAc,GAAW,sEAAuB,CAAC,IAAI,CAAC,GAAG,EAAE,EAAE,MAAM,EAAE,wDAAG,CAAC,WAAW,CAAC,CAAC;wBAEpF,KAAK,GAAG,IAAI,6DAAW,EAAE,CAAC;wBAO1B,IAAI,GAAG,UAAU,IAAI,YAAY,CAAC;wBAClC,cAAc,GAAG,cAAc,CAAC,KAAK,CAAC,GAAG,CAAC,cAAI;4BAClD,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,KAAK,KAAK,IAAI,IAAI,CAAC,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC;gCACpD,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,EAAhB,CAAgB,CAAC,CAAC;gCACxD,MAAM,CAAC,mEAAoB,CAAC,QAAQ,IAAI,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE;oCACzD,qBAAqB,EAAE,wBAAwB;oCAC/C,cAAc,EAAE,iBAAiB;oCACjC,SAAS,EAAE,WAAW;iCACvB,EAAE,KAAK,CAAC,CAAC;4BACZ,CAAC;4BAAC,IAAI,CAAC,CAAC;gCACN,IAAM,WAAW,sDAAO,IAAI,CAAC,CAAC;gCAC9B,OAAO,WAAW,CAAC,KAAK,CAAC;gCACzB,MAAM,CAAC,WAAW,CAAC;4BACrB,CAAC;wBACH,CAAC,CAAC,CAAC;wBACH,cAAc,GAAG,0DAAM,CAAC,cAAc,EAAE,EAAC,KAAK,EAAE,EAAC,IAAI,EAAE,cAAc,EAAC,EAAC,CAAC,CAAC;wBAEzE,cAAc,GAAG,mEAAoB,CAAC,UAAU,IAAI,EAAE,EAAE,cAAc,EAAE,SAAS,EAAE;4BACjF,aAAa,EAAE,SAAS;4BACxB,cAAc,EAAE,iBAAiB;4BACjC,qBAAqB,EAAE,wBAAwB;4BAC/C,SAAS,EAAE,WAAW;4BACtB,MAAM,EAAE,QAAQ;4BAChB,KAAK,EAAE,OAAO;yBACf,EAAE,KAAK,CAAC,CAAC;wBAEV,cAAc,sDAAO,cAAc,CAAE,CAAC;wBACtC,cAAc,CAAC,WAAW,GAAG,gCAAgC,CAAC;wBACxD,IAAI,GAAG,CAAC,cAAc,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,aAAG,IAAI,UAAG,KAAK,YAAY,EAApB,CAAoB,CAAC,CAAC;wBAC7E,cAAc,CAAC,IAAI,GAAG,cAAc,CAAC,WAAW,CAAC,CAAC;4BAChD,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;6BAE/B,CAAC,UAAU,EAAX,wBAAW;wBACb,gCAAgC;wBAChC,KAAK,CAAC,GAAG,CAAC,SAAS,EAAE,cAAc,CAAC,CAAC;6BACjC,MAAM,CAAC,MAAM,EAAb,wBAAa;wBACE,qBAAM,0EAAmB,CAAC,WAAW,EAAE;;wBAAlD,QAAQ,GAAG,SAAuC;wBACxD,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;wBACjE,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;4BAClB,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;wBACzE,CAAC;;;;wBAGH,wCAAwC;wBACxC,KAAK,CAAC,GAAG,CAAC,SAAS,EAAE,cAAc,CAAC,CAAC;6BACjC,EAAC,UAAU,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,GAAnC,wBAAmC;wBAEpB,qBAAM,0EAAmB,CAAC,WAAW,EAAE;;wBAAlD,QAAQ,GAAG,SAAuC;wBACxD,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;;;6BAC9D,WAAU,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,GAAnC,wBAAmC;wBAE3B,qBAAM,0EAAmB,CAAC,WAAW,EAAE;;wBAAlD,QAAQ,GAAG,SAAuC;wBACxD,KAAK,CAAC,MAAM,CAAC,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;;4BAKjE,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,CAAC,gBAAgB,CAAC;;wBAA9D,GAAG,GAAG,SAAwD;wBACpE,6DAAQ,CAAE,UAAU,CAAC,CAAC,CACpB,sDAAC,qKAAyB,KAAC,CAAC,CAC5B,sDAAC,iJAAoB,KAAC,CAAC;wBACzB,gDAAgD;wBAChD,EAAE,CAAC,CAAC,GAAG,IAAI,GAAG,CAAC,QAAQ,CAAC;4BACpB,cAAc,GAAG,yDAAU,CAAC,cAAc,EAAE,GAAG,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAW,CAAC;wBAE7F,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,KAAK,wDAAG,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC;4BAC7C,6BAA6B;4BAC7B,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;gCAChB,0EAAmB,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;4BAC7C,CAAC;4BAAC,IAAI,CAAC,CAAC;gCACN,0EAAmB,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;4BAC7C,CAAC;wBACH,CAAC;wBAED,qBAAM,IAAI,CAAC,uBAAuB,CAAC,EAAC,MAAM,EAAE,cAAc,EAAE,UAAU,EAAE,cAAc,EAAE,cAAc,EAAE,KAAK,EAAC,CAAC;;wBAA/G,SAA+G,CAAC;wBAChH,wEAAyB,CAAC,EAAE,CAAC,CAAC;wBAC9B,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;4BAChB,mGAAmG;4BACnG,QAAQ,CAAC,IAAI,GAAG,eAAa,cAAc,CAAC,EAAE,UAAO,CAAC;wBACxD,CAAC;;;;;KACF;IAED,oCAAe,GAAf;QAAA,iBAkBC;QAjBC,IAAM,MAAM,sDAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACtC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;YACnB;;;cAGE;YAEF,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC;YACrB,MAAM,CAAC,WAAW,GAAG;gBACnB,IAAI,EAAE,wDAAG,CAAC,WAAW,CAAC,WAAW;gBACjC,GAAG,EAAE,SAAS,GAAI,wDAAG,CAAC,WAAW,CAAC,IAAI;aACvC,CAAC;YACF,MAAM,CAAC,aAAa,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YAClC,IAAI,CAAC,gBAAgB,CAAC,EAAC,MAAM,UAAC,CAAC;iBAC5B,IAAI,CAAC,cAAI,YAAI,CAAC,IAAI,EAAE,EAAX,CAAW,CAAC;iBACrB,KAAK,CAAC,OAAO,CAAC,CAAC;QACpB,CAAC;IACH,CAAC;IAED,sCAAiB,GAAjB;QAAA,iBAaC;QAZC,IAAM,MAAM,sDAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACtC,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;YAClB,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC;YACtB,MAAM,CAAC,aAAa,GAAG;gBACrB,IAAI,EAAE,wDAAG,CAAC,WAAW,CAAC,WAAW;gBACjC,GAAG,EAAE,SAAS,GAAI,wDAAG,CAAC,WAAW,CAAC,IAAI;aACvC,CAAC;YACF,MAAM,CAAC,eAAe,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;YACpC,IAAI,CAAC,gBAAgB,CAAC,EAAC,MAAM,UAAC,CAAC;iBAC5B,IAAI,CAAC,cAAI,YAAI,CAAC,IAAI,EAAE,EAAX,CAAW,CAAC;iBACrB,KAAK,CAAC,OAAO,CAAC,CAAC;QACpB,CAAC;IACH,CAAC;IAED,+BAAU,GAAV,UAAW,eAAgC;QACzC,IAAI,CAAC,uBAAuB,CAAC,EAAC,gBAAgB,EAAE,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,CAAC,eAAe,CAAC,EAAC,CAAC,CAAC;IACxG,CAAC;IAED,gCAAW,GAAX;QACS,kDAAgB,CAAe;QAC/B,oCAAM,CAAqB;QAClC,MAAM,IAAI,IAAI,CAAC,uBAAuB,CAAC,EAAC,gBAAgB,EAAE,gBAAgB,CAAC,KAAK,CAAC,CAAC,EAAE,MAAM,GAAG,CAAC,CAAC,EAAC,CAAC,CAAC;QAClG,6DAA6D;QAC7D,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,MAAM;YAAE,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;IAC3D,CAAC;IAED,8BAAS,GAAT,UAAU,MAAgC,EAAE,KAAa;QACvD,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,CAAC,wGAAwG;IACxI,CAAC;IAED,8BAAS,GAAT,UAAW,EAAiB;QAC1B,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAClD,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC3C,IAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,MAAM,CAAC;YACT,CAAC;YACD,IAAI,CAAC,IAAI,EAAE,CAAC;QACd,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,KAAK,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YACrE,IAAI,CAAC,WAAW,EAAE,CAAC;YACnB,EAAE,CAAC,cAAc,EAAE,CAAC;QACtB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,KAAK,EAAE,CAAC,CAAC,CAAC;YAC3B,IAAM,UAAU,GAAG,EAAE,CAAC,MAAqB,CAAC;YAC5C,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC;gBACxC,UAAU,CAAC,OAAO,KAAK,UAAU;gBACjC,UAAU,CAAC,OAAO,KAAK,OAAO;gBAC9B,UAAU,CAAC,OAAO,KAAK,QAAQ;gBAC/B,UAAU,CAAC,OAAO,KAAK,QAAQ;gBAC/B,CAAC,UAAU,CAAC,eAAe,CAAC,CAC9B,CAAC;gBACC,IAAI,CAAC,UAAU,EAAE,CAAC;YACpB,CAAC;QACH,CAAC;IACH,CAAC;IAED,iCAAY,GAAZ,UAAa,EAAS;QACpB,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;YACxE,EAAE,CAAC,CAAC,CAAC,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,CAAC;gBAC5D,EAAE,CAAC,WAAW,GAAG,wBAAwB,CAAC;gBAC1C,MAAM,CAAC,EAAE,CAAC,WAAW,CAAC;YACxB,CAAC;QACH,CAAC;IACH,CAAC;IAED,yCAAoB,GAApB,UAAqB,EAAS;QAC5B,EAAE,CAAC,CAAC,EAAE,CAAC,MAAM,IAAI,CAAC,EAAE,GAAE,EAAE,CAAC,MAAc,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,KAAK,GAAG,CAAC,CAAC,CAAC;YACvE,IAAM,CAAC,GAAsB,EAAE,CAAC,MAA2B,CAAC;YAC5D,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;gBAC1D,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,CAAC;oBACxE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,wBAAwB,CAAC,CAAC,CAAC,CAAC;wBACvC,EAAE,CAAC,cAAc,EAAE,CAAC;wBACpB,EAAE,CAAC,eAAe,EAAE,CAAC;wBACrB,MAAM,CAAC,KAAK,CAAC;oBACf,CAAC;gBACH,CAAC;YACH,CAAC;QACH,CAAC;IACH,CAAC;IAED,+BAAU,GAAV;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAC3C,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,MAAM,GAAC,CAAC,CAAC,CAAC,CAAC,kGAAkG;YACrK,MAAM,IAAI,MAAM,CAAC,IAAI,EAAE,CAAC;QAC1B,CAAC;IACH,CAAC;IAED,2BAAM,GAAN;QAAA,iBAmDC;QAlDC,IAAM,OAAO,GAAG,wDAAG,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC5D,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;QACjC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,6DAAK,KAAK,EAAE,EAAC,OAAO,EAAE,CAAC,EAAC;YAClD,oDAAC,2DAAY,IACX,KAAK,EAAC,EAAE,EACR,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,EAC3B,MAAM,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GAC1C;YAAA;gBAAG,oDAAC,gEAAO,OAAE;yDAAqC,CAC9C,CAAC,CAAC;YACR,6DAAK,KAAK,EAAE,EAAC,OAAO,EAAE,CAAC,EAAC;gBACxB,oDAAC,2DAAY,IACX,KAAK,EAAE,MAAM,CAAC,IAAI,GAAG,KAAK,GAAG,MAAM,CAAC,MAAM,GAAG,GAAG,EAChD,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,EAC3B,MAAM,EAAE;wBACN,WAAW,EAAE,mFAA0B,CAAC,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,EAAC,CAAC;wBAC5F,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW;qBACjC,EACD,IAAI,EAAE,IAAI,EACV,MAAM,EAAE,MAAM,EACd,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,EACjC,eAAe,EAAE,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,aAAG,IAAI,UAAG,CAAC,EAAE,KAAK,MAAM,CAAC,OAAO,EAAzB,CAAyB,CAAC,CAAC,GAAG,CAAC,aAAG,IAAE,UAAG,CAAC,GAAG,EAAP,CAAO,CAAC,CAAC,CAAC,CAAC,EAC5F,UAAU,EAAE,MAAM,CAAC,UAAU,GAC5B;gBACH,6DAAK,SAAS,EAAC,kBAAkB;oBAC/B,6DAAK,SAAS,EAAC,uCAAuC;wBACpD,6DAAK,SAAS,EAAC,uDAAuD;4BACpE,6DAAK,SAAS,EAAC,uDAAuD,EAAC,GAAG,EACxE,aAAG,IAAI,YAAI,CAAC,UAAU,GAAG,GAAG,EAArB,CAAqB;gCAC5B,oDAAC,kEAAe,IACd,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,EACzB,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,EACjC,IAAI,EAAE,IAAI,GAAI;gCAChB,+DAAK;gCACJ,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,GAAG,CAAC,UAAC,EAAkB,EAAE,CAAC;wCAApB,wBAAS,EAAE,gBAAK;oCACjD,MAAM,CAAC,6DAAK,GAAG,EAAE,CAAC;wCAChB,6DAAK,SAAS,EAAC,QAAQ,GACjB;wCACN,6DAAK,SAAS,EAAC,iBAAiB;4CAC9B,6DAAK,SAAS,EAAC,YAAY;gDACzB,oDAAC,SAAS,mDAAC,GAAG,EAAE,gBAAM,IAAE,YAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC,EAAzB,CAAyB,IAAM,KAAK,EAAI;gDAChE,oDAAC,uEAAU,IAAC,OAAO,EAAE,cAAI,YAAI,CAAC,WAAW,EAAE,EAAlB,CAAkB,GAAI,CAC3C,CACF,CACF;gCACR,CAAC,CAAC,CACE,CACF,CACF,CACF,CACF;IACR,CAAC;IACH,iBAAC;AAAD,CAAC,CAvd+B,+CAAe,GAud9C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9gB8B;AACU;AAEE;AACA;AAEI;AACe;AACV;AAYpD;IAA6B,iEAA4B;IACvD,iBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,KAAK,GAAG;YACX,QAAQ,EAAE,IAAI;SACf,CAAC;;IACJ,CAAC;IAED,oCAAkB,GAAlB;QACE,IAAI,CAAC,IAAI,EAAE,CAAC;IACd,CAAC;IAEK,sBAAI,GAAV;;;;;4BACmB,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAU,UAAU,EAAE,EAAE,OAAO,EAAE,iBAAiB,EAAE,CAAC;;wBAA/F,QAAQ,GAAG,SAAoF;wBACrG,IAAI,CAAC,QAAQ,CAAC,EAAE,QAAQ,YAAE,CAAC,CAAC;;;;;KAC7B;IAED,wBAAM,GAAN;QACE,IAAM,OAAO,GAAa,EAAE,CAAC;QAC7B,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,WAAC,IAAI,cAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,eAAe,CAAC,EAA9C,CAA8C,CAAC,CAAC;QACxG,OAAO,CAAC,IAAI,CAAC,UAAC,EAAE,EAAE,EAAE,IAAK,SAAE,CAAC,IAAI,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAlD,CAAkD,CAAC,CAAC;QAC7E,MAAM,CAAC;YACL,oDAAC,2DAAY,IACX,KAAK,EAAE,sDAAC,iIAAY,MACpB,UAAU,EAAC,iBAAiB,EAC5B,MAAM,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GAC1C;YACD,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;gBACrB;oBAAG,oDAAC,+DAAO,OAAG;0DAAkC,CAAC,CAAC;gBAClD,oDAAC,0EAAmB,IAAC,OAAO,EAAE,OAAO,GAAI,CACrC;IACV,CAAC;IACH,cAAC;AAAD,CAAC,CAhC4B,+CAAe,GAgC3C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpD8B;AAEiD;AAC5C;AACoB;AACS;AAE0C;AAC1D;AAI6B;AAC1B;AACwB;AACX;AACS;AACM;AACN;AAMzE,CAAC;AAMF;IAAqC,yEAA4B;IAG/D,yBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,KAAK,GAAG;YACX,cAAc,EAAE,KAAK;SACtB,CAAC;;IACJ,CAAC;IAED,qCAAW,GAAX,UAAY,QAAgB;QAClB,8BAAM,CAAgB;QAC9B,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;QAEtB,CAAC;IACH,CAAC;IAED,gCAAM,GAAN;QACQ,mBAAyC,EAAvC,kBAAM,EAAE,0BAAU,EAAE,cAAI,CAAgB;QAChD,IAAM,8BAA8B,GAAG,yFAAiC,CAAC,MAAM,CAAC,CAAC;QACjF,IAAM,sBAAsB,GAAG,+EAAuB,CAAC,MAAM,CAAC,CAAC;QAC/D,IAAM,mBAAmB,GAAG,mEAAW,CAAC,MAAM,CAAC,CAAC;QAChD,IAAM,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAG,IAAI,UAAG,CAAC,EAAE,KAAK,MAAM,CAAC,OAAO,EAAzB,CAAyB,CAAC,CAAC;QACzE,IAAM,qBAAqB,GAAG,WAAW,IAAI,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAEjF,MAAM,CAAC,6DAAK,SAAS,EAAC,iCAAiC;YACrD,6DAAK,SAAS,EAAE,sCAAsC;gBACpD,6DAAK,SAAS,EAAC,2CAA2C;oBACvD,MAAM,CAAC,UAAU,IAAI,2EAAiB;oBACvC,wFAAyB;oBACzB,+DAAM;oBACN,6DAAK,SAAS,EAAC,WAAW;wBACxB;4BACE,+EAAqB;4BACpB,qBAAqB,CAAC,CAAC;gCACtB,6VACyG;gCACxG,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;oCAAK,kEACpB,KAAK,EAAE,WAAW,CAAC,GAAG,EACtB,KAAK,EAAE,EAAC,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAC,EACtC,QAAQ,EAAE,YAAE,IAAE,4EAAc,CAAC,MAAM,EAAE,UAAU,EAAE,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,EAAzD,CAAyD,GAAG;oCAC1E,gUACoJ,CAChJ,CAAC,CAAC;oCACN,uNACoG;4BACxG,+DAAK,CACD;wBAEL,CAAC,MAAM,CAAC,UAAU,IAAI;4BACrB,8EAAoB;4BACpB,2DAAG,SAAS,EAAC,WAAW,gGAAyF;4BACjH,kEAAU,SAAS,EAAC,6BAA6B,EAC/C,KAAK,EAAE,MAAM,CAAC,WAAW,EACzB,QAAQ,EAAE,YAAE,IAAI,WAAI,CAAC,MAAM,CAAC,EAAE,WAAW,EAAE,EAAE,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,EAAE,EAAE,CAAC,EAAvD,CAAuD,GAAI;4BAC7E,+DAAM,CACF;wBAEN;4BACE,+EAAqB;4BACrB,2DAAG,SAAS,EAAC,WAAW,yDAAkD;4BAC1E,oDAAC,0EAAO,IACN,IAAI,EAAE,MAAM,CAAC,SAAS,EACtB,cAAc,EAAE,+EAAe,EAC/B,OAAO,EAAE;oCACP,MAAM;oCACN,QAAQ;oCACR,WAAW;oCACX,eAAe;oCACf,UAAU;oCACV,UAAU;oCACV,OAAO;oCACP,OAAO;oCACP,MAAM;oCACN,MAAM;oCACN,OAAO;iCAAC,EACV,QAAQ,EAAE,iBAAO,IAAI,WAAI,CAAC,MAAM,CAAC,EAAE,SAAS,EAAE,EAAC,IAAI,EAAE,OAAO,EAAC,EAAC,CAAC,EAA1C,CAA0C,GAAI;4BACrE,+DAAM,CACF;wBAEN,+EAAqB;wBACrB,2DAAG,SAAS,EAAC,WAAW,wDAAiD;wBACzE,oDAAC,2FAAoB,IACnB,SAAS,EAAE,MAAM,CAAC,SAAS,EAC3B,QAAQ,EAAE,0BAAgB,IAAI,WAAI,CAAC,MAAM,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE,CAAC,EAA5C,CAA4C,EAC1E,IAAI,EAAE,IAAI,GAAI;wBAChB,+DAAM;wBACN,kFAAmB;wBACnB,2DAAG,SAAS,EAAC,WAAW,iEAAgD;wBACxE,oDAAC,4FAAoB,IACnB,GAAG,EAAE,MAAM,CAAC,YAAY,EACxB,QAAQ,EAAE,iBAAO,IAAI,WAAI,CAAC,MAAM,CAAC,EAAE,YAAY,EAAE,OAAO,EAAE,CAAC,EAAtC,CAAsC,EAC3D,IAAI,EAAE,IAAI,GAAI;wBAChB,+DAAM;wBACL,CAAC,MAAM,CAAC,UAAU,IAAI;4BACrB,mFAAyB;4BACzB,6DAAK,SAAS,EAAC,yBAAyB;gCACtC,6DAAK,SAAS,EAAC,oBAAoB;oCACjC,+DACE,WAAW,EAAC,sBAAsB,EAClC,IAAI,EAAC,MAAM,EACX,IAAI,EAAE,EAAE,EACR,KAAK,EAAE,MAAM,CAAC,kBAAkB,EAChC,QAAQ,EAAE,YAAE,IAAI,WAAI,CAAC,MAAM,CAAC,EAAC,kBAAkB,EAAE,EAAC,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,EAAC,EAAC,CAAC,EAA1D,CAA0D,GAAG,CAC3E;gCACN,6DAAK,SAAS,EAAC,oBAAoB;oCACjC,+DACE,WAAW,EAAC,KAAK,EACjB,IAAI,EAAC,MAAM,EACX,IAAI,EAAE,CAAC,EACP,KAAK,EAAE,MAAM,CAAC,mBAAmB,EACjC,QAAQ,EAAE,YAAE,IAAI,WAAI,CAAC,MAAM,CAAC,EAAC,mBAAmB,EAAE,EAAC,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,EAAC,EAAC,CAAC,EAA3D,CAA2D,GAAI,CAC7E,CACF,CACF;wBAEN,+DAAM;wBACL,CAAC,MAAM,CAAC,UAAU,IAAI;4BAAE,oDAAC,yFAAmB,IAC3C,QAAQ,EAAE,MAAM,CAAC,mBAAmB,EACpC,QAAQ,EAAE,wBAAc;oCACtB,IAAI,CAAC,MAAM,CAAC,EAAC,mBAAmB,EAAE,cAAc,EAAC,CAAC,CAAC;gCACrD,CAAC,GAAI;4BACP,+DAAM;4BACN,yFAA0B;4BAC1B,+DAAO,QAAQ,EAAE,CAAC,EAAE,KAAK,EAAE,EAAC,KAAK,EAAE,MAAM,EAAC;gCACxC;oCAAO;wCAAI,gFAEN,CAAK,CAAQ;gCAClB;oCACE;wCACE;4CACE,oDAAC,mFAAc,IACb,KAAK,EAAE,IAAI,EACX,kBAAkB,EAAC,6EAA8D,EACjF,IAAI,EAAE,MAAM,CAAC,gBAAgB,CAAC,CAAC,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAC/D,WAAW,EAAC,4CAAuC,EACnD,GAAG,EAAC,OAAO,EACX,QAAQ,EAAE,eAAK,IAAI,WAAI,CAAC,MAAM,CAAC,EAAC,gBAAgB,EAAE,EAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAC,EAAC,CAAC,EAAhD,CAAgD,GACnE,CACC,CACF,CACC,CACF,CACL,CAEC;oBACN,6DAAK,SAAS,EAAC,4BAA4B,EAAC,EAAE,EAAC,iCAAiC;wBAC9E,6DAAK,EAAE,EAAC,gBAAgB,GAClB;wBACN,kFAAwB;wBACxB,+DAAM,CACF;oBACN,oDAAC,oEAAgB,IACf,IAAI,EAAE,IAAI,EACV,MAAM,EAAE,MAAM,EACd,sBAAsB,EAAE,sBAAsB,GAAI;oBAEpD;wBACE,+DAAK;wBACL,oDAAC,wFAAkB,IAAC,MAAM,EAAE,MAAM,GAAG,CACjC;oBAEN,6DAAK,SAAS,EAAC,4BAA4B;wBACzC,iFAAuB;wBACvB,+DAAM;wBACL,MAAM,CAAC,SAAS,IAAI,MAAM,CAAC,WAAW,IAAI;;4BACxB,uDAAQ,CAAC,MAAM,CAAC,WAAW,CAAC;;4BAAK,oEAAS,MAAM,CAAC,SAAS,CAAC,IAAI,CAAU;gCACxF;wBACH,MAAM,CAAC,UAAU,IAAI,MAAM,CAAC,YAAY,IAAI;;4BAChB,uDAAQ,CAAC,MAAM,CAAC,YAAY,CAAC;;4BAAK,oEAAS,MAAM,CAAC,UAAU,CAAC,IAAI,CAAU;gCACpG;wBACH,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;;4BACL,4EAAsB;;4BAAQ,uDAAQ,CAAC,MAAM,CAAC,aAAa,CAAC;;4BAAK,oEAAS,MAAM,CAAC,WAAW,CAAC,IAAI,CAAU;gCACnH,CAAC,CAAC,CAAC;;4BACO,8EAAwB;4BAAC,MAAM,CAAC,aAAa,CAAC,CAAC,CAAC;;gCACjD,uDAAQ,CAAC,MAAM,CAAC,eAAe,CAAC;;gCAAK,oEAAS,MAAM,CAAC,aAAa,CAAC,IAAI,CAAU;oCAAQ,CAAC,CAAC,CAAC,sEAAc,CAEjH;wBACL,CAAC,8BAA8B,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;4BAC7C,2DAAG,SAAS,EAAC,aAAa,+EAAmE,CAAC,CAAC;4BAC/F,6DAAK,SAAS,EAAC,uBAAuB;gCAAC,6DAAK,SAAS,EAAC,aAAa;oCACjE,2DAAG,SAAS,EAAC,4BAA4B,iBAAa,MAAM,GAAK,CAC7D;gCAAA,gJAA2E,CAC3E,CAAC;wBACR,mBAAmB,CAAC,GAAG,CAAC,iBAAO,IAAI,oEAAK,GAAG,EAAE,OAAO,EAAE,SAAS,EAAC,uBAAuB;4BAAC,6DAAK,SAAS,EAAC,aAAa;gCACjH,2DAAG,SAAS,EAAC,4BAA4B,iBAAa,MAAM,GAAK,CAC7D;4BAAA,+DAAI,OAAO,CAAK,CAAM,EAFM,CAEN,CAAC;wBAC/B,+DAAM;wBACL,CAAC,MAAM,CAAC,UAAU,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,6DACnC,SAAS,EAAC,sCAAsC,EAChD,OAAO,EAAE;gCACP,EAAE,CAAC,CAAC,OAAO,CAAC,sDAAC,wRAAmC,EAAW,KAAM,EAAkB,qBAAgB,EAAa,mEAAqD,KAArH,MAAM,CAAC,IAAI,EAAM,MAAM,CAAC,WAAW,EAAgB,MAAM,CAAC,MAAM,EAAsD,CAAC;oCACrK,IAAI,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,sDAAS,CAAC,CAAC;4BACzC,CAAC,mBACgB,EAAC,8DAClB,SAAS,EAAC,sCAAsC,EAChD,OAAO,EAAE,cAAI,cAAO,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAd,CAAc,aAErB,CAAC;wBACT,6DAAK,SAAS,EAAC,eAAe,EAAC,OAAO,EAAE,cAAM,WAAI,CAAC,IAAI,EAAE,EAAX,CAAW,YAEnD;wBACL,MAAM,CAAC,MAAM,CAAC,CAAC;4BACd,6DAAK,SAAS,EAAC,wBAAwB,EACrC,OAAO,EAAE,cAAM,WAAI,CAAC,iBAAiB,EAAE,EAAxB,CAAwB,2BAEnC,CAAC,CAAC;4BACR,6DAAK,SAAS,EAAC,wBAAwB,EACrC,OAAO,EAAE,cAAM,WAAI,CAAC,eAAe,EAAE,EAAtB,CAAsB,yBAEjC,CACJ,CACF,CACF;YACN,6DAAK,SAAS,EAAC,uBAAuB;gBACpC,oDAAC,4EAAa,OAAG,CACb,CACF;IACR,CAAC;IACH,sBAAC;AAAD,CAAC,CA3NoC,+CAAe,GA2NnD;;;;;;;;;;;;;;;;;;;;;;;ACzP8B;AAEU;AACD;AAEjC,IAAM,mBAAmB,GAAG,UAAC,KAA+C;IACzE,2BAAO,CAAW;IAC1B,MAAM,CAAC;QACL,gEAAK,sDAAC,+KAA8B,KAAM;QAC1C,4DAAI,SAAS,EAAC,aAAa,IACxB,OAAO,CAAC,GAAG,CAAC,UAAC,EAAkD;gBAAhD,UAAE,EAAE,cAAI,EAAE,cAAI,EAAE,4BAAW,EAAE,kBAAM,EAAE,wBAAS;YAC5D,mEAAI,GAAG,EAAE,EAAE,EAAE,SAAS,EACpB,CAAC,WAAW,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY,CAAC;oBACzC,CAAC,KAAK,CAAC,gBAAgB,KAAK,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC;gBAClD,oDAAC,qDAAI,IAAC,EAAE,EAAE,uBAAqB,SAAS,SAAI,EAAI;oBAAG,IAAI;;oBAAK,MAAM,CAAQ,CAAK;QAHjF,CAGiF,CAAC,CACjF,CACD;AACR,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjB8B;AACO;AACyC;AACL;AACtC;AACa;AACT;AAExC,QAAQ;AAC2C;AACH;AACG;AACI;AACA;AAGvD,qBAAqB;AAC6C;AAClE,mFAAgB,EAAE,CAAC;AAUnB;IAAmC,uEAA4B;IAC7D,uBAAY,KAAY;eACtB,kBAAM,KAAK,CAAC;IACd,CAAC;IAED,8BAAM,GAAN;QAAA,iBA4DC;QA3DC,IAAM,YAAY,GAAG,wDAAG,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,WAAI,KAAK,OAAO,IAAI,IAAI,KAAK,UAAU,EAAvC,CAAuC,CAAC,CAAC;QACjG,IAAM,OAAO,GAAG,wDAAG,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,WAAI,KAAK,OAAO,EAAhB,CAAgB,CAAC,CAAC;QACrE,MAAM,CAAC,6DAAK,SAAS,EAAC,gBAAgB;YACpC,oDAAC,2DAAM,QACJ,YAAY,CAAC,CAAC,CAAC;gBACd,oDAAC,sDAAK,IAAC,KAAK,QAAC,IAAI,EAAC,GAAG,EAAC,MAAM,EAAE,UAAC,EAAS;4BAAP,gBAAK;wBAAO,cAAO,CAAC,CAAC;4BACpD,oDAAC,gDAAO,IAAC,aAAa,EAAE,KAAI,CAAC,KAAK,CAAC,aAAa,EAAE,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI,CAAC,CAAC;4BAC3F,oDAAC,oEAAe,IAAC,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI;oBAFb,CAEa,GAAI;gBAC9D,oDAAC,sDAAK,IAAC,KAAK,QAAC,IAAI,EAAC,UAAU,EAAC,MAAM,EAAE,UAAC,EAAS;4BAAP,gBAAK;wBAC3C,2DAAC,gDAAO,IACN,aAAa,EAAE,KAAI,CAAC,KAAK,CAAC,aAAa,EACvC,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI;oBAFzC,CAEyC,GAAI;gBAC/C,oDAAC,sDAAK,IAAC,KAAK,QAAC,IAAI,EAAC,cAAc,EAAC,MAAM,EAAE,cAAI,2DAAC,6DAAS,IAAC,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI,EAAlD,CAAkD,GAAI;gBACnG,oDAAC,sDAAK,IAAC,KAAK,QAAC,IAAI,EAAC,mBAAmB,EAAC,MAAM,EAAE,UAAC,EAAS;4BAAP,gBAAK;wBAAO,2DAAC,gEAAU,IACtE,EAAE,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE,EACnB,KAAK,EAAE,sDAAC,uIAAe,MACvB,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI;oBAHoB,CAGpB,GAAI;gBAC7C,oDAAC,sDAAK,IAAC,KAAK,QAAC,IAAI,EAAC,WAAW,EAAC,MAAM,EAAE,cAAI,2DAAC,kDAAQ,IAAC,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI,EAAjD,CAAiD,GAAI;gBAC/F,oDAAC,sDAAK,IAAC,IAAI,EAAC,eAAe,EAAC,MAAM,EAAE,UAAC,EAAS;4BAAP,gBAAK;wBAAO,2DAAC,qDAAW,IAC7D,EAAE,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE,EACnB,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI;oBAFU,CAEV,GAAI;gBAC7C,oDAAC,sDAAK,IAAC,KAAK,QAAC,IAAI,EAAC,cAAc,EAAC,MAAM,EAAE,cAAK,2DAAC,oEAAe,IAC9D,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GAAI,EADO,CACP,GAAI;gBAC3C,oDAAC,sDAAK,IAAC,IAAI,EAAC,2CAA2C,EAAC,MAAM,EAAE,UAAC,EAAO;4BAAN,gBAAK;wBAAM,2DAAC,mDAAU,IACtF,UAAU,EAAE,KAAK,CAAC,MAAM,CAAC,UAAU,EACnC,IAAI,EAAC,eAAe,EACpB,aAAa,EAAE,KAAI,CAAC,KAAK,CAAC,aAAa,EACvC,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GACnC;oBAL2E,CAK3E,GAAG;gBACL,oDAAC,sDAAK,IAAC,IAAI,EAAC,mBAAmB,EAAC,MAAM,EAAE,UAAC,EAAO;4BAAN,gBAAK;wBAAM,2DAAC,mDAAU,IAC9D,EAAE,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE,EACnB,IAAI,EAAC,eAAe,EACpB,aAAa,EAAE,KAAI,CAAC,KAAK,CAAC,aAAa,EACvC,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,GACnC;oBALmD,CAKnD,GAAI,CACF,CAAC,CAAC,CAAC;gBACL,oDAAC,sDAAK,IAAC,IAAI,EAAC,GAAG,EAAC,MAAM,EAAE,cAAM;wBAC5B,oDAAC,oEAAY,IAAC,KAAK,EAAC,cAAc,EAAC,UAAU,EAAC,eAAe,EAAC,MAAM,EAAE,EAAC,QAAQ,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GAAI;wBAC5G,yFAA0B;wBAC1B,mJAAoE;wBACpE,wFAAyB;wBACzB,+DAAO,SAAS,EAAC,WAAW,EAAC,KAAK,EAAE,EAAC,MAAM,EAAE,gBAAgB,EAAC;4BAC5D;gCACE;oCACE,2EAAiB;oCACjB,6EAAc,CACX,CACC;4BACR,mEACG,MAAM,CAAC,IAAI,CAAC,wDAAG,CAAC,WAAW,CAAC,CAAC,GAAG,CAAC,cAAI,IAAI,mEAAI,GAAG,EAAE,IAAI;gCACrD,gEAAK,IAAI,CAAM;gCACf,gEAAK,wDAAG,CAAC,WAAW,CAAC,IAAI,CAAC,CAAM,CAC7B,EAHqC,CAGrC,CAAC,CACA,CAAQ,CACd,EAlBwB,CAkBxB,GAAI,CACN,CACD;YACT,oDAAC,kFAAoB,OAAG,CACpB;IACR,CAAC;IACH,oBAAC;AAAD,CAAC,CAlEkC,+CAAe,GAkEjD;;;;;;;;;;;;;;;;;;;;;;;;;AC9F8B;AACU;AAGL;AAEH;AAWjC;IAAkC,sEAA4B;IAC5D,sBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,EAAC,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAC,CAAC;;IAC1D,CAAC;IAED,2BAAI,GAAJ;QACE,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC;QAC5B,EAAE,CAAC,CAAC,CAAC,gDAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YAAC,MAAM,IAAI,KAAK,CAAC,sDAAC,uNAAgB,EAAY,8EAAoE,KAAhF,QAAQ,CAAC,GAAG,EAAqE,CAAC;QACtJ,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IAC9B,CAAC;IAED,6BAAM,GAAN;QAAA,iBA+CC;QA9CO,mBAAsC,EAArC,gBAAK,EAAE,kBAAM,EAAE,sBAAQ,CAAe;QAC7C,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC;QAC5B,IAAM,UAAU,GAAG,gDAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAElD,MAAM,CAAC;YAAK,6DAAK,SAAS,EAAC,2CAA2C;gBACpE,gEAAK,KAAK,CAAM;gBAChB,+DAAM;gBACN,6DAAK,SAAS,EAAC,kBAAkB;oBAC/B,6DAAK,SAAS,EAAC,oBAAoB,YAAY;oBAC/C,6DAAK,SAAS,EAAC,oBAAoB;wBACjC,+DAAO,IAAI,EAAC,MAAM,EAAC,SAAS,QAC1B,QAAQ,EAAE,CAAC,EACX,IAAI,EAAE,EAAE,EACR,KAAK,EAAE,QAAQ,CAAC,IAAI,EACpB,QAAQ,EAAE,YAAE,IAAE,YAAI,CAAC,QAAQ,CAAC,EAAC,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,EAAC,CAAC,EAAtC,CAAsC,GAAI,CACtD;oBACN,6DAAK,SAAS,EAAC,2BAA2B,GAAO,CAC7C;gBACN,6DAAK,SAAS,EAAC,kBAAkB;oBAC/B,6DAAK,SAAS,EAAC,oBAAoB,iBAAY;oBAC/C,6DAAK,SAAS,EAAC,qBAAqB;wBAClC,+DAAO,IAAI,EAAC,MAAM,EAChB,QAAQ,EAAE,CAAC,EACX,IAAI,EAAE,EAAE,EACR,KAAK,EAAE,QAAQ,CAAC,GAAG,EACnB,QAAQ,EAAE,YAAE,IAAE,YAAI,CAAC,QAAQ,CAAC,EAAC,GAAG,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,EAAC,CAAC,EAArC,CAAqC,GAAI,CACrD;oBACN,6DAAK,SAAS,EAAC,2BAA2B,GAAO,CAC7C;gBACN,+DAAM,CAAM;YACZ,6DAAK,SAAS,EAAC,4BAA4B;gBACxC,CAAC,QAAQ,CAAC,WAAW,IAAI,QAAQ,CAAC,YAAY,CAAC,IAAI;oBACjD,QAAQ,CAAC,WAAW,IAAI;;wBACG,uDAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC;;wBAAK,oEAAS,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAU;4BACrG;oBACH,QAAQ,CAAC,YAAY,IAAI;;wBACY,uDAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC;;wBAAK,oEAAS,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAU;4BACjH;oBACJ,+DAAM;oBAAA,+DAAK,CACP;gBACL,QAAQ,IAAI,6DAAK,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAC,sCAAsC,EAAC,OAAO,EAAE,cAAI,eAAQ,EAAE,EAAV,CAAU,+BAEjG;gBACN,2DAAG,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAE,eAAe,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,UAAU,IAAI,CAAC,cAAM,aAAM,CAAC,QAAQ,CAAC,EAAhB,CAAgB,CAAC,YAAW,CACxI,CACF;IACR,CAAC;IACH,mBAAC;AAAD,CAAC,CA5DiC,+CAAe,GA4DhD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7E8B;AACS;AAEO;AACsB;AAC5B;AAEgB;AACiB;AACzC;AACmB;AACY;AACgB;AAC5C;AAC4B;AACrB;AACS;AACO;AACe;AAC3B;AACnB;AACiB;AA4B7C;IAA8B,kEAA6B;IASzD,kBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAoDb;QA3DD,cAAQ,GAAG,IAAI,mDAAQ,EAAE,CAAC;QAQxB,IAAM,WAAW,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,sEAAc,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC9D,KAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;gBACjB,WAAW,CAAC,CAAC,CACX,sDAAC,mKAA0B,EAAiB,IAAG,KAApB,KAAK,CAAC,MAAM,CAAC,IAAI,EAAI,CAAC,CACjD,sDAAC,2JAAsB,EAAiB,IAAG,KAApB,KAAK,CAAC,MAAM,CAAC,IAAI,CAAG,CAAC,CAAC;gBAC/C,KAAK,CAAC,UAAU,CAAC,CAAC,CAChB,sDAAC,yKAAwB,EAAiB,IAAG,KAApB,KAAK,CAAC,MAAM,CAAC,IAAI,EAAI,CAAC,CAC/C,sDAAC,yLAAgC,EAAiB,IAAG,KAApB,KAAK,CAAC,MAAM,CAAC,IAAI,CAAG;YACzD,mBAAmB,EAAE,KAAK;YAC1B,iBAAiB,EAAE,KAAK,CAAC,iBAAiB,IAAI,EAAE;YAChD,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,kDAId,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,KAAK,IAAI,QAAQ,IAChC,KAAK,CAAC,IAAI,EACb,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;gBAC3B,mEAAmE;gBACnE,sCAAsC;gBACtC;oBACE,EAAE,EAAE,oEAAU,EAAE;oBAChB,KAAK,EAAE,KAAK;oBACZ,IAAI,EAAE,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC;oBACzC,MAAM,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,IAAI,yDAAG,CAAC,WAAW,CAAC,MAAM;oBAC1D,SAAS,EAAE,EAAE;oBACb,SAAS,EAAE,EAAE;oBACb,cAAc,EAAE,EAAE;oBAClB,eAAe,EAAE,EAAE;oBACnB,qBAAqB,EAAE,EAAE;oBACzB,IAAI,EAAE,EAAE;oBACR,GAAG,EAAE,EAAE;oBACP,GAAG,EAAE,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;wBAC7B,aAAa,gQAA+P;qBAC7Q,CAAC,CAAC,CAAC;wBACA,aAAa;wBACb,gBAAc,yDAAG,CAAC,WAAW,CAAC,MAAM,gBAAa;qBAClD;iBACJ;YACL,eAAe,EAAE,KAAK,CAAC,UAAU,IAAI,EAAE;YACvC,YAAY,EAAE,KAAK,CAAC,UAAU,IAAI,EAAE;YACpC,WAAW,EAAE,KAAK,CAAC,UAAU;SAC9B,CAAC;QACF,EAAE,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;YACrB,KAAI,CAAC,cAAc,GAAG,IAAI,sEAAc,CAAC;gBACvC,gEAAG,CAAC,gBAAgB,CAAC,IAAI,CAAO,OAAO,EAAE;oBACvC,IAAI,EAAE,SAAO,KAAK,CAAC,MAAM,CAAC,WAAa;oBACvC,OAAO,EAAE,CAAC,uBAAuB,EAAE,WAAW,EAAE,gBAAgB,CAAC;oBACjE,KAAK,EAAE,CAAC,gBAAgB,CAAC;iBAC1B,CAAC;YAJF,CAIE,CAAC,CAAC,CAAC,sCAAsC;QAC/C,CAAC;;IACH,CAAC;IAzDD,mCAAgB,GAAhB,UAAiB,KAAqB;QAAtC,iBAEC;QADC,MAAM,CAAC,IAAI,OAAO,CAAC,iBAAO,IAAI,wBAAM,QAAQ,aAAC,cAAM,YAAc,EAAd,CAAc,EAAE,OAAO,CAAC,EAA7C,CAA6C,CAAC,CAAC;IAC/E,CAAC;IAyDK,oCAAiB,GAAvB;;;;;;6BACM,IAAI,CAAC,KAAK,CAAC,UAAU,EAArB,wBAAqB;wBACvB,IAAI,CAAC,gBAAgB,CAAC,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;;;;wBAE3C,qBAAM,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE;;wBAAjC,SAAiC,CAAC;6BAC9B,KAAI,CAAC,KAAK,CAAC,eAAe,IAAI,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,MAAM,KAAK,CAAC,GAArE,wBAAqE;wBACvE,qBAAM,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC;;wBAAzD,SAAyD,CAAC;;;;;wBAG5D,8DAAS,CAAC,KAAG,CAAC,CAAC;;4BAEf,qBAAM,IAAI,CAAC,gBAAgB,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC;;wBAAnD,SAAmD,CAAC;;;;;;KAGzD;IAEK,wCAAqB,GAA3B,UAA4B,eAAyB;;;;;;wBAC7C,eAAe,GAAG,IAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,eAAe,mBAAE,kBAAkB,EAAE,IAAI,EAAE,CAAC,CAAC;6BACrG,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,EAA3B,wBAA2B;wBAC7B,qBAAM,IAAI,CAAC,cAAc,CAAC,OAAO;;wBAAjC,SAAiC,CAAC;wBAClC,kFAAkF;wBAClF,mBAAmB;wBACnB,qBAAM,eAAe;;wBAFrB,kFAAkF;wBAClF,mBAAmB;wBACnB,SAAqB,CAAC,CAAC,yCAAyC;wBAChE,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC;;4BAE/C,qBAAM,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC;;wBAA9C,SAA8C,CAAC;;;;;KAChD;IAEK,qCAAkB,GAAxB,UAAyB,eAAyB;;;;;4BACrB,qBAAM,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE;;wBAAtD,kBAAkB,GAAG,SAAiC;wBAEtD,YAAY,GAAG,kBAAkB,CAAC,MAAM,CAAC,WAAC;4BAC9C,sBAAe,CAAC,KAAK,CAAC,YAAE;gCACtB,QAAC,CAAC,qBAAqB,CAAC,IAAI,CAAC,YAAE,IAAI,SAAE,CAAC,EAAE,KAAK,EAAE,EAAZ,CAAY,CAAC;oCAChD,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC;oCAClC,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC;4BAFvC,CAEuC,CAAC;wBAH1C,CAG0C,CAAC,CAAC;wBAE9C,IAAI,CAAC,gBAAgB,CAAC;4BACpB,YAAY;yBACb,CAAC,CAAC;;;;;KACJ;IAED,gCAAa,GAAb,UAAc,EAAU,EAAE,QAAiB;QACjC,sCAAU,CAAgB;QAClC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YACP,gDAAe,CAAgB;YACvC,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,CAAC;gBACnC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC5B,eAAe,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,KAAK,EAAE,EAAR,CAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,sDAAS,CAAC,CAAC;YAC1D,MAAM,CAAC;QACT,CAAC;QACO,8BAAM,CAAgB;QACtB,0BAAI,CAAgB;QAC5B,4CAA4C;QAC5C,IAAM,OAAO,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC,CAAC;QACxD,IAAM,oBAAoB,GAAG,MAAM,CAAC,qBAAqB,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC,CAAC;QACjF,IAAM,cAAc,GAAG,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,YAAE,IAAI,SAAE,CAAC,EAAE,KAAK,EAAE,EAAZ,CAAY,CAAC,CAAC;QAEhE;;;;;;gCAOc,EAPb,sBAAc,EAAE,YAAI,CAON;QAErB,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,2BAA2B,GAAG,EAAE,CAAC,CAAC;YAChD,MAAM,CAAC;QACT,CAAC;QAED,IAAM,iBAAiB,GAAe,IAAI,CAAC,cAAc,CAAC,CAAC,KAAK,EAAE,CAAC;QACnE,EAAE,CAAC,CAAC,QAAQ,CAAC;YACX,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/B,IAAI;YACF,iBAAiB,CAAC,MAAM,CAAC,iBAAiB,CAAC,SAAS,CAAC,aAAG,IAAI,UAAG,CAAC,EAAE,KAAK,EAAE,EAAb,CAAa,CAAC,EAAE,CAAC,CAAC,CAAC;QAEjF,IAAM,WAAW,sDAAQ,IAAI,CAAE,CAAC;QAChC,WAAW,CAAC,cAAc,CAAC,GAAG,iBAAiB,CAAC;QAEhD,IAAI,CAAC,gBAAgB,CAAC;YACpB,IAAI,EAAE,WAAW;SAClB,CAAC,CAAC;IACL,CAAC;IAEK,uBAAI,GAAV;;;;;;wBACQ,KAA8B,IAAI,CAAC,KAAK,EAAtC,IAAI,YAAE,iBAAiB,wBAAgB;wBACzC,WAAW,GAAG,sEAAc,CAAC,IAAI,CAAC,CAAC;6BACrC,WAAW,EAAX,wBAAW;wBACb,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;4BAC7B,MAAM,IAAI,KAAK,CAAC,sDAAC,2OAAuD,KAAC,CAAC;wBAC5E,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,gDAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;4BACxC,MAAM,IAAI,KAAK,CAAC,sDAAC,uMAAgB,EAAQ,8DAAoD,KAA5D,IAAI,CAAC,GAAG,EAAqD,CAAC;6BAC7F,KAAI,CAAC,KAAK,CAAC,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,GAAjD,wBAAiD;wBACnD,kCAAkC;wBAClC,qBAAM,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC;;wBADpD,kCAAkC;wBAClC,SAAoD,CAAC;;;oBAErD,uBAAuB;oBACvB,qBAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC;;wBADnC,uBAAuB;wBACvB,SAAmC,CAAC;;;;6BAE7B,IAAI,CAAC,KAAK,CAAC,UAAU,EAArB,wBAAqB;wBAC9B,qBAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,iBAAiB,CAAC;;wBAAhD,SAAgD,CAAC;;;wBAEjD,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,IAAI,IAAI,CAAC,KAAK,KAAK,KAAK,CAAC;4BACvD,MAAM,IAAI,KAAK,CAAC,sDAAC,qRAA4E,KAAC,CAAC;wBAEjG,qBAAM,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,iBAAiB,CAAC;;wBAAvD,SAAuD,CAAC;;;;;;KAE3D;IAEK,2BAAQ,GAAd;;;;;;wBACQ,QAAQ,sDACT,IAAI,CAAC,KAAK,CAAC,IAAI,EACf,CAAC,IAAI,CAAC,KAAK,CAAC,iBAAiB,IAAI,EAAE,CAAC,IACvC,EAAE,EAAE,oEAAU,EAAE,EAChB,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;gCAClC,aAAa,CAAC,kQAAkQ;6BACjR,CAAC,CAAC,CAAC;gCACA,aAAa;gCACb,gBAAc,yDAAG,CAAC,WAAW,CAAC,MAAM,gBAAa;6BAClD,GACJ,CAAC;wBACF,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;wBAEvB,qBAAM,IAAI,CAAC,gBAAgB,CAAC;gCAC1B,IAAI,EAAE,QAAQ;gCACd,KAAK,EAAE,sDAAC,qLAAmC,EAAsB,IAAG,KAAzB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAG;gCACpE,iBAAiB,EAAE,SAAS;6BAC7B,CAAC;;wBAJF,SAIE,CAAC;;;;;KACJ;IAED,8BAAW,GAAX,UAAkC,QAAW;QACrC,mBAAsC,EAArC,cAAI,EAAE,wCAAiB,CAAe;QAC7C,IAAM,aAAa,GAAG,iBAAiB,IAAI,iBAAiB,CAAC,QAAQ,CAAC,CAAC;QACvE,MAAM,CAAC,aAAa,KAAK,SAAS,CAAC,CAAC;YAClC,aAAa,CAAC,CAAC;YACf,IAAI,CAAC,QAAQ,CAAC,CAAC;IACnB,CAAC;IAED,4CAAyB,GAAzB,UAA2B,QAAoB,EAAE,OAAO;QAChD,mBAAsC,EAArC,cAAI,EAAE,wCAAiB,CAAe;QAC7C,IAAM,WAAW,GAAG,IAAI,IAAI,sEAAc,CAAC,IAAI,CAAC,CAAC;QACjD,EAAE,CAAC,CAAC,WAAW,IAAI,CAAC,CAAC,iBAAiB,IAAI,iBAAiB,CAAC,QAAQ,CAAC,KAAK,SAAS,CAAC,CAAC,CAAC,CAAC;YACrF,IAAM,OAAO,sDAAO,IAAI,CAAC,CAAC;YAC1B,OAAO,CAAC,QAAQ,CAAC,GAAG,0DAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,CAAC,CAAC;YACpD,IAAI,CAAC,gBAAgB,CAAC,EAAC,IAAI,EAAE,OAAO,EAAC,CAAC,CAAC;QACzC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAM,gBAAgB,sDAAO,iBAAiB,CAAC,CAAC;YAChD,gBAAgB,CAAC,QAAQ,CAAC,GAAG,0DAAM,CACjC,gBAAgB,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,EAC5C,OAAO,CACR,CAAC;YACF,IAAI,CAAC,gBAAgB,CAAC,EAAC,iBAAiB,EAAE,gBAAgB,EAAC,CAAC,CAAC;QAC/D,CAAC;IACH,CAAC;IAED,yBAAM,GAAN;QAAA,iBA4RC;QA3RO,mBAAuF,EAArF,kBAAM,EAAE,kBAAM,EAAE,sBAAQ,EAAE,sBAAQ,EAAE,kDAAsB,EAAE,0BAAU,CAAgB;QACxF,mBAA2F,EAAzF,cAAI,EAAE,wCAAiB,EAAE,gBAAK,EAAE,8BAAY,EAAE,oCAAe,EAAE,4BAAW,CAAgB;QAClG,IAAM,SAAS,GAAG,UAAU,CAAC,CAAC;YAC5B,eAAe,CAAC,CAAC;YACjB,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,EAAJ,CAAI,CAAC;iBAC/B,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,EAAJ,CAAI,CAAC,CAAC;iBACrC,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,EAAJ,CAAI,CAAC,CAAC,CAAC;QAEvD,IAAM,WAAW,GAAG,IAAI,IAAI,sEAAc,CAAC,IAAI,CAAC,CAAC;QACjD,IAAM,YAAY,GAAG,IAAI,IAAI,gDAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC/C,4BAAQ,CAAS;QAExB,MAAM,CAAC,6DAAK,SAAS,EAAC,uDAAuD;YAC3E,6DAAK,SAAS,EAAC,uDAAuD;gBACpE,6DAAK,SAAS,EAAC,+CAA+C;oBAC5D,6DAAK,SAAS,EAAC,yBAAyB;wBACtC,4DAAI,SAAS,EAAC,IAAI,IAAE,KAAK,CAAM,CAC3B,CACF;gBACN,6DAAK,SAAS,EAAC,wCAAwC;oBACrD,6DAAK,SAAS,EAAC,sCAAsC;wBACnD,6DAAK,SAAS,EAAC,2CAA2C;4BACxD,6DAAK,SAAS,EAAC,WAAW;gCACxB,gEAAK,UAAU,CAAC,CAAC;oCACf,0BAA0B,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;oCACxC,mBAAmB,CAAC,CAAC;oCACrB,cAAc,CAAM;gCACvB,UAAU,CAAC,CAAC;oCACX,8HAEI,CAAC,CAAC,CAAC,WAAW;oCAClB,sHAEI;gCAEN,oDAAC,gFAAe,IACd,qBAAqB,EAAE,MAAM,CAAC,qBAAqB,EACnD,SAAS,EAAE,SAAS,EACpB,cAAc,EAAE,sBAAsB,EACtC,QAAQ,EAAE,UAAU,IAAI,WAAW,EACnC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,GAC5C,CACE,CACF;wBAEN,6DAAK,SAAS,EAAC,4BAA4B;4BACzC,oDAAC,qFAAiB,IAChB,OAAO,EAAE,MAAM,CAAC,SAAS,EACzB,KAAK,EAAE,WAAW,IAAI,UAAU,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,UAAU,EAC/D,SAAS,EAAE,SAAS,EACpB,QAAQ,EAAE,WAAW,IAAI,UAAU,EACnC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,GAAI,CAC9C;wBAEN,6DAAK,SAAS,EAAC,4BAA4B;4BACzC,oDAAC,qFAAiB,IAChB,OAAO,EAAE,MAAM,CAAC,cAAc,EAC9B,KAAK,EAAE,WAAW,IAAI,UAAU,CAAC,CAAC,CAAC,wBAAwB,CAAC,CAAC,CAAC,mBAAmB,EACjF,SAAS,EAAE,SAAS,EACpB,QAAQ,EAAE,WAAW,IAAI,UAAU,EACnC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,GAAI,CAC9C;wBAEL,CAAC,UAAU,IAAI,6DAAK,SAAS,EAAC,4BAA4B;4BAAC,6DAAK,SAAS,EAAE,kBAAkB,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;gCAC9I,6DAAK,SAAS,EAAC,YAAY,EAAC,OAAO,EAAE,cAAM,YAAI,CAAC,gBAAgB,CAAC,EAAE,mBAAmB,EAAE,CAAC,KAAI,CAAC,KAAK,CAAC,mBAAmB,EAAE,CAAC,EAA/E,CAA+E,IACvH,WAAW,CAAC,CAAC;oCACZ,kGAAkC,CAAC,CAAC;oCACpC,wFAA6B,CAC3B;gCACN,6DAAK,SAAS,EAAC,aAAa;oCAC1B,6FAAyB;oCAEzB,6DAAK,SAAS,EAAC,eAAe,IAC3B,sEAAe,CAAC,GAAG,CAAC,YAAE;wCACrB,IAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;wCACvD,MAAM,CAAC,6DAAK,SAAS,EAAC,kBAAkB,EAAC,GAAG,EAAE,EAAE;4CAC9C,6DAAK,SAAS,EAAC,oBAAoB;gDACjC,6DACE,SAAS,EAAE,UAAU,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EACpD,OAAO,EAAE,WAAW,CAAC,CAAC,CAAC;wDACrB,IAAM,WAAW,sDAAQ,IAAI,CAAE,CAAC;wDAChC,WAAW,CAAC,eAAe;4DACzB,QAAQ,CAAC,CAAC;gEACR,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,IAAI,EAAE,EAAP,CAAO,CAAC,CAAC,CAAC;gEAC3C,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;wDACpC,KAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;oDAC/C,CAAC,CAAC,CAAC,CAAC,SAAS,GAAI,CACf;4CACN,6DAAK,SAAS,EAAC,oBAAoB,IAAE,EAAE,CACjC,CACF;oCACR,CAAC,CAAC,CACE,CACF,CAEF,CAAM,CACR;oBACN,6DAAK,SAAS,EAAC,uBAAuB;wBACpC,6DAAK,SAAS,EAAC,2CAA2C;4BACvD,WAAW,IAAI;gCAAG,oDAAC,gEAAO,OAAG;uDAAwB;4BACrD,YAAY,CAAC,CAAC,CAAC,6DAAK,SAAS,EAAE,oBAAoB,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC;gCACxH,eAAe,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;oCAC7B,yGAAqC,CAAC,CAAC;oCACvC,yGAA0C;gCAC5C,6DAAK,SAAS,EAAC,eAAe,IAC3B,YAAY,CAAC,GAAG,CAAC,mBAAS,IAAI,oEAAK,GAAG,EAAE,SAAS,CAAC,EAAE,EAAE,SAAS,EAAC,kBAAkB;oCACjF,6DAAK,SAAS,EAAC,oBAAoB;wCACjC,6DACE,SAAS,EAAE,UAAU,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE,KAAK,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EAC5E,OAAO,EAAE,cAAM,oEAAW,CAAC,KAAI,CAAC,CAAC,aAAa,CAAC,SAAS,GAAG,CAAC,IAAI,KAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,kBAAkB,EAAE,IAAI,EAAE,CAAC,EAArH,CAAqH,GAAI,CACtI;oCACN,6DAAK,SAAS,EAAC,oBAAoB,IAChC,SAAS,CAAC,OAAO,CAAC,CAAC;wCAClB,2DAAG,IAAI,EAAC,GAAG,EAAC,OAAO,EAAE,YAAE;gDACrB,KAAI,CAAC,QAAQ,CAAC,EAAE,kBAAkB,EAAE,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;gDACrE,EAAE,CAAC,cAAc,EAAE,CAAC;gDACpB,EAAE,CAAC,eAAe,EAAE,CAAC;4CACvB,CAAC,IAAG,SAAS,CAAC,IAAI,CAAK,CAAC,CAAC;wCACzB,2DAAG,IAAI,EAAE,SAAS,CAAC,GAAG,EAAE,MAAM,EAAC,QAAQ,IAAE,SAAS,CAAC,IAAI,CAAK,CAC1D,CACF,EAfyB,CAezB,CAAC,CACH;gCACN,+DAAM;gCACN,+DAAM,CACF,CAAC,CAAC,CAAC,IAAI,IAAI;gCACf,gGAAiC;gCACjC,6DAAK,SAAS,EAAC,yBAAyB;oCACtC,6DAAK,SAAS,EAAC,oBAAoB;wCACjC,kFAAuB,CACnB;oCACN,6DAAK,SAAS,EAAC,oBAAoB;wCACjC,+DAAO,SAAS,QAAC,IAAI,EAAC,MAAM,EAAC,IAAI,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,CAAC,WAAW,EAAE,QAAQ,EAAE,CAAC,WAAW,EAAE,QAAQ,EAAE,YAAE;gDACnH,IAAM,OAAO,sDAAQ,IAAI,CAAE,CAAC;gDAC5B,OAAO,CAAC,IAAI,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;gDAC/B,KAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;4CAC3C,CAAC,GAAI,CACD,CACF;gCACN,6DAAK,SAAS,EAAC,yBAAyB;oCACtC,6DAAK,SAAS,EAAC,oBAAoB;wCACjC,sEAAW,CACP;oCACN,6DAAK,SAAS,EAAE,oBAAoB;wCAClC,+DAAO,IAAI,EAAC,MAAM,EAAC,IAAI,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,GAAG,EAAE,QAAQ,EAAE,CAAC,WAAW,EAAE,QAAQ,EAAE,CAAC,WAAW,EAAE,QAAQ,EAAE,YAAE;gDACxG,IAAM,OAAO,sDAAQ,IAAI,CAAE,CAAC;gDAC5B,OAAO,CAAC,GAAG,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;gDAC9B,KAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;4CAC3C,CAAC,GAAI,CACD,CACF;gCAEL,QAAQ,CAAC,eAAe,IAAI;oCAAE,yFAA0B;oCACzD,6DAAK,SAAS,EAAC,kBAAkB;wCAC/B,6DAAK,SAAS,EAAC,oBAAoB;4CACjC,6DAAK,SAAS,EAAE,UAAU,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,EAC7E,OAAO,EAAE;oDACP,KAAI,CAAC,yBAAyB,CAAC,YAAY,EAAE,EAAC,IAAI,EAAE,CAAC,KAAI,CAAC,WAAW,CAAC,YAAY,CAAC,EAAC,CAAC,CAAC;gDACxF,CAAC,GACD,CACE;wCACN,6DAAK,SAAS,EAAC,oBAAoB;4CAC/B,0HAAgD,CAC9C,CACF;oCACL,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI;wCACjC,sFAAsB;wCACpB,6DAAK,SAAS,EAAC,kBAAkB;4CAC/B,6DAAK,SAAS,EAAC,oBAAoB;gDACjC,oDAAC,yDAAe,IACd,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,8CAAM,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,EAC9E,UAAU,EAAC,YAAY,EACvB,MAAM,EAAE,IAAI,EACZ,eAAe,EAAC,cAAc,EAC9B,QAAQ,EAAE,eAAK;wDACb,KAAI,CAAC,yBAAyB,CAAC,UAAU,EAAE,EAAC,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,EAAC,CAAC,CAAC;oDACjF,CAAC,GACD,CACE;4CACN,6DAAK,SAAS,EAAC,oBAAoB,IAChC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,2DAAG,SAAS,EAAC,YAAY,EAAC,IAAI,EAAC,GAAG,EAAC,KAAK,EAAC,8BAAyB,EAAC,OAAO,EAAE,YAAE;oDAC7G,EAAE,CAAC,cAAc,EAAE,CAAC;oDACpB,KAAI,CAAC,yBAAyB,CAAC,UAAU,EAAE,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC;gDAC3D,CAAC,GAAM,CACH,CACF,CACP,CACF,CACG;4BAEL,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,CAAC;gCAC9B,6DAAK,uBAAuB,EAAE,EAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,kBAAkB,EAAC,GAAI;gCAC1E,CAAC,CAAC,IAAI,IAAI;oCACL,kGAA8B;oCAC9B;wCACE,kEACE,SAAS,EAAC,gCAAgC,EAC1C,QAAQ,EAAE,CAAC,WAAW,EACtB,KAAK,EAAE,IAAI,CAAC,YAAY,EACxB,QAAQ,EAAE,YAAE;gDACV,IAAM,OAAO,sDAAQ,IAAI,CAAE,CAAC;gDAC5B,OAAO,CAAC,YAAY,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;gDACvC,KAAI,CAAC,gBAAgB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;4CAC3C,CAAC,GACD,CACE;oCAEN,+DAAM;oCACL,CAAC,WAAW,IAAI,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI;wCAClC,2FAA4B;wCACzB,WAAW,IAAI,kKAEZ;wCACJ,oDAAC,oEAAO,IACN,OAAO,EAAE;gDACP,MAAM;gDACN,QAAQ;gDACR,WAAW;gDACX,eAAe;gDACf,UAAU;gDACV,UAAU;gDACV,OAAO;gDACP,OAAO;gDACP,MAAM;gDACN,MAAM;gDACN,OAAO;6CAAC,EACV,cAAc,EAAE,+EAAe,EAC/B,QAAQ,EAAE,CAAC,WAAW,EACtB,IAAI,EAAE,IAAI,CAAC,OAAO,EAClB,QAAQ,EAAE,cAAI;gDACZ,IAAM,OAAO,sDAAQ,IAAI,CAAE,CAAC;gDAC5B,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC;gDACvB,KAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;4CACnC,CAAC,GACD,CACH;oCAEJ,iBAAiB,IAAI,iBAAiB,CAAC,SAAS,CAAC,CAAC;wCACjD,sIAAkE,CAAC,CAAC;wCACpE,mGAAyC;oCAE3C,oDAAC,4FAAoB,IACnB,SAAS,EACP,CAAC,iBAAiB,IAAI,iBAAiB,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,SAAS,EACtE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,EACrB,QAAQ,EAAE,yBAAe;4CACvB,KAAI,CAAC,yBAAyB,CAAC,WAAW,EAAE,eAAe,CAAC,CAAC;wCAC/D,CAAC,GAAI,CACN,CACD;wBACL,IAAI,IAAI,6DAAK,SAAS,EAAC,4BAA4B;4BAAC,+DAAM;4BACzD,oFAA0B;4BAEzB,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,WAAW,IAAI;;gCACjB,wDAAQ,CAAC,IAAI,CAAC,WAAW,CAAC;;gCAAK,oEAAS,IAAI,CAAC,SAAS,CAAC,IAAI,CAAU;oCACvF;4BACH,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,YAAY,IAAI;;gCACT,wDAAQ,CAAC,IAAI,CAAC,YAAY,CAAC;;gCAAK,oEAAS,IAAI,CAAC,UAAU,CAAC,IAAI,CAAU;oCACnG;4BAEJ,+DAAM;4BACL,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,6DACxB,SAAS,EAAC,sCAAsC,EAChD,OAAO,EAAE,cAAM,YAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,EAArB,CAAqB,kCAEhC;4BACN,6DAAK,SAAS,EAAC,YAAY,aAAa;4BACxC,6DAAK,SAAS,EAAC,sCAAsC,EAAC,OAAO,EAAE,cAAM,YAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,EAArB,CAAqB,aAEpF;4BAEN,6DAAK,SAAS,EAAC,eAAe,EAAC,OAAO,EAAE,cAAM,YAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,sDAAS,CAAC,EAA5B,CAA4B,YAEpE;4BACL,CAAC,WAAW,IAAI,6DAAK,SAAS,EAAC,eAAe,EAAC,OAAO,EAAE,cAAM,YAAI,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,sDAAS,CAAC,EAAhC,CAAgC,4CAEzF,CACF,CACF,CACF;gBACN,6DAAK,SAAS,EAAC,WAAW;oBACxB,6DAAK,SAAS,EAAC,2CAA2C,GAAO,CAC7D,CACF,CAAM;IAChB,CAAC;IAEH,eAAC;AAAD,CAAC,CA3f6B,+CAAe,GA2f5C;;;;;;;;;;;;;;;;;;;;;;;;AC5iB8B;AACU;AAGR;AAYjC;IAAsC,0EAA4B;IAChE,0BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAG,EAAC,GAAG,EAAE,KAAI,CAAC,KAAK,CAAC,GAAG,IAAI,EAAE,EAAC,CAAC;;IAC3C,CAAC;IAED,+BAAI,GAAJ;QACS,wBAAG,CAAe;QACzB,EAAE,CAAC,CAAC,CAAC,gDAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAAC,MAAM,IAAI,KAAK,CAAC,sDAAC,mMAAgB,EAAG,0DAAgD,KAAnD,GAAG,EAAiD,CAAC;QAChH,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IACzB,CAAC;IAED,iCAAM,GAAN;QAAA,iBA+BC;QA9BO,mBAA+B,EAA9B,kBAAM,EAAE,sBAAQ,CAAe;QACtC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,IAAM,UAAU,GAAG,gDAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAElD,MAAM,CAAC;YAAK,6DAAK,SAAS,EAAC,2CAA2C;gBACpE,wGAAyC;gBACzC,kIAAwD;gBACxD,+DAAM;gBACN,6DAAK,SAAS,EAAC,kBAAkB;oBAC/B,6DAAK,SAAS,EAAC,oBAAoB,iBAAY;oBAC/C,6DAAK,SAAS,EAAC,qBAAqB;wBAClC,+DAAO,IAAI,EAAC,MAAM,EAChB,QAAQ,EAAE,CAAC,EACX,IAAI,EAAE,EAAE,EACR,KAAK,EAAE,KAAK,CAAC,GAAG,EAChB,QAAQ,EAAE,YAAE,IAAE,YAAI,CAAC,QAAQ,CAAC,EAAC,GAAG,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,EAAC,CAAC,EAArC,CAAqC,GAAI,CACrD;oBACN,6DAAK,SAAS,EAAC,2BAA2B,GAAO,CAC7C;gBACN,+DAAM,CAAM;YACZ,6DAAK,SAAS,EAAC,4BAA4B,EAAC,EAAE,EAAC,iCAAiC;gBAC7E,QAAQ,IAAI,6DAAK,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAC,sCAAsC,EAAC,OAAO,EAAE,cAAI,eAAQ,EAAE,EAAV,CAAU,8BAEjG;gBACN,2DACE,QAAQ,EAAE,CAAC,EACX,SAAS,EAAE,eAAe,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,eAAe,CAAC,EAChE,OAAO,EAAE,UAAU,IAAI,CAAC,cAAM,aAAM,CAAC,KAAK,CAAC,GAAG,CAAC,EAAjB,CAAiB,CAAC,YAAW,CACzD,CACF;IACR,CAAC;IACH,uBAAC;AAAD,CAAC,CA5CqC,+CAAe,GA4CpD;;;;;;;;;;;;;;;;;;;;;;;;;;AC5D8B;AAEyB;AACJ;AACT;AACiC;AACpC;AAUxC;IAAgC,oEAA4B;IAG1D,oBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAG,IAAI,CAAC;;IACpB,CAAC;IAED,sCAAiB,GAAjB;QACE,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,aAAG,IAAI,qEAAS,CAAC,GAAG,CAAC,EAAd,CAAc,CAAC,CAAC;IAC3C,CAAC;IAEK,yBAAI,GAAV;;;;;;6BACM,IAAI,CAAC,KAAK,CAAC,EAAE,EAAb,wBAAa;wBAEP,EAAE,GAAK,IAAI,CAAC,KAAK,GAAf,CAAgB;wBACX,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,GAAG,CAAS,SAAS,EAAE,EAAE,CAAC;;wBAA9D,MAAM,GAAG,SAAqD;wBACpE,IAAI,CAAC,UAAU,sDAAQ,MAAM,CAAE,CAAC;wBAChC,IAAI,CAAC,QAAQ,oDAAM,MAAM,EAAG,CAAC;;;wBAE7B,6BAA6B;wBAC7B,IAAI,CAAC,QAAQ,CAAC;4BACZ,EAAE,EAAE,oEAAU,EAAE;yBACjB,CAAC,CAAC;;;;;;KAEN;IAEK,yBAAI,GAAV;;;;;;wBACQ,CAAC,GAAG,IAAI,6DAAW,EAAE,CAAC;wBACxB,MAAM,sDAAQ,IAAI,CAAC,KAAK,CAAE,CAAC;6BAC3B,CAAC,IAAI,CAAC,UAAU,EAAhB,wBAAgB;wBAClB,MAAM,CAAC,GAAG,GAAG,CAAC,aAAa,CAAC,CAAC;wBAC7B,MAAM,CAAC,GAAG,CAAC,IAAI,CACb,IAAI,gEAAc,CAChB,YAAY,EACT,MAAM,CAAC,IAAI,cAAW,EAAE,GAAG,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;wBAChD,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;;;6BAChB,KAAI,CAAC,UAAU,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,GAAxC,wBAAwC;wBAEjD,uBAAuB;wBACvB,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC,EAAE,EAAE;4BAC9B,IAAI,gEAAc,CAAC,YAAY,EAAK,IAAI,CAAC,UAAU,CAAC,IAAI,cAAW,EAAE,GAAG,CAAC;yBAC1E,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,QAAQ,EAAE,EAAZ,CAAY,CAAC,CAAC,CAAC;6BAEtB,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,EAAE,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE,GAApE,wBAAoE;wBACtE,mEAAmE;wBACnE,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC,gBAAgB,CAAC;;wBADpD,mEAAmE;wBACnE,SAAoD,CAAC;wBACrD,CAAC,CAAC,gBAAgB,GAAG,EAAE,CAAC;;;wBAE1B,qBAAqB;wBACrB,CAAC,CAAC,KAAK,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE;4BAChC,IAAI,gEAAc,CAAC,YAAY,EAAK,IAAI,CAAC,KAAK,CAAC,IAAI,cAAW,EAAE,GAAG,CAAC;yBACrE,CAAC,GAAG,CAAC,WAAC,IAAI,QAAC,CAAC,QAAQ,EAAE,EAAZ,CAAY,CAAC,CAAC,CAAC;wBAC1B,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;;;wBAEzB,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;;4BAG3B,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC,gBAAgB,CAAC;;wBAApD,SAAoD,CAAC;wBAErD,QAAQ,CAAC,IAAI,GAAG,WAAW,CAAC;;;;;KAC7B;IAEK,iCAAY,GAAlB;;;;;6BACM,OAAO,CAAC,sDAAC,yNAAsC,EAAe,IAAG,KAAlB,IAAI,CAAC,KAAK,CAAC,IAAI,EAAI,EAAlE,wBAAkE;wBACpE,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;;wBAA3D,SAA2D,CAAC;wBAC5D,QAAQ,CAAC,IAAI,GAAE,WAAW,CAAC;;;;;;KAE9B;IAED,2BAAM,GAAN;QAAA,iBAkDC;QAjDO,mBAA0B,EAAxB,gBAAK,EAAE,UAAE,CAAgB;QACjC,IAAM,YAAY,GAAG,CAAC,CAAC,EAAE,CAAC;QAC1B,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC;QAC1B,IAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;QACnC,IAAM,OAAO,GAAG,wDAAG,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,WAAI,KAAK,OAAO,EAAhB,CAAgB,CAAC,CAAC;QACrE,MAAM,CAAC,6DAAK,KAAK,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE;YAC/B,oDAAC,mEAAY,IACX,KAAK,EAAC,QAAQ,EAAC,UAAU,EAAC,SAAS,EAAC,SAAS,EAAE,EAAC,OAAO,EAAE,cAAI,eAAQ,CAAC,IAAI,GAAC,WAAW,EAAzB,CAAyB,EAAC,EACvF,MAAM,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GAAI;YAChD,6DAAK,SAAS,EAAC,kBAAkB;gBAC/B,6DAAK,SAAS,EAAC,uDAAuD;oBACpE,gEAAK,KAAK,CAAM;oBAChB,+DAAM;oBACN,6DAAK,SAAS,EAAC,kBAAkB;wBAC/B,6DAAK,SAAS,EAAC,oBAAoB,YAAY;wBAC/C,6DAAK,SAAS,EAAC,oBAAoB;4BACjC,+DAAO,IAAI,EAAC,MAAM,EAAC,SAAS,QAC1B,QAAQ,EAAE,CAAC,OAAO,EAClB,QAAQ,EAAE,CAAC,EACX,IAAI,EAAE,EAAE,EACR,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAChC,QAAQ,EAAE,YAAE,IAAI,YAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAxC,CAAwC,GAAI,CAC1D;wBACN,6DAAK,SAAS,EAAC,2BAA2B,GAAO,CAC7C;oBACL,OAAO,IAAI,YAAY,IAAI,6DAAK,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAC,sCAAsC,EAAC,OAAO,EAAE;4BACtG,YAAI,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,sDAAS,CAAC;wBAApC,CAAoC,oBAEhC;oBACN,6DAAK,SAAS,EAAC,YAAY,aAAa;oBACxC,oDAAC,qDAAI,IAAC,SAAS,EAAC,sCAAsC,EAAC,EAAE,EAAC,UAAU,aAE7D;oBAEN,OAAO,IAAI,2DAAG,QAAQ,EAAE,CAAC,EAAE,SAAS,EAAE,eAAe,EAAE,OAAO,EAAE;4BAC/D,EAAE,CAAC,CAAC,UAAU,IAAI,UAAU,CAAC,IAAI,KAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;gCAClD,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,sDAAC,ygCAIqC,KAAC,CAAC,CAAC,CAAC;oCACrD,MAAM,CAAC;gCACT,CAAC;4BACH,CAAC;4BACD,KAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,sDAAS,CAAC,CAAC;wBAC/B,CAAC,YAAW,CACR,CACF,CACF,CAAC;IACT,CAAC;IACH,iBAAC;AAAD,CAAC,CAzH+B,+CAAe,GAyH9C;;;;;;;;;;;;;;;;;;;;;;;ACzI8B;AAIY;AAGH;AACQ;AACI;AAO7C,IAAM,kBAAkB,GAAG,UAAC,KAAY;IACrC,2BAAO,EAAE,mCAAa,CAAW;IACzC,IAAM,OAAO,GAAG,wDAAG,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,WAAI,KAAK,OAAO,EAAhB,CAAgB,CAAC,CAAC;IACrE,MAAM,CAAC,6DAAK,SAAS,EAAC,sBAAsB;QAC1C,iEACG,OAAO,CAAC,CAAC,CAAC;YACT,mEACG,OAAO,CAAC,GAAG,CAAC,gBAAM;gBACjB,mEAAI,SAAS,EAAC,kBAAkB,EAAC,GAAG,EAAE,MAAM,CAAC,EAAE;oBAC7C;wBACE,oDAAC,qDAAI,IAAC,SAAS,EAAC,UAAU,EAAC,EAAE,EAAE,cAAY,MAAM,CAAC,EAAE,UAAO,GAAS,CACjE;oBACL;wBACE,+DAAI,MAAM,CAAC,IAAI,CAAK,CACjB;oBACL;wBACE;4BAAG,2DAAG,KAAK,EAAE,EAAC,MAAM,EAAE,SAAS,EAAC,EAAE,OAAO,EAAE,cAAI,oEAAK,CAAC,EAAC,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE,MAAM,CAAC,IAAI,EAAC,CAAC,EAA9C,CAA8C,gDAAqC,CAAI,CACnI;oBACL;wBACE;4BAAG,2DAAG,KAAK,EAAE,EAAC,MAAM,EAAE,SAAS,EAAC,EAAE,OAAO,EAAE,cAAI,oEAAK,CAAC,EAAC,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,IAAI,EAAE,GAAG,EAAE,aAAa,EAAC,CAAC,EAAjE,CAAiE,yCAAmC,CAAI,CACpJ,CACF;YAbL,CAaK,CAAC,CACF,CACF,CAAC,CAAC,CAAC;YAAG,oDAAC,+DAAO,OAAG;kDAAkC,CACvD;QACN,+DAAM;QACL,OAAO,IAAI,OAAO,IAAI,oDAAC,qDAAI,IAAC,EAAE,EAAC,cAAc,EAAC,SAAS,EAAC,KAAK,2BAAuB,CAChF;AACT,CAAC;;;;;;;;;;;;;;;;;;;;;;;AC5C8B;AACyB;AACb;AAEiB;AACE;AAW9D;IAA6B,iEAA4B;IACvD,iBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,KAAK,GAAG;YACX,OAAO,EAAE,IAAI;SACd;;IACH,CAAC;IAED,mCAAiB,GAAjB;QACE,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,aAAG,IAAI,qEAAS,CAAC,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,EAA7B,CAA6B,CAAC,CAAC;IAC1D,CAAC;IAEK,sBAAI,GAAV;;;;;4BACkB,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAS,SAAS,CAAC;;wBAA5D,OAAO,GAAG,SAAkD;wBAClE,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,WAAE,CAAC,CAAC;;;;;KAC5B;IAED,wBAAM,GAAN;QACU,gCAAO,CAAgB;QAC/B,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC,gEAAW,CAAC,MAAM,CAAC,CAAC,CAAC;QAC7C,MAAM,CAAC,6DAAK,KAAK,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE;YAC/B,oDAAC,mEAAY,IAAC,KAAK,EAAC,QAAQ,EAAC,UAAU,EAAC,SAAS,EAAC,MAAM,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GAAI;YAChG,6DAAK,SAAS,EAAC,kBAAkB;gBAC/B,6DAAK,SAAS,EAAC,uDAAuD;oBACpE,oDAAC,wEAAkB,IAAC,OAAO,EAAE,OAAO,EAAE,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,aAAa,GAAI,CAC7E,CACF,CACF;IAER,CAAC;IACH,cAAC;AAAD,CAAC,CA9B4B,+CAAe,GA8B3C;;;;;;;;;;;;;;;;;;;AC9C8B;AACU;AAMlC,IAAM,SAAS,GAAG,UAAC,KAAY,IAAG,2DAAC,uDAAU,IAAC,KAAK,EAAC,sBAAiB,EAAC,WAAW,EAAE,KAAK,CAAC,WAAW,GAAI,EAAtE,CAAsE,CAAC;;;;;;;;;;;;;;;;;;;;;;ACPjF;AAI2B;AACK;AACpB;AAY3C;IAA0C,8EAA4B;IACpE,8BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAC,EAAE,CAAC;;IAChB,CAAC;IAED,qCAAM,GAAN;QACQ,mBAAwC,EAAvC,cAAI,EAAE,sBAAQ,EAAE,wBAAS,CAAe;QAC/C,MAAM,CAAC;YACL,6DAAK,SAAS,EAAC,eAAe,IAC3B,SAAS,CAAC,GAAG,CAAC,UAAC,QAAQ,EAAE,GAAG;gBAC3B,oEAAK,SAAS,EAAC,kBAAkB,EAAC,GAAG,EAAE,GAAG;oBACxC,6DAAK,SAAS,EAAC,oBAAoB;wBACjC,2DAAG,SAAS,EAAC,UAAU,EAAC,OAAO,EAAE,cAAI,WAAI,CAAC,UAAU,CAAC;gCACnD,SAAS,EAAE,uEAAY;gCACvB,KAAK,EAAE;oCACL,KAAK,EAAE,iBAAiB;oCACxB,QAAQ;oCACR,MAAM,EAAE,wBAAc;wCACpB,IAAM,eAAe,GAAG,kFAAmC,CAAC,cAAc,EAAE,wDAAG,CAAC,WAAW,CAAC,CAAC;wCAC7F,QAAQ,CAAC,EAAC,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,eAAe,CAAC,CAAC,EAAC,CAAC,CAAC;wCACjD,IAAI,CAAC,WAAW,EAAE,CAAC;oCACrB,CAAC;oCACD,QAAQ,EAAE;wCACR,QAAQ,CAAC,EAAC,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;wCAChC,IAAI,CAAC,WAAW,EAAE,CAAC;oCACrB,CAAC;iCACF;6BACF,CAAC,EAfmC,CAenC,GAAM,CACJ;oBACN,6DAAK,SAAS,EAAC,oBAAoB;wBACjC,2DAAG,IAAI,EAAE,QAAQ,CAAC,GAAG,EAAE,MAAM,EAAC,QAAQ,IAAG,QAAQ,CAAC,IAAI,CAAK,CACvD,CACF;YAtBN,CAsBM,CAAC,CACN;YACP,2DAAG,SAAS,EAAC,KAAK,EAAC,OAAO,EAAE,cAAI,WAAI,CAAC,UAAU,CAAC;oBAC9C,SAAS,EAAE,uEAAY;oBACvB,KAAK,EAAE;wBACL,KAAK,EAAE,kBAAkB;wBACzB,MAAM,EAAE,qBAAW;4BACjB,IAAM,eAAe,GAAG,kFAAmC,CAAC,WAAW,EAAE,wDAAG,CAAC,WAAW,CAAC,CAAC;4BAC1F,QAAQ,CAAC,EAAC,KAAK,EAAE,CAAC,eAAe,CAAC,EAAC,CAAC;4BACpC,IAAI,CAAC,WAAW,EAAE,CAAC;wBACrB,CAAC;qBACF;iBACF,CAAC,EAV8B,CAU9B;gBAAE,2DAAG,SAAS,EAAC,iBAAiB,wBAAiB;yCAAqB,CAClE;IACR,CAAC;IACH,2BAAC;AAAD,CAAC,CAhDyC,+CAAe,GAgDxD;;;;;;;;;;;;;;;;;;;;;;;;AClE8B;AAIqB;AAEW;AACpB;AACc;AAoBzD;IAAsC,0EAA4B;IAChE,0BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAG,EAAE,CAAC;;IAClB,CAAC;IAED,yCAAc,GAAd,UAAe,IAAU;QACjB,mBAYQ,EAXZ,0CAAkB,EAClB,kBAAM,EACN,cAAI,EACJ,kBAAM,EACN,oBAAO,EACP,4BAAW,EACX,gCAAa,EACb,0DAA0B,EAC1B,gCAAa,EACb,kDAAsB,EACtB,kCAAc,CACD;QAEf,IAAI,CAAC,UAAU,CAAC;YACd,SAAS,EAAE,+DAAQ;YACnB,KAAK,EAAE;gBACL,IAAI;gBACJ,iBAAiB,EAAE,kBAAkB,IAAI,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC;gBACpE,MAAM;gBACN,MAAM;gBACN,IAAI;gBACJ,sBAAsB;gBACtB,MAAM,EAAE,cAAI;oBACV,IAAM,WAAW,GAAG,kFAAmC,CAAC,IAAI,EAAE,wDAAG,CAAC,WAAW,CAAC,CAAC;oBAC/E,aAAa,CAAC,WAAW,CAAC,CAAC;oBAC3B,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrB,CAAC;gBACD,mBAAmB,EAAE,uBAAa;oBAChC,0BAA0B,CAAC,IAAI,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;oBACnD,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrB,CAAC;gBACD,QAAQ,EAAE;oBACR,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;oBACvB,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrB,CAAC;gBACD,SAAS,EAAE,UAAC,MAAc,EAAE,OAAa;oBACvC,cAAc,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;oBAChC,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrB,CAAC;gBACD,QAAQ,EAAE,cAAM,WAAI,CAAC,WAAW,EAAE,EAAlB,CAAkB;aACnC;SACF,CAAC,CAAC;IACL,CAAC;IAED,iCAAM,GAAN;QAAA,iBA0EC;QAzEC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,CAAC;YACL,6DAAK,SAAS,EAAC,eAAe,IAC3B,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,YAAE,IAAI,YAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC,EAAzC,CAAyC,CAAC,CAAC,GAAG,CAAC,cAAI;gBAC1E,IAAM,aAAa,GAAG,sEAAc,CAAC,IAAI,CAAC,CAAC;gBAE3C,MAAM,CAAC,6DAAK,SAAS,EAAC,kBAAkB,EAAC,GAAG,EAAE,IAAI,CAAC,EAAE;oBACnD,6DAAK,SAAS,EAAC,oBAAoB;wBACjC,6DAAK,SAAS,EAAE,aAAa,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,UAAU,EAAE,OAAO,EAAE;gCAChE,YAAI,CAAC,cAAc,CAAC,IAAI,CAAC;4BAAzB,CAAyB,GAAI,CAC3B;oBACN,6DAAK,SAAS,EAAC,oBAAoB,IAChC,IAAI,CAAC,OAAO,CAAC,CAAC;wBACb,kEAAkE;wBAClE,mBAAmB;wBACnB,2DAAG,IAAI,EAAC,GAAG,EAAC,OAAO,EAAE,YAAE;gCACrB,EAAE,CAAC,cAAc,EAAE,CAAC;gCACpB,KAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;4BAC5B,CAAC,IAAG,IAAI,CAAC,IAAI,CAAK,CAAC,CAAC;wBACpB,2DAAG,IAAI,EAAE,IAAI,CAAC,GAAG,EAAE,MAAM,EAAC,QAAQ,IAAE,IAAI,CAAC,IAAI,CAAK,CAChD,CACF,CAAC;YACT,CAAC,CAAC,CACE;YACN,+DAAM;YACN,2DAAG,SAAS,EAAC,KAAK,EAAC,OAAO,EAAE;oBACpB,oBAMqC,EALzC,kBAAM,EACN,cAAI,EACJ,kDAAsB,EACtB,kBAAM,EACN,4BAAW,EACX,0DAA0B,CAAgB;oBAE5C,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC;wBACpB,SAAS,EAAE,+DAAQ;wBACnB,KAAK,EAAE;4BACL,UAAU,EAAE,IAAI;4BAChB,MAAM;4BACN,MAAM;4BACN,IAAI;4BACJ,sBAAsB;4BACtB,MAAM,EAAE,UAAC,WAAW,EAAE,iBAAiB;gCACrC,WAAW,GAAG,kFAAmC,CAAC,WAAW,EAAE,wDAAG,CAAC,WAAW,CAAC,CAAC;gCAChF,WAAW,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;gCAC5C,IAAI,CAAC,WAAW,EAAE,CAAC;4BACrB,CAAC;4BACD,QAAQ,EAAE,cAAM,WAAI,CAAC,WAAW,EAAE,EAAlB,CAAkB;yBACnC;qBACF,CAAC,CAAC;gBACL,CAAC;gBAAE,2DAAG,SAAS,EAAC,cAAc,wBAAe;oCAAgB;;YAE7D,2DAAG,OAAO,EAAE;oBACJ,oBAAiH,EAA/G,kBAAM,EAAE,cAAI,EAAE,kBAAM,EAAE,oBAAO,EAAE,4BAAW,EAAE,gCAAa,EAAE,gCAAa,EAAE,kDAAsB,CAAgB;oBACxH,IAAI,CAAC,UAAU,CAAC;wBACd,SAAS,EAAE,+DAAQ;wBACnB,KAAK,EAAE;4BACL,MAAM;4BACN,MAAM;4BACN,IAAI;4BACJ,sBAAsB;4BACtB,MAAM,EAAE,iBAAO;gCACb,OAAO,GAAG,kFAAmC,CAAC,OAAO,EAAE,wDAAG,CAAC,WAAW,CAAC,CAAC;gCACxE,WAAW,CAAC,OAAO,CAAC,CAAC;gCACrB,IAAI,CAAC,WAAW,EAAE,CAAC;4BACrB,CAAC;4BACD,QAAQ,EAAE,cAAM,WAAI,CAAC,WAAW,EAAE,EAAlB,CAAkB;yBACnC;qBACF,CAAC,CAAC;gBACL,CAAC,EAAE,SAAS,EAAC,KAAK;gBAChB,2DAAG,SAAS,EAAC,YAAY,wBAAe;+CACtC,CACC;IACT,CAAC;IACH,uBAAC;AAAD,CAAC,CA/HqC,+CAAe,GA+HpD;;;;;;;;;;;;;;;;;;;;AC3J8B;AAa/B;IAAyC,6EAA4B;IAGnE,6BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAC,EAAC,WAAW,EAAE,KAAK,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAC,CAAC;;IACxD,CAAC;IAED,oCAAM,GAAN;QAAA,iBAsEC;QArEK,mBAAiC,EAAhC,sBAAQ,EAAE,sBAAQ,CAAe;QAC/B,wCAAW,CAAe;QACjC,EAAE,CAAC,CAAC,WAAW,CAAC;YAAC,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,EAAC,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAC,CAAC,CAAC;QAEjE,MAAM,CAAC,6DAAK,SAAS,EAAC,eAAe;YACnC,wFAAyB;YACzB,+DAAO,QAAQ,EAAE,CAAC,EAAE,KAAK,EAAE,EAAC,KAAK,EAAE,MAAM,EAAC,EAAE,MAAM,EAAE,YAAE;oBACpD,QAAC,CAAC,EAAE,CAAC,aAAa;wBACjB,EAAE,CAAC,aAAqB,CAAC,OAAO,KAAK,OAAO,CAAC;wBAC9C,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC;wBAC9B,KAAI,CAAC,QAAQ,CAAC,EAAC,WAAW,EAAE,KAAK,EAAC,CAAC;gBAHnC,CAGmC;gBAEnC,mEACG,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI;oBACtB,4DAAI,KAAK,EAAE,EAAC,KAAK,EAAE,KAAK,EAAC,WAAW;oBACpC,+FAAgC,CAC7B,CACC;gBACR,mEACG,QAAQ,CAAC,GAAG,CAAC,UAAC,OAAO,EAAE,GAAG;oBAC3B,mEAAI,GAAG,EAAE,GAAG;wBACV;4BAAI,+DAAO,IAAI,EAAC,MAAM,EAAC,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,QAAQ,GAAG,IAAI,EAApB,CAAoB,EAAE,KAAK,EAAE,OAAO,CAAC,IAAI,EAAE,SAAS,EAAE,CAAC,OAAO,CAAC,IAAI,IAAI,GAAG,GAAG,CAAC,EAAE,QAAQ,EAC1H,YAAE;oCACA,EAAE,CAAC,CAAC,WAAW,IAAI,GAAG,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;wCAC9C,QAAQ,CAAC,EAAC,KAAK,EAAE,oDAAK,OAAO,IAAE,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,IAAE,EAAE,CAAC,CAAC;wCAC1D,KAAI,CAAC,QAAQ,CAAC,EAAC,WAAW,EAAE,KAAK,EAAC,CAAC,CAAC;oCACtC,CAAC;oCAAC,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;wCAC1C,QAAQ,CAAC,EAAC,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,qDAAM,OAAO,IAAE,IAAI,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,IAAE,CAAC,EAAE,CAAC,CAAC;oCACxE,CAAC;oCAAC,IAAI,CAAC,CAAC;wCACN,EAAE,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,CAAC;4CACnC,KAAI,CAAC,QAAQ,CAAC,EAAC,WAAW,EAAE,IAAI,EAAC,CAAC,CAAC;wCACrC,QAAQ,CAAC,EAAC,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;oCAClC,CAAC;gCACH,CAAC,GACA,CAAK;wBACR;4BAAI,+DACF,IAAI,EAAC,MAAM,EACX,KAAK,EAAE,EAAC,KAAK,EAAE,MAAM,EAAC,EACtB,KAAK,EAAE,OAAO,CAAC,GAAG,EAClB,SAAS,EAAE,YAAE;oCACX,SAAE,CAAC,KAAK,KAAK,CAAC;wCACd,CAAC,EAAE,CAAC,QAAQ;wCACZ,GAAG,KAAK,QAAQ,CAAC,MAAM,GAAG,CAAC;wCAC3B,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,IAAI;4CAC1D,CAAC,KAAI,CAAC,QAAQ,CAAC,EAAC,WAAW,EAAE,IAAI,EAAC,CAAC,EAAC,EAAE,CAAC,cAAc,EAAE,CAAC,CAAC;gCAJ3D,CAI2D,EAC7D,QAAQ,EAAE,YAAE;oCACV,EAAE,CAAC,CAAC,WAAW,IAAI,GAAG,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;wCAC9C,QAAQ,CAAC,EAAC,KAAK,EAAE,oDAAK,OAAO,IAAE,GAAG,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,IAAE,EAAC,CAAC;wCACvD,KAAI,CAAC,QAAQ,CAAC,EAAC,WAAW,EAAE,KAAK,EAAC,CAAC,CAAC;oCACtC,CAAC;oCAAC,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;wCAC3C,QAAQ,CAAC,EAAC,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,qDAAM,OAAO,IAAE,GAAG,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,IAAE,CAAC,EAAC,CAAC,CAAC;oCACtE,CAAC;oCAAC,IAAI,CAAC,CAAC;wCACN,EAAE,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,CAAC;4CACnC,KAAI,CAAC,QAAQ,CAAC,EAAC,WAAW,EAAE,IAAI,EAAC,CAAC,CAAC;wCACrC,QAAQ,CAAC,EAAC,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC;oCAClC,CAAC;gCACH,CAAC,GAEA,CAAK,CACL;gBAvCL,CAuCK,CAAC,CACA,CACF;YACR,+DAAK;YACL,2DAAG,SAAS,EAAC,KAAK,EAAC,OAAO,EAAE;oBAC1B,YAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;wBACtB,KAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;wBACvB,KAAI,CAAC,QAAQ,CAAC,EAAC,WAAW,EAAE,IAAI,EAAC,CAAC;gBAFpC,CAEoC;gBAChC,2DAAG,SAAS,EAAC,iBAAiB,wBAAe;uDAA8B,CAC7E;IACR,CAAC;IACH,0BAAC;AAAD,CAAC,CA/EwC,+CAAe,GA+EvD;;;;;;;;;;;;;;;;;;;;;AC5F8B;AAOsC;AAQrE;IAA0C,8EAAsB;IAC9D,8BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAC,EAAE,CAAC;;IAChB,CAAC;IAED,qCAAM,GAAN;QACQ,mBAAkC,EAAjC,cAAI,EAAE,sBAAQ,EAAE,YAAG,CAAe;QACzC,MAAM,CAAC;YACL,6DAAK,SAAS,EAAC,eAAe,IAC3B,GAAG;gBACF,6DAAK,SAAS,EAAC,kBAAkB;oBAC/B,6DAAK,SAAS,EAAC,oBAAoB;wBACjC,2DAAG,SAAS,EAAC,UAAU,EAAC,OAAO,EAAE,cAAI,WAAI,CAAC,UAAU,CAAC;gCACnD,SAAS,EAAE,gFAAgB;gCAC3B,KAAK,EAAE;oCACL,GAAG;oCACH,MAAM,EAAE,gBAAM;wCACZ,QAAQ,CAAC,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC,CAAC;wCACzB,IAAI,CAAC,WAAW,EAAE,CAAC;oCACrB,CAAC;oCACD,QAAQ,EAAE;wCACR,QAAQ,CAAC,EAAC,IAAI,EAAE,SAAS,EAAC,CAAC,CAAC;wCAC5B,IAAI,CAAC,WAAW,EAAE,CAAC;oCACrB,CAAC;iCACF;6BACF,CAAC,EAbmC,CAanC,GAAM,CACJ;oBACN,6DAAK,SAAS,EAAC,oBAAoB;wBACjC,2DAAG,IAAI,EAAE,GAAG,EAAE,MAAM,EAAC,QAAQ,gCAA0B,CACnD,CACF,CAEL;YACN,CAAC,GAAG,IAAI,2DAAG,SAAS,EAAC,KAAK,EAAC,OAAO,EAAE,cAAI,WAAI,CAAC,UAAU,CAAC;oBACvD,SAAS,EAAE,gFAAgB;oBAC3B,KAAK,EAAE;wBACL,MAAM,EAAE,gBAAM;4BACZ,QAAQ,CAAC,EAAC,IAAI,EAAE,MAAM,EAAC,CAAC;4BACxB,IAAI,CAAC,WAAW,EAAE,CAAC;wBACrB,CAAC;qBACF;iBACF,CAAC,EARuC,CAQvC;gBAAE,2DAAG,SAAS,EAAC,iBAAiB,wBAAiB;yDAAqC,CAClF;IACR,CAAC;IACH,2BAAC;AAAD,CAAC,CA7CyC,+CAAe,GA6CxD;;;;;;;;;;;;;;;;;;;;AC5D8B;AAiB/B;IAAqC,yEAA0B;IAC7D,yBAAY,KAAY;eACtB,kBAAM,KAAK,CAAC;IACd,CAAC;IAED,gCAAM,GAAN;QACQ,mBAAiD,EAA/C,gDAAqB,EAAE,wBAAS,CAAgB;QAClD,mBAAwD,EAAtD,kCAAc,EAAE,sBAAQ,EAAE,gCAAa,CAAgB;QAE/D,IAAM,OAAO,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;QAChC,IAAM,IAAI,GAA6B,EAAE,CAAC;QAC1C,IAAM,IAAI,GAAG,qBAAqB,CAAC,KAAK,EAAE,CAAC;QAC3C,IAAI,GAAG,GAAkC,IAAI,CAAC;QAC9C,OAAO,IAAI,EAAE,CAAC;YACZ,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,eAAK;gBACrB,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,WAAC,IAAI,QAAC,CAAC,SAAS,CAAC,WAAW,EAAE,KAAK,KAAK,EAAnC,CAAmC,CAAC,CAAC;gBACvE,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;oBAAC,MAAM,CAAC,IAAI,CAAC;gBAC3B,IAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;gBACvB,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACtB,MAAM,CAAC,EAAE,CAAC;YACZ,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,WAAC,IAAI,QAAC,KAAK,IAAI,EAAV,CAAU,CAAC,CAAC;gBAC7B,KAAK,CAAC;YACR,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC;QAED,MAAM,CAAC;YACL;gBACE;oBACE,gEACG,OAAO,CAAC,GAAG,CAAC,WAAC,IAAI,mEAAI,GAAG,EAAE,CAAC,IAAG,CAAC,CAAM,EAApB,CAAoB,CAAC,CACpC,CACC;gBACR,mEACG,IAAI,CAAC,GAAG,CAAC,UAAC,GAAG,EAAC,CAAC;oBACd,mEAAI,GAAG,EAAE,CAAC,IACP,GAAG,CAAC,GAAG,CAAC,UAAC,WAAW,EAAC,CAAC;wBACrB,IAAM,UAAU,GAAG,WAAW,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;wBACtF,IAAM,aAAa,GAAG,WAAW,IAAI,cAAc,IAAI,cAAc,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;wBACtF,MAAM,CAAC,4DACL,GAAG,EAAE,CAAC,EACN,uBAAuB,EAAE,EAAC,MAAM,EAAE,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAC,EACtE,SAAS,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC;gCACzC,CAAC,UAAU,CAAC,CAAC;oCACX,cAAc,CAAC,CAAC;oCAChB,CAAC,aAAa,CAAC,CAAC;wCACd,YAAY,EAAC;wCACb,EAAE,CAAC,CAAC,EACN,OAAO,EAAE,QAAQ,IAAI,WAAW,CAAC,CAAC;gCAChC,cAAI,oBAAa,CAAC,WAAW,CAAC,EAAE,EAAE,CAAC,UAAU,CAAC,EAA1C,CAA0C,CAAC,CAAC;gCAChD,SAAS,GAAI;oBACrB,CAAC,CAAC,CACC;gBAjBL,CAiBK,CACN,CACK,CACF,CACJ;QAEN,CAAC;QAwCO,CAAC;IACX,CAAC;IACH,sBAAC;AAAD,CAAC,CApGoC,+CAAe,GAoGnD;;;;;;;;;;;;;;;;;;;;;ACrH8B;AACU;AAOxC,CAAC;AAEK,IAAM,UAAU,GAAG,UAAC,EAA2C;QAAzC,oBAAO,EAAE,wBAAS,EAAE,gBAAK,EAAE,gBAAK;IAE3D,oEACE,KAAK,EAAE,KAAK,IAAI,sDAAC,yHAAQ,MACzB,SAAS,EAAE,aAAa,GAAG,CAAC,SAAS,IAAI,EAAE,CAAC,EAC5C,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,GAAI;AAHpC,CAGoC;;;;;;;;;;;;;;;;;;;;;;;;;ACfP;AACkC;AAEG;AAChC;AACI;AACG;AAS3C;IAAmC,uEAA4B;IAC7D,uBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAKb;QAJC,KAAI,CAAC,KAAK,GAAG;YACX,aAAa,EAAE,IAAI;SACpB;QACD,KAAI,CAAC,sBAAsB,GAAG,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;;IACvE,CAAC;IAED,yCAAiB,GAAjB;QACE,yEAAmB,CAAC,SAAS,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC,KAAK,CAAC,sDAAS,CAAC,CAAC;IAC9E,CAAC;IAED,4CAAoB,GAApB;QACE,yEAAmB,CAAC,WAAW,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;IAC/D,CAAC;IAED,8CAAsB,GAAtB,UAAuB,aAAuB;QAC5C,IAAM,WAAW,GAAG,gEAAW,CAAC,MAAM,CAAC,CAAC;QACxC,IAAM,kBAAkB,GAAG,gEAAW,CAAC,aAAa,CAAC,CAAC;QACtD,aAAa,CAAC,IAAI,CAAC,UAAC,CAAC,EAAC,CAAC,IAAK,kBAAW,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,kBAAkB,CAAC,CAAC,EAAC,CAAC,CAAC,EAA3C,CAA2C,CAAC,CAAC;QACzE,IAAI,CAAC,QAAQ,CAAC,EAAC,aAAa,iBAAC,CAAC,CAAC;IACjC,CAAC;IAED,8BAAM,GAAN;QACS,4CAAa,CAAe;QACnC,MAAM,CAAC,6DAAK,SAAS,EAAC,2CAA2C;YAC/D,6DAAK,SAAS,EAAC,WAAW;gBACxB,iFAAuB;gBACvB,6DAAK,SAAS,EAAC,wBAAwB,IACpC,CAAC,aAAa,CAAC,CAAC;oBACf;wBAAG,oDAAC,gDAAO,OAAG;iDAA0B,CAAC,CAAC;oBAC1C,aAAa,CAAC,GAAG,CAAC,gBAAM,IAAI,oEAAK,SAAS,EAAC,cAAc,EAAC,GAAG,EAAE,MAAM,CAAC,EAAE;wBACxE,6DAAK,SAAS,EAAC,kBAAkB;4BAC/B,6DAAK,SAAS,EAAC,+BAA+B;gCAC5C,oDAAC,qDAAI,IACH,EAAE,EAAE,cAAY,MAAM,CAAC,EAAE,UAAO,EAChC,SAAS,EAAC,UAAU,GACpB,CACE;4BACN,6DAAK,SAAS,EAAC,oBAAoB;gCACjC,oDAAC,qDAAI,IAAC,EAAE,EAAE,cAAY,MAAM,CAAC,EAAE,UAAO,IAAG,MAAM,CAAC,IAAI,CAAQ,CAAM;4BACpE,6DAAK,SAAS,EAAC,oBAAoB,IAChC,MAAM,CAAC,MAAM,IAAI,6DAAK,SAAS,EAAC,aAAa,YAAY,CACtD;4BACL,MAAM,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,WAAW,IAAI,6DAAK,SAAS,EAAC,oBAAoB;gCAC1E,6DAAK,SAAS,EAAC,iBAAiB,iBAAiB,CAC7C,CACF;wBACN,6DAAK,SAAS,EAAC,oBAAoB;4BACjC,+DAAI,MAAM,CAAC,WAAW,CAAK,CACvB;wBACN,6DAAK,SAAS,EAAC,oBAAoB,IAChC,MAAM,CAAC,UAAU,CAAC,CAAC;4BAClB,2DAAG,SAAS,EAAC,OAAO;;gCAAe,MAAM,CAAC,UAAU,CAAC,IAAI;;gCAAK,8DAAe,CAAC,MAAM,CAAC,YAAY,CAAC,CAAK,CAAC,CAAC;4BACzG,2DAAG,SAAS,EAAC,OAAO,EAAC,KAAK,EAAE,EAAC,SAAS,EAAE,QAAQ,EAAC,QAAO,CACtD,CACF,EAzBwB,CAyBxB,CAAC,CACH;gBACL,QAAQ,CAAC,IAAI,KAAK,eAAe,IAAI,oDAAC,qDAAI,IACzC,SAAS,EAAC,KAAK,EACf,EAAE,EAAC,cAAc,EACjB,OAAO,EAAE,cAAI,aAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAnB,CAAmB,oBAE3B,CACH,CACF;IACR,CAAC;IACH,oBAAC;AAAD,CAAC,CApEkC,+CAAe,GAoEjD;;;;;;;;;;;;;;;;;;;;;ACnF8B;AAEwC;AAavE;IAAuC,2EAA4B;IACjE,2BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAG,EAAE,CAAC;;IAClB,CAAC;IAED,kCAAM,GAAN;QAAA,iBAgBC;QAfO,mBAAkD,EAAjD,oBAAO,EAAE,gBAAK,EAAE,wBAAS,EAAE,sBAAQ,CAAe;QACzD,MAAM,CAAC,oDAAC,+EAAY,IAAC,KAAK,EAAE,+DAAI,KAAK,CAAK,EAAE,SAAS,EAAC,QAAQ,IACzD,OAAO,CAAC,GAAG,CAAC,gBAAM;YACjB,IAAM,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,KAAK,MAAM,CAAC,EAAE,EAAf,CAAe,CAAC,CAAC;YACtD,MAAM,CAAC,6DAAK,SAAS,EAAC,kBAAkB,EAAC,GAAG,EAAE,MAAM,CAAC,EAAE,EAAE,OAAO,EAAE;oBAChE,eAAQ,IAAI,KAAI,CAAC,KAAK,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC;gBAA1D,CAA0D;gBAC1D,6DAAK,SAAS,EAAE,2BAA2B;wBACzC,CAAC,QAAQ,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC;wBAC/B,CAAC,QAAQ,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,CAAC;oBAChC,2DAAG,uBAAuB,EAAE,EAAC,MAAM,EAAE,MAAM,CAAC,IAAI,EAAC,GAAI;oBACrD,+DAAM,CACF,CACF,CAAC;QACT,CAAC,CAAC,CACS;IACjB,CAAC;IACH,wBAAC;AAAD,CAAC,CAvBsC,+CAAe,GAuBrD;;;;;;;;;;;;;;;;;;ACtC8B;AAExB,IAAM,OAAO,GAAG,cAAK;IAAM,2DAAG,SAAS,EAAC,uBAAuB,iBAAa,MAAM,GAAK;aAAa,EAA/E,CAA+E,CAAC;;;;;;;;;;;;;;;;;;;;;;ACF7E;AAE2B;AACM;AACO;AAUvE;IAAwC,4EAA4B;IAClE,4BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,KAAK,GAAG;YACX,MAAM,EAAE,KAAK;SACd,CAAC;;IACJ,CAAC;IAED,mCAAM,GAAN;QACU,8BAAM,CAAgB;QACtB,8BAAM,CAAgB;QAC9B,IAAM,IAAI,GAAG,EAAE,CAAC;QAChB,IAAM,UAAU,GAAG,6EAAa,CAAC,MAAM,CAAC,CAAC;QAEzC,IAAI,CAAC,IAAI,CAAC,4DAAI,GAAG,EAAC,gBAAgB,EAAC,SAAS,EAAC,oBAAoB;YAAC,4DAAI,OAAO,EAAE,CAAC,6BAAwB,CAAK,CAAC,CAAC;QAC/G,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,UAAC,EAAE,EAAC,GAAG,IAAK,WAAI,CAAC,IAAI,CAAC,4DAAI,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;YACtG;gBAAI,2DAAG,SAAS,EAAC,cAAc,EAAC,uBAAuB,EAAE,EAAC,MAAM,EAAE,EAAE,CAAC,IAAI,EAAC,GAAG,CAAK;YAClF;gBAAI,+DAAI,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAK,CAAK,CAC/C,CAAC,EAHoC,CAGpC,CAAC,CAAC;QAER,IAAI,CAAC,IAAI,CAAC,4DAAI,GAAG,EAAC,WAAW,EAAC,SAAS,EAAC,oBAAoB;YAAC,4DAAI,OAAO,EAAE,CAAC,yBAAe,CAAK,CAAC,CAAC;QACjG,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,UAAC,OAAO,EAAC,GAAG,IAAK,WAAI,CAAC,IAAI,CAAC,4DAAI,GAAG,EAAE,OAAO,CAAC,EAAE,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;YAC3G;gBAAI,2DAAG,SAAS,EAAC,aAAa,EAAC,uBAAuB,EAAE,EAAC,MAAM,EAAE,OAAO,CAAC,IAAI,EAAC,GAAG,CAAK;YACtF;gBAAI,+DAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAK,CAAK,CACpD,CAAC,EAHoC,CAGpC,CAAC,CAAC;QAER,IAAI,CAAC,IAAI,CAAC,4DAAI,GAAG,EAAC,iBAAiB,EAAC,SAAS,EAAC,oBAAoB;YAAC,4DAAI,OAAO,EAAE,CAAC,iCAAuB,CAAK,CAAC,CAAC;QAC9G,qEAAe,CAAC,OAAO,CAAC,UAAC,iBAAiB,EAAE,GAAG,IAAK,WAAI,CAAC,IAAI,CAAC,4DAAI,GAAG,EAAE,iBAAiB,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;YAC7H;gBAAI,2DAAG,SAAS,EAAC,aAAa,IAAE,iBAAiB,CAAK,CAAK;YAC3D;gBAAI,+DAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAK,CAAK,CAC3D,CAAC,EAH+C,CAG/C,CAAC,CAAC;QAER,MAAM,CAAC,oDAAC,+EAAY,IAClB,SAAS,EAAC,QAAQ,EAClB,KAAK,EAAE,8FAA8B,EACrC,gBAAgB,EAAC,sBAAsB;YACrC,mIAA8D;YAC9D;gBAAO,mEAAQ,IAAI,CAAS,CAAQ,CACzB;IACjB,CAAC;IACH,yBAAC;AAAD,CAAC,CAxCuC,+CAAe,GAwCtD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtD8B;AACiC;AACrB;AAEpB;AAE8B;AACR;AACkC;AAC1B;AACG;AACJ;AAYpD;IAA8B,kEAA4B;IACxD,kBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAMb;QALC,KAAI,CAAC,KAAK,GAAG;YACX,iBAAiB,EAAE,IAAI;YACvB,QAAQ,EAAE,EAAE;YACZ,eAAe,EAAE,IAAI;SACtB,CAAC;;IACJ,CAAC;IAED,qCAAkB,GAAlB;QACE,IAAI,CAAC,IAAI,EAAE,CAAC;IACd,CAAC;IAEK,uBAAI,GAAV;;;;;4BACmB,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC;;wBAAtD,QAAQ,GAAG,SAA2C;wBAC5D,QAAQ,CAAC,IAAI,CAAC,gEAAW,CAAC,MAAM,CAAC,CAAC,CAAC;wBACnC,IAAI,CAAC,QAAQ,CAAC,EAAE,QAAQ,YAAE,iBAAiB,EAAE,KAAK,EAAE,CAAC,CAAC;;;;;KACvD;IAEK,mCAAgB,GAAtB,UAAuB,EAAmC;;;;;;wBACxD,EAAE,CAAC,eAAe,EAAE,CAAC;wBACrB,EAAE,CAAC,cAAc,EAAE,CAAC;wBACd,KAAK,GAAG,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC;wBACxB,qBAAM,6DAAc,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;;wBAApC,GAAG,GAAG,SAA8B;wBACpC,GAAG,GAAG,6CAAC,CAAC,6CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;wBACzB,KAAK,GAAuB;4BAChC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,IAAI,EAAE;4BACrC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,IAAI,EAAE;4BACrC,OAAO,EAAE,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,IAAI,EAAE;4BAC3C,OAAO,EAAE,EAAE;yBACZ,CAAC;wBACI,OAAO,GAAG,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;wBAC5C,GAAG,CAAC,CAAK,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;4BAC9B,MAAM,GAAG,6CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;4BACvB,sBAAsB,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;iCAC/E,GAAG,CAAC,WAAC,IAAI,QAAC,EAAC,SAAS,EAAE,6CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,6CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAC,CAAC,EAA5E,CAA4E,CAAC,CAAC;4BAE1F,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC;gCACjB,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE;gCAChC,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE;gCAChC,cAAc,EAAE,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,IAAI,EAAE;gCACpD,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC;gCAC7C,sBAAsB;6BACvB,CAAC,CAAC;wBACL,CAAC;wBACD,IAAI,CAAC,QAAQ,CAAC,EAAC,eAAe,EAAE,KAAK,EAAC,CAAC,CAAC;;;;;KACzC;IAED,kCAAe,GAAf,UAAgB,OAAO;QACpB,6DAAQ,CAAC,sDAAC,kJAAe,EAAO,WAAW,KAAlB,OAAO,EAAY,CAAC;QAC7C,IAAI,CAAC,QAAQ,CAAC,EAAC,eAAe,EAAE,IAAI,EAAC,CAAC,CAAC;QACvC,IAAI,CAAC,IAAI,EAAE,CAAC;IACf,CAAC;IAED,yBAAM,GAAN;QAAA,iBAyBC;QAxBC,MAAM,CAAC;YAAK,oDAAC,mEAAY,IACvB,KAAK,EAAE,sDAAC,iIAAO,MACf,UAAU,EAAC,UAAU,EACrB,MAAM,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GACzC;YACA,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;gBAC7B,oDAAC,iEAAe,mDACd,QAAQ,EAAE,cAAI,YAAI,CAAC,QAAQ,CAAC,EAAC,eAAe,EAAE,IAAI,EAAC,CAAC,EAAtC,CAAsC,EACpD,eAAe,EAAE,iBAAO,IAAI,YAAI,CAAC,eAAe,CAAC,OAAO,CAAC,EAA7B,CAA6B,IACrD,IAAI,CAAC,KAAK,CAAC,eAAe,EAAI;gBACtC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;oBAC9B;wBAAK;4BAAG,oDAAC,gEAAO,OAAE;iFAAuC,CAAM,CAAC,CAAC;oBACjE;wBACE,gEAAK,sDAAC,iIAAO,KAAM;wBACnB,gEAAK,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAC;4BAC5B,mEAAI,GAAG,EAAE,CAAC,CAAC,EAAE,EAAE,SAAS,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,YAAY;gCACjE,oDAAC,qDAAI,IAAC,EAAE,EAAE,YAAY,GAAG,CAAC,CAAC,EAAE,IAAG,CAAC,CAAC,IAAI,CAAQ,CAC3C;wBAFL,CAEK,CAAC,CACH;wBACL,6DAAK,SAAS,EAAC,WAAW,EAAC,UAAU,EAAE,gDAAS,EAAE,MAAM,EAAE,YAAE,IAAE,YAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,EAAzB,CAAyB;;4BACjC,2DAAG,IAAI,EAAC,+BAA+B,EAAC,MAAM,EAAC,YAAY,6BAA2B;gCACtI,CACF,CACD;IACT,CAAC;IACH,eAAC;AAAD,CAAC,CAjF6B,+CAAe,GAiF5C;;;;;;;;;;;;;;;;;;;;;;;;ACxG8B;AAGY;AAEa;AACJ;AAWpD;IAAiC,qEAA4B;IAC3D,qBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAEb;QADC,KAAI,CAAC,KAAK,GAAG,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC;;IAC/B,CAAC;IAED,wCAAkB,GAAlB;QACE,IAAI,CAAC,IAAI,EAAE,CAAC;IACd,CAAC;IAEK,0BAAI,GAAV;;;;;4BACkB,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,GAAG,CAAU,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,iBAAiB,EAAE,CAAC;;wBAA5G,OAAO,GAAG,SAAkG;wBAClH,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,WAAE,CAAC,CAAC;;;;;KAC5B;IAED,4BAAM,GAAN;QACE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YAAC,MAAM,CAAC;gBAAG,oDAAC,+DAAO,OAAG,CAAI,CAAC;QAC7C,2BAAoD,EAAlD,cAAI,EAAE,cAAI,EAAE,oCAAe,CAAwB;QAC3D,MAAM,CAAC;YAAK,oDAAC,mEAAY,IACvB,KAAK,EAAE,IAAI,EACX,UAAU,EAAC,UAAU,EACrB,MAAM,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAC,GACvC;YACH;;gBAAsB,IAAI;;gBAAI,IAAI;oBAAO;YACzC,4DAAI,SAAS,EAAC,aAAa,IACxB,eAAe,CAAC,GAAG,CAAC,UAAC,EAAqC;oBAApC,UAAE,EAAE,cAAI,EAAE,cAAI,EAAE,4BAAW,EAAE,kBAAM;gBACxD,mEAAI,GAAG,EAAE,EAAE,EAAE,SAAS,EAAC,UAAU;oBAC9B,IAAI;;oBAAK,MAAM;wBACb;YAFL,CAEK,CAAC,CACL,CACD,CAAC;IACT,CAAC;IACH,kBAAC;AAAD,CAAC,CAhCgC,+CAAe,GAgC/C;;;;;;;;;;;;;;;;;;;;;;;;;ACjD8B;AACU;AAElB;AACoB;AAEkC;AAsB7E;IAAqC,yEAA6B;IAMhE,yBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAUb;QATC,KAAI,CAAC,YAAY,GAAG,EAAE,CAAC;QACvB,KAAI,CAAC,mBAAmB,GAAG,EAAE,CAAC;QAC9B,KAAI,CAAC,yBAAyB,GAAG,EAAE,CAAC;QACpC,KAAI,CAAC,KAAK,GAAG;YACX,YAAY,EAAE,KAAK;YACnB,OAAO,EAAE,EAAE;YACX,SAAS,EAAE,IAAI;YACf,WAAW,EAAE,KAAK;SACnB,CAAC;;IACJ,CAAC;IAEK,2CAAiB,GAAvB;;;;;;wBACE,IAAI,CAAC,iCAAiC,EAAE,CAAC;;;;wBAEvB,qBAAM,IAAI,CAAC,gBAAgB,EAAE;;wBAAvC,OAAO,GAAG,SAA6B;wBAC7C,IAAI,CAAC,QAAQ,CAAC,EAAE,OAAO,WAAE,CAAC,CAAC;;;wBAE3B,IAAI,CAAC,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;;;;;;KAEvC;IAED,2DAAiC,GAAjC;QACE,IAAM,SAAS,GAAG,6CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACjF,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC9B,IAAM,eAAe,GAAG,6CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/D,eAAe,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;QAC5C,IAAM,qBAAqB,GAAG,6CAAC,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC1E,qBAAqB,CAAC,QAAQ,CAAC,uBAAuB,CAAC,CAAC;QACxD,IAAM,GAAG,GAAG,6CAAC,CAAC,CAAC,SAAS,EAAE,eAAe,EAAE,qBAAqB,CAAC,CAAC,CAAC;QACnE,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;IAC9B,CAAC;IAED,wCAAc,GAAd;QAAA,iBA+BC;QA9BC,EAAE;QACF,+HAA+H;QAC/H,mGAAmG;QACnG,2FAA2F;QAC3F,EAAE;QACF,IAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;QAC/B,IAAM,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,6CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;QAE7F,MAAM,CAAC;YACL,IAAI,EAAE,WAAW,CAAC,IAAI;YACtB,IAAI,EAAE,WAAW,CAAC,IAAI;YACtB,SAAS,EAAE,SAAS,CAAC,GAAG,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAG,CAAC,GAAG,CAAC,UAAK,6CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAI,EAA1B,CAA0B,CAAC;YAC9D,OAAO,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;iBACpC,GAAG,CAAC,oBAAU,IAAI,YAAI,CAAC,YAAY,CAAC,UAAU,CAAC,EAA7B,CAA6B,CAAC;iBAChD,GAAG,CAAC,UAAC,EAAgB;oBAAd,kBAAM,EAAE,cAAI;gBAAO,QAAC;oBAC1B,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,MAAM,EAAE,MAAM,CAAC,MAAM;oBACrB,cAAc,EAAE,KAAK,CAAC,IAAI,CAAC,6CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,GAAG,CAAC,WAAC,IAAI,oDAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAX,CAAW,CAAC;oBAClF,qBAAqB,EACrB,KAAK,CAAC,IAAI,CAAC,6CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC,CAAC,GAAG,CAAC,WAAC,IAAI,oDAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAX,CAAW,CAAC;yBACnF,GAAG,CAAC,cAAI,IAAI,QAAC,EAAE,SAAS,EAAE,GAAG,EAAE,IAAI,QAAE,CAAC,EAA1B,CAA0B,CAAC;yBACvC,MAAM,CACP,KAAK,CAAC,IAAI,CAAC,6CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC,CAAC,GAAG,CAAC,WAAC,IAAI,oDAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAX,CAAW,CAAC;yBACnF,GAAG,CAAC,cAAI,IAAI,QAAC,EAAE,SAAS,EAAE,GAAG,EAAE,IAAI,QAAE,CAAC,EAA1B,CAA0B,CAAC,CAAC;yBAC1C,MAAM,CACP,KAAK,CAAC,IAAI,CAAC,6CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,sCAAsC,CAAC,CAAC,CAAC,GAAG,CAAC,WAAC,IAAI,oDAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAX,CAAW,CAAC;yBACnF,GAAG,CAAC,cAAI,IAAI,QAAC,EAAE,SAAS,EAAE,GAAG,EAAE,IAAI,QAAE,CAAC,EAA1B,CAA0B,CAAC,CAAC;iBAC9C,CAAC;YAdyB,CAczB,CAAC;SACN,CAAC;IACJ,CAAC;IAEK,0CAAgB,GAAtB;;;YAUE;gBACE,IAAM,EAAE,GAAG,UAAU,CAAC;gBACtB,UAAU,IAAI,CAAC,CAAC;gBAChB,MAAM,CAAC,EAAE,CAAC;YACZ,CAAC;;;;;wBAbK,eAAe,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;wBAC1C,OAAO,GAAa,EAAE,CAAC;wBAEF,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAAU,UAAU,CAAC;;wBAAvE,gBAAgB,GAAG,SAAoD;wBACzE,eAAe,GAAG,gBAAgB,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,IAAI,KAAK,KAAI,CAAC,KAAK,CAAC,IAAI,EAA1B,CAA0B,CAAC,CAAC,CAAC,CAAC,CAAC;wBAC9E,cAAc,GAAG,EAAsB,EACzC,qBAAqB,GAAG,EAA4B,CAAC;wBAEnD,UAAU,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;6BAOxB,eAAe,EAAf,wBAAe;wBAEC,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,GAAG,CAC9C,UAAU,EACV,eAAe,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,iBAAiB,EAAE,CAAC;;wBAHrD,gEAAgE;wBAChE,eAAe,GAAG,SAEmC,CAAC;wBAGtB,qBAAM,OAAO,CAAC,GAAG,CAC/C,eAAe,CAAC,eAAe,CAAC,GAAG,CAAC,YAAE,IAAI,+DAAG,CAAC,gBAAgB,CAAC,GAAG,CAAS,SAAS,EAAE,EAAE,CAAC,EAAE,EAAE;gCAC3F,OAAO,EAAE;oCACP,gBAAgB;oCAChB,uBAAuB;iCACxB;6BACF,CAAC,EALwC,CAKxC,CAAC,CAAC;;wBANA,uBAAuB,GAAG,SAM1B;4CAEK,cAAc;;;;;wCAOjB,SAAS,GAAG,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,IAAI,KAAK,cAAc,CAAC,IAAI,EAA9B,CAA8B,CAAC,CAAC;wCAE9E,mBAAmB,GAAG,SAAS,CAAC,cAAc;6CACjD,GAAG,CAAC,cAAI,IAAI,qBAAc,CAAC,cAAc;6CACvC,MAAM,CAAC,YAAE,IAAI,SAAE,CAAC,IAAI,KAAK,IAAI,EAAhB,CAAgB,CAAC;6CAC9B,GAAG,CAAC,YAAE,IAAI,SAAE,CAAC,EAAE,EAAL,CAAK,CAAC,CAAC,CAAC,CAAC,EAFT,CAES,CAAC,CAAC;wCAE1B,EAAE,CAAC,CAAC,mBAAmB,CAAC,IAAI,CAAC,YAAE,IAAI,QAAC,EAAE,EAAH,CAAG,CAAC,CAAC;4CAAC,MAAM,IAAI,KAAK,CACtD,wCAAwC,CAAC,CAAC;wCAEtC,0BAA0B,GAAG,SAAS,CAAC,qBAAqB;6CAC/D,GAAG,CAAC,eAAK,IAAI,qBAAc,CAAC,qBAAqB;6CAC/C,MAAM,CAAC,YAAE,IAAI,SAAE,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,IAAI,EAAE,CAAC,SAAS,KAAK,KAAK,CAAC,SAAS,EAA1D,CAA0D,CAAC;6CACxE,GAAG,CAAC,YAAE,IAAI,SAAE,CAAC,EAAE,EAAL,CAAK,CAAC,CAAC,CAAC,CAAC,EAFR,CAEQ,CAAC,CAAC;wCAE1B,EAAE,CAAC,CAAC,0BAA0B,CAAC,IAAI,CAAC,YAAE,IAAI,QAAC,EAAE,EAAH,CAAG,CAAC,CAAC;4CAAC,MAAM,IAAI,KAAK,CAC7D,8CAA8C,CAAC,CAAC;wCAE7B,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAClD,SAAS,EAAE,EAAE,IAAI,EAAE,cAAc,CAAC,IAAI,EAAE,CAAC;;wCADvC,cAAc,GAAG,SACsB;wCAC3C,kFAAkF;wCAClF,cAAc,GAAG,cAAc,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,WAAW,KAAK,eAAe,CAAC,IAAI,EAAtC,CAAsC,CAAC,CAAC;4DAEzE,MAAM;4CACf,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,mBAAmB;gDAC7B,CAAC,MAAM,CAAC,0BAA0B;gDAClC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAC;gDACtE,MAAM,CAAC,0BAA0B,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,0BAA0B,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gDACvF,MAAM,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;gDACjD,MAAM,CAAC,0BAA0B,GAAG,0BAA0B,CAAC;gDAC/D,OAAO,CAAC,IAAI,CAAC;oDACX,MAAM,EAAE,4DAA4D;oDACpE,OAAO,EAAK,MAAM,CAAC,IAAI,iBAAO,MAAM,CAAC,MAAM,UAAK,MAAM,CAAC,WAAW,MAAG;oDACrE,SAAS,EAAE,WAAC;wDACV,CAAC,CAAC,GAAG,CAAC,SAAS,qDAAO,MAAM,EAAG,CAAC;oDAClC,CAAC;iDACF,CAAC,CAAC;4CACL,CAAC;wCACH,CAAC;wCAfD,GAAG,CAAC,OAA+B,EAAd,iCAAc,EAAd,4BAAc,EAAd,IAAc;4CAAxB,MAAM;oDAAN,MAAM;yCAehB;;;;;8BA7CiD,EAAvB,mDAAuB;;;6BAAvB,sCAAuB;wBAAzC,cAAc;sDAAd,cAAc;;;;;wBAAI,IAAuB;;;;wBAiD9C,eAAsB,eAAe,GAAG;4BAC5C,EAAE,EAAE,oEAAU,EAAE;4BAChB,GAAG,EAAE,CAAC,aAAa,CAAC;4BACpB,IAAI,EAAE,eAAe,CAAC,IAAI;4BAC1B,IAAI,EAAE,eAAe,CAAC,IAAI;4BAC1B,WAAW,EAAE,KAAK;4BAClB,QAAQ,EAAE,EAAE,EAAE;yBACf,CAAC;wBACF,OAAO,CAAC,IAAI,CAAC;4BACX,MAAM,EAAE,WAAW;4BACnB,OAAO,EAAK,eAAe,CAAC,IAAI,UAAK,eAAe,CAAC,IAAI,MAAG;4BAC5D,SAAS,EAAE,WAAC,IAAI,QAAC,CAAC,GAAG,CAAC,UAAU,EAAE,YAAU,CAAC,EAA7B,CAA6B;yBAC9C,CAAC,CAAC;wBAEG,gBAAgB,GAAG,EAAE,CAAC;4CAEnB,CAAC;4BACR,IAAM,UAAU,GAAY;gCAC1B,EAAE,EAAE,oEAAU,EAAE;gCAChB,IAAI,EAAE,CAAC;gCACP,GAAG,EAAE,CAAC,aAAa,CAAC;gCACpB,QAAQ,EAAE,EAAE,EAAE;6BACf,CAAC;4BAEF,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,qCAAqC;4BAExE,OAAO,CAAC,IAAI,CAAC;gCACX,MAAM,EAAE,YAAY;gCACpB,OAAO,EAAE,CAAC;gCACV,SAAS,EAAE,WAAC;oCACV,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC;oCAC/B,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,YAAU,CAAC,EAAE,EAAE,WAAW,EAAE,UAAU,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;gCAC7E,CAAC;6BACF,CAAC,CAAC;wBACL,CAAC;wBAlBD,GAAG,CAAC,OAAmC,EAAzB,oBAAe,CAAC,SAAS,EAAzB,cAAyB,EAAzB,IAAyB;4BAA9B,CAAC;oCAAD,CAAC;yBAkBT;4CAEQ,CAAC;4BACR,IAAM,SAAS,GAAW;gCACxB,EAAE,EAAE,oEAAU,EAAE;gCAChB,WAAW,EAAE,YAAU,CAAC,IAAI;gCAC5B,IAAI,EAAE,CAAC,MAAM,GAAG,YAAU,CAAC,IAAI,CAAC;gCAChC,QAAQ,EAAE,EAAE,EAAE;gCACd,UAAU,EAAE,IAAI;gCAChB,GAAG,EAAE,CAAC,iBAAiB,CAAC;gCACxB,IAAI,EAAE,CAAC,CAAC,IAAI;gCACZ,IAAI,EAAE,CAAC,CAAC,IAAI;gCACZ,MAAM,EAAE,CAAC,CAAC,MAAM;gCAChB,OAAO,EAAE,EAAE;gCACX,SAAS,EAAE,YAAU,CAAC,EAAE;gCACxB,SAAS,EAAE,EAAE;gCACb,SAAS,EAAE,EAAE,IAAI,EAAE,wDAAG,CAAC,WAAW,CAAC,WAAW,EAAE,GAAG,EAAE,SAAS,GAAG,wDAAG,CAAC,WAAW,CAAC,IAAI,EAAE;gCACvF,WAAW,EAAE,IAAI,CAAC,GAAG,EAAE;gCACvB,0BAA0B,EAAE,EAAE;gCAC9B,mBAAmB,EAAE,EAAE;6BACxB,CAAC;4BAEF,OAAO,CAAC,IAAI,CAAC;gCACX,MAAM,EAAE,SAAS;gCACjB,OAAO,EAAE,CAAC,CAAC,IAAI;gCACf,SAAS,EAAE,WAAC;oCACV,CAAC,CAAC,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;oCAC5B,CAAC,CAAC,IAAI,CAAC,UAAU,EAAE,YAAU,CAAC,EAAE,EAAE,SAAS,EAAE,SAAS,CAAC,EAAE,EAAE,iBAAiB,CAAC,CAAC;gCAChF,CAAC;6BACF,CAAC,CAAC;oDAEM,IAAI;gCACX,8EAA8E;gCAC9E,IAAI,iBAAiB,GAAG,cAAc,CAAC,MAAM,CAAC,YAAE,IAAI,SAAE,CAAC,IAAI,KAAK,IAAI,EAAhB,CAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;gCACzE,EAAE,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC;oCACvB,iBAAiB,GAAG;wCAClB,EAAE,EAAE,oEAAU,EAAE;wCAChB,QAAQ,EAAE,EAAE,EAAE;wCACd,IAAI,EAAE,IAAI;wCACV,GAAG,EAAE,CAAC,aAAa,CAAC;qCACrB,CAAC;oCACF,cAAc,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;oCAEvC,OAAO,CAAC,IAAI,CAAC;wCACX,MAAM,EAAE,wBAAwB;wCAChC,OAAO,EAAE,IAAI;wCACb,SAAS,EAAE,WAAC;4CACV,CAAC,CAAC,GAAG,CAAC,iBAAiB,EAAE,iBAAiB,CAAC,CAAC;4CAC5C,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,EAAE,iBAAiB,EAAE,iBAAiB,CAAC,EAAE,EAAE,gBAAgB,CAAC,CAAC;wCAC7F,CAAC;qCACF,CAAC,CAAC;gCACL,CAAC;gCAAC,IAAI,CAAC,CAAC;oCAEN,OAAO,CAAC,IAAI,CAAC;wCACX,SAAS,EAAE,WAAC;4CACV,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,EAAE,iBAAiB,EAAE,iBAAiB,CAAC,EAAE,EAAE,gBAAgB,CAAC,CAAC;wCAC7F,CAAC;qCACF,CAAC,CAAC;gCACL,CAAC;gCACD,wEAAwE;gCACxE,SAAS,CAAC,mBAAmB,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;4BAC3D,CAAC;4BA9BD,GAAG,CAAC,CAAa,UAAgB,EAAhB,MAAC,CAAC,cAAc,EAAhB,cAAgB,EAAhB,IAAgB;gCAA5B,IAAI,IAAI;wCAAJ,IAAI;6BA8BZ;oDAEQ,EAAE;gCACT,IAAI,uBAAuB,GAAG,qBAAqB,CAAC,MAAM,CAAC,YAAE,IAAI,SAAE,CAAC,IAAI,KAAK,EAAE,CAAC,IAAI,IAAI,EAAE,CAAC,SAAS,KAAK,EAAE,CAAC,SAAS,EAApD,CAAoD,CAAC,CAAC,CAAC,CAAC,CAAC;gCAC1H,EAAE,CAAC,CAAC,CAAC,uBAAuB,CAAC,CAAC,CAAC;oCAC7B,uBAAuB,GAAG;wCACxB,EAAE,EAAE,oEAAU,EAAE;wCAChB,QAAQ,EAAE,EAAE,EAAE;wCACd,IAAI,EAAE,EAAE,CAAC,IAAI;wCACb,SAAS,EAAE,EAAE,CAAC,SAAS;wCACvB,GAAG,EAAE,CAAC,aAAa,CAAC;qCACrB,CAAC;oCAEF,qBAAqB,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;oCAEpD,OAAO,CAAC,IAAI,CAAC;wCACX,MAAM,EAAE,gCAAgC,GAAG,EAAE,CAAC,SAAS;wCACvD,OAAO,EAAE,EAAE,CAAC,IAAI;wCAChB,SAAS,EAAE,WAAC;4CACV,CAAC,CAAC,GAAG,CAAC,wBAAwB,EAAE,uBAAuB,CAAC,CAAC;4CACzD,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,EAAE,wBAAwB,EAAE,uBAAuB,CAAC,EAAE,EAAE,uBAAuB,CAAC,CAAC;wCACjH,CAAC;qCACF,CAAC,CAAC;gCACL,CAAC;gCAAC,IAAI,CAAC,CAAC;oCACN,OAAO,CAAC,IAAI,CAAC;wCACX,SAAS,EAAE,WAAC;4CACV,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,EAAE,wBAAwB,EAAE,uBAAuB,CAAC,EAAE,EAAE,uBAAuB,CAAC,CAAC;wCACjH,CAAC;qCACF,CAAC;gCACJ,CAAC;gCACD,8EAA8E;gCAC9E,SAAS,CAAC,0BAA0B,CAAC,IAAI,CAAC,uBAAuB,CAAC,EAAE,CAAC,CAAC;4BACxE,CAAC;4BA9BD,GAAG,CAAC,CAAW,UAAuB,EAAvB,MAAC,CAAC,qBAAqB,EAAvB,cAAuB,EAAvB,IAAuB;gCAAjC,IAAI,EAAE;wCAAF,EAAE;6BA8BV;oDAIU,CAAC;gCACV,OAAO,CAAC,IAAI,CAAC;oCACX,SAAS,EAAE,WAAC;wCACV,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,EAAE,WAAW,EAAE,CAAC,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;oCAClE,CAAC;iCACF,CAAC;4BACJ,CAAC;4BATD,yBAAyB;4BAEzB,4EAA4E;4BAC5E,GAAG,CAAC,CAAY,UAAgB,EAAhB,qCAAgB,EAAhB,8BAAgB,EAAhB,IAAgB;gCAA3B,IAAM,CAAC;wCAAD,CAAC;6BAMX;wBACH,CAAC;wBAtGD,GAAG,CAAC,OAAiC,EAAvB,oBAAe,CAAC,OAAO,EAAvB,cAAuB,EAAvB,IAAuB;4BAA5B,CAAC;oCAAD,CAAC;yBAsGT;;4BAEH,sBAAO,OAAO,EAAC;;;;KAChB;IAED,gCAAM,GAAN;QACE,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;IACxB,CAAC;IAEK,gCAAM,GAAZ;;;;;;wBACE,IAAI,CAAC,QAAQ,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;wBAChD,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAM,IAAI,aAAM,CAAC,SAAS,EAAhB,CAAgB,CAAC,CAAC;;;;wBAEtE,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,EAAE,CAAC,WAAC;gCAC7B,YAAY,CAAC,OAAO,CAAC,aAAG,IAAI,UAAG,CAAC,CAAC,CAAC,EAAN,CAAM,CAAC,CAAC;4BACtC,CAAC,CAAC;;wBAFF,SAEE,CAAC;;;wBAEH,IAAI,CAAC,QAAQ,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;;;wBAE1D,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;;;;;KAC7C;IAED,8BAAI,GAAJ,UAAK,IAAY;QACf,MAAM,CAAC,IAAI,CAAC,8BAA6B;IAC3C,CAAC;IAED,gCAAM,GAAN;QAAA,iBAsEC;QArEC,MAAM,CAAC;YAAK,gEAAK,sDAAC,mJAAgB,KAAM;YACrC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,4EAAiB,CAAC,CAAC;gBACzC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,+EAAoB,CAAC,CAAC;oBAC7C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;wBAC/B;4BACE,8FAA8B;4BAC9B,gEAAQ,OAAO,EAAE,cAAM,YAAI,CAAC,MAAM,EAAE,EAAb,CAAa,WAAe,CAC/C,CAAC,CAAC;wBACZ;4BACE;gCAAO;oCAAO;wCACd,4DAAI,OAAO,EAAE,CAAC,gDAA2C,CACtD;oCAAA;wCACD,+EAAgB;wCAChB,gFAAiB,CACd,CAAQ;gCAAA,mEACV,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAM,IAAI,aAAM,CAAC,MAAM,EAAb,CAAa,CAAC,CAAC,GAAG,CAAC,gBAAM,IAAI,mEAAI,GAAG,EAAE,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,OAAO;oCACvG,gEAAK,MAAM,CAAC,MAAM,CAAM;oCACxB,4DAAI,uBAAuB,EAAE,EAAE,MAAM,EAAE,MAAM,CAAC,OAAO,EAAE,GAAI,CACxD,EAH6D,CAG7D,CAAC,CACA,CAAQ;4BAClB,gEAAQ,OAAO,EAAE,cAAM,YAAI,CAAC,MAAM,EAAE,EAAb,CAAa,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,aAAiB;4BACvF,gEAAQ,OAAO,EAAE,cAAM,YAAI,CAAC,MAAM,EAAE,EAAb,CAAa,EAAE,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,gBAAoB;4BAC1F,+DAAM,CACA;YACR,gEACE,OAAO,EAAE,cAAM,YAAI,CAAC,QAAQ,CAAC,EAAE,YAAY,EAAE,CAAC,KAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC,EAAzD,CAAyD,IACvE,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC,CACxB,sDAAC,2IAAY,KAAC,CAAC,CACf,sDAAC,uLAAkC,KAC9B;YAIT,+DAAO,KAAK,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,EAAE;gBAAE;oBAAO;wBACvE,uEAEO;wBACP,gEACG,IAAI,CAAC,KAAK,CAAC,IAAI,CACb,CACF;oBAAA;wBACD,gFAEK;wBACL,gEACG,IAAI,CAAC,KAAK,CAAC,IAAI,CACb,CACF;oBAAA;wBACH,wEAEK;wBACL,4DAAI,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,WAAW,GAAG,IAAI,EAAvB,CAAuB,EAAE,uBAAuB,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,GAAI,CAC7G;oBAAA;wBACH,yEAEK;wBACL,gEACG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAM,IAAI,sEAAO,GAAG,EAAE,MAAM,CAAC,IAAI,EAAE,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,UAAE,IAAI,QAAE,EAAjD,CAAiD;4BAAE;gCACzH;oCAAI,+EAAqB;oCAAA,gEAAK,MAAM,CAAC,IAAI,CAAM,CAAK;gCACpD;oCAAI,0EAAgB;oCAAA,gEAAK,MAAM,CAAC,IAAI,CAAM,CAAK;gCAC/C;oCAAI,6EAAc;oCAAA,gEAAK,MAAM,CAAC,MAAM,CAAM,CAAK;gCAC/C;oCAAI,yFAA0B;oCAAA,4DAAI,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAnC,CAAmC,EAAE,uBAAuB,EAAE,EAAE,MAAM,EAAE,KAAI,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,EAAE,GAAI,CAAK;gCAClK;oCAAI,uFAA6B;oCAAA,4DAAI,SAAS,EAAC,cAAc,EAAC,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAzC,CAAyC,EAAE,uBAAuB,EAAE,EAAE,MAAM,EAAE,KAAI,CAAC,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,SAAS,KAAK,GAAG,EAAnB,CAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,GAAI,CAAK;gCACrP;oCAAI,uFAA6B;oCAAA,4DAAI,SAAS,EAAC,cAAc,EAAC,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAzC,CAAyC,EAAE,uBAAuB,EAAE,EAAE,MAAM,EAAE,KAAI,CAAC,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,SAAS,KAAK,GAAG,EAAnB,CAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,GAAI,CAAK;gCACrP;oCAAI,uFAA6B;oCAAA,4DAAI,SAAS,EAAC,cAAc,EAAC,GAAG,EAAE,cAAI,IAAI,YAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAzC,CAAyC,EAAE,uBAAuB,EAAE,EAAE,MAAM,EAAE,KAAI,CAAC,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,SAAS,KAAK,GAAG,EAAnB,CAAmB,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,GAAI,CAAK,CAC/O,CAAQ,EARkB,CAQlB,CAAC,CACd,CACF,CAAQ,CAAQ,CACnB;IACR,CAAC;IACH,sBAAC;AAAD,CAAC,CApYoC,+CAAe,GAoYnD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACha2B;AAGgC;AACnB;AAElB;AACiB;AAElC,8BAA+B,MAAM,EAAE,MAAM,EAAE,KAAa,EAAE,MAAmC,EAAE,KAAkB;IACzH,IAAM,UAAU,GAAG,EAAE,CAAC;IACtB,IAAM,KAAK,GAAG,MAAM,CAAC,EAAE,CAAC;4BACf,OAAO;QACd,IAAM,YAAY,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;QACrC,IAAM,OAAO,GAAe,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;QAClD,IAAM,OAAO,GAAe,MAAM,CAAC,OAAO,CAAC,CAAC;QAC5C,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC;8BAAU;QACvB,IAAM,MAAM,GAAG,OAAO;aACnB,GAAG,CAAC,UAAC,GAAG,EAAE,GAAG,IAAG,QAAC,EAAC,GAAG,OAAE,GAAG,OAAC,CAAC,EAAZ,CAAY,CAAC,CAAC,CAAC,8DAA8D;QAChG,IAAM,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,eAAK,IAAI,QAAC,OAAO,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,KAAK,CAAC,GAAG,CAAC,EAAE,EAArB,CAAqB,CAAC,EAAzC,CAAyC,CAAC,CAAC,CAAC,mBAAmB;QAEpG,GAAG,CAAC,CAAU,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAK;YAAd,IAAI,CAAC;YACR,IAAM,aAAa,sDAAO,CAAC,CAAC,GAAG,CAAC,CAAC;YACjC,IAAM,IAAI,GAAG,aAAa,CAAC,KAAK,CAAC;YACjC,OAAO,aAAa,CAAC,KAAK,CAAC,CAAC,0EAA0E;YACtG,EAAE,CAAC,CAAC,IAAI,KAAK,KAAK,CAAC,CAAC,CAAC;gBACnB,EAAE,CAAC,CAAC,CAAC,aAAa,CAAC,EAAE,CAAC;oBAAC,aAAa,CAAC,EAAE,GAAG,oEAAU,EAAE,CAAC,CAAC,+BAA+B;gBACvF,gDAAgD;gBAChD,KAAK,CAAC,GAAG,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC;YACzC,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC;gBAC7B,KAAK,CAAC,GAAG,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC;YACzC,CAAC;YACD,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,EAAE,YAAY,EAAE,aAAa,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;YAElE,2EAA2E;YAC3E,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;gBAAC,UAAU,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;YACnD,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,EAAC,IAAI,EAAE,aAAa,EAAC,CAAC;SACpD;QACD,IAAM,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,OAAO,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,EAAb,CAAa,CAAC,EAAjC,CAAiC,CAAC,CAAC;QACvE,GAAG,CAAC,CAAU,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAO;YAAhB,IAAI,CAAC;YACR,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;SACzD;QACD,IAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,eAAK,IAAI,cAAO,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,KAAK,CAAC,GAAG,CAAC,EAAE,IAAI,KAAK,CAAC,GAAG,CAAC,KAAK,KAAK,QAAQ,EAArD,CAAqD,CAAC,EAAxE,CAAwE,CAAC,CAAC;QACjH,GAAG,CAAC,CAAU,UAAO,EAAP,mBAAO,EAAP,qBAAO,EAAP,IAAO;YAAhB,IAAI,CAAC;YACR,IAAM,aAAa,sDAAO,CAAC,CAAC,GAAG,CAAC,CAAC;YACjC,OAAO,aAAa,CAAC,KAAK,CAAC;YAC3B,KAAK,CAAC,GAAG,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC;YAEvC,+FAA+F;YAC/F,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;gBAAC,UAAU,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;YACnD,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,EAAC,IAAI,EAAE,aAAa,EAAC,CAAC;SACpD;IACH,CAAC;IAxCD,GAAG,CAAC,CAAgB,UAAmB,EAAnB,WAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAnB,cAAmB,EAAnB,IAAmB;QAAlC,IAAI,OAAO;gBAAP,OAAO;KAwCf;IACD,MAAM,CAAC,0DAAM,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;AACpC,CAAC;AAEK,kBAAmB,QAAuC;IAC9D,MAAM,CAAC,6CAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;AACjD,CAAC;AAEK,yBAA0B,QAAuC;IACrE,MAAM,CAAC,6CAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAC3C,CAAC;AAEK,iCAAmC,GAAW,EAAE,GAAwB,EAAE,IAAU;IACxF,MAAM,CAAC,0DAAM,CAAC,GAAG,EAAE;QACjB,QAAQ,EAAE,EAAC,IAAI,EAAE,GAAG,EAAC;QACrB,YAAY,EAAE,EAAC,IAAI,EAAE,GAAG,EAAC;QACzB,UAAU,EAAE;YACV,IAAI,EAAE;gBACJ,IAAI,EAAE,IAAI,CAAC,WAAW;gBACtB,GAAG,EAAE,SAAS,GAAG,IAAI,CAAC,IAAI;aAC3B;SACF;KACF,CAAC,CAAC;AACL,CAAC;AAEK,6BAA+B,GAAW,EAAE,GAAwB,EAAE,IAAU;IACpF,MAAM,CAAC,0DAAM,CAAC,GAAG,EAAE;QACjB,WAAW,EAAE,EAAC,IAAI,EAAE,IAAI,CAAC,GAAG,EAAE,EAAC;QAC/B,SAAS,EAAE;YACT,IAAI,EAAE;gBACJ,IAAI,EAAE,IAAI,CAAC,WAAW;gBACtB,GAAG,EAAE,SAAS,GAAG,IAAI,CAAC,IAAI;aAC3B;SACF;KACF,CAAC,CAAC;AACL,CAAC;AAEK,6CAA8C,GAAwB,EAAE,IAAU;IACtF,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;IACvB,GAAG,GAAG,uBAAuB,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IAC9C,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC;QAAC,GAAG,GAAG,mBAAmB,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;IAC9D,MAAM,CAAC,GAAG,CAAC;AACb,CAAC;AAEK,oBAAqB,GAAa,EAAE,QAAgC,EAAE,MAAgB;IAC1F,IAAM,GAAG,sDAAO,GAAG,CAAC,CAAC;IACrB,IAAM,IAAI,GAAG,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;IAC9B,EAAE,CAAC,CAAC,IAAI,CAAC;QACP,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC;IACnB,GAAG,CAAC,CAAc,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM;QAAnB,IAAI,KAAK;QACZ,IAAM,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,WAAC,IAAI,iBAAU,CAAC,CAAC,EAAE,QAAQ,EAAE,EAAE,CAAC,EAA3B,CAA2B,CAAC,CAAC;QACjE,GAAG,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC;KACtB;IACD,MAAM,CAAC,GAAG,CAAC;AACb,CAAC;AAEK,kBAAmB,IAAU,EAAE,CAAuB;IAC1D,MAAM,CAAC,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;QACjC,IAAM,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;QAChC,MAAM,CAAC,MAAM,GAAG,YAAE,IAAI,cAAO,CAAE,EAAE,CAAC,MAAc,CAAC,MAAM,CAAC,EAAlC,CAAkC,CAAC;QACzD,MAAM,CAAC,OAAO,GAAG,YAAE,IAAI,aAAM,CAAC,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC,EAAtC,CAAsC,CAAC;QAC9D,MAAM,CAAC,OAAO,GAAG,YAAE,IAAI,aAAM,CAAE,EAAE,CAAC,MAAc,CAAC,KAAK,CAAC,EAAhC,CAAgC,CAAC;QACxD,CAAC,CAAC,MAAM,CAAC,CAAC;IACZ,CAAC,CAAC,CAAC;AACL,CAAC;AAEK,wBAA0B,IAAU;IACxC,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,WAAC,IAAE,QAAC,CAAC,UAAU,CAAC,IAAI,CAAC,EAAlB,CAAkB,CAAC,CAAC;AAC/C,CAAC;AAEK,2BAA6B,IAAU;IAC3C,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,WAAC,IAAE,QAAC,CAAC,aAAa,CAAC,IAAI,CAAC,EAArB,CAAqB,CAAC,CAAC;AAClD,CAAC;AAEK,mBAAoB,CAAkC;IAC1D,CAAC,CAAC,eAAe,EAAE,CAAC;IACpB,CAAC,CAAC,cAAc,EAAE,CAAC;IACnB,CAAC,CAAC,YAAY,CAAC,UAAU,GAAG,MAAM,CAAC;AACrC,CAAC;AAEK,mCAAoC,MAA0C;IAClF,IAAM,GAAG,GAAG,6CAAC,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,CAAC;IACvC,EAAE,CAAC,CAAC,GAAG,CAAC;QAAC,GAAG,CAAC,SAAS,GAAG,gBAAgB,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,UAAU,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;AAClF,CAAC;AAEK,oBAA2B,EAAU,EAAE,OAE1C;;;;;;oBAEK,MAAM,GAAG,wDAAG,CAAC,gBAAgB,CAAC;oBAC9B,oBAAoB,GAAG,OAAO,IAAI,OAAO,CAAC,oBAAoB,CAAC;oBACvB,qBAAM,OAAO,CAAC,GAAG,CAAC;4BAC9D,MAAM,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,EAAE;gCACxB,OAAO,EAAE;oCACP,gBAAgB;oCAChB,uBAAuB;oCACvB,WAAW;oCACX,QAAQ;oCACR,KAAK,CAAC,8BAA8B;iCACrC;6BACF,CAAC;4BACF,4EAA4E;4BAC5E,iBAAiB;4BACjB,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE;gCACnB,YAAY,EAAE,EAAE;gCAChB,OAAO,EAAE,CAAC,uBAAuB,EAAE,gBAAgB,EAAE,WAAW,EAAE,KAAK,CAAC;gCACxE,KAAK,EAAE,CAAC,gBAAgB,CAAC,CAAC,qDAAqD;6BAChF,CAAC;4BACF,oBAAoB,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE;gCAC7C,YAAY,EAAE,EAAE;gCAChB,KAAK,EAAE,CAAC,SAAS,CAAC;6BACnB,CAAC;yBACH,CAAC;;oBArBI,KAAuC,CAAC,SAqB5C,CAA+B,EArB1B,MAAM,UAAE,WAAW,UAAE,aAAa;oBAsBzC,MAAM,CAAC,KAAK,GAAG,WAAW,CAAC;oBAE3B,6CAA6C;oBAC7C,EAAE,CAAC,CAAC,MAAM,CAAC,0BAA0B,CAAC,CAAC,CAAC;wBACtC,MAAM,CAAC,qBAAqB,GAAG,MAAM,CAAC,0BAA0B,CAAC,GAAG,CAAC,YAAE;4BACrE,aAAM,CAAC,qBAAqB,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,EAAE,KAAK,EAAE,EAAX,CAAW,CAAC;wBAAnD,CAAmD,CAAC,CAAC;oBACzD,CAAC;oBAED,sCAAsC;oBACtC,EAAE,CAAC,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAAC,CAAC;wBAC/B,MAAM,CAAC,cAAc,GAAG,MAAM,CAAC,mBAAmB,CAAC,GAAG,CAAC,YAAE;4BACvD,aAAM,CAAC,cAAc,CAAC,IAAI,CAAC,YAAE,IAAI,SAAE,CAAC,EAAE,KAAK,EAAE,EAAZ,CAAY,CAAC;wBAA9C,CAA8C,CAAC,CAAC;oBACpD,CAAC;oBAED,uCAAuC;oBACvC,EAAE,CAAC,CAAC,oBAAoB,CAAC;wBAAC,MAAM,CAAC,aAAa,GAAG,aAAa,CAAC;oBAC/D,sBAAO,MAAM,EAAC;;;;CACf;;;;;;;;;;;;;;;;ACtLD;AAAA;AAAA;;EAEE;;AAE6B;AAgB/B;IAAkC,sEAA4B;IAC5D,sBAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,KAAK,GAAG;YACX,UAAU,EAAE,KAAK,CAAC,UAAU,IAAI,KAAK;SACtC,CAAC;;IACJ,CAAC;IAED,gDAAyB,GAAzB,UAA2B,SAAgB;QACzC,EAAE,CAAC,CAAC,SAAS,CAAC,UAAU,KAAK,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;YACnD,IAAI,CAAC,QAAQ,CAAC,EAAC,UAAU,EAAE,SAAS,CAAC,UAAU,EAAC,CAAC,CAAC;QACpD,CAAC;IACH,CAAC;IAED,6BAAM,GAAN;QAAA,iBAgBC;QAfO,mBAA8E,EAA5E,gBAAK,EAAE,wBAAS,EAAE,sBAAQ,EAAE,oCAAe,EAAE,sCAAgB,CAAgB;QAC7E,sCAAU,CAAgB;QAElC,MAAM,CAAC,6DAAK,SAAS,EAAE,CAAC,SAAS,IAAE,EAAE,CAAC,GAAG,YAAY,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;YACjF,6DAAK,SAAS,EAAE,YAAY,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,GAAG,GAAG,eAAe,CAAC,CAAC,CAAC,EAAE,CAAC,EAC3E,OAAO,EAAE;oBACP,EAAE,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,WAAW,CAAC;wBAAC,KAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,KAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;oBAC3E,KAAI,CAAC,QAAQ,CAAC,EAAE,UAAU,EAAE,CAAC,KAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC,CAAC;gBACxD,CAAC,IACA,KAAK,CACF;YACN,6DAAK,SAAS,EAAE,aAAa,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC,GAAG,GAAG,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,IAC7E,QAAQ,CACL,CACF,CAAC;IACT,CAAC;IACH,mBAAC;AAAD,CAAC,CA/BiC,+CAAe,GA+BhD;;;;;;;;;;;;;;;;;;;;;;ACnD8B;AAER;AAmBvB;;;EAGE;AACF;IAAoC,wEAA4B;IAI5D,wBAAY,KAAY;QAAxB,YACI,kBAAM,KAAK,CAAC,SAMf;QALG,KAAI,CAAC,KAAK,GAAG;YACT,QAAQ,EAAE,KAAK;YACf,YAAY,EAAE,IAAI;YAClB,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,EAAE;SACzB;;IACL,CAAC;IAED,kDAAyB,GAAzB,UAA0B,SAAS;QAC/B,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;YACrC,IAAI,CAAC,QAAQ,CAAC,EAAC,IAAI,EAAE,SAAS,CAAC,IAAI,IAAI,EAAE,EAAC,CAAC,CAAC;QAChD,CAAC;IACL,CAAC;IAED,+BAAM,GAAN;QAAA,iBA0CC;QAzCG,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,EAAE,CAAC;QACnC,MAAM,CAAC,6DACC,SAAS,EAAE,iBAAiB,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,EAClG,QAAQ,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,CAAC,EACnC,OAAO,EAAE,UAAC,CAAC,IAAI,KAAI,CAAC,MAAM,EAAE,GAAC,EAC7B,KAAK,EAAE,EAAC,KAAK,EAAE,MAAM,EAAC;YAE1B,6DACI,GAAG,EAAE,eAAK,IAAI,YAAI,CAAC,KAAK,GAAG,KAAK,EAAlB,CAAkB,EAChC,KAAK,EAAE;oBACH,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;iBAC7C,IAEA,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,kBAAkB,CACpC;YACL,IAAI,CAAC,KAAK,CAAC,GAAG,KAAK,UAAU,CAAC,CAAC;gBAC5B,kEAAU,GAAG,EAAE,eAAK,IAAI,YAAI,CAAC,KAAK,GAAG,KAAK,EAAlB,CAAkB,EACtC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,EAC9B,KAAK,qDAAM,IAAI,CAAC,KAAK,CAAC,YAAY,IAAE,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,KAC9E,OAAO,EAAE,YAAE,IAAE,oDAAC,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAArB,CAAqB,EAClC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAC9B,KAAK,EAAE,IAAI,EACX,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EACpC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAClC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,CAAC,EAClC,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,GACrC,CAAC,CAAC;gBACJ,+DAAO,GAAG,EAAE,eAAK,IAAI,YAAI,CAAC,KAAK,GAAG,KAAK,EAAlB,CAAkB,EACnC,IAAI,EAAC,MAAM,EACX,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,EAC9B,KAAK,qDAAM,IAAI,CAAC,KAAK,CAAC,YAAY,IAAE,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,KAC9E,OAAO,EAAE,YAAE,IAAE,oDAAC,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAArB,CAAqB,EAClC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAC9B,KAAK,EAAE,IAAI,EACX,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EACpC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAClC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAC7C,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,GACrC,CAEJ;IACV,CAAC;IAED,kCAAS,GAAT,UAAU,CAAgB;QACtB,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC,CAAC,CAAC;YACnB,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,EAAE,CAAC;YACzC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YAClB,CAAC,CAAC,eAAe,EAAE,CAAC;QACxB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC,CAAC,CAAC;YAC1B,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YACzC,IAAI,CAAC,QAAQ,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;QAC/D,CAAC;IACL,CAAC;IAED,+BAAM,GAAN,UAAO,CAAQ;QACX,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACzC,IAAI,CAAC,QAAQ,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;IAC/D,CAAC;IAID,0CAAiB,GAAjB,UAAkB,QAAQ;QACtB,EAAE,CAAC,CAAC,IAAI,CAAC,kBAAkB,IAAI,QAAQ,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,kBAAkB,GAAG,QAAQ,CAAC;YACnC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAClC,CAAC;IACL,CAAC;IAED,iCAAQ,GAAR,UAAS,CAAQ;QACb,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;QAC1C,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;YAAC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IACnE,CAAC;IAED,+BAAM,GAAN,UAAO,GAAY;QAAnB,iBA6BC;QA5BG,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;YAAC,MAAM,CAAC;QACvD,GAAG,GAAG,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,EAAE,CAAC;QACnC,IAAM,KAAK,GAAG,6CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC5B,IAAI,CAAC,QAAQ,CAAC;YACV,IAAI,EAAE,GAAG;YACT,QAAQ,EAAE,IAAI;YACd,YAAY,EAAE;gBACV,SAAS,EAAE,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC;gBACjC,QAAQ,EAAE,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC;gBAChC,UAAU,EAAE,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;gBACnC,aAAa,EAAE,KAAK,CAAC,GAAG,CAAC,eAAe,CAAC;gBACzC,WAAW,EAAE,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC;gBACrC,YAAY,EAAE,KAAK,CAAC,GAAG,CAAC,cAAc,CAAC;gBACvC,SAAS,EAAE,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC;gBACjC,YAAY,EAAE,KAAK,CAAC,GAAG,CAAC,cAAc,CAAC;gBACvC,UAAU,EAAE,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;gBACnC,WAAW,EAAE,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC;gBACrC,YAAY,EAAE,KAAK,CAAC,GAAG,CAAC,cAAc,CAAC;gBACvC,eAAe,EAAE,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAC;gBAC7C,UAAU,EAAE,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;gBACnC,UAAU,EAAE,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC;gBACnC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,MAAM;gBACnB,MAAM,EAAE,MAAM;gBACd,KAAK,EAAE,MAAM;gBACb,SAAS,EAAE,YAAY;aAC1B;SACJ,EAAE,cAAI,oDAAC,CAAC,KAAI,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,EAArB,CAAqB,CAAC,CAAC;IAClC,CAAC;IACL,qBAAC;AAAD,CAAC,CA3HmC,+CAAe,GA2HlD;;;;;;;;;;;;;;;;ACpJyB;AAE1B,+DAAe;IACb,IAAI,EAAE;QACJ,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,SAAS;QAChB,MAAM,EAAE,cAAM,4DAAI,CAAC,MAAM,CAAC,EAAZ,CAAY;KAC3B;IACD,MAAM,EAAE;QACN,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,QAAQ;QACf,MAAM,EAAE,cAAM,4DAAI,CAAC,QAAQ,CAAC,EAAd,CAAc;KAC7B;IACD,SAAS,EAAE;QACT,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,cAAc;QACrB,MAAM,EAAE,cAAM,4DAAI,CAAC,WAAW,CAAC,EAAjB,CAAiB;KAChC;IACD,aAAa,EAAE;QACb,IAAI,EAAE,oBAAoB;QAC1B,KAAK,EAAE,SAAS;QAChB,MAAM,EAAE,cAAM,4DAAI,CAAC,eAAe,CAAC,EAArB,CAAqB;KACpC;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,sBAAsB;QAC5B,KAAK,EAAE,UAAU;QACjB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,MAAM,CAAC,EAA3B,CAA2B;KAC1C;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,sBAAsB;QAC5B,KAAK,EAAE,UAAU;QACjB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,MAAM,CAAC,EAA3B,CAA2B;KAC1C;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,sBAAsB;QAC5B,KAAK,EAAE,UAAU;QACjB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,MAAM,CAAC,EAA3B,CAA2B;KAC1C;IACD,SAAS,EAAE;QACT,IAAI,EAAE,QAAQ;QACd,KAAK,EAAE,UAAU;QACjB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,KAAK,CAAC,EAA1B,CAA0B;KACzC;IACD,KAAK,EAAE;QACL,IAAI,EAAE,iBAAiB;QACvB,KAAK,EAAE,OAAO;QACd,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,cAAc,CAAC,EAAnC,CAAmC;KAClD;IACD,KAAK,EAAE;QACL,IAAI,EAAE,kDAAkD;QACxD,KAAK,EAAE,cAAc;QACrB,MAAM,EAAE,cAAM,4DAAI,CAAC,mBAAmB,CAAC,EAAzB,CAAyB;KACxC;IACD,KAAK,EAAE;QACL,IAAI,EAAE,+CAA+C;QACrD,KAAK,EAAE,YAAY;QACnB,MAAM,EAAE,cAAM,4DAAI,CAAC,qBAAqB,CAAC,EAA3B,CAA2B;KAC1C;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,WAAW;QACjB,KAAK,EAAE,YAAY;QACnB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,OAAO,CAAC,EAA5B,CAA4B;KAC3C;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,SAAS;QACf,KAAK,EAAE,cAAc;QACrB,MAAM,EAAE,cAAM,4DAAI,CAAC,sBAAsB,CAAC,EAA5B,CAA4B;KAC3C;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,+CAA+C;QACrD,KAAK,EAAE,aAAa;QACpB,MAAM,EAAE;YACN,IAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC;YAC7C,EAAE,CAAC,CAAC,GAAG,CAAC;gBAAC,qDAAI,CAAC,YAAY,EAAE,GAAG,CAAC;QAClC,CAAC;KACF;IACD,KAAK,EAAE;QACL,IAAI,EAAE,oDAAoD;QAC1D,KAAK,EAAE,aAAa;QACpB,MAAM,EAAE,UAAC,EAAE,EAAE,SAAS;YACpB,IAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC;YAC7C,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;gBACR,2BAA2B;gBAC3B,IAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBAC1C,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;gBACd,GAAG,CAAC,QAAQ,GAAG,CAAC,CAAC;gBACjB,aAAa,CAAC,GAAG,CAAC,CAAC;gBACnB,GAAG,CAAC,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC;gBAChC,GAAG,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC;gBAC9B,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;YAC3D,CAAC;QACH,CAAC;KACF;CACF;AAED,uBAAuB,OAAoB;IACvC,IAAI,GAAG,EAAE,KAAK,CAAC;IACf,EAAE,CAAC,CAAC,MAAM,CAAC,YAAY,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,YAAY,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;QAClE,KAAK,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAC1B,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACrB,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAC1B,qDAAqD;QACrD,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAC7B,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACrB,GAAG,CAAC,eAAe,EAAE,CAAC;QACtB,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACxB,CAAC;AACL,CAAC;;;;;;;;;;;;;;;AC3GyB;AAE1B,+DAAe;IACb,IAAI,EAAE;QACJ,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,MAAM;QACb,MAAM,EAAE,cAAM,4DAAI,CAAC,MAAM,CAAC,EAAZ,CAAY;KAC3B;IACD,MAAM,EAAE;QACN,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,QAAQ;QACf,MAAM,EAAE,cAAM,4DAAI,CAAC,QAAQ,CAAC,EAAd,CAAc;KAC7B;IACD,SAAS,EAAE;QACT,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE,WAAW;QAClB,MAAM,EAAE,cAAM,4DAAI,CAAC,WAAW,CAAC,EAAjB,CAAiB;KAChC;IACD,aAAa,EAAE;QACb,IAAI,EAAE,oBAAoB;QAC1B,KAAK,EAAE,gBAAgB;QACvB,MAAM,EAAE,cAAM,4DAAI,CAAC,eAAe,CAAC,EAArB,CAAqB;KACpC;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,sBAAsB;QAC5B,KAAK,EAAE,WAAW;QAClB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,MAAM,CAAC,EAA3B,CAA2B;KAC1C;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,sBAAsB;QAC5B,KAAK,EAAE,WAAW;QAClB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,MAAM,CAAC,EAA3B,CAA2B;KAC1C;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,sBAAsB;QAC5B,KAAK,EAAE,WAAW;QAClB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,MAAM,CAAC,EAA3B,CAA2B;KAC1C;IACD,SAAS,EAAE;QACT,IAAI,EAAE,QAAQ;QACd,KAAK,EAAE,WAAW;QAClB,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,KAAK,CAAC,EAA1B,CAA0B;KACzC;IACD,KAAK,EAAE;QACL,IAAI,EAAE,iBAAiB;QACvB,KAAK,EAAE,OAAO;QACd,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,cAAc,CAAC,EAAnC,CAAmC;KAClD;IACD,KAAK,EAAE;QACL,IAAI,EAAE,OAAO;QACb,KAAK,EAAE,cAAc;QACrB,MAAM,EAAE,cAAM,4DAAI,CAAC,mBAAmB,CAAC,EAAzB,CAAyB;KACxC;IACD,KAAK,EAAE;QACL,IAAI,EAAE,SAAS;QACf,KAAK,EAAE,gBAAgB;QACvB,MAAM,EAAE,cAAM,4DAAI,CAAC,qBAAqB,CAAC,EAA3B,CAA2B;KAC1C;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,WAAW;QACjB,KAAK,EAAE,MAAM;QACb,MAAM,EAAE,cAAM,4DAAI,CAAC,aAAa,EAAE,OAAO,CAAC,EAA5B,CAA4B;KAC3C;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,SAAS;QACf,KAAK,EAAE,iBAAiB;QACxB,MAAM,EAAE,cAAM,4DAAI,CAAC,sBAAsB,CAAC,EAA5B,CAA4B;KAC3C;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,WAAW;QACjB,KAAK,EAAE,MAAM;QACb,MAAM,EAAE;YACN,IAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,oBAAoB,CAAC;YAC/C,EAAE,CAAC,CAAC,GAAG,CAAC;gBAAC,qDAAI,CAAC,YAAY,EAAE,GAAG,CAAC;QAClC,CAAC;KACF;IACD,KAAK,EAAE;QACL,IAAI,EAAE,WAAW;QACjB,KAAK,EAAE,OAAO;QACd,MAAM,EAAE;YACN,IAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC;YAChD,EAAE,CAAC,CAAC,GAAG,CAAC;gBAAC,qDAAI,CAAC,aAAa,EAAE,GAAG,CAAC;QACnC,CAAC;KACF;CACF;;;;;;;;;;;;;;ACpFD,+DAAe,UAAC,OAAO,EAAE,KAAY;IAAZ,oCAAY;IACnC,QAAQ,CAAC,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE,KAAK,CAAC;AAC7C,CAAC;;;;;;;;;;;;;;;ACFa,0BAA2B,EAAE;IACzC,MAAM,CAAC,CAAC;YACN,IAAI,EAAE,YAAY;YAClB,IAAI,EAAE,0SAKC;YACP,KAAK,EAAE,kCAAkC;YACzC,MAAM,EAAE,cAAM,SAAE,CAAC,YAAY,CAAC,EAAhB,CAAgB;SAC/B,EAAE;YACD,IAAI,EAAE,aAAa;YACnB,IAAI,EAAE,2SAKC;YACP,KAAK,EAAE,gCAAgC;YACvC,MAAM,EAAE,cAAM,SAAE,CAAC,aAAa,CAAC,EAAjB,CAAiB;SAChC,EAAE;YACD,IAAI,EAAE,SAAS;YACf,IAAI,EAAE,8XAMC;YACP,KAAK,EAAE,4BAA4B;YACnC,MAAM,EAAE,cAAM,SAAE,CAAC,SAAS,CAAC,EAAb,CAAa;SAC5B,CAAC,CAAC;AACL,CAAC;;;;;;;;;;;;;;;;;;;;;;ACjC8B;AAEM;AACe;AACpB;AAsBhC,IAAM,OAAO,GAAG;IACd,SAAS,EAAE,mBAAmB;IAC9B,MAAM,EAAE,gBAAgB;IACxB,OAAO,EAAE,iBAAiB;IAC1B,SAAS,EAAE,mBAAmB;IAC9B,UAAU,EAAE,oBAAoB;IAChC,eAAe,EAAE,0BAA0B;CAC5C;AAED;IAA6B,iEAA4B;IAOvD,iBAAa,KAAY;QAAzB,YACE,kBAAM,KAAK,CAAC,SAOb;QANC,KAAI,CAAC,KAAK,GAAG,EAAC,SAAS,EAAE,IAAI,EAAC,CAAC;QAC/B,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACvC,KAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACrC,KAAI,CAAC,WAAW,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC/C,KAAI,CAAC,WAAW,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC/C,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;;IAC7C,CAAC;IAED,mCAAiB,GAAjB;QAAA,iBAUC;QATC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,cAAI,IAAI,OAAC,IAA+C,EAAhD,CAAgD,CAAC;aAClH,OAAO,CAAC,cAAI;YACX,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;YAClB,IAAI,CAAC,OAAO,GAAG,KAAI,CAAC,OAAO,CAAC;YAC5B,IAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAa,CAAC;QACnC,CAAC,CAAC,CAAC;QACH,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACzD,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QACzD,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;IACvD,CAAC;IAED,oCAAkB,GAAlB;QAAA,iBAOC;QANC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,cAAI,IAAI,OAAC,IAA+C,EAAhD,CAAgD,CAAC;aAClH,OAAO,CAAC,cAAI;YACX,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;YAClB,IAAI,CAAC,OAAO,GAAG,KAAI,CAAC,OAAO,CAAC;YAC5B,IAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAa,CAAC;QACnC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,sCAAoB,GAApB;QACE,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAC5D,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAC5D,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;IAC1D,CAAC;IAED,uCAAqB,GAArB,UAAsB,SAAgB,EAAE,SAAgB;QACtD,yCAAyC;QACzC,uCAAuC;QACvC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU;YACrB,SAAS,IAAI,IAAI,CAAC,KAAK;YACvB,SAAS,CAAC,QAAQ,KAAK,IAAI,CAAC,KAAK,CAAC,QAAQ;YAC1C,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC;IACjD,CAAC;IAED,iCAAe,GAAf,UAAgB,IAAY;QAC1B,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,2DAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;IAC7D,CAAC;IAED,yBAAO,GAAP,UAAQ,EAAc;QACpB,IAAM,IAAI,GAAG,EAAE,CAAC,MAAqB,CAAC;QACtC,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;YAAC,MAAM,CAAC;QACnC,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,KAAK,KAAK,IAAI,IAAI,CAAC,OAAO,KAAK,GAAG,CAAC;YAAC,MAAM,CAAC;QAC3D,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;QACpD,IAAM,QAAQ,GAAG;YACf,SAAS,EAAE,uBAAuB,CAAC,aAAa,EAAE,IAAI,CAAC;SACxD;QACD,MAAM,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YACrB,KAAK,GAAG,CAAC;YACT,KAAK,KAAK,CAAC;YAEX,SAAS,KAAK,CAAC;QACjB,CAAC;QACD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACxB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;IACxB,CAAC;IAED,wBAAM,GAAN,UAAO,EAAoC;QACzC;;;;;;;WAOG;QACH,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,MAAM,KAAK,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC,aAAa,KAAK,IAAI,CAAC,YAAY,CAAC;YAC1E,EAAE,CAAC,MAAM,KAAK,IAAI,CAAC,YAAY,CAAC,CAClC,CAAC;YACC,IAAI,CAAC,QAAQ,CAAC,EAAC,SAAS,EAAE,IAAI,EAAC,CAAC,CAAC;QACnC,CAAC;IACH,CAAC;IAED,+BAAa,GAAb,UAAc,IAAiB;QAC5B,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;IACrB,CAAC;IAED,6BAAW,GAAX,UAAY,EAAE;QACZ,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC5E,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;YACtC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;YACrB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,OAAO,CAAC;QACjC,CAAC;IACH,CAAC;IAED,6BAAW,GAAX,UAAY,EAAc;QACxB,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YAC1D,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,0EAA0E;YAC1E,8CAA8C;YAC9C,mDAAmD;YACnD,gFAAgF;YAChF,8DAA8D;YAC9D,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,EAAE,CAAC;YAC5D,EAAE,CAAC,CAAC,SAAS,CAAC,KAAK,GAAG,EAAE,CAAC;gBAAC,MAAM,CAAC;YACjC,uCAAuC;YACvC,yCAAyC;YACzC,gGAAgG;YAChG,IAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;gBACvD,SAAS,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;gBACpD,gCAAgC;gBAChC,SAAS,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;YACtD,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,OAAO,CAAC;YAC7B,8BAA8B;YAChC,IAAM,MAAM,GAAG,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC;YAC1C,IAAM,SAAS,GAAG,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC;YAC5C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,QAAQ,GAAG,IAAI,CAAC;YAC7C,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,SAAS,GAAG,IAAI,CAAC;YAC/C,IAAI,CAAC,QAAQ,CAAC;gBACZ,SAAS,EAAE,uBAAuB,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,IAAI,CAAC,SAAS,CAAC;aAClF,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAED,2BAAS,GAAT,UAAU,EAAE;QACV,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YAC1D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QAClD,CAAC;IACH,CAAC;IAED,+BAAa,GAAb,UAAc,EAAE;QACd,GAAG,CAAC,CAAoB,UAAsC,EAAtC,MAAC,EAAE,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAtC,cAAsC,EAAtC,IAAsC;YAAzD,IAAM,SAAS;YAClB,MAAM,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;gBAClB,KAAK,MAAM;oBACT,MAAM,CAAC,IAAI,CAAC;gBACd,KAAK,MAAM;oBACT,MAAM,CAAC,MAAM,CAAC;gBAChB,KAAK,MAAM;oBACT,MAAM,CAAC,IAAI,CAAC;gBACd,KAAK,MAAM;oBACT,MAAM,CAAC,IAAI,CAAC;YAChB,CAAC;SACF;QACD,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED,qCAAmB,GAAnB,UAAqB,GAAW;QAC9B,mBAAmB;QACnB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;YAAC,MAAM,CAAC;QAC5B,0BAA0B;QAC1B,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACZ,KAAK,YAAY;gBACf,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;gBACvC,KAAK,CAAC;YACR,KAAK,aAAa;gBAChB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,OAAO,CAAC;gBACxC,KAAK,CAAC;YACR,KAAK,SAAS;gBACZ,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,EAAE,CAAC;gBACnC,KAAK,CAAC;QACV,CAAC;QACD,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QAChD,IAAI,CAAC,QAAQ,CAAC,EAAC,SAAS,EAAE,uBAAuB,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,IAAI,CAAC,SAAS,CAAC,EAAC,CAAC,CAAC;IACrG,CAAC;IAED,wBAAM,GAAN;QAAA,iBAqEC;QApEC,IAAM,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,IAAI,gDAAO,CAAC;QAC5D,IAAI,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAM;YACnE,cAAO,MAAM,KAAK,QAAQ,CAAC,CAAC;gBAC1B,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC;gBACxB,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,oDACtB,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,EAAK,MAAM,EAAG,CAAC;oBAC/C,MAAM;QAJV,CAIU,CAAC;YACb,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,GAAG,CAAC,gBAAM,IAAI,qBAAc,CAAC,MAAM,CAAC,EAAtB,CAAsB,CAAC,CAAC;QAEpE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;YACzB,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,mEAAgB,CAAC,aAAG,IAAI,YAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,EAA7B,CAA6B,CAAC,CAAC,CAAC;QAC7F,CAAC;QAEM,oCAAS,CAAe;QACxB,kCAAQ,CAAe;QAE9B,MAAM,CAAC,6DAAK,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS;YACxC,CAAC,QAAQ,IAAI,6DAAK,SAAS,EAAE,OAAO,CAAC,SAAS,IAC5C,YAAY,CAAC,GAAG,CAAC,UAAC,MAAM,EAAE,GAAG;gBAC5B,uEAAQ,GAAG,EAAE,GAAG,EAAE,SAAS,EAAE,OAAO,CAAC,MAAM,EACzC,uBAAuB,EAAE,EAAC,MAAM,EAAE,MAAM,CAAC,IAAI,EAAC,EAC9C,KAAK,EAAE,MAAM,CAAC,KAAK,EACnB,WAAW,EAAE,YAAE,IAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,KAAI,CAAC,GAAC,EAC1C,SAAS,EAAE,YAAE,IAAE,iBAAU,CAAC,cAAI,YAAI,CAAC,UAAU,CAAC,KAAK,EAAE,EAAvB,CAAuB,EAAE,EAAE,CAAC,EAA3C,CAA2C,GAC1D;YALF,CAKE,CAAC,CACD;YACN,6DAAK,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,EAAE,KAAK,EAAE,EAAC,QAAQ,EAAE,UAAU,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAC;gBAClH,6DAAK,SAAS,EAAC,QAAQ,EACrB,GAAG,EAAE,aAAG,IAAI,YAAI,CAAC,UAAU,GAAG,GAAG,EAArB,CAAqB,EACjC,uBAAuB,EAAE,EAAC,MAAM,EAAE,2DAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAC,EAC5D,eAAe,EAAE,CAAC,QAAQ,EAC1B,OAAO,EAAE,YAAE,IAAI,YAAI,CAAC,eAAe,CAAE,EAAE,CAAC,MAAc,CAAC,SAAS,CAAC,EAAlD,CAAkD,EACjE,SAAS,EAAE,YAAE;wBACX,EAAE,CAAC,CAAC,QAAQ,CAAC;4BAAC,MAAM,CAAC;wBACrB,kCAAkC;wBAClC,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,IAAI,EAAE,IAAI,EAAE,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,CAAC;4BACrC,EAAE,CAAC,eAAe,EAAE,CAAC,CAAC,uCAAuC;wBAC/D,CAAC;wBACD,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,KAAK,CAAC,CAAC;4BAAC,EAAE,CAAC,cAAc,EAAE,CAAC;wBACxC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,OAAO,KAAK,EAAE,CAAC,IAAI,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;4BACtF,EAAE,CAAC,CAAC,KAAI,CAAC,SAAS,IAAI,KAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC,CAAC;gCACnD,KAAI,CAAC,SAAS,CAAC,aAAa,CAAC,WAAW,CAAC,KAAI,CAAC,SAAS,CAAC,CAAC;4BAC3D,CAAC;4BACD,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC;4BACtB,KAAI,CAAC,QAAQ,CAAC,EAAC,SAAS,EAAE,IAAI,EAAC,CAAC,CAAC;4BACjC,KAAI,CAAC,eAAe,CAAC,KAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;wBAClD,CAAC;oBACH,CAAC,GACD;gBACD,SAAS,IAAI,6DACZ,GAAG,EAAE,aAAG,IAAI,YAAI,CAAC,YAAY,GAAG,GAAG,EAAvB,CAAuB,EACnC,SAAS,EAAE,OAAO,CAAC,SAAS,EAC5B,MAAM,EAAE,IAAI,CAAC,MAAM,EACnB,QAAQ,EAAE,CAAC,EACX,KAAK,EAAE;wBACL,OAAO,EAAE,CAAC;wBACV,QAAQ,EAAE,UAAU;wBACpB,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG;wBAC7B,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI;wBAC/B,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK;wBACjC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM;qBAAC;oBACtC,6DAAK,SAAS,EAAE,OAAO,CAAC,UAAU,GAAG,OAAO,EAAE,KAAK,EAAE,EAAC,QAAQ,EAAC,UAAU,EAAE,GAAG,EAAC,CAAC,EAAE,IAAI,EAAC,CAAC,EAAC,GAAI;oBAC7F,6DAAK,SAAS,EAAE,OAAO,CAAC,UAAU,GAAG,OAAO,EAAE,KAAK,EAAE,EAAC,QAAQ,EAAC,UAAU,EAAE,GAAG,EAAC,CAAC,EAAE,KAAK,EAAC,CAAC,EAAC,GAAI;oBAC9F,6DAAK,SAAS,EAAE,OAAO,CAAC,UAAU,GAAG,OAAO,EAAE,KAAK,EAAE,EAAC,QAAQ,EAAC,UAAU,EAAE,MAAM,EAAC,CAAC,EAAE,KAAK,EAAC,CAAC,EAAC,GAAI;oBACjG,6DAAK,SAAS,EAAE,OAAO,CAAC,UAAU,GAAG,OAAO,EAAE,KAAK,EAAE,EAAC,QAAQ,EAAC,UAAU,EAAE,MAAM,EAAC,CAAC,EAAE,IAAI,EAAC,CAAC,EAAC,GAAI,CAC5F,CACF,CACF;IACR,CAAC;IACH,cAAC;AAAD,CAAC,CApP4B,+CAAe,GAoP3C;;AAED,iCAAkC,MAAmB,EAAE,KAAkB;IACvE,IAAM,UAAU,GAAG,MAAM,CAAC,qBAAqB,EAAE,CAAC;IAClD,IAAM,SAAS,GAAG,KAAK,CAAC,qBAAqB,EAAE,CAAC;IAChD,MAAM,CAAC;QACL,GAAG,EAAE,SAAS,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,GAAG,MAAM,CAAC,SAAS;QACtD,IAAI,EAAE,SAAS,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC,UAAU;QAC1D,MAAM,EAAE,SAAS,CAAC,MAAM,GAAG,UAAU,CAAC,GAAG,GAAG,MAAM,CAAC,SAAS;QAC5D,KAAK,EAAE,SAAS,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC,UAAU;QAC5D,KAAK,EAAE,SAAS,CAAC,KAAK;QACtB,MAAM,EAAE,SAAS,CAAC,MAAM;KACzB,CAAC;AACJ,CAAC;;;;;;;;;;;;;;AClSD;AAAA,IAAM,MAAM,GAAG,IAAI,SAAS,EAAE,CAAC;AAI/B;;GAEG;AACH,IAAM,gBAAgB,GAAe;IACnC,CAAC,EAAE,EAAE;IACL,CAAC,EAAE,EAAE;IACL,CAAC,EAAE,EAAE;IACL,CAAC,EAAE,EAAE;IACL,MAAM,EAAE,EAAE;IACV,GAAG,EAAE,EAAE;IACP,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,GAAG,EAAE,EAAC,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAC;IAC1D,CAAC,EAAE,EAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAC;IAC7B,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAE;IACN,GAAG,EAAE,EAAE;IACP,IAAI,EAAE,EAAE;IACR,cAAc;IACd,KAAK,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;IACrB,KAAK,EAAE,EAAE;IACT,KAAK,EAAE,EAAE;IACT,KAAK,EAAE,EAAE;IACT,EAAE,EAAE,EAAE;IACN,EAAE,EAAE,EAAC,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAC;IACjD,EAAE,EAAE,EAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAC;CACzF,CAAC;AAEI,kBAAoB,IAAY;IACpC,IAAM,GAAG,GAAG,MAAM,CAAC,eAAe,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;IAC/C,oCAAU,CAAa;IAC9B,IAAI,QAAQ,GAAG,KAAK,CAAC;IACrB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;QACvC,EAAE,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACjC,QAAQ,GAAG,IAAI,CAAC;QAClB,CAAC;IACH,CAAC;IACD,MAAM,CAAC,QAAQ,CAAC,CAAC;QACf,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACpB,IAAI,CAAC,CAAC,0FAA0F;IAC1F,yFAAyF;AACnG,CAAC;AAED,kBAAkB,IAAkC;IAClD,IAAI,QAAQ,GAAG,KAAK,CAAC;IACrB,EAAE,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACpB,EAAE,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACtB,QAAQ,GAAG,IAAI,CAAC;QAClB,CAAC;IACH,CAAC;IACD,EAAE,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACzB,QAAQ,GAAG,IAAI,CAAC;IAClB,CAAC;IACD,MAAM,CAAC,QAAQ,CAAC;AAClB,CAAC;AAED,wBAAwB,IAAU;IAChC,IAAI,QAAQ,GAAG,KAAK,CAAC;IACd,gCAAU,CAAS;IAC1B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;QACvC,EAAE,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACjC,QAAQ,GAAG,IAAI,CAAC;QAClB,CAAC;IACH,CAAC;IACD,MAAM,CAAC,QAAQ,CAAC;AAClB,CAAC;AAED;;GAEG;AACH,6BAA6B,OAAgB;IACpC,mCAAU,CAAY;IAC7B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;QACvC,OAAO,CAAC,UAAU,CAAC,YAAY,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;IAC/D,CAAC;IACD,OAAO,CAAC,MAAM,EAAE,CAAC;AACnB,CAAC;AAED,qBAAqB,OAAgB;IACnC,IAAM,MAAM,GAAG,OAAO,CAAC,OAAO,IAAI,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC;IAClF,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;QACZ,OAAO,CAAC,IAAI,CAAC,0BAA0B,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;QAC1D,cAAc,CAAC,OAAO,CAAC,CAAC;QACxB,mBAAmB,CAAC,OAAO,CAAC,CAAC;QAC7B,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IACD,IAAI,QAAQ,GAAG,KAAK,CAAC;IACrB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,OAAO,CAAC,UAAU,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;QAC/C,IAAM,IAAI,GAAG,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACxC,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;QAC/D,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACb,QAAQ,GAAG,IAAI,CAAC;YAChB,OAAO,CAAC,IAAI,CAAC,gCAAgC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;YAC1D,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrC,CAAC;IACH,CAAC;IACD,MAAM,CAAC,QAAQ,CAAC;AAClB,CAAC;AAED,mBAAmB,IAAU;IAC3B,MAAM,CAAC,CAAC,CAAE,IAAgB,CAAC,OAAO,CAAC;AACrC,CAAC;;;;;;;;;;;;;;;AClDD;AAAA;IAAA;IAWA,CAAC;IAAD,aAAC;AAAD,CAAC;;AAqBM,IAAM,eAAe,GAAG;IAC3B,eAAe;IACf,WAAW;IACX,eAAe;IACf,qBAAqB;IACrB,gBAAgB;IAChB,eAAe;CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;ACrG8B;AACnD,IAAM,aAAa,GAAG,wDAAG,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,4CAA4C;AAC7C;AACtB;AAES;AACwB;AAER;AACyB;AAWjF;IAAyC,6EAA4B;IACnE,6BAAY,KAAY;QAAxB,YACE,kBAAM,KAAK,CAAC,SAIb;QAHC,KAAI,CAAC,KAAK,GAAG;YACX,aAAa,EAAE,KAAK;SACrB;;IACH,CAAC;IAED,gDAAkB,GAAlB;QAAA,iBAMC;QALC,aAAa,CAAC,IAAI,CAAC;YACjB,KAAI,CAAC,QAAQ,CAAC,EAAC,aAAa,EAAE,IAAI,EAAC,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC,KAAK,CAAC,aAAG;YACV,8DAAS,CAAC,GAAG,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,oCAAM,GAAN;QACE,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;YAC/B,oDAAC,wEAAa,IACZ,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,aAAa,EACvC,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,GAAI,CAAC,CAAC;YAC3C;gBAAG,oDAAC,yFAAO,OAAE;qDAAiC;IAClD,CAAC;IACH,0BAAC;AAAD,CAAC,CAvBwC,+CAAe,GAuBvD;;;;;;;;;;;;;;;;;;;AC3CmC;AACqB;AACzD,oDAAG,CAAC,UAAU,sDAAO,oDAAG,CAAC,UAAU,EAAK,sDAAU,CAAC,CAAC;;;;;;;;;;;;;;;;;ACDK;AACpB;AAErC;IAKE;QACE,IAAM,IAAI,GAAG,wDAAG,CAAC,WAAY,CAAC;QAC9B,IAAM,KAAK,GAAG,4EAAgB,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC;QACjE,IAAM,QAAQ,GAAI,CAAC,KAAK,CAAC,QAAQ,IAAE,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAc;aAC3D,GAAG,CAAC,iBAAO,IAAI,cAAO,CAAC,WAAW,EAAE,EAArB,CAAqB,CAAC,CAAC,CAAC,6BAA6B;QAEvE,IAAI,CAAC,uBAAuB;YAC1B,IAAI,CAAC,UAAU,KAAK,aAAa,IAAI,KAAK,CAAC,UAAU,KAAK,aAAa,CAAC;QAC1E,IAAI,CAAC,QAAQ;YACX,IAAI,CAAC,UAAU,KAAK,aAAa,IAAI,KAAK,CAAC,UAAU,KAAK,aAAa,CAAC;QAC1E,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC;IAC7C,CAAC;IACH,eAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;ACrB0B;;;;;;;;;;;;;;;;;;;;;;;ACAqE;AACS;AACnC;AACjC;AACA;AAEgC;AACpB;AAEjD,4BAA4B,SAAiB,EAAE,cAAsB,EAAE,MAAgB;IACrF,gFAAgF;IAChF,IAAM,YAAY,GAAG,4EAAgB,CAAC,cAAc,CAAC,CAAC;IACtD,IAAM,kBAAkB,GAAG,oEAAe,CAAC,YAAY,EAAE,gFAA0B,CAAC,CAAC;IAC/E,gGAAuE,EAAtE,6BAAqB,EAAE,wBAAgB,CAAgC;IAC9E,IAAM,cAAc,GAAG,4EAAgB,CAAC,gBAAgB,CAAC,CAAC;IAC1D,MAAM,CAAC,qBAAqB,GAAG,+EAAmB,oDAC7C,cAAc,EACd,kBAAkB,IACrB,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,IACxB,CAAC;AACL,CAAC;AAED,oBAAoB,eAAuB,EAAE,SAAiB;IAC5D,MAAM,CAAC,eAAe,GAAG,GAAG,GAAG,SAAS,CAAC;AAC3C,CAAC;AAED,sBAAsB,IAAU,EAAE,OAAe;IAC/C,wDAAG,CAAC,WAAW,GAAG,IAAI,CAAC;IACvB,cAAc,CAAC,OAAO,CAAC,UAAU,GAAG,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;AACrE,CAAC;AAED,sBAAsB,OAAe;IACnC,IAAM,iBAAiB,GAAG,cAAc,CAAC,OAAO,CAAC,UAAU,GAAG,OAAO,CAAC,CAAC;IACvE,EAAE,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC;QACtB,wDAAG,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;IAClD,CAAC;AACH,CAAC;AAED,8BAA8B,eAAuB,EAAE,SAAiB;IACtE,IAAM,OAAO,GAAG,UAAU,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC;IACvD,MAAM,CAAC,IAAI,4EAAuB,CAAC,eAAe,EAAE,sBAAY;QAC9D,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAiE,CAAC;QACrG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC;YAAC,MAAM,IAAI,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACxC,EAAE,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;YACb,YAAY,CAAC,GAAG,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAClC,CAAC;QACD,MAAM,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,CAAC;IACpE,CAAC,EAAE,OAAO,CAAC,CAAC;AACd,CAAC;AAED,mCAAmC,eAAuB,EAAE,SAAiB;IAC3E,IAAM,OAAO,GAAG,UAAU,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC;IACvD,MAAM,CAAC,IAAI,4EAAuB,CAAC,eAAe,EAAE,sBAAY;QAC9D,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAiE,CAAC;QACrG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC;YAAC,MAAM,IAAI,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACxC,MAAM,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,CAAC;IACpE,CAAC,EAAE,OAAO,CAAC,CAAC;AACd,CAAC;AAED,iCAAiC,QAAgB,EAAE,IAAU,EAAE,MAAgB;IAC7E,MAAM,CAAC,IAAI,mEAAiB,CAC1B,+DAAU,EACV,4DAAO,EACP,QAAQ,GAAG,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,MAAM,EACtC,wDAAG,CAAC,aAAa,EACjB,wDAAG,CAAC,iBAAiB,EACrB,QAAQ,EAAE;QACR,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;QAC9B,KAAK,EAAE,IAAI,CAAC,KAAK;QACjB,MAAM,EAAE,IAAI,CAAC,MAAM;QACnB,UAAU,EAAE,IAAI,CAAC,UAAU;QAC3B,MAAM;KACP,CAAC,CAAC;AACP,CAAC;AAED,8DAA8D;AAC9D,0EAA0E;AAC1E,2EAA2E;AAC3E,iFAAiF;AACjF,0DAA0D;AAC1D,IAAM,gBAAgB,GAAG,wDAAG,CAAC,WAAW,IAAI,wDAAG,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,qCAAqC;AACvG,EAAE,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC;IACrB,MAAM;IACN,EAAE,CAAC,CAAC,wDAAG,CAAC,cAAc,CAAC,CAAC,CAAC;QACvB,EAAE;QACF,EAAE;QACF,qEAAqE;QACrE,EAAE;QACF,EAAE;QACF,IAAM,eAAe,GAAG,kBAAkB,CACxC,wDAAG,CAAC,cAAc,EAClB,QAAQ,CAAC,MAAM,EAAE;YACf,YAAY;YACZ,KAAK;SACN,CAAC,CAAC;QACL,wDAAG,CAAC,cAAc,GAAG,oBAAoB,CAAC,eAAe,EAAE,gBAAgB,CAAC,CAAC;QAC7E,YAAY,CAAC,UAAU,CAAC,eAAe,EAAE,gBAAgB,CAAC,CAAC,CAAC;QAE5D,SAAS;QACT,IAAM,gBAAgB,GAAG,kBAAkB,CACzC,wDAAG,CAAC,cAAc,EAClB,QAAQ,CAAC,MAAM,EAAE;YACf,mDAAmD;SACpD,CAAC,CAAC;QACL,wDAAG,CAAC,mBAAmB,GAAG,yBAAyB,CAAC,gBAAgB,EAAE,gBAAgB,CAAC,CAAC;IAC1F,CAAC;IAAC,IAAI,CAAC,EAAE,CAAC,CAAC,wDAAG,CAAC,aAAa,IAAI,wDAAG,CAAC,aAAa,IAAI,wDAAG,CAAC,iBAAiB,CAAC,CAAC,CAAC;QAC3E,EAAE;QACF,EAAE;QACF,0DAA0D;QAC1D,EAAE;QACF,EAAE;QACF,wDAAG,CAAC,cAAc,GAAG,uBAAuB,CAAC,wDAAG,CAAC,aAAa,EAAE,wDAAG,CAAC,WAAW,EAAE;YAC/E,YAAY;YACZ,KAAK;SACN,CAAC,CAAC;QACH,wDAAG,CAAC,mBAAmB,GAAG,uBAAuB,CAAC,wDAAG,CAAC,aAAa,GAAG,SAAS,EAAE,wDAAG,CAAC,WAAW,EAAE;YAChG,mDAAmD;SACpD,CAAC,CAAC;IACL,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;IACpE,CAAC;AACH,CAAC;;;;;;;;;;;;;;;;;ACzHoC;AACA;AACsB;AAE3D,wDAAG,CAAC,gBAAgB,GAAG,IAAI,wEAAmB,CAC5C,wDAAG,CAAC,WAAW,EACf,wDAAG,CAAC,cAAc,CAAC,CAAC;;;;;;;;;;;;;;;ACNE;AA0BvB,CAAC;AAEF,EAAE,CAAC,CAAC,CAAC,4CAAG,CAAC,GAAG,CAAC;IAAC,4CAAG,CAAC,GAAG,GAAG,EAAE,CAAC;AAE3B,+DAAe,4CAAG,CAAC,GAAwB,EAAC;;;;;;;;;;;;;;;ACzBpB;AAaxB,EAAE,CAAC,CAAC,CAAC,4CAAG,CAAC,GAAG,CAAC;IAAC,4CAAG,CAAC,GAAG,GAAG,EAAE,CAAC;AAE3B,+DAAe,4CAAG,CAAC,GAAU,EAAC;;;;;;;;;;;;;;;ACnBvB,IAAM,aAAa,GAAG,KAAK,CAAC;AAInC,IAAI,MAAM,GAAG,OAAO,GAAG,KAAK,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;AAEnD,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,WAAW,IAAI,OAAO,GAAG,KAAK,WAAW,CAAC,CAAC,CAAC;IAC9D,MAAM,CAAC,aAAa,CAAC,GAAG,MAAM,CAAC;AACnC,CAAC;AAED,+DAAe,MAAM,EAAC;;;;;;;;;;;;;;;ACVf,IAAM,aAAa,GAAG,KAAK,CAAC;AAInC,IAAI,MAAM,GAAG,OAAO,GAAG,KAAK,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;AAEnD,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,WAAW,IAAI,OAAO,GAAG,KAAK,WAAW,CAAC,CAAC,CAAC;IAC9D,MAAM,CAAC,aAAa,CAAC,GAAG,MAAM,CAAC;AACnC,CAAC;AAED,+DAAe,MAAM,EAAC;;;;;;;;;;;;;;;;;ACHtB;IAKE,cAAmB,IAAyB;QAAzB,SAAI,GAAJ,IAAI,CAAqB;QAC1C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;IACxB,CAAC;IAED,wBAAS,GAAT,UAAU,UAAyB;QAAnC,iBAKC;QAJC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC;YAC/B,UAAU,CAAC,KAAI,CAAC,KAAK,CAAC,CAAC;YACvB,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACpC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,0BAAW,GAAX,UAAY,UAAyB;QACnC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAE,WAAC,IAAI,QAAC,KAAK,UAAU,EAAhB,CAAgB,CAAC,CAAC;IACrE,CAAC;IAED,gCAAiB,GAAjB;QAAA,iBAEC;QADC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,WAAC,IAAI,QAAC,CAAC,KAAI,CAAC,KAAK,CAAC,EAAb,CAAa,CAAC,CAAC;IAC/C,CAAC;IAED,4BAAa,GAAb;QACE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC;YAAC,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAChD,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED,gCAAiB,GAAjB;QAAA,iBAMC;QALC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,eAAK;YAC7C,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,KAAI,CAAC,iBAAiB,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAEK,qBAAM,GAAZ,UAAa,IAAa;;;;;4BACxB,qBAAM,IAAI,CAAC,aAAa,EAAE;;wBAA1B,SAA0B,CAAC;wBACrB,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;wBAClD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAE;4BAC5B,IAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,UAAC,EAAI;oCAAH,UAAE;gCAAM,SAAE,CAAC,EAAE,KAAK,EAAE;4BAAZ,CAAY,CAAC,CAAC;4BAChD,MAAM,CAAC,IAAI,CAAC,CAAC;gCACX,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC;gCACzB,EAAE,CAAC;wBACP,CAAC,CAAC,CAAC;wBACH,IAAI,CAAC,iBAAiB,EAAE,CAAC;;;;;KAC1B;IAED,qBAAM,GAAN,UAAO,IAAa;QAApB,iBAKC;QAJC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC;YAC/B,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YACrC,KAAI,CAAC,iBAAiB,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC;IAED,qBAAM,GAAN,UAAO,EAAqB;QAA5B,iBAMC;QALC,IAAM,GAAG,GAAG,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;QAC1C,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC;YAC/B,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,YAAE,IAAI,QAAC,GAAG,CAAC,IAAI,CAAC,YAAE,IAAI,SAAE,CAAC,EAAE,KAAK,EAAE,EAAZ,CAAY,CAAC,EAA7B,CAA6B,CAAC,CAAC;YACpE,KAAI,CAAC,iBAAiB,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC;IACH,WAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;ACzE+C;AAEX;AACO;AAE5C;IAAgC,2EAAY;IAM1C,2BAAY,aAAyB;QAArC,YACE,kBAAM;YACJ,KAAK,EAAE;;;;;4BACC,UAAU,GAAG,aAAa,EAAE,CAAC;4BACnB,qBAAM,wDAAG,CAAC,gBAAgB,CAAC,IAAI,CAC7C,SAAS,EAAE;oCACT,IAAI,EAAE,UAAU;oCAChB,OAAO,EAAE,CAAC,SAAS,CAAC;iCACrB,CAAC;;4BAJE,OAAO,GAAG,SAIZ;4BACJ,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;4BACrD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;gCAAC,MAAM,IAAI,KAAK,CAAC,sDAAC,kSAAU,EAAU,+JACwC,EAAU,IAAG,KAD/D,UAAU,EACwC,UAAU,EAAI,CAAC;4BACjH,sBAAO,4DAAO,CAAC,OAAO,CAAC,GAAG,CAAC,gBAAM,IAAI,aAAM,CAAC,OAAO,EAAd,CAAc,CAAC,CAAC,EAAC;;;iBACvD;SACF,CAAC,SACH;;IAAD,CAAC;IAnBD,uCAAW,GAAX;QAAA,iBAEC;QADC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC,cAAI,YAAI,CAAC,SAAS,EAAd,CAAc,CAAC,CAAC;IACvD,CAAC;IAkBH,wBAAC;AAAD,CAAC,CAtB+B,0CAAI,GAsBnC;AAEM,IAAM,mBAAmB,GAAG,IAAI,iBAAiB,CAAC,cAAI,+DAAG,CAAC,WAAW,CAAC,MAAM,EAAtB,CAAsB,CAAC,CAAC;;;;;;;;;;;;;;;AC5BrF;AAAA;IAGI,wBAAmB,OAAuB;QAAvB,YAAO,GAAP,OAAO,CAAgB;QACtC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACvB,CAAC;IAED,8BAAK,GAAL;QAAA,iBAIC;QAHG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACjB,IAAI,CAAC,OAAO,CAAC,CAAC;YACd,CAAC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,WAAC,IAAI,YAAI,CAAC,MAAM,GAAG,CAAC,EAAf,CAAe,CAAC,CAAC,CAAC;IACnE,CAAC;IAED,8BAAK,GAAL;QACI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IACxB,CAAC;IACL,qBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;AClB8B;AACL;AAW1B;IAA0C,8EAA4B;IACpE,8BAAa,KAAY;QAAzB,YACE,kBAAM,KAAK,CAAC,SASb;QARC,KAAI,CAAC,KAAK,GAAC;YACT,KAAK,EAAE,SAAS;YAChB,IAAI,EAAE,SAAS;SAChB,CAAC;QACF,KAAI,CAAC,mBAAmB,GAAG,KAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC/D,KAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACrC,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjD,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;;IACzC,CAAC;IAED,gDAAiB,GAAjB;QACE,MAAM,CAAC,gBAAgB,CAAC,oBAAoB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;QACxE,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QAC9C,MAAM,CAAC,gBAAgB,CAAC,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QAC1D,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IAChD,CAAC;IAED,mDAAoB,GAApB;QACE,MAAM,CAAC,mBAAmB,CAAC,oBAAoB,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;QAC3E,MAAM,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QACjD,MAAM,CAAC,mBAAmB,CAAC,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QAC7D,MAAM,CAAC,mBAAmB,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IACnD,CAAC;IAED,kDAAmB,GAAnB,UAAqB,EAA2B;QAAhD,iBAGC;QAFC,IAAI,CAAC,QAAQ,CAAC,EAAC,KAAK,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,gDAAC,uLAA6B,MAAE,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC;QACnG,UAAU,CAAC,cAAI,YAAI,CAAC,QAAQ,CAAC,EAAC,KAAK,EAAE,IAAI,EAAC,CAAC,EAA5B,CAA4B,EAAE,KAAK,CAAC,CAAC;IACtD,CAAC;IAED,qCAAM,GAAN,UAAQ,EAA0B;QAAlC,iBAGC;QAFC,IAAI,CAAC,QAAQ,CAAC,EAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,gDAAC,uLAA6B,MAAE,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC;QACjG,UAAU,CAAC,cAAI,YAAI,CAAC,QAAQ,CAAC,EAAC,KAAK,EAAE,IAAI,EAAC,CAAC,EAA5B,CAA4B,EAAE,KAAK,CAAC,CAAC;IACtD,CAAC;IAED,2CAAY,GAAZ,UAAc,EAAe;QAA7B,iBAGC;QAFC,IAAI,CAAC,QAAQ,CAAC,EAAC,KAAK,EAAE,EAAE,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,EAAC,CAAC,CAAC;QAC9C,UAAU,CAAC,cAAI,YAAI,CAAC,QAAQ,CAAC,EAAC,KAAK,EAAE,IAAI,EAAC,CAAC,EAA5B,CAA4B,EAAE,KAAK,CAAC,CAAC;IACtD,CAAC;IAED,sCAAO,GAAP,UAAQ,EAAe;QAAvB,iBAGC;QAFC,IAAI,CAAC,QAAQ,CAAC,EAAC,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC;QAC/C,UAAU,CAAC,cAAI,YAAI,CAAC,QAAQ,CAAC,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC,EAA3B,CAA2B,EAAE,KAAK,CAAC,CAAC;IACrD,CAAC;IAED,qCAAM,GAAN;QACE,MAAM,CAAC,6DAAK,SAAS,EAAC,wBAAwB,EAAC,KAAK,EAAE;gBACpD,QAAQ,EAAE,OAAO;gBACjB,IAAI,EAAE,CAAC;gBACP,GAAG,EAAE,CAAC;gBACN,KAAK,EAAE,MAAM;gBACb,aAAa,EAAE,MAAM;aACtB;YACC,6DAAK,KAAK,EAAE,EAAC,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAC;gBAC9C,2DAAG,SAAS,EAAC,OAAO,EAAC,KAAK,EAAE,EAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,EAAC,IAAG,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAK;gBACjH,2DAAG,SAAS,EAAC,MAAM,EAAC,KAAK,EAAE,EAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,EAAC,IAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAK,CACtF,CACF,CAAC;IACT,CAAC;IACH,2BAAC;AAAD,CAAC,CA7DyC,+CAAe,GA6DxD;;;;;;;;;;;;;;;;;;;;;ACzEsB;AAEvB,IAAM,kBAAkB,GAAG,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,aAAa;AACvD,IAAM,aAAa,GAAG,kCAAkC,CAAC,CAAC,yDAAyD;AAEnH,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;AAExB;IACJ,WAAW,CAAC,SAAS,EAAE,kBAAkB,CAAC,CAAC;IAC3C,UAAU,CAAC,cAAI,oDAAC,CAAC,MAAM,CAAC;SACrB,SAAS,CAAC,YAAY,CAAC;SACvB,QAAQ,CAAC,YAAY,CAAC;SACtB,MAAM,CAAC,YAAY,CAAC,EAHR,CAGQ,EAAE,GAAG,CAAC,CAAC;AAChC,CAAC;AAED;IACE,YAAY,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;AAC5B,CAAC;AAED;IACE,IAAM,cAAc,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,YAAY,CAAC;IACjD,EAAE,CAAC,CAAC,cAAc,GAAG,kBAAkB,CAAC,CAAC,CAAC;QACxC,SAAS,EAAE,CAAC;IACd,CAAC;AACH,CAAC;AAED;;;;;;oBACE,OAAO,CAAC,GAAG,CAAC,kCAAgC,aAAe,CAAC,CAAC;;;;oBAE/C,qBAAM,KAAK,CAAC,aAAa,EAAE;4BACrC,KAAK,EAAE,UAAU;4BACjB,WAAW,EAAE,aAAa;yBAC3B,CAAC;;oBAHI,GAAG,GAAG,SAGV;oBACF,OAAO,CAAC,GAAG,CAAC,mBAAiB,aAAa,UAAK,GAAG,CAAC,MAAM,SAAI,GAAG,CAAC,UAAY,CAAC,CAAC;;;;oBAE/E,OAAO,CAAC,IAAI,CAAC,gBAAc,aAAa,iBAAY,KAAK,CAAC,CAAC;;;;;;CAE9D;;;;;;;;;;;;;;;;;;;ACjCK,0BAA2B,cAAsB,EAAE,OAAiC;IACjF,qCAAO,CAA+C;IAC7D,IAAM,MAAM,GAAG,EAAE,CAAC;IAClB,EAAE,CAAC,CAAC,cAAc,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC;QAC9C,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC;aACrB,KAAK,CAAC,GAAG,CAAC;aACV,GAAG,CAAC,cAAI,IAAI,WAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,WAAC,IAAI,yBAAkB,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,EAA5B,CAA4B,CAAC,EAAtD,CAAsD,CAAC;aACnE,OAAO,CAAC,UAAC,EAAY;gBAAX,WAAG,EAAE,aAAK;YAAM,aAAM,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,KAAK;QAAjD,CAAiD,CAAC,CAAC;IAClF,MAAM,CAAC,MAAM,CAAC;AAChB,CAAC;AAED,sBAAsB,MAA8B;IAClD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,aAAG,IAAI,OAAG,kBAAkB,CAAC,GAAG,CAAC,SAAI,kBAAkB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAG,EAA/D,CAA+D,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AACnH,CAAC;AAEK,6BAA8B,MAA8B;IAChE,MAAM,CAAC,GAAG,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;AACpC,CAAC;AAEK,8BAA+B,YAAoB,EAAE,OAAiC;IAC1F,MAAM,CAAC,gBAAgB,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;AACjD,CAAC;AAEK,iCAAkC,MAA8B;IACpE,MAAM,CAAC,GAAG,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;AACpC,CAAC;AAEK,0BAA4B,oBAA4B;IAC5D,IAAM,MAAM,GAAG,oBAAoB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IACjD,MAAM,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC;QAClB,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,EAAE,oBAAoB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAC/E,CAAC,oBAAoB,EAAE,EAAE,CAAC,CAAC;AAC/B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnCK,yBAA2B,GAAG;IAChC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,GAAG,CAAC,MAAM,EAAE,CAAC,GAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC;QACnC,EAAE,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;YAC7B,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,iBAAiB,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC7E,CAAC;IACL,CAAC;IACD,MAAM,CAAC,GAAG,CAAC;AACf,CAAC;AAEK,gBAAiB,GAAG,EAAE,SAAS;IACjC,EAAE,CAAC,CAAC,OAAO,SAAS,KAAK,QAAQ,CAAC;QAAC,MAAM,CAAC,GAAG,CAAC;IAC9C,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,aAAG;QAC9B,GAAG,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;IAC9B,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,GAAG,CAAC;AACf,CAAC;AAEK,eAAsB,GAAO,EAAE,SAAa;IAC9C,IAAI,KAAK,GAAG,EAAE,CAAC;IACf,MAAM,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,aAAG;QACvC,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,GAAG,EAAE,MAAM,CAAC,wBAAwB,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;IACjF,CAAC,CAAC,CAAC;IACH,EAAE,CAAC,CAAC,SAAS,CAAC;QAAC,MAAM,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;IACxC,MAAM,CAAC,KAAgB,CAAC;AAC5B,CAAC;AAED,IAAM,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC;AACnB,iBAAsB,CAAe;IACvC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE,CAAC,CAAQ,CAAC;AACtC,CAAC;AAEK,qBAAsB,IAAW;IACnC,MAAM,CAAC,UAAC,CAAC,EAAC,CAAC;QACP,IAAM,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;QACvC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACtD,CAAC;AACL,CAAC;AAEK,sBAAuB,KAAwB,EAAE,OAA2B,EAAE,OAA8B;IAC9G,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;IAE/C,IAAM,aAAa,GAAG,UAAC,CAAC,EAAC,CAAC;QACtB,cAAO,CAAC,KAAK,QAAQ,CAAC,CAAC;YACnB,CAAC,CAAC,aAAa,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;YACtC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAF9B,CAE8B,CAAC;IAEnC,MAAM,CAAC,KAAK;SACP,GAAG,CAAC,cAAI,IAAI,iBAAC,CAAC,EAAC,CAAC,IAAK,oBAAa,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,EAA/B,CAA+B,EAAxC,CAAwC,CAAC;SACrD,MAAM,CAAC,UAAC,IAAI,EAAE,IAAI;QACf,iBAAC,CAAC,EAAC,CAAC,IAAK,WAAI,CAAC,CAAC,EAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,EAAC,CAAC,CAAC,EAAtB,CAAsB;IAA/B,CAA+B,CAAC,CAAC;AAC7C,CAAC;AAEK,WAAY,IAAI;IAAE,cAAO;SAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;QAAP,6BAAO;;IAC3B,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IACpB,MAAM,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;AACpC,CAAC;AAED,sBAAuB,IAAI,EAAE,IAAI;IAC7B,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IACjB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,IAAI,CAAC,MAAM,EAAE,CAAC,GAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC;QACpC,EAAE,IAAI,IAAI,CAAC,CAAC,GAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;IAC9B,CAAC;IACD,MAAM,CAAC,EAAE,CAAC;AACd,CAAC;AAED;IACI,YAAY,QAAW;QACnB,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;IAC3B,CAAC;IACL,SAAC;AAAD,CAAC;;AAEK,yBAA2B,GAAG,EAAE,KAAK;IACvC,IAAI,CAAC,CAAC;IACN,EAAE,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC;QAC5B,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACpC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACJ,MAAM,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3B,CAAC;IACL,CAAC;IACD,MAAM,CAAC,KAAK,CAAC;AACjB,CAAC;AAEK,kBAAoB,GAAG;IACzB,IAAI,KAAK,GAAG,IAAI,WAAW,CAAC,MAAM,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC,CAAC;IACvD,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAChC,CAAC;AAEK,mBAAqB,MAAsB;IAC7C,IAAM,GAAG,GAAG,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC;IACjE,IAAI,KAAK,GAAG,IAAI,WAAW,CAAC,aAAa,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC,CAAC;IAC9D,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACtB,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAChC,CAAC;AAEK,mBAAoB,GAAW,EAAE,MAAc;IACjD,MAAM,CAAC,GAAG,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC;QACxB,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;QACnC,GAAG,CAAC;AACZ,CAAC;AAEK,uBAA2B,CAAM,EAAE,WAAyC;IAC9E,IAAM,MAAM,GAA2B,EAAE,CAAC;IAC1C,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,CAAC,CAAC,MAAM,EAAE,CAAC,GAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC;QACjC,IAAM,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAClB,IAAM,GAAG,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC;QAC9B,IAAI,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;QACxB,EAAE,CAAC,CAAC,KAAK,CAAC;YAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5B,IAAI;YAAC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAEK,oBAAwB,CAAM,EAAE,WAAyC;IAC3E,IAAM,MAAM,GAAyB,EAAE,CAAC;IACxC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,CAAC,CAAC,MAAM,EAAE,CAAC,GAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC;QACjC,IAAM,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAClB,IAAM,GAAG,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC;QAC9B,MAAM,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;IACvB,CAAC;IACD,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAEK,yBAA8B,GAAM,EAAE,WAAqB;IAC7D,IAAM,MAAM,GAAG,EAAE,CAAC;IAClB,GAAG,CAAC,CAAgB,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAW;QAA1B,IAAM,KAAK;QACd,EAAE,CAAC,CAAC,KAAK,IAAI,GAAG,CAAC;YAAC,MAAM,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC;KAC9C;IACD,MAAM,CAAC,MAAoB,CAAC;AAChC,CAAC;AAEK,kBAAuB,CAAM,EAAE,WAA6B;IAC9D,IAAM,GAAG,GAAG,UAAU,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC;IACvC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,aAAG,IAAI,UAAG,CAAC,GAAG,CAAC,EAAR,CAAQ,CAAC,CAAC;AACjD,CAAC;;;;;;;;;;;;ACtID,wB;;;;;;;;;;;ACAA,uB;;;;;;;;;;;ACAA,0B","file":"kedappcoursebuilder.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \tvar installedChunks = {\n \t\t\"kedappcoursebuilder\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp_name_\"] = window[\"webpackJsonp_name_\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([\"./src/elements/KEDAppCourseBuilder/webpack-entry.ts\",\"vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import {BearerPersistentStorage, BearerTokenInfo} from '../ked-backend-client';\n\nexport class BearerStorageSessionStorage implements BearerPersistentStorage {\n    save(id: string, tokenInfo: BearerTokenInfo) {\n        sessionStorage.setItem(\"bearer-\" + id, JSON.stringify(tokenInfo));\n    }\n\n    load(id: string): Promise<BearerTokenInfo> {\n        try {\n            const json = sessionStorage.getItem(\"bearer-\" + id);\n            return Promise.resolve(json ? JSON.parse(json) : {token: null, expires: 0});\n        } catch (ex) {\n            return Promise.resolve({token: null, expires: 0});\n        }\n    }\n}\n","import { KedBackendClient, BearerProvider, BearerTokenInfo, IsomorphicEnv } from '../ked-backend-client';\nimport { BearerStorageSessionStorage } from \"./bearer-storage-sessionstorage\";\nimport { avoidSimultanousCalls } from '../ked-backend-client/utils';\nimport { KedModelMigratorMixin } from '../ked-model-migrator';\nKedModelMigratorMixin(KedBackendClient.prototype);\n\nexport const storage = new BearerStorageSessionStorage();\n\nconst timeOfPageLoad = Date.now();\n\nexport class WebServerBearerProvider implements BearerProvider {\n    tokenInfo: BearerTokenInfo;\n    wantsRedirect: boolean;\n\n    constructor (\n        public tokenPath: string,\n        public tokenResponseMapper: (responseText: string) => BearerTokenInfo,\n        public tokenId: string)\n    {\n        this.tokenInfo = {token: null, expires: 0};\n        this.getBearer = avoidSimultanousCalls(this.getBearer.bind(this));\n        this.refreshBearer = avoidSimultanousCalls(this.refreshBearer.bind(this));\n    }\n\n    async getBearer() {\n        if (!this.tokenInfo.token) {\n            if (this.tokenId) this.tokenInfo = await storage.load(this.tokenId);\n        }\n        if (this.tokenInfo.expires < Date.now()) {\n            await this.refreshBearer();\n        }\n        return this.tokenInfo;\n    }\n\n    async refreshBearer() {\n        const res = await fetch(this.tokenPath, {\n            headers: {Accept: \"text/plain; application/json\"},\n            redirect: 'manual',\n            cache: 'no-cache',\n            credentials: \"same-origin\"\n        });\n        if (res.status === 302 || (!res.status && res.type === \"opaqueredirect\")) {\n            // User session timed out and server wants to redirect entire page to login page\n            // Time to reload current page to force a redirect of the entire page instead for\n            // just redirecting to /api/token or whatever.\n            if (Date.now() - timeOfPageLoad > 60000) {// prohibit endless loop of reloading self.\n                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.\n                console.log(\"Redirect wanted. Reload page.\")\n                window.location.reload(true);\n            }\n        }\n        if (res.status != 200) throw new Error(\"HTTP\"+res.status + \" \" + await res.text());\n        this.tokenInfo = this.tokenResponseMapper(await res.text());\n        storage.save(this.tokenId, this.tokenInfo);\n        return this.tokenInfo;\n    }\n}\n\nexport const isomorphic = {fetch: fetch.bind(self), btoa: btoa.bind(self)};\n\nexport class KedBackendClientWeb extends KedBackendClient {\n    constructor(\n        apiBaseUrl: string,\n        providerOrTokenPath: string | BearerProvider,\n        options?: {\n            tokenResponseMapper?: (responseText: string) => BearerTokenInfo,\n            tokenId?: string\n        })\n    {\n        const bearerProvider = typeof providerOrTokenPath !== 'string' ?\n            providerOrTokenPath :\n            new WebServerBearerProvider(\n                providerOrTokenPath,\n                (options && options.tokenResponseMapper) || (x=>({token: x, expires: Date.now() + 59 * 60 * 60})),\n                options && options.tokenId);\n        super(isomorphic, bearerProvider, apiBaseUrl);\n    }\n}\n","export interface AccessClaim {\n  type: string;\n  value: string;\n}\n\nexport type AccessRight = 'R' | 'W' | 'S';\n\nexport class DocumentAccess {\n  constructor(\n    public accessClaimType: string,\n    public accessClaimValue: string,\n    public right: AccessRight\n  ) { }\n\n  static fromString(ac: string) {\n    if (!ac) return null;\n    var split = ac.split(':');\n    if (split.length < 3) throw new Error(\"Invalid access string: \" + ac);\n    var claimType = DocumentAccess.unescape(split[0]);\n    var claimValue = DocumentAccess.unescape(split[1]);\n    var right = split[2];\n    if (right !== 'R' && right !== 'W' && right !== 'S')\n      throw new Error(\"Invalid access string: \" + ac);\n    return new DocumentAccess(\n      claimType,\n      claimValue,\n      right);\n  }\n\n  static escape(accessComponent: string) {\n    return accessComponent.replace(/\\%/g, \"%25\").replace(/\\:/g, \"%3A\");\n  }\n\n  static unescape(accessComponent: string) {\n    return accessComponent.replace(/\\%3A/g, \":\").replace(/\\%25/g, \"%\");\n  }\n\n  toString() {\n    return DocumentAccess.escape(this.accessClaimType) + \":\" +\n      DocumentAccess.escape(this.accessClaimValue) + \":\" +\n      this.right;\n  }\n\n  static fromStringArray(acl: string[]) {\n    return acl\n      .map(ac => DocumentAccess.fromString(ac))\n      .filter(ac => ac);\n  }\n\n  static toStringArray(acl: DocumentAccess[]) {\n    return acl.map(ac => ac.toString());\n  }\n}\n\nexport function hasAccess(acl: DocumentAccess[], userClaims: AccessClaim[], requestedRight: AccessRight) {\n  if (userClaims.some(claim => claim.type === 'role' && claim.value === \"ADMIN\"))\n    return true;\n\n  return acl.some(a =>\n    userClaims.some(c =>\n      a.accessClaimType === c.type &&\n      a.accessClaimValue === c.value && (\n        (a.right === 'R' && requestedRight === 'R') ||\n        (a.right === 'W' && ['R','W'].indexOf(requestedRight) >= 0) ||\n        (a.right === 'S'))));\n}\n","\nexport class HttpError extends Error {\n    constructor (public code: number, public message: string) {\n      super(\"HTTP\" + code + \" \" + message)\n      this.name = \"http\" + code;\n    }\n}\n","import {RestClient, BearerProvider, BearerTokenInfo} from './restclient';\nexport {BearerProvider, BearerTokenInfo};\nexport {BearerPersistentStorage} from './ked-bearer-provider';\nexport {createUUID} from './utils';\nexport {KedBearerProvider} from './ked-bearer-provider';\nimport {IsomorphicEnv} from './isomorphic-env';\nexport {IsomorphicEnv};\nexport {TokenQuery} from './token-query';\nexport * from './access-control';\nimport {HttpError} from './http-error';\nexport {HttpError}\n\nexport interface ListOptions {\n    from?: number,\n    to?: number,\n    include?: string | string[],\n    role?: string | string[],\n    hasEdgesTo?: string | string[],\n    hasEdgesFrom?: string | string[],\n    ids?: string[],\n    name?: string,\n    tags?: string | string[],\n    flags?: QueryFlag[],\n    cacheBust?: string | number\n};\n\nexport type QueryFlag = 'idsOnly' | 'includeIdsOnly' | 'idsAndNamesOnly' | 'includeIdsAndNamesOnly'; // | 'otherFlag' | 'thirdFlag';...\n\nexport class KedBackendClient {\n    http: RestClient;\n\n    constructor (\n        isomorphic: IsomorphicEnv,\n        bearerProvider: BearerProvider,\n        baseUrl: string)\n    {\n        this.http = new RestClient(\n            isomorphic,\n            baseUrl,\n            {bearerProvider});\n    }\n\n    async getMyClaims(table?: string, fetchOptions?: RequestInit) : Promise<any> // TODO: Specify what you get here\n    {\n        const res = await this.http.get(\"me/claims/\" + (table ||\"\"), null, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async get<T = any>(table, id, options?: {include?: string | string[]}, fetchOptions?: RequestInit) : Promise<T> {\n        const res = await this.http.get(`${table}/${id}`, options, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }    \n\n    async list<T = any>(table: string, options?: ListOptions, fetchOptions?: RequestInit) : Promise<T[]>\n    {\n        const res = await this.http.get(`${table}`, options, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async batch(reqs: MutationRequest[], fetchOptions?: RequestInit) : Promise<BatchResponse> {\n        // Reorder operations so that 'add's come first and 'delete's come last:\n        reqs = reqs.slice().sort((req1, req2) =>\n            req1.op === 'add' ? -1 : req2.op === 'add' ? 1 : \n            req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0);\n        const res = await this.http.post(`batch`, reqs, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async do(scopeFn: (r:BatchRunner)=>void) : Promise<BatchResponse> {\n        const runner = new BatchRunner();\n        scopeFn(runner);\n        return await this.batch(runner.mutationRequests);\n    }\n\n    async deleteRealm(realm: string) : Promise<number> {\n        const res = await this.http.delete(\"realms/\" + realm);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    add(table:string, doc) {\n        return this.do(r=>r.add(table, doc));\n    }\n    put(table:string, doc) {\n        return this.do(r=>r.put(table, doc));\n    }\n    delete (table:string, id:string) {\n        return this.do(r=>r.delete(table, id));\n    }\n    share(table:string, id:string, acl: string[]) {\n        return this.do(r=>r.share(table, id, acl));\n    }\n    unshare (table:string, id:string, acl: string[]) {\n        return this.do(r=>r.unshare(table, id, acl));\n    }\n    link (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        return this.do(r=>r.link(sourceTable, sourceId, targetTable, targetId, label));\n    }\n    link2 (sourceTable:string, sourceId:string, targetId:string, label:string) {\n        return this.do(r=>r.link2(sourceTable, sourceId, label, targetId));\n    } \n    unlink (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        return this.do(r=>r.unlink(sourceTable, sourceId, targetTable, targetId, label));\n    }\n    unlink2 (sourceTable:string, sourceId:string, targetId:string, label:string) {\n        return this.do(r=>r.unlink2(sourceTable, sourceId, label, targetId));\n    }\n}\n\nexport class BatchRunner {\n    mutationRequests: MutationRequest[];\n\n    constructor() {\n        this.mutationRequests = [];\n    }\n\n    add (table:string, doc) {\n        this.mutationRequests.push({op: 'add', table, doc});\n        return this;\n    }\n    put (table:string, doc) {\n        doc = {...doc};\n        delete doc.acl; // Forbidden to send acl with put() calls.\n        this.mutationRequests.push({op: 'put', table, doc});\n        return this;\n    }\n    delete (table:string, id:string) {\n        this.mutationRequests.push({op: 'delete', table, id});\n        return this;\n    }\n    share (table:string, id:string, acl:string[]) {\n        this.mutationRequests.push({op: 'share', table, id, acl});\n        return this;\n    }\n    unshare (table:string, id:string, acl:string[]) {\n        this.mutationRequests.push({op: 'unshare', table, id, acl});\n        return this;\n    }\n    link (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        this.mutationRequests.push({op: 'link', sourceTable, sourceId, targetTable, targetId, label});\n        return this;\n    }\n    link2 (sourceTable:string, sourceId:string, label:string, targetId:string) {\n        this.mutationRequests.push({op: 'link', sourceTable, sourceId, targetId, label});\n    }\n    unlink (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        this.mutationRequests.push({op: 'unlink', sourceTable, sourceId, targetTable, targetId, label});\n        return this;\n    }\n    unlink2 (sourceTable:string, sourceId:string, label:string, targetId:string) {\n        this.mutationRequests.push({op: 'unlink', sourceTable, sourceId, targetId, label});\n        return this;\n    }\n}\n\nexport interface AddRequest {\n    op: 'add';\n    table: string;\n    doc: {id?: string, acl?: string[], name?: string, dateTime?: number};\n}\n\nexport interface PutRequest {\n    op: 'put';\n    table: string;\n    doc: {id: string, name?: string, dateTime?: number};\n}\n\nexport interface DeleteRequest {\n    op: 'delete';\n    table: string;\n    id: string;\n}\n\nexport interface ShareRequest {\n    op: 'share';\n    table: string;\n    id: string;\n    acl: string[];\n}\n\nexport interface UnshareRequest {\n    op: 'unshare';\n    table: string;\n    id: string;\n    acl: string[];\n}\n\nexport interface LinkRequest {\n    op: 'link';\n    sourceTable: string;\n    sourceId: string;\n    targetTable?: string;\n    targetId: string;\n    label: string;\n}\n\nexport interface UnlinkRequest {\n    op: 'unlink';\n    sourceTable: string;\n    sourceId: string;\n    targetTable?: string;\n    targetId: string;\n    label: string;\n}\n\nexport type MutationRequest =\n    AddRequest |\n    PutRequest |\n    DeleteRequest |\n    ShareRequest |\n    UnshareRequest |\n    LinkRequest |\n    UnlinkRequest;\n\nexport interface BatchResponse {\n    newEtags: {[id:string] : string};\n}\n\n","import {BearerProvider, RestClient, BearerTokenInfo} from './restclient';\nimport {IsomorphicEnv} from './isomorphic-env';\nimport {TokenQuery} from './token-query';\nimport {avoidSimultanousCalls} from './utils';\n\nexport interface BearerPersistentStorage {\n    save(id: string, tokenInfo: BearerTokenInfo);\n    load(id: string) : Promise<BearerTokenInfo>;\n}\n\nexport class KedBearerProvider implements BearerProvider {\n    tokenInfo: BearerTokenInfo;\n    client: RestClient;\n    \n    constructor (\n        public isomorphic: IsomorphicEnv,\n        public storage: BearerPersistentStorage,\n        public tokenId:string,\n        public clientId: string,\n        public clientSecret: string,\n        public tokenUrl: string,\n        public tokenQuery: TokenQuery)\n    {\n        this.tokenInfo = {token: null, expires: 0};\n        this.client = new RestClient(isomorphic, \"\", {\n            username: this.clientId,\n            password: this.clientSecret\n        });\n        this.getBearer = avoidSimultanousCalls(this.getBearer.bind(this));\n        this.refreshBearer = avoidSimultanousCalls(this.refreshBearer.bind(this));\n    }\n\n    async getBearer(): Promise<BearerTokenInfo> {\n        const {token, expires} = this.tokenInfo;\n        if (token && expires >= Date.now()) return this.tokenInfo;\n        try {\n            this.tokenInfo = await this.storage.load(this.clientId + \"/\" + this.tokenId);\n            if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now()) return this.tokenInfo;\n            await this.refreshBearer();\n            return this.tokenInfo;\n        } catch (e) {\n            await this.refreshBearer();\n            return this.tokenInfo;\n        }\n    }\n\n    async refreshBearer(): Promise<BearerTokenInfo> {\n        let res: Response;\n        for (let retries=0;retries<6;++retries) {\n            console.log(`Retrieving token for ${this.tokenId}`);\n            res = await this.client.get(this.tokenUrl, this.tokenQuery, {cache: 'reload'});\n            if (res.status !== 200) {\n                console.warn(`Got ${res.status} ${res.statusText}`);\n                continue;\n            }\n            this.tokenInfo = {token: await res.text(), expires: Date.now() + 59 * 60 * 1000};\n            console.log(`Got token for ${this.tokenId}: ${JSON.stringify(this.tokenInfo)}`);\n            this.storage.save(this.clientId + \"/\" + this.tokenId, this.tokenInfo);\n            return this.tokenInfo;\n        }\n        throw new Error(\"Failed to retrieve token for \" + JSON.stringify(this.tokenId));\n    }\n}\n","/*\ndeclare var Buffer; // node built-in\n\n\nfunction basicAuthHeader(username, password) {\n    return \"Basic \" + new Buffer(username + \":\" + password).toString(\"base64\");\n}\n*/\n\nimport {IsomorphicEnv} from './isomorphic-env';\nimport { createUUID } from \"./utils\";\n\nexport interface BearerTokenInfo {\n    token: string;\n    expires: number;\n}\n\nexport interface BearerProvider {\n    getBearer(): Promise<BearerTokenInfo>;\n    refreshBearer(): Promise<BearerTokenInfo>;\n    wantsRedirect?: boolean;\n}\n\nexport class RestClient {\n    authHeader?: string;\n    tokenInfo?: BearerTokenInfo;\n    bearerProvider?: BearerProvider;\n    fetchOptions: RequestInit;\n\n    constructor(\n        public isomorphic: IsomorphicEnv,\n        public baseUrl: string,\n        public options: {\n            username?,\n            password?,\n            bearer?,\n            bearerProvider?: BearerProvider\n        },\n    ) {\n        this.fetchOptions = {mode: 'cors'};\n        this.authHeader = options.bearer ?\n            \"Bearer \" + options.bearer :\n            options.username ?\n                \"Basic \" + isomorphic.btoa(options.username + \":\" + (options.password || \"\")) :\n                null;\n        this.bearerProvider = options.bearerProvider || null;\n    }\n\n    async fetch(path: string, method: string, headers, query?, fetchOptions?: RequestInit): Promise<Response> {\n        if (fetchOptions && fetchOptions.cache === 'no-cache') {\n            // Workaround for back-button not respecting cache control in Chrome/Opera.\n            // Append a query parameter to force a cache entry\n            query = {...query, nocache: createUUID()}\n        }\n        const queryStr = query && Object.keys(query).map(key =>\n            encodeURIComponent(key) +\n            \"=\" +\n            encodeURIComponent(query[key]))\n            .join('&');\n\n        let {authHeader, tokenInfo, bearerProvider} = this;\n\n        // {username, password or bearer} not specified in options, but bearerProvider specified:\n        if (!authHeader && !tokenInfo && bearerProvider) {\n            this.tokenInfo = tokenInfo = await bearerProvider.getBearer();\n        }\n        // Either because we've just specified bearerProvider in options, OR, we've got a 401\n        // in earlier response with www-authenticate: Bearer, and we had a BearerProvider,\n        // so we saved the tokenInfo. Now use it regardless of whether username,password or bearer was given\n        // to options in constructor:\n        if (tokenInfo) {\n            if (tokenInfo.expires < Date.now()) {\n                console.log(\"Token expired. Refresh it:\");\n                this.tokenInfo = tokenInfo = await bearerProvider.refreshBearer();\n            }\n            authHeader = \"Bearer \" + tokenInfo.token;            \n        }\n\n        // In one way or another, we've concluded an Authorization header to use:\n        if (authHeader) {\n            headers.Authorization = authHeader;\n        }\n\n        const url = this.baseUrl + path + (queryStr ? \"?\" + queryStr : \"\");\n        let res: Response = await this.isomorphic.fetch(url, { ...this.fetchOptions, headers, method, ...fetchOptions });\n        if (res.status == 401 && this.bearerProvider) {\n            const wwwauth = res.headers.get(\"www-authenticate\");\n            console.log(`Got ${res.status} from ${this.baseUrl + path}`);\n            if (wwwauth && /Bearer/i.test(wwwauth)) {\n                this.tokenInfo = await this.bearerProvider.refreshBearer();\n                headers.Authorization = \"Bearer \" + this.tokenInfo.token;\n                res = await this.isomorphic.fetch(url, { ...this.fetchOptions, headers, method, ...fetchOptions });\n            }\n        }\n        return res;\n    }\n\n    get(path: string, query?, fetchOptions?: RequestInit) {\n        return this.fetch(path, \"GET\", { Accept: \"application/json; text/plain\" }, query, fetchOptions);\n    }\n\n    post(path: string, data, fetchOptions?: RequestInit): Promise<Response> {\n        return this.fetch(path, \"POST\", {\n            \"Content-Type\": \"application/json\",\n            \"Accept\": \"application/json\"\n        }, null, {...fetchOptions, body: JSON.stringify(data)});\n    }\n\n    delete(path: string, query?, body?, fetchOptions?: RequestInit) {\n        return this.fetch(path, \"DELETE\", { Accept: \"application/json; text/plain\" }, query, {...fetchOptions, body});\n    }\n}\n","\nexport function createUUID() {\n  // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\n  var d = Date.now();\n  var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    var r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n  });\n  return uuid;\n}\n\nexport function avoidSimultanousCalls<T,A>(method: (...args:A[])=>Promise<T>) : (...args:A[])=>Promise<T> {\n  let ongoingPromise: Promise<T> = null;\n  return function() {\n      if (!ongoingPromise) {\n          ongoingPromise = method.apply(this, arguments).then(result=>{\n              ongoingPromise = null;\n              return result;\n          });\n      }\n      return ongoingPromise;\n  }\n}\n","import { KedBackendClient } from '../ked-backend-client';\nimport migrate from './migrate';\n\nexport const KedModelMigratorMixin = (client: KedBackendClient) => {\n    if ((client as any).__migrator_mixed_in) return;\n    (client as any).__migrator_mixed_in = true;\n    \n    const get = client.get;\n    const list = client.list;\n\n    client.get = function (table, id, options) {\n        const include = options && options.include;\n        return get.apply(this, arguments).then(result => {\n            migrate(result, table, include && include.toString().split(','));\n            return result;\n        });\n    }\n\n    client.list = function (table, options) {\n        const include = options && options.include;\n        return list.apply(this, arguments).then(result => {\n            result.forEach(doc => migrate(doc, table, include && include.toString().split(',')));\n            return result;\n        });\n    }\n\n    return client;\n}\n\n","import { Course } from '../../KED.Backend.API/schema';\nimport migrateTask from './migrate-task';\n\nexport default function migrateCourse(course: Course, graphs?: string[]) {\n  if (!course.modules) course.modules = [];\n  course.modules.forEach(module => {\n    if (!module.resources) {\n      module.resources = [];\n    }\n    if (!module.taskIds) {\n      module.taskIds = [];\n    }\n  });\n\n  if (!course.responsibleTeachers) {\n    course.responsibleTeachers = []\n  }\n\n  // Earlier wrong spelling of resources\n  if ('resourses' in (course as any) && !('resources' in (course as any))) {\n    course.resources = (course as any).resourses;\n    delete (course as any).resourses;\n  }\n  if (!course.resources) {\n    course.resources = [];\n  }\n\n  if (graphs) {\n    graphs.forEach(label => {\n      switch (label) {\n        case 'tasks':\n          course.tasks.forEach(task => migrateTask(task));\n          break;\n      }\n    });\n  }\n}\n","import { Task } from '../../KED.Backend.API/schema';\n\nexport default function migrateTask(task: Task) {\n    if (!task.resources) task.resources = [];\n}\n","import * as model from '../../KED.Backend.API/schema';\nimport migrateCourse from './migrate-course';\nimport migrateTask from './migrate-task';\n\nexport default function migrate(doc, table: string, graphs?: string[]) {\n  switch (table) {\n    case \"courses\":\n      migrateCourse(doc, graphs);\n      break;\n    case \"tasks\":\n      migrateTask(doc);\n      break;\n  }\n}\n","var map = {\n\t\"./en-au\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-au.js\": \"./node_modules/moment/locale/en-au.js\",\n\t\"./en-ca\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-ca.js\": \"./node_modules/moment/locale/en-ca.js\",\n\t\"./en-gb\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-gb.js\": \"./node_modules/moment/locale/en-gb.js\",\n\t\"./en-ie\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-ie.js\": \"./node_modules/moment/locale/en-ie.js\",\n\t\"./en-nz\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./en-nz.js\": \"./node_modules/moment/locale/en-nz.js\",\n\t\"./sv\": \"./node_modules/moment/locale/sv.js\",\n\t\"./sv.js\": \"./node_modules/moment/locale/sv.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\tvar module = __webpack_require__(id);\n\treturn module;\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error('Cannot find module \"' + req + '\".');\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./node_modules/moment/locale sync recursive sv|en\";","import { User } from \"../contracts/ked-models\";\n\nexport default function getUserClaims (user: User) {\n  return [{\n    type: \"email\",\n    value: user.mail\n  },{\n    type: \"school\",\n    value: user.school\n  }].concat(user.roles.map(role => ({\n    type: \"role\",\n    value: role\n  }))).concat(user.roles.map(role => ({\n    type: \"schoolRole\",\n    value: user.school + \"/\" + role\n  })));\n}\n","import { AccessClaim, DocumentAccess, hasAccess as _hasAccess, AccessRight } from 'kedbackend/client';\nimport { Document } from 'kedbackend/models';\nimport getUserClaims from './get-user-claims';\nimport env from '../globals/KED.env';\nimport { parseQueryString, generateQueryString } from \"../utils/query-string\";\nexport { getUserClaims };\n\nexport const IMPERSONATION_QUERY_PARAMS = [\"user\",\"role\",\"school\",\"debug\",\"testVersion\",\"testversion\",\"schoolType\",\"schooltype\"];\n\nexport function hasAccess(doc: Document, requestedRight: AccessRight) {\n  var claims = getUserClaims(env.currentUser);\n  var result = _hasAccess(DocumentAccess.fromStringArray(doc.acl || []), claims, requestedRight);\n  //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);\n  return result;\n}\n\nexport function hasReadAccess(doc: Document) {\n  return hasAccess(doc, 'R');\n}\n\nexport function hasWriteAccess(doc: Document) {\n  return hasAccess(doc, 'W');\n}\n\nexport function hasShareAccess(doc: Document) {\n  return hasAccess(doc, 'S');\n}\n\nexport function isTeacherAtSchool(school: string) {\n  const isTeacher = env.currentUser.roles.some(role => role === 'EMPLOYEE' || role === 'ADMIN');\n  const belongsToSchool = (school||\"\").toLowerCase() === env.currentUser.school.toLowerCase();\n  return (isTeacher && belongsToSchool);\n}\n\nexport const impersonationEnv = {\n  actAs (options: {role, school, url?}) {\n    const {role, school, url} = options;\n    const currentQuery = parseQueryString(location.search);\n    const newQuery = {...currentQuery, role, school};\n    const newQueryString = generateQueryString(newQuery);\n    if (url) {\n      location.href = `${url}${newQueryString}`;\n    } else {\n      location.hash = \"#\";\n      location.search = newQueryString;\n    }\n  }\n}\n\nexport function actAs(options: {role, school, url?}) {\n  impersonationEnv.actAs(options);\n}\n\nexport function preserveImpersonationQuery (url: string, query: {[name: string] : string}) {\n  const currentQuery = parseQueryString(location.search);\n  const newQuery = {...query};\n  for (const param of IMPERSONATION_QUERY_PARAMS) {\n    if (currentQuery[param]) newQuery[param] = currentQuery[param];\n  }\n  const newQueryString = generateQueryString(newQuery);\n  return `${url}${newQueryString}`;\n}\n","import { Document, Course, KnowledgeRequirement, CourseModule, Task } from 'kedbackend/models';\nimport { flatten, L } from \"../../../utils/utils\";\n\nexport function getUncoveredKnowledgeRequirements(course: Course) {\n  const uncoveredRequirements = course.knowledgeRequirements.reduce((result, item) => {\n    result[item.id] = item;\n    return result;\n  }, {} as { [id: string]: KnowledgeRequirement });\n\n  course.tasks.forEach(task => {\n    task.knowledgeRequirements.forEach(kr => {\n      delete uncoveredRequirements[kr.id];\n    });\n  });\n\n  return Object.keys(uncoveredRequirements).map(id => uncoveredRequirements[id]);\n}\n\nexport function getIdsNotCoveredByTasks(course: Course) : {[id: string]: true} {\n  const uncoveredIds = {};\n  // 1. Mark the ids of all knowledge requirements, abilities and central content for this course:\n  course.knowledgeRequirements.forEach(r => {\n    uncoveredIds[r.id] = true;\n  });\n  course.abilities.forEach(a => {\n    uncoveredIds[a.id] = true;\n  });\n  course.centralContent.forEach(cc => {\n    uncoveredIds[cc.id] = true;\n  });\n  // 2. List all tasks and unmark all ids that they refer to\n  const { tasks } = course;\n  tasks.forEach(task => {\n    task.knowledgeRequirements.forEach(kr => {\n      delete uncoveredIds[kr.id];\n    });\n    task.abilities.forEach(a => {\n      delete uncoveredIds[a.id];\n    });\n    task.centralContent.forEach(cc => {\n      delete uncoveredIds[cc.id];\n    });\n  });\n  return uncoveredIds;\n}\n\nexport function sanityCheck (course: Course) {\n  function hasDuplicateTasks(course: Course) {\n    const taskIds: {[id:string]: boolean} = {};\n    return flatten(course.modules.map(module => module.taskIds.map(taskId => {\n      if (taskIds[taskId]) {\n        const task = course.tasks.find(t => t.id === taskId);\n        return L`Samma uppgift förekommer flera gånger: \"${task.name}\"`;\n      }\n      taskIds[taskId] = true;\n    }).filter(x => x)));\n  }\n\n  function tasksWithSameUrl(course: Course) {\n    const taskUrls: {[url:string]: Task} = {};\n    return course.tasks.map(task => {\n      if (task.url) {\n        if (taskUrls[task.url]) {\n          return L`Två uppgifter pekar på samma URL: \"${taskUrls[task.url].name}\" samt \"${task.name}\"`;\n        }\n        taskUrls[task.url] = task;\n      }\n    }).filter(x => x);  \n  }\n\n  function hasEmptyModuleNames(course: Course) {\n    return course.modules.some (module => module.name === \"\") &&\n      L`Det finns minst en modul utan angivet namn`;\n  }\n\n  function hasDuplicateModuleNames(course: Course) {\n    const moduleNames: {[name: string]: true} = {};\n    return course.modules.map(module => {\n      if (module.name && moduleNames[module.name]) {\n        return L`Modulen med namn ${module.name} förekommer flera gånger`;\n      }\n      if (module.name) moduleNames[module.name] = true;\n    })\n  }\n\n  const checks = flatten([\n    hasDuplicateTasks(course),\n    tasksWithSameUrl(course),\n    hasEmptyModuleNames(course),\n    hasDuplicateModuleNames(course)\n  ]);\n\n  return checks.filter (result => result);\n}\n\n\nexport function getTasksPerId (course: Course) {\n  const result: {[id: string]: Task[]} = {};\n  function add(id: string, task: Task) {\n    const list = result[id] || (result[id] = []);\n    list.push(task);\n  }\n  course.tasks.forEach(task => {\n    task.abilities.forEach(a => add(a.id, task));\n    task.centralContent.forEach(c => add(c.id, task));\n    task.futureAbilities.forEach(fa => add(fa, task));\n  });\n  return result;\n}\n","import * as React from 'react';\nimport { HashRouter as Router, Route, Link, Redirect } from 'react-router-dom';\nimport { ICourseEditorHost } from \"../interfaces/course-editor-host\";\nimport { Course } from 'kedbackend/models';\nimport { readBlobAsText, allowCopy, readBlobAsDataUrl } from \"../utils\";\nimport { showError, L } from \"../../../utils/utils\";\nimport { createUUID } from \"kedbackend/client\";\nimport { hasAccess } from \"../../../access-control\";\nimport env from '../../../globals/KED.env';\n\ntype Callback = () => void;\n\ninterface Props {\n  title: string,\n  activePage: BannerMenuItem,\n  callbacks?: { [menuName: string]: Callback },\n  routes: { [menuName: string]: string } & { feedback: string },\n  backgroundImage?: string,\n  isTemplate?,\n  host?: ICourseEditorHost,\n  course?: Course,\n  origCourse?: Course\n}\n\ntype BannerMenuItem =\n  \"courseBuilder\" |\n  \"studentPage\" |\n  \"templateBuilder\" |\n  \"subjects\" |\n  \"schools\";\n\nconst AdminMenuItems = [\n  { name: \"schools\", text: L`Skolor`, route: \"/schools\" },\n  { name: \"subjects\", text: L`Ämnen`, route: \"/subjects\" },\n  //{name: \"templateBuilder\", text: L`Mallbyggaren`, route: \"/course-templates\"},\n]\n\nconst NonAdminMenuItems = [\n  { name: \"courseBuilder\", text: L`Kursbyggaren`, route: \"/courses/new\" },\n  { name: \"studentPage\", text: L`Elevsida`, route: \"\" },\n  { name: \"feedback\", text: <span><i className=\"fa fa-commenting-o\" aria-hidden=\"true\"></i> Feedback</span>, route: \"https://kg.kunskapsporten.se/kursbyggaren/\" }\n]\n\n\nasync function onDropImage(ev: React.DragEvent<HTMLDivElement>, host: ICourseEditorHost, course: Course, origCourse: Course) {\n  ev.stopPropagation();\n  ev.preventDefault();\n  const files = ev.dataTransfer.files;\n  let url = null;\n  const items = Array.from(ev.dataTransfer.items);\n  if (files.length > 0) {\n    const file = files[0];\n    if (file.size > 2 * 1024 * 1024) {\n      showError(L`Kan inte ladda upp bilder större än 2 MB`);\n      return;\n    }\n    url = await readBlobAsDataUrl(file);\n  } else {\n    for (let i = 0; i < items.length; ++i) {\n      const item = items[i];\n      if (item.type.match('^text/uri-list')) {\n        // URI\n        url = await new Promise(resolve => item.getAsString(resolve));\n      }\n    }\n  }\n  if (url == null) {\n    showError(L`Kunde inte hitta någon bild i innehållet`);\n    return;\n  }\n  setCourseImage(course, origCourse, host, url);\n}\n\nexport function setCourseImage(\n  course: Course,\n  origCourse: Course,\n  host: ICourseEditorHost,\n  url: string\n) {\n  const imageId = createUUID();\n  host.update({\n    imageId: { $set: imageId },\n    images: {\n      $set: [{\n        id: imageId,\n        url,\n        acl: [\n          `role:USER:R`,\n          `schoolRole:${env.currentUser.school}/EMPLOYEE:S`\n        ],\n        $meta: 'add'\n      }]\n    }\n  });\n}\n\n/* This version had the bug that old images were not replaced.\nOne course at Uppsala contained 12 images.\n\n\nexport function setCourseImageOld(\n  course: Course,\n  origCourse: Course,\n  host: ICourseEditorHost,\n  url: string)\n{\n  if (!origCourse || !origCourse.imageId) {\n    const imageId = createUUID();\n    host.update({\n      imageId: { $set: imageId },\n      images: {\n        $push: [{\n          id: imageId,\n          url,\n          acl: course.isTemplate ? [\"role:USER:R\"] : [\"role:USER:R\", `schoolRole:${env.currentUser.school}/EMPLOYEE:S`],\n          $meta: 'add'\n        }]\n      }\n    });\n  } else {\n    // Update existing image:\n    const imgIdx = course.images.findIndex(img => img.id === course.imageId);\n    if (imgIdx >= 0) {\n      const imageEntity = course.images[imgIdx];\n      if (course.isTemplate) {\n        // Templates: Update the template image content:\n        host.update({\n          images: {\n            $splice: [[imgIdx, 1, {\n              ...imageEntity,\n              url,\n              $meta: 'update'\n            }]]\n          }\n        })\n      } else {\n        // Real courses: Replace with a new image\n        const imageId = createUUID();\n        host.update({\n          imageId: { $set: imageId },\n          images: {\n            $splice: [[imgIdx, 1, {\n              id: imageId,\n              url,\n              acl: [\n                `role:USER:R`,\n                `schoolRole:${env.currentUser.school}/EMPLOYEE:S`\n              ],\n              $meta: 'add'\n            }]]\n          }\n        })\n      }\n    } else {\n      showError(L`Kunde inte uppdatera bilden.`);\n    }\n  }\n}\n*/\n\nexport const CourseBanner = (props: Props) => {\n  const { title, isTemplate, host, course, origCourse, backgroundImage, activePage } = props;\n  const isAdmin = env.currentUser.roles.some(role => role === \"ADMIN\");\n  let menuItems = NonAdminMenuItems;\n  if (isAdmin) menuItems = AdminMenuItems.concat(menuItems);\n\n  return <div className=\"sv-row sv-layout sv-skip-spacer\">\n    <div className=\"sv-layout sv-skip-spacer sv-column-12\">\n      <div className=\"sv-script-portlet sv-portlet sv-skip-spacer\">\n        {backgroundImage && <style>{`\n        .pageHeader {\n          background-image: url('${backgroundImage}') !important;\n        }\n      `}</style>}\n        <div className=\"pageHeader\"\n          onDragOver={course && allowCopy}\n          onDrop={course && (ev => onDropImage(ev, host, course, origCourse))}>\n          <a>\n            <h1>{title}</h1>\n          </a>\n          <div className=\"buttonsField\">\n            <div className=\"buttonsContainer\">\n              <div className=\"align-horizontal\"></div>\n              <div className='horizontalMenu'>\n                <ul>\n                  {menuItems.map(item => ({\n                    item,\n                    isActive: activePage === item.name,\n                    callback: props.callbacks && props.callbacks[item.name],\n                    givenRoute: (props.routes && props.routes[item.name]),\n                    defaultRoute: item.route\n                  })).filter(x => x.callback || x.defaultRoute || x.givenRoute).map(({ item, isActive, callback, defaultRoute, givenRoute }) => {\n                    return <li\n                      key={item.name}\n                      className={isActive ? \"activePage\" : \"\"}\n                      onClick={callback}\n                    >\n                      {callback ?\n                        <a>{item.text}</a> :\n                        defaultRoute || givenRoute ?\n                          givenRoute || /^http[s]\\:\\/\\//i.test(defaultRoute) ?\n                            <a href={givenRoute || defaultRoute}>{item.text}</a> :\n                            <Link to={defaultRoute}>{item.text}</Link> :\n                          <a>{item.text}</a>}\n                    </li>;\n                  })}\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n}\n","import * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { Course, CourseModule, Image, Task, Document, Ability } from 'kedbackend/models';\nimport { createUUID } from 'kedbackend/client';\nimport $ from 'jquery';\nimport update from 'react-addons-update';\nimport { ICourseEditorHost } from '../interfaces/course-editor-host';\nimport { CourseModuleComponent } from './course-module';\n\ninterface Props {\n  course: Course;\n  host: ICourseEditorHost;\n  idsNotCoveredByAnyTask: {[id: string]: true};\n}\n\ninterface State {\n}\n\nexport class CourseModuleList extends React.Component<Props,State> {\n  _elem: HTMLDivElement;\n  _moduleRefs: {[moduleId: string]: CourseModuleComponent};\n\n  constructor(props: Props) {\n    super(props);\n    this._moduleRefs = {};\n    this.state = {\n    }\n  }\n\n  addModule() {\n    this.props.host.update({modules: {$push: [{\n      name: \"Ny kursmodul\",\n      id: createUUID(),\n      resources: [],\n      taskIds: []\n     } as CourseModule\n    ]}});\n  }\n\n  getOrderedModules() {\n    const { course } = this.props;\n    const moduleOrder = course.moduleOrder || course.modules.map(m => m.id);\n    return moduleOrder\n      // Map ordered id to module\n      .map(id => course.modules.find(m => m.id === id))\n      // Ignore entries that only exists in moduleOrder but not in modules\n      .filter(m => !!m)\n      // Append modules at end that are not listed in moduleOrder\n      .concat (course.modules.filter(m => !moduleOrder.find(id => m.id === id)));\n  }\n\n  async reorder (moduleId: string, direction: -1 | 1) {\n    const { course } = this.props;\n    const orderedModules = this.getOrderedModules();\n    const moduleIndex = orderedModules.findIndex(m => m.id === moduleId);\n    const newModuleIndex = moduleIndex + direction;\n    if (newModuleIndex < 0 || newModuleIndex >= orderedModules.length) {\n      // Cannot order outside limits.\n      return;\n    }\n    const currentModuleAtPosition = orderedModules[newModuleIndex];\n    const moduleOrder = orderedModules.map(m => m.id);\n    moduleOrder[newModuleIndex] = moduleId;\n    moduleOrder[moduleIndex] = currentModuleAtPosition.id;\n    const origScrollPos = document.documentElement.scrollTop;\n    await this.props.host.update({\n      moduleOrder: {$set: moduleOrder}\n    });\n    // Now, scroll smoothly into view after reordering:\n    const elemModule: HTMLElement = findDOMNode(this._moduleRefs[moduleId]);\n    if (elemModule) {\n      try {\n        window.scrollTo({top: origScrollPos}); // Prohibit default scrolling directly upwards on move up.\n        elemModule.scrollIntoView({behavior: 'smooth', block: 'start'});\n      } catch (e) {\n        // Only Chrome beta supports the arguments given above. Default for older browsers.\n        window.scrollTo(null, origScrollPos);\n        elemModule.scrollIntoView(true);\n      }\n    }\n  }\n\n  render() {\n    const { course, host, idsNotCoveredByAnyTask} = this.props;\n    const moduleOrder = course.moduleOrder || course.modules.map(m => m.id);\n    const orderedModules = this.getOrderedModules();\n\n    return <div className=\"sv-html-portlet sv-portlet\" ref={elem => this._elem = elem}>\n      {orderedModules.map(module => <CourseModuleComponent\n        ref={elem => this._moduleRefs[module.id] = elem}\n        key={module.id}\n        course={course}\n        module={module}\n        onReorder={direction => this.reorder(module.id, direction)}\n        getOrderedModules={()=>this.getOrderedModules()}\n        host={host}\n        idsNotCoveredByAnyTask={idsNotCoveredByAnyTask}\n       />)}\n      <div className=\"btn btn-large\" onClick={()=>this.addModule()}>\n        Lägg till kursmodul\n      </div>\n    </div>\n  }\n}\n\n","import * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { Course, CourseModule, Image, Task, Document, Ability } from 'kedbackend/models';\nimport $ from 'jquery';\nimport { EditableResourceList } from '../sub-components/editable-resource-list';\nimport { EditableTaskList } from '../sub-components/editable-task-list';\nimport update from 'react-addons-update';\nimport { ICourseEditorHost } from '../interfaces/course-editor-host';\nimport { RenameableText } from '../../utility-components/renameable-text';\nimport { RemoveItem } from '../sub-components/remove-item';\nimport { createUUID } from 'kedbackend/client';\nimport { L, showError } from \"../../../utils/utils\";\nimport moment from 'moment';\nimport { Wysiwyg } from '../../utility-components/wysiwyg';\nimport actions_swedish from '../../utility-components/wysiwyg/actions-sv';\nimport { OpenCloseBox } from '../../utility-components/open-close-box';\n\ninterface Props {\n  course: Course;\n  module: CourseModule;\n  host: ICourseEditorHost;\n  idsNotCoveredByAnyTask: {[id: string]: true};\n  onReorder: (direction: 1 | -1) => void;\n  getOrderedModules: ()=>CourseModule[];\n}\n\ninterface State {\n  editMandatoryContent: boolean;\n}\n\nconst DEFAULT_KNOWLEDGE_MATRIX = [{\n  abilityIds: [],\n  EIds: [],\n  CIds: [],\n  AIds: []\n}];\n\nexport class CourseModuleComponent extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      editMandatoryContent: false\n    }\n  }\n\n  getModuleIndex() {\n    const {course, module} = this.props;\n    return course.modules.findIndex(m => m.id === module.id);\n  }\n\n  getModuleOrderIndex() {\n    const {course, module} = this.props;\n    const orderedModules = this.props.getOrderedModules();\n    return orderedModules.findIndex(m => m.id === module.id);\n  }\n\n  updateModule(moduleUpdates) {\n    const {module} = this.props;\n    const updatedModule = update(module, moduleUpdates);\n    const moduleIndex = this.getModuleIndex();\n    this.props.host.update({ modules: { $splice: [[moduleIndex, 1, updatedModule]] } });\n  }\n\n  /* This method works for both adding new tasks to the task table\n  and adding references to existing tasks. The magic of that has to do with\n  whether task.$meta = 'add' or not and is done in EditCourse.save()\n  */\n  onTaskAdded (task: Task, taskCustomization: Partial<Task> | null) {\n    // Add task ID to module taskIds list:\n    const courseUpdates:any = {};\n    const taskIds = this.props.module.taskIds.slice();\n    taskIds.push(task.id);\n    // Add physical Task to Course.tasks.\n    if (!this.props.course.tasks.some(t => t.id ===task.id)) {\n      courseUpdates.tasks = {$push: [task]};\n    }\n    const customizations = {...(this.props.module.taskCustomizations || {})};\n    if (taskCustomization) customizations[task.id] = taskCustomization;\n    const moduleIndex = this.getModuleIndex();\n    courseUpdates.modules = {};\n    courseUpdates.modules[moduleIndex] = {\n      taskIds: {$set: taskIds},\n      taskCustomizations: {$set: customizations}\n    };\n    // Update module\n    this.props.host.update(courseUpdates);\n  }\n\n  onTaskUpdated (task: Task) {\n    if (!task.$meta) throw new Error(L`Hoppsan, blev lite knas. Fel ID: ${'Pa7Dq'}`);\n    const taskIndex = this.props.course.tasks.findIndex(t => t.id === task.id);\n    if (taskIndex >= 0) {\n      this.props.host.update({tasks: {$splice: [[taskIndex, 1, task]]}});\n    }\n  }\n\n  onTaskCustomized (taskId: string, customization: Partial<Task>) {\n    const customizations = {...(this.props.module.taskCustomizations || {})};\n    customizations[taskId] = customization;\n    this.updateModule({taskCustomizations: {$set: customizations}});\n  }\n\n  onTaskDeleted (id: string) {\n    // Remove task ID from module taskIds list.\n    // This depends on the fact that EditCourse._setState() maintains\n    // removed Task links (which it actually does (or should do at least)).\n    this.updateModule({\n      taskIds: {$set: this.props.module.taskIds.filter(tid => tid !== id)},\n      taskCustomizations: {\n        $apply: customizations => {\n          const copy = {...customizations};\n          delete copy[id];\n          return copy;\n        }\n      }\n    });\n  }\n\n  onTaskReplaced (id: string, task: Task) {\n    const idxTask = this.props.module.taskIds.indexOf(id);\n    if (idxTask < 0) {\n      showError(L`Kunde inte spara uppgift. Felkod d72kQ`);\n      return;\n    }\n    const moduleUpdates = {\n      // Replace old id with new id:\n      taskIds: {$splice: [[idxTask, 1, task.id]]},\n      taskCustomizations: {\n        $apply: customizations => {\n          const copy = {...customizations};\n          delete copy[id];\n          return copy;\n        }\n      }\n    }\n    const updatedModule = update(this.props.module, moduleUpdates);\n    const moduleIndex = this.getModuleIndex();\n    this.props.host.update({\n      // Apply moduleUpdates from above:\n      modules: { $splice: [[moduleIndex, 1, updatedModule]] },\n      // Add the new task to Course.tasks.\n      // Don't remove the old one! Why? Because it may be referenced\n      // by another module in same course! Let EditCourse._setState()\n      // do the \"garbage collection\" instead.\n      tasks: { $set: this.props.course.tasks.concat(task)}\n    });\n  }\n\n  render() {\n    const { course, host, module, idsNotCoveredByAnyTask } = this.props;\n    const moduleIndex = this.getModuleIndex();\n    const moduleOrderedIndex = this.getModuleOrderIndex();\n    let knowledgeMatrixDiv;\n\n    const updateModule = this.updateModule.bind(this);\n    let week = 1;\n    const startWeekOptions = [\"--\"];\n    const endWeekOptions = [\"--\"];\n    for (let i=0; i<51; ++i) {\n      startWeekOptions.push(''+ week);\n      endWeekOptions.push(''+ ++week);\n    }\n\n    return <div className=\"course-module ked_boxed\" style={{position: 'relative'}}>\n      <h3><RenameableText eager={true}\n        clickAdvertiseText=\"Namnlös modul\"\n        maxChars={100}\n        text={module.name}\n        onChange={newName => updateModule({name: {$set: newName}})} />\n      </h3>\n      <div className=\"align-horizontal spaced\">\n        <div className=\"horizontalItem center\">\n          <p>Startvecka</p>\n        </div>\n        <div className=\"horizontalItem center\">\n          <select value={module.startWeek || \"--\"}\n            onChange={ev => updateModule({startWeek: {\n              $set: ev.target.value === '--' ?\n                undefined :\n                parseInt(ev.target.value)\n            }\n          })}>\n            {startWeekOptions.map(o => <option key={o} value={o}>{o}</option>)}\n          </select>\n        </div>\n        <div className=\"horizontalItem center\">\n          <p>Slutvecka</p>\n        </div>\n        <div className=\"horizontalItem center\">\n          <select value={module.endWeek || \"--\"}\n            onChange={ev => updateModule({endWeek: {\n              $set: ev.target.value === '--' ?\n                undefined :\n                parseInt(ev.target.value)\n            }\n          })}>\n            {endWeekOptions.map(o => <option key={o} value={o}>{o}</option>)}\n          </select>\n        </div>\n      </div>\n      <h4>Kursmodulens introduktion</h4>\n      <Wysiwyg\n        actions={[\n          \"bold\",\n          \"italic\",\n          \"underline\",\n          \"strikethrough\",\n          \"heading2\",\n          \"heading3\",\n          \"olist\",\n          \"ulist\",\n          \"line\",\n          \"link\",\n          \"image\"]}\n        defaultActions={actions_swedish}\n        html={module.mandatoryContent}\n        onChange={html => {\n          updateModule({mandatoryContent: {$set: html}})\n        }} />\n\n      <h4>Uppgifter</h4>\n      <EditableTaskList\n        taskIds={module.taskIds}\n        taskCustomizations={module.taskCustomizations}\n        course={course}\n        module={module}\n        host={host}\n        idsNotCoveredByAnyTask={idsNotCoveredByAnyTask}\n        onTaskAdded={(task: Task, taskCustomization: Partial<Task>) => this.onTaskAdded(task, taskCustomization)}\n        onTaskUpdated={(task: Task) => this.onTaskUpdated(task)}\n        onTaskCustomizationUpdated={(taskId: string, customization: Partial<Task>) =>\n          this.onTaskCustomized(taskId, customization)}\n        onTaskDeleted={(id: string) => this.onTaskDeleted(id)}\n        onTaskReplaced={(id: string, task: Task) => this.onTaskReplaced(id, task)} />\n\n      <h4>Modulresurser</h4>\n      <p className=\"subHeader\">(Eventuella resuser för redovisning av modulen samt för modulen som helhet)</p>\n      <EditableResourceList\n        resources={module.resources}\n        onUpdate={resourcesUpdates => updateModule({ resources: resourcesUpdates })}\n        host={host} />\n      <div style={{position: 'absolute', top: 0, right: 0}}>\n        {moduleOrderedIndex > 0 && <span>\n          <i className=\"fa fa-arrow-circle-up selectable\"\n            aria-hidden=\"true\"\n            onClick={()=>this.props.onReorder(-1)} /> </span>}\n        {moduleOrderedIndex < course.modules.length - 1 && <span>\n          <i className=\"fa fa-arrow-circle-down selectable\"\n            aria-hidden=\"true\"\n            onClick={()=>this.props.onReorder(1)} /> </span>}\n        <RemoveItem\n          title=\"Ta bort modulen\"\n          style={{display: 'inline-block'}}\n          onClick={()=>confirm(L`Ta bort modul ${module.name}?`) && host.update({modules: {$splice: [[moduleIndex, 1]]}})} />\n      </div>\n    </div>\n  }\n}\n\n","import * as React from 'react';\nimport { CourseBanner } from \"./course-banner\";\nimport { L, showError, flatten, compareProp, showInfo, maxLength, capitalizeFirst } from \"../../../utils/utils\";\nimport { Course, Subject } from \"kedbackend/models\";\nimport env from '../../../globals/KED.env';\nimport { Link } from 'react-router-dom';\nimport { Spinner } from \"../sub-components/spinner\";\nimport { SchoolCourses } from \"../sub-components/school-courses\";\n\ninterface Props {\n  feedbackUrl: string;\n}\n\ninterface State {\n  courseOptions: CourseOption[];\n  selectedTemplateId: string;\n  courses: CourseOption[] | null;\n  selectedCourseId: string;\n}\n\ninterface CourseOption {\n  id: string;\n  name: string;\n}\n\nexport class CreateNewCourse extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      courseOptions: null,\n      selectedTemplateId: \"--\",\n      courses: null,\n      selectedCourseId: \"\"\n    }\n  }\n\n  componentDidMount() {\n    this.load().catch(showError);\n  }\n\n  async load() {\n    showInfo(\"Laddar kurser\");\n    const subjects = await env.kedBackendClient.list<Subject>(\"subjects\", { include: \"courseTemplates\" });\n    const courses = flatten(subjects.map(s => s.courseTemplates)).sort(compareProp(\"name\"));\n    const courseOptions: CourseOption[] =\n      [{ id: \"--\", name: \"--\" }].concat(courses);\n    showInfo(\"\");\n    this.setState({ courseOptions });\n  }\n\n  async onSelectCourse(id: string) {\n    const derivedCourses = await env.kedBackendClient.list<Course>(\"courses\", { hasEdgesTo: [id] });\n    const courseOptions = derivedCourses\n      .filter(course => course.active)\n      .map(({ id, school, description, createdBy, modifiedBy }) => {\n        if (description) description = maxLength(description, 80);\n        let descriptionOrAuthor = description ||\n          (createdBy ? `${createdBy.name}s version` :\n          modifiedBy && `${modifiedBy.name}s version`);\n        return {\n          id,\n          name: school === 'standard' ?\n            description ? `Standard - ${description}` : \"Standard\" :\n            `${school} - ${maxLength(descriptionOrAuthor, 90)}`,\n          school\n        };\n      }).sort(compareProp(\"name\"));\n    const kedStandardOptions = courseOptions.filter(option => option.school === \"standard\");\n    const teacherMade = courseOptions.filter(option => option.school !== \"standard\");\n    const courses = [\n      ...kedStandardOptions,\n      { id, name: \"Tom\" },\n      ...teacherMade];\n    this.setState({\n      courses,\n      selectedTemplateId: id,\n      selectedCourseId: courses[0].id\n    });\n  }\n\n  render() {\n    const { courseOptions, selectedTemplateId, courses, selectedCourseId } = this.state;\n    return <div style={{ outline: 0 }}>\n      <CourseBanner\n        title={L`Kursbyggaren`}\n        activePage=\"courseBuilder\"\n        routes={{feedback: this.props.feedbackUrl}}\n      />\n      <div className=\"sv-row sv-layout\">\n        <div className=\"sv-layout sv-skip-spacer sv-column-12\">\n          <div className=\"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer\">\n            <div className=\"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer\">\n\n              <div className=\"sv-row sv-layout sv-skip-spacer\">\n                <div className={\"sv-layout sv-skip-spacer sv-column-7\"}>\n                  <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n                    <h2>Skapa ny kurs</h2>\n                    <hr />\n                    <div className=\"align-horizontal spaced\">\n                      <div className=\"horizontalItem top\">\n                        <p>Välj gymnasiekurs :</p>\n                      </div>\n                    </div>\n                    <div className=\"align-horizontal spaced\">\n                      <div className=\"horizontalItem top\">\n                        {!courseOptions ?\n                          <div><Spinner /><select disabled value=\"\"><option>--</option></select></div> :\n                          <select\n                            value={this.state.selectedTemplateId}\n                            onChange={ev => this.onSelectCourse(ev.target.value).catch(showError)}\n                          >\n                            {courseOptions.map(course =>\n                              <option key={course.id} value={course.id}>{course.name}</option>\n                            )}\n                          </select>}\n                      </div>\n                    </div>\n                    {courses && <div className=\"align-horizontal spaced\">\n                      <div className=\"horizontalItem top\">\n                        <p>Utgå från version: </p>\n                      </div>\n                    </div>}\n                    {courses && <div className=\"align-horizontal spaced\">\n                      <div className=\"horizontalItem top\">\n                        <select value={selectedCourseId} onChange={ev => this.setState({\n                          selectedCourseId: ev.target.value\n                        })}>\n                          {courses.map(course =>\n                            <option key={course.id} value={course.id}>{course.name}</option>\n                          )}\n                        </select>\n                      </div>\n                    </div>}\n                    <br /><br />\n                    {courses && selectedCourseId && <Link\n                      to={`/courses/create-from-template/${this.state.selectedCourseId}`}\n                      className=\"btn btn-large\"\n                    >Skapa</Link>}\n                  </div>\n                </div>\n                <div className=\"sv-layout sv-column-5\">\n                  <SchoolCourses />\n                </div>\n              </div>\n\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  }\n}","import * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { L, showInfo, showError, flatten, compareProp } from '../../../utils/utils';\nimport { Course, Resource, KnowledgeRequirement, Subject, Ability, Task, School } from 'kedbackend/models';\nimport { BatchRunner, HttpError, createUUID } from 'kedbackend/client';\nimport env from '../../../globals/KED.env';\nimport { CourseBanner } from './course-banner';\nimport { InnerEditCourse } from './inner-edit-course';\nimport moment from 'moment';\nimport update from 'react-addons-update';\nimport { updateDocumentGraphs, applyEtags, updateCourseBuilderStatus, loadCourse, updateModificationAndCreationStamps, updateCreationStamp, updateModificationStamp } from '../utils';\nimport { ICourseEditorHost, Dialog, DialogContainer } from '../interfaces/course-editor-host';\nimport { RemoveItem } from '../sub-components/remove-item';\nimport $ from 'jquery';\nimport { getUncoveredKnowledgeRequirements, getIdsNotCoveredByTasks } from './business-logic';\nimport cfg from '../../../globals/KED.cfg';\nimport { Spinner } from \"../sub-components/spinner\";\nimport { mySchoolCoursesRepo } from '../../../repos/school-courses';\nimport { preserveImpersonationQuery } from \"../../../access-control\";\n\nconst catcher = cfg.ENVIRONMENT === 'production' ?\n  showError : null;\n\ninterface Props {\n  id?: string;\n  subjectId?: string;\n  isTemplate?: boolean;\n  templateId?: string;\n  view?: 'studentPage' | 'courseBuilder' | 'templateBuilder';\n  viewCourseUrl: string;\n  feedbackUrl: string;\n}\n\ninterface State {\n  origCourse: Course | null;\n  origTemplate: Course | null;\n  course: Course;\n  allCourses?: Course[];\n  dialogContainers: DialogContainer[]; // When editing items, it may show as a dialog\n  hasUnsavedData: boolean;\n  view: 'studentPage' | 'courseBuilder' | 'templateBuilder';\n}\n\nconst CONFIRM_NAVIGATE_MESSAGE =\n  L`Du har osparat data. Välj avbryt och tryck CTRL+S om du vill spara först.`;\n  \nconst DEFAULT_STATE: State = {\n  origCourse: null,\n  origTemplate: null,\n  course: null,\n  dialogContainers: [],\n  hasUnsavedData: false,\n  view: 'courseBuilder'\n};\n\nexport class EditCourse extends React.Component<Props,State> implements ICourseEditorHost {\n  pageYOffset: number;\n  contentDiv: HTMLDivElement;\n  contentYPos: number;\n  isSaving: boolean;\n  dialogs: Dialog[];\n\n  setStatePromised (state: Partial<State>) : Promise<any> {\n    return this._setState({hasUnsavedData: true, ...state});\n  }\n\n  setNonSaveableDataState (state: Partial<State>) : Promise<any> {\n    return this._setState(state);\n  }\n\n  _setState (state: Partial<State>) : Promise<any> {\n    if (state.course) {\n      {\n        //\n        // Maintain course task links (remove links to tasks that are not used\n        // by any module)\n        //\n        const {tasks, modules} = state.course;\n        const usedTaskIds = {};\n        modules.forEach(module => module.taskIds.forEach(id => usedTaskIds[id] = true));\n        const filteredCourseTasks = tasks.filter(t => usedTaskIds[t.id]);\n        const modifiedCourse = {...state.course};\n        modifiedCourse.tasks = filteredCourseTasks;\n        state = {...state, course: modifiedCourse};\n      }\n    }\n\n    // Invoke our course into state property allCourses so that the\n    // right-hand side list of courses gets update immediately with\n    // the publishable state of this course.\n    let allCourses = state.allCourses || this.state.allCourses;\n    const course = state.course || this.state.course;\n    if (allCourses) {\n      const idxOurCourse = allCourses.findIndex(c => c.id === this.props.id);\n      allCourses = update(allCourses, {$splice: [[idxOurCourse, 1, course]]});\n      state = {...state};\n      state.allCourses = allCourses;\n    }\n\n    return new Promise(resolve => super.setState(()=>state as State, resolve));\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {...DEFAULT_STATE};\n    this.update = this.update.bind(this);\n    this.refDialog = this.refDialog.bind(this);\n    this.contentYPos = 0;\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.beforeUnload = this.beforeUnload.bind(this);\n    this.onClickPreventUnload = this.onClickPreventUnload.bind(this);\n    this.isSaving = false;\n    this.dialogs = [];\n    if (props.view) this.state = {\n      ...this.state,\n      view: props.view\n    };\n  }\n\n  componentWillMount() {\n    this.load().catch(catcher);\n    window.addEventListener('keydown', this.onKeyDown);\n    window.addEventListener('beforeunload', this.beforeUnload);\n    document.body.addEventListener('click', this.onClickPreventUnload);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onKeyDown);\n    window.removeEventListener('beforeunload', this.beforeUnload);\n    document.body.removeEventListener('click', this.onClickPreventUnload);\n    updateCourseBuilderStatus('');\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (this.state && this.state.course) {\n      if (nextProps.id !== this.props.id || nextProps.templateId !== this.props.templateId) {\n        this.setStatePromised(DEFAULT_STATE);\n      }\n    }\n    if (nextProps.view !== this.props.view) {\n      this.setNonSaveableDataState({view: nextProps.view});\n    }\n  }\n\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    if (this.contentDiv) {\n      const contentDiv: HTMLDivElement = findDOMNode(this.contentDiv);\n      if (contentDiv) {\n        this.contentYPos = contentDiv.getBoundingClientRect().top;\n      }\n    }\n\n    if (prevState && prevState.course) {\n      // This was not the initial update.\n      // If props have been updated to point out another course or template, reset component:\n      if (this.props.id !== prevProps.id || this.props.templateId !== prevProps.templateId) {\n        this.load().catch(catcher);\n      }\n    }\n\n    if (!prevState.hasUnsavedData && this.state.hasUnsavedData) {\n      updateCourseBuilderStatus('unsaved');\n    }\n  }\n\n  async loadFromTemplate(templateId: string) {\n    showInfo(\"Laddar data från mall...\");\n    const template = await loadCourse(templateId, {includeTemplateChain: true});\n    const course = updateCreationStamp(Date.now(), template, env.currentUser);\n    course.id = createUUID();\n    course.parentId = templateId;\n    course.active = false;\n    course.isTemplate = false;\n    course.templateChain = [...course.templateChain];\n    course.templateChain.push({id: templateId, $meta: 'ref'} as Course);\n    const mySchool = env.currentUser.school;\n    course.school = mySchool;\n    course.description = \"\";\n    course.responsibleTeachers = [];\n    course.acl = [\n      \"role:USER:R\", // All users may view it. (Could have restricted it to school, but not nescessary!)\n      `schoolRole:${mySchool}/EMPLOYEE:S` // Other teachers at same school should be able to modify the course.\n    ];\n    delete course.$etag;\n    delete course.createdBy;\n    delete course.createdDate;\n    delete course.modifiedBy;\n    delete course.modifiedDate;\n    delete course.activatedBy;\n    delete course.activatedDate;\n    delete course.googleClassRoomCode;\n    delete course.googleClassRoomURL;\n    await this.setStatePromised({ course, origCourse: null, origTemplate: template });\n    showInfo(\"\");\n  }\n\n  async load() {\n    updateCourseBuilderStatus('');\n    if (this.props.id) {\n      await this.loadExistingCourse(this.props.id);\n    } else if (this.props.templateId) {\n      await this.loadFromTemplate(this.props.templateId);\n    } else {\n      throw new Error(L`Ogiltig parameter. id eller templateId måste anges`);\n    }\n  }\n\n  async loadExistingCourse(courseId: string) {\n    showInfo(\"Laddar kurs\");\n    const course = await loadCourse(courseId);\n    if (!course.responsibleTeachers) course.responsibleTeachers = [];\n    await this.setNonSaveableDataState({ course, origCourse: course });\n    showInfo(\"\");\n  }\n\n  async update(courseUpdates) {\n    await this.setStatePromised({ course: update(this.state.course, courseUpdates) });\n  }\n\n  async deleteCourse() {\n    showInfo(\"Raderar kursen...\");\n    const courseSchool = this.state.course.school;\n    const parentId = this.state.course.parentId;\n    const courseId = this.props.id;\n\n    const children = await env.kedBackendClient.list<Course>(\"courses\", {\n      hasEdgesTo: [this.props.id]\n    });\n    const br = new BatchRunner();\n    for (const childCourse of children) {\n      /* CANNOT DO THIS. MAY NOT HAVE ACCESS! if (childCourse.parentId === courseId) {\n        // Reconnect child with my parent instead, as I will be disappearing...\n        childCourse.parentId = parentId;\n        br.put(\"courses\", childCourse);\n      }*/\n    }\n\n    br.delete(\"courses\", courseId);\n    await env.kedBackendClient.batch(br.mutationRequests);\n    if (courseSchool === env.currentUser.school) {\n      mySchoolCoursesRepo.delete(courseId);\n    }\n    showInfo(\"\");\n    location.hash = \"#/courses/new\";\n  }\n\n  async save () {\n    if (this.isSaving) return;\n    try {\n      this.isSaving = true;\n      await this._save();\n    } catch (err) {\n      let errorMessage = err && err.message ? err.message : L`Ett okänt fel har inträffat...`;\n      if (err) {\n        if (err.name === 'http409' || err.name === 'http412' || err.name === 'http404') {\n          // Conflict. Show a nicer error message:\n          errorMessage = L`Kursen har redigerad av annan användare. Ladda om sidan och gör om ändrinarna.`;\n        } else if (err.name === 'http403') {\n          if (this.state.course.isTemplate)\n            errorMessage = L`Ingen behörighet att spara kursmallen. Endast administratörer kan redigera kursmallar.`;\n          else if (this.state.course.school)\n            errorMessage = L`Ingen behörighet att spara kursen ${this.state.course.name}. Kursen kan bara redigeras av anställda på ${this.state.course.school}`;\n        }\n      }\n      showError(errorMessage);\n      updateCourseBuilderStatus('error');\n    } finally {\n      this.isSaving = false;\n    }\n  }\n\n  private async _save() {\n    const { course, origCourse, origTemplate } = this.state;\n    const doesAllTasksCoverAllRequirements = getUncoveredKnowledgeRequirements(course).length === 0;\n\n    showInfo(L`Sparar...`);\n    let modifiedCourse: Course = updateModificationStamp(Date.now(), course, env.currentUser);\n\n    const batch = new BatchRunner();\n\n    // Resolve manipulated graphs of each task and remove $meta, generate UUID etc for\n    // each added / updated task.\n    // The result of this operation is two-fold:\n    //  1) Remove $meta and create id for each task. To be reflected into next state.\n    //  2) Generate mutation requests into 'batch' to include in the single batch request to the server.\n    const orig = origCourse || origTemplate;\n    const newCourseTasks = modifiedCourse.tasks.map(task => {\n      if (task.$meta === 'add' || task.$meta === 'update') {\n        const origTask = orig.tasks.find(t => t.id === task.id);\n        return updateDocumentGraphs(origTask || {}, task, \"tasks\", {\n          knowledgeRequirements: 'knowledge-requirements',\n          centralContent: 'central-content',\n          abilities: 'abilities'\n        }, batch);\n      } else {\n        const updatedTask = {...task};\n        delete updatedTask.$meta;\n        return updatedTask;\n      }\n    });\n    modifiedCourse = update(modifiedCourse, {tasks: {$set: newCourseTasks}});\n\n    modifiedCourse = updateDocumentGraphs(origCourse || {}, modifiedCourse, 'courses', {\n      templateChain: 'courses',\n      centralContent: 'central-content',\n      knowledgeRequirements: 'knowledge-requirements',\n      abilities: 'abilities',\n      images: 'images',\n      tasks: 'tasks'\n    }, batch);\n\n    modifiedCourse = {...modifiedCourse };\n    modifiedCourse.publishable = doesAllTasksCoverAllRequirements;\n    const tags = (modifiedCourse.tags || []).filter(tag => tag !== 'incomplete');\n    modifiedCourse.tags = modifiedCourse.publishable ?\n      tags : tags.concat(\"incomplete\");\n\n    if (!origCourse) {\n      // A new course should be added:\n      batch.add('courses', modifiedCourse);\n      if (course.school) {\n        const schoolId = await mySchoolCoursesRepo.getSchoolId();\n        batch.link(\"schools\", schoolId, \"courses\", course.id, \"courses\");\n        if (course.active) {\n          batch.link(\"schools\", schoolId, \"courses\", course.id, \"activeCourses\");\n        }\n      }\n    } else {\n      // An existing course should be updated:\n      batch.put('courses', modifiedCourse);\n      if (!origCourse.active && course.active) {\n        // Course was activated. Add a reference to the course on school.activeCourses.\n        const schoolId = await mySchoolCoursesRepo.getSchoolId();\n        batch.link(\"schools\", schoolId, \"courses\", course.id, \"activeCourses\");\n      } else if (origCourse.active && !course.active) {\n        // Course was inactivated. Remove from school.activeCourses.\n        const schoolId = await mySchoolCoursesRepo.getSchoolId();\n        batch.unlink(\"schools\", schoolId, \"courses\", course.id, \"activeCourses\");\n      }\n    }\n\n    // Perform the entire batch through a single POST request:\n    const res = await env.kedBackendClient.batch(batch.mutationRequests);\n    showInfo (origCourse ?\n      L`Ändringarna har sparats` :\n      L`Kursen har skapats`);\n    // Update state to reflect what has been posted:\n    if (res && res.newEtags)\n        modifiedCourse = applyEtags(modifiedCourse, res.newEtags, [\"images\", \"tasks\"]) as Course;\n    \n    if (course.school === env.currentUser.school) {\n      // Update mySchoolCoursesRepo\n      if (!origCourse) {\n        mySchoolCoursesRepo.insert(modifiedCourse);\n      } else {\n        mySchoolCoursesRepo.update(modifiedCourse);\n      }\n    }\n\n    await this.setNonSaveableDataState({course: modifiedCourse, origCourse: modifiedCourse, hasUnsavedData: false});\n    updateCourseBuilderStatus('');\n    if (!origCourse) {\n      // This was the creation of a new course. Correct the route now when the user enters an edit state:\n      location.hash = `#/courses/${modifiedCourse.id}/edit`;\n    }\n  }\n\n  activateAndSave() {\n    const course = {...this.state.course};\n    if (!course.active) {\n      /*const uncoveredRequirements = getUncoveredKnowledgeRequirements(course);\n      if (uncoveredRequirements.length > 0) \n        return showError (L`Det finns kunskapskrav som inte uppfylls av någon modul. Kan inte aktivera kursen förrän alla kunskapskrav finns med.`);\n      */\n\n      course.active = true;\n      course.activatedBy = {\n        name: env.currentUser.displayName,\n        url: \"mailto:\" +  env.currentUser.mail\n      };\n      course.activatedDate = Date.now();\n      this.setStatePromised({course})\n        .then(()=>this.save())\n        .catch(catcher);\n    }\n  }\n\n  inactivateAndSave() {\n    const course = {...this.state.course};\n    if (course.active) {\n      course.active = false;\n      course.inactivatedBy = {\n        name: env.currentUser.displayName,\n        url: \"mailto:\" +  env.currentUser.mail\n      };\n      course.inactivatedDate = Date.now();\n      this.setStatePromised({course})\n        .then(()=>this.save())\n        .catch(catcher);\n    }\n  }\n\n  openDialog(dialogContainer: DialogContainer) {\n    this.setNonSaveableDataState({dialogContainers: this.state.dialogContainers.concat(dialogContainer)});\n  }\n\n  closeDialog() {\n    const {dialogContainers} = this.state;\n    const {length} = dialogContainers;\n    length && this.setNonSaveableDataState({dialogContainers: dialogContainers.slice(0, length - 1)});\n    // Now sync the direct 'dialogs' property with the new state:\n    while (this.dialogs.length >= length) this.dialogs.pop();\n  }\n\n  refDialog(dialog: Dialog & React.Component, index: number) {\n    this.dialogs[index] = dialog; // Setting per index instead of push(). Works even if the ref attribute could be invoked multiple times.\n  }\n\n  onKeyDown (ev: KeyboardEvent) {\n    if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S\n      ev.preventDefault();\n      if (this.state.dialogContainers.length > 0) {\n        this.saveDialog();\n        return;\n      }\n      this.save();\n    } else if (ev.which === 27 && this.state.dialogContainers.length > 0) {\n      this.closeDialog();\n      ev.preventDefault();\n    } else if (ev.which === 13) {\n      const targetElem = ev.target as HTMLElement;\n      if (this.state.dialogContainers.length > 0 &&\n        targetElem.tagName !== 'TEXTAREA' &&\n        targetElem.tagName !== 'INPUT' &&\n        targetElem.tagName !== 'SELECT' &&\n        targetElem.tagName !== 'OPTION' &&\n        !targetElem.contentEditable)\n      {\n        this.saveDialog();\n      }\n    }\n  }\n\n  beforeUnload(ev: Event) {\n    if (this.state.dialogContainers.length > 0 || this.state.hasUnsavedData) {\n      if (!env.kedBackendClient.http.bearerProvider.wantsRedirect) {\n        ev.returnValue = CONFIRM_NAVIGATE_MESSAGE;\n        return ev.returnValue;\n      }\n    }\n  }\n\n  onClickPreventUnload(ev: Event) {\n    if (ev.target && (''+(ev.target as any).tagName).toLowerCase() === 'a') {\n      const a: HTMLAnchorElement = ev.target as HTMLAnchorElement;\n      if (a.href && a.getAttribute('href') !== '#' && !a.target) {\n        if (this.state.dialogContainers.length > 0 || this.state.hasUnsavedData) {\n          if (!confirm(CONFIRM_NAVIGATE_MESSAGE)) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return false;\n          }\n        }\n      }\n    }\n  }\n\n  saveDialog() {\n    if (this.state.dialogContainers.length > 0) {\n      const dialog = this.dialogs[this.state.dialogContainers.length-1]; // YES, should reference this.dialogs by length of dialogContainers. Strange yes, but leave it so!\n      dialog && dialog.save(); \n    }\n  }\n\n  render() {\n    const isAdmin = env.currentUser.roles.indexOf(\"ADMIN\") >= 0;\n    const course = this.state.course;\n    return !this.state.course ? <div style={{outline: 0}}>\n      <CourseBanner\n        title=\"\"\n        activePage={this.state.view}\n        routes={{feedback: this.props.feedbackUrl}}\n      /><p><Spinner/>V.g. vänta medan kursen laddas...</p>\n      </div> :\n      <div style={{outline: 0}}>\n      <CourseBanner\n        title={course.name + \" - \" + course.points + \"p\"}\n        activePage={this.state.view}\n        routes={{\n          studentPage: preserveImpersonationQuery(this.props.viewCourseUrl, {courseId: this.props.id}),\n          feedback: this.props.feedbackUrl\n        }}\n        host={this}\n        course={course}\n        origCourse={this.state.origCourse}\n        backgroundImage={course.images.filter(img => img.id === course.imageId).map(img=>img.url)[0]}\n        isTemplate={course.isTemplate}\n       />\n      <div className=\"sv-row sv-layout\">\n        <div className=\"sv-layout sv-skip-spacer sv-column-12\">\n          <div className=\"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer\">\n            <div className=\"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer\" ref={\n              div => this.contentDiv = div}>\n              <InnerEditCourse\n                course={this.state.course}\n                origCourse={this.state.origCourse}\n                host={this} />\n              <br/>\n              {this.state.dialogContainers.map(({Component, props}, i) => {\n                return <div key={i}>\n                  <div className=\"darken\">\n                  </div>\n                  <div className=\"modal-page-wrap\">\n                    <div className=\"modal-page\">\n                      <Component ref={dialog=>this.refDialog(dialog, i)} {...props} />\n                      <RemoveItem onClick={()=>this.closeDialog()} />\n                    </div>\n                  </div>\n                </div>\n              })}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { L } from '../../../utils/utils';\nimport { Course, Subject } from 'kedbackend/models';\nimport env from '../../../globals/KED.env';\nexport { EditCourse } from './edit-course';\nimport { HashRouter as Router, Route, Link, Redirect } from 'react-router-dom';\nimport { CourseBanner } from \"./course-banner\";\nimport { ListCourseTemplates } from './list-course-templates';\nimport { Spinner } from \"../sub-components/spinner\";\n\ninterface Props {\n  selectedCourseId?: string;\n  selectedCoursePublishable?: string;\n  feedbackUrl: string;\n}\n\ninterface State {\n  subjects: Subject[] | null;\n}\n\nexport class Courses extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      subjects: null\n    };\n  }\n\n  componentWillMount() {\n    this.load();\n  }\n\n  async load() {\n    const subjects = await env.kedBackendClient.list<Subject>('subjects', { include: 'standardCourses' });\n    this.setState({ subjects });\n  }\n\n  render() {\n    const courses: Course[] = [];\n    this.state.subjects && this.state.subjects.forEach(s => courses.push.apply(courses, s.standardCourses));\n    courses.sort((c1, c2) => c1.name > c2.name ? 1 : c1.name < c2.name ? -1 : 0);\n    return <div>\n      <CourseBanner\n        title={L`Kursmallar`}\n        activePage=\"templateBuilder\"\n        routes={{feedback: this.props.feedbackUrl}}\n      />\n      {!this.state.subjects ?\n        <p><Spinner />V.g. vänta medan kurser laddas</p> :\n        <ListCourseTemplates courses={courses} />}\n      </div>\n  }\n}\n","import * as React from 'react';\nimport { Course, Ability, Subject } from 'kedbackend/models';\nimport { EditableResourceList } from '../sub-components/editable-resource-list';\nimport { dtFormat } from '../utils';\nimport { CourseModuleList } from './course-module-list';\nimport { SchoolCourses } from '../sub-components/school-courses';\nimport { ICourseEditorHost } from '../interfaces/course-editor-host';\nimport { getUncoveredKnowledgeRequirements, sanityCheck, getIdsNotCoveredByTasks } from './business-logic';\nimport { setCourseImage } from \"./course-banner\";\nimport { Courses } from \"./index\";\nimport { ListCourseTemplates } from \"./list-course-templates\";\nimport { Spinner } from '../sub-components/spinner';\nimport { EditableTeacherList } from '../sub-components/editable-teacher-list';\nimport { showError, L } from \"../../../utils/utils\";\nimport { WeightedItemsTable } from '../sub-components/weighted-items-table';\nimport { Wysiwyg } from '../../utility-components/wysiwyg/index';\nimport actions_swedish from '../../utility-components/wysiwyg/actions-sv';\nimport { EditableWorkFlowLink } from '../sub-components/editable-workflow-link';\nimport { RenameableText } from '../../utility-components/renameable-text';\n\ninterface Props {\n  course: Course;\n  origCourse: Course;\n  host: ICourseEditorHost;\n};\n\ninterface State {\n  changeImageUrl: boolean;\n}\n\nexport class InnerEditCourse extends React.Component<Props,State> {\n  props: Props;\n  state: State;\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      changeImageUrl: false\n    };\n  }\n\n  setImageUrl(imageUrl: string) {\n    const { course } = this.props;\n    if (!course.imageId) {\n\n    }\n  }\n\n  render() {\n    const { course, origCourse, host } = this.props;\n    const uncoveredKnowledgeRequirements = getUncoveredKnowledgeRequirements(course);\n    const idsNotCoveredByAnyTask = getIdsNotCoveredByTasks(course);\n    const sanityCheckWarnings = sanityCheck(course);\n    const courseImage = course.images.find(img => img.id === course.imageId);\n    const courseImageIsUploaded = courseImage && courseImage.url.startsWith('data:');\n\n    return <div className=\"sv-row sv-layout sv-skip-spacer\">\n      <div className={\"sv-layout sv-skip-spacer sv-column-7\"}>\n        <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n          {course.isTemplate && <h1>Kursmall</h1> }\n          <h2>Kursövergripande</h2>\n          <hr />\n          <div className=\"ked_boxed\">\n            <div>\n              <h3>Kursens bild</h3>\n              {courseImageIsUploaded ?\n                <p>Kursens bild ligger i databasen. För att ändra bild måste du dra och släppa en ny bild ovanpå den gamla högst upp på denna sida.\n                  Bilden kan antingen vara från en annan webbsida. Lokala bildfiler går också bra att dra och släppa.</p>\n                 : courseImage ? <div><textarea\n                  value={courseImage.url}\n                  style={{width: '100%', height: '30px'}}\n                  onChange={ev=>setCourseImage(course, origCourse, host, ev.target.value)}/>\n                  <p>Bilden som visas högst upp hämtas från angiven URL.\n                    För att ändra bild kan du redigera URL ovan. Ett annat sätt att ändra bild är att dra och släppa en ny bild över den gamla högst upp på sidan.</p>\n                </div> :\n                  <p>Kursen saknar egen bild.\n                    Lägg till en bild genom att dra och släppa en bild på kurs-bannern högst upp på den här sidan.</p>}\n              <br/>\n            </div>\n\n            {!course.isTemplate && <div>\n              <h3>Beskrivning</h3>\n              <p className=\"subHeader\">(Beskrivning av kursen. För att skilja mellan olika varianter av samma gymnasiekurs)</p>\n              <textarea className=\"inputTextBox inputTextSmall\"\n                value={course.description}\n                onChange={ev => host.update({ description: { $set: ev.target.value } })} />\n              <br />\n            </div>}            \n\n            <div>\n              <h3>Upptaktstext</h3>\n              <p className=\"subHeader\">(texten ska visas på kursens upptaktssektion)</p>\n              <Wysiwyg\n                html={course.runUpText}\n                defaultActions={actions_swedish}\n                actions={[\n                  \"bold\",\n                  \"italic\",\n                  \"underline\",\n                  \"strikethrough\",\n                  \"heading2\",\n                  \"heading3\",\n                  \"olist\",\n                  \"ulist\",\n                  \"line\",\n                  \"link\",\n                  \"image\"]}\n                onChange={newHtml => host.update({ runUpText: {$set: newHtml}})} />\n              <br />\n            </div>\n\n            <h3>Kursresurser</h3>\n            <p className=\"subHeader\">(Resurser för upptakt och kursen som helhet)</p>\n            <EditableResourceList\n              resources={course.resources}\n              onUpdate={resourcesUpdates => host.update({ resources: resourcesUpdates })}\n              host={host} />\n            <br />\n            <h3>Arbetsgång</h3>\n            <p className=\"subHeader\">(Eventuell länk till arbetsgång för kursen)</p>\n            <EditableWorkFlowLink\n              url={course.workFlowLink}\n              onUpdate={updates => host.update({ workFlowLink: updates })}\n              host={host} />\n            <br />\n            {!course.isTemplate && <div>\n              <h3>Google Classroom</h3>\n              <div className=\"align-horizontal spaced\">\n                <div className=\"horizontalItem top\">\n                  <input\n                    placeholder=\"Google classroom URL\"\n                    type=\"text\"\n                    size={30}\n                    value={course.googleClassRoomURL}\n                    onChange={ev => host.update({googleClassRoomURL: {$set: ev.target.value}})}/>\n                </div>\n                <div className=\"horizontalItem top\">\n                  <input\n                    placeholder=\"kod\"\n                    type=\"text\"\n                    size={8}\n                    value={course.googleClassRoomCode}\n                    onChange={ev => host.update({googleClassRoomCode: {$set: ev.target.value}})} />\n                </div>\n              </div>\n            </div>}\n\n            <br />\n            {!course.isTemplate && <><EditableTeacherList \n              teachers={course.responsibleTeachers}\n              onUpdate={teachersUpdate => {\n                host.update({responsibleTeachers: teachersUpdate});\n              }} />\n            <br />\n            <h3>Inlämnings E-post</h3>\n            <table tabIndex={1} style={{width: '100%'}}>\n              <thead><tr><th>\n                E-postaddress\n              </th></tr></thead>\n              <tbody>\n                <tr>\n                  <td>\n                    <RenameableText\n                      eager={true}\n                      clickAdvertiseText=\"Klicka här för att ange vem som tar emot inlämningsuppgifter\"\n                      text={course.assignmentEmails ? course.assignmentEmails[0] : \"\"}\n                      placeholder=\"Ange mottagare av inlämningsuppgifter\"\n                      tag=\"input\"\n                      onChange={value => host.update({assignmentEmails: {$set: [value]}})}\n                    />\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n            </>}\n\n          </div>\n          <div className=\"sv-html-portlet sv-portlet\" id=\"svid12_6ab4811f15b13c706b43bb47\">\n            <div id=\"Kursensmoduler\">\n            </div>\n            <h2>Kursens moduler</h2>\n            <hr />\n          </div>\n          <CourseModuleList\n            host={host}\n            course={course}\n            idsNotCoveredByAnyTask={idsNotCoveredByAnyTask} />\n          \n          <div>\n            <br/>\n            <WeightedItemsTable course={course}/>\n          </div>\n\n          <div className=\"sv-html-portlet sv-portlet\">\n            <h2>Kursens status</h2>\n            <hr />\n            {course.createdBy && course.createdDate && <p>\n              Kursen skapades {dtFormat(course.createdDate)} av <strong>{course.createdBy.name}</strong>.\n            </p>}\n            {course.modifiedBy && course.modifiedDate && <p>\n              Kursen redigerades senast {dtFormat(course.modifiedDate)} av <strong>{course.modifiedBy.name}</strong>.\n            </p>}\n            {course.active ? <p>\n              Kursen är <strong>AKTIV</strong> sedan {dtFormat(course.activatedDate)} av <strong>{course.activatedBy.name}</strong>.\n            </p> : <p>\n                Kursen är <strong>INAKTIV</strong>{course.inactivatedBy ? <span>\n                  sedan {dtFormat(course.inactivatedDate)} av <strong>{course.inactivatedBy.name}</strong>.</span> : <span>.</span>\n                }\n              </p>}\n            {(uncoveredKnowledgeRequirements.length === 0 ?\n              <p className=\"markedGreen\">Modulernas kunskapskrav täcker skolverkets krav för denna kurs</p> :\n              <div className=\"markedRed warning-box\"><div className=\"warningFlag\">\n                <i className=\"fa fa-exclamation-triangle\" aria-hidden=\"true\"></i>\n              </div><p>Modulernas kunskapskrav täcker inte skolverkets krav för denna kurs.</p>\n              </div>)}\n            {sanityCheckWarnings.map(warning => <div key={warning} className=\"markedRed warning-box\"><div className=\"warningFlag\">\n                <i className=\"fa fa-exclamation-triangle\" aria-hidden=\"true\"></i>\n              </div><p>{warning}</p></div>)}\n            <br />\n            {!course.isTemplate && (origCourse ? <div\n              className=\"btn btn-warning btn-large pull-right\"\n              onClick={()=>{\n                if (confirm(L`Bekräfta borttagning av kursen \"${course.name} - ${course.description}\" för skolan ${course.school}\\n\\nKursen kommar att raderas helt!\\n\\nÄr du säker?`))\n                  host.deleteCourse().catch(showError);\n              }}\n            >Ta bort kurs</div>:<div\n              className=\"btn btn-warning btn-large pull-right\"\n              onClick={()=>history.go(-1)}\n            >Avbryt\n              </div>)}\n            <div className=\"btn btn-large\" onClick={() => host.save()}>\n              Spara\n            </div>\n            {course.active ?\n              <div className=\"btn btn-info btn-large\"\n                onClick={() => host.inactivateAndSave()}>\n                Inaktivera och spara\n              </div> :\n              <div className=\"btn btn-info btn-large\"\n                onClick={() => host.activateAndSave()}>\n                Aktivera och spara\n              </div>}\n          </div>\n        </div>\n      </div>\n      <div className=\"sv-layout sv-column-5\">\n        <SchoolCourses />\n      </div>\n    </div>\n  }\n}","import * as React from 'react';\nimport { Course } from 'kedbackend/models';\nimport { L } from '../../../utils/utils';\nimport { Link } from 'react-router-dom';\n\nexport const ListCourseTemplates = (props: { courses: Course[], selectedCourseId? }) => {\n  const { courses } = props;\n  return <div>\n    <h2>{L`Välj kursmall att redigera: `}</h2>\n    <ul className=\"entity-list\">\n      {courses.map(({ id, name, code, publishable, points, subjectId }) =>\n        <li key={id} className={\n          (publishable ? \"complete\" : \"incomplete\") +\n          (props.selectedCourseId === id ? \" selected\" : \"\")}>\n          <Link to={`/course-templates/${subjectId}/${id}`}>{name} - {points}</Link></li>)}\n    </ul>\n  </div>\n}\n\n","import * as React from 'react';\nimport { L } from '../../utils/utils';\nimport { HashRouter as Router, Route, Link, Redirect } from 'react-router-dom';\nimport { ErrorSuccessFeedback } from '../../utils/error-success-feedback';\nimport { Schools } from './schools';\nimport { NewSchool } from './schools/new-school';\nimport env from '../../globals/KED.env';\n\n// Views\nimport { Subjects, ShowSubject } from './subjects';\nimport { Courses, EditCourse } from './courses';\nimport { EditSchool } from \"./schools/edit-school\";\nimport { CourseBanner } from \"./courses/course-banner\";\nimport { CreateNewCourse } from \"./courses/create-new\";\nimport { Spinner } from \"./sub-components/spinner\";\n\n// Keep Session Alive\nimport { keepSessionAlive } from '../../utils/keep-session-alive';\nkeepSessionAlive();\n\ninterface Props {\n  viewCourseUrl: string;\n  feedbackUrl: string;\n}\n\ninterface State {\n}\n\nexport class CourseBuilder extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n  }\n\n  render() {\n    const isAuthorized = env.currentUser.roles.some(role => role === \"ADMIN\" || role === \"EMPLOYEE\");\n    const isAdmin = env.currentUser.roles.some(role => role === \"ADMIN\");\n    return <div className=\"course-builder\">\n      <Router>\n        {isAuthorized ? <div>\n          <Route exact path=\"/\" render={({ match }) => isAdmin ?\n            <Schools viewCourseUrl={this.props.viewCourseUrl} feedbackUrl={this.props.feedbackUrl} /> :\n            <CreateNewCourse feedbackUrl={this.props.feedbackUrl} />} />\n          <Route exact path=\"/schools\" render={({ match }) =>\n            <Schools\n              viewCourseUrl={this.props.viewCourseUrl}\n              feedbackUrl={this.props.feedbackUrl} />} />\n          <Route exact path=\"/schools/new\" render={()=><NewSchool feedbackUrl={this.props.feedbackUrl} />} />\n          <Route exact path=\"/schools/:id/edit\" render={({ match }) => <EditSchool\n            id={match.params.id}\n            title={L`Editera skola`}\n            feedbackUrl={this.props.feedbackUrl} />} />\n          <Route exact path=\"/subjects\" render={()=><Subjects feedbackUrl={this.props.feedbackUrl} />} />\n          <Route path=\"/subjects/:id\" render={({ match }) => <ShowSubject\n            id={match.params.id}\n            feedbackUrl={this.props.feedbackUrl} />} />\n          <Route exact path=\"/courses/new\" render={()=> <CreateNewCourse\n          feedbackUrl={this.props.feedbackUrl} />} />\n          <Route path=\"/courses/create-from-template/:templateId\" render={({match}) => <EditCourse\n            templateId={match.params.templateId}\n            view=\"courseBuilder\"\n            viewCourseUrl={this.props.viewCourseUrl}\n            feedbackUrl={this.props.feedbackUrl}\n          />}/>\n          <Route path=\"/courses/:id/edit\" render={({match}) => <EditCourse\n            id={match.params.id}\n            view=\"courseBuilder\"\n            viewCourseUrl={this.props.viewCourseUrl}\n            feedbackUrl={this.props.feedbackUrl}\n          />} />\n        </div> : <div>\n            <Route path=\"/\" render={() => <div>\n              <CourseBanner title=\"Kursbyggaren\" activePage=\"courseBuilder\" routes={{feedback: this.props.feedbackUrl}} />\n              <h2>Behörighet saknas</h2>\n              <p>Detta verktyg är endast till för anställda på Kunskapsskolan.</p>\n              <h3>Användarattribut</h3>\n              <table className=\"ked_boxed\" style={{border: \"1px solid #eee\"}}>\n                <thead>\n                  <tr>\n                    <th>Attribut</th>\n                    <th>Värde</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {Object.keys(env.currentUser).map(attr => <tr key={attr}>\n                    <td>{attr}</td>\n                    <td>{env.currentUser[attr]}</td>\n                  </tr>)}\n                </tbody></table>\n            </div>} />\n          </div>}\n      </Router>\n      <ErrorSuccessFeedback />\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { L } from '../../../utils/utils';\nimport { SchoolCourses } from '../sub-components/school-courses';\nimport { Resource } from 'kedbackend/models';\nimport { dtFormat } from '../utils';\nimport { Dialog } from '../interfaces/course-editor-host';\nimport validUrl from 'valid-url';\n\ninterface Props {\n  resource?: Resource;\n  title: string;\n  onSave: (newResource: Resource) => void;\n  onDelete?: ()=>void;\n}\n\ntype State = Resource;\n\nexport class EditResource extends React.Component<Props,State> implements Dialog {\n  constructor(props: Props) {\n    super(props);\n    this.state = this.props.resource || {name: '', url: ''};\n  }\n\n  save() {\n    const resource = this.state;\n    if (!validUrl.isUri(resource.url)) throw new Error(L`Angiven URL '${resource.url}' är ogiltig. Ska börja med exempelvis http:, https: eller mailto:`);\n    this.props.onSave(resource);\n  }\n\n  render() {\n    const {title, onSave, onDelete} = this.props;\n    const resource = this.state;\n    const isValidUrl = validUrl.isUri(this.state.url);\n\n    return <div><div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n      <h2>{title}</h2>\n      <hr />\n      <div className=\"align-horizontal\">\n        <div className=\"horizontalItem top\">Namn:</div>\n        <div className=\"horizontalItem top\">\n          <input type=\"text\" autoFocus\n            tabIndex={1}\n            size={50}\n            value={resource.name}\n            onChange={ev=>this.setState({name: ev.target.value})} />\n        </div>\n        <div className=\"horizontalItem top spaced\"></div>\n      </div>\n      <div className=\"align-horizontal\">\n        <div className=\"horizontalItem top\">Länk:</div>\n        <div className=\"horizontalItem top \">\n          <input type=\"text\"\n            tabIndex={1}\n            size={50}\n            value={resource.url}\n            onChange={ev=>this.setState({url: ev.target.value})} />\n        </div>\n        <div className=\"horizontalItem top spaced\"></div>\n      </div>\n      <br /></div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        {(resource.createdDate || resource.modifiedDate) && <div>\n          {resource.createdDate && <p>\n            Resursen/Länken skapades {dtFormat(resource.createdDate)} av <strong>{resource.createdBy.name}</strong>.\n          </p>}\n          {resource.modifiedDate && <p>\n            Resursen/Länken redigerades senast {dtFormat(resource.modifiedDate)} av <strong>{resource.modifiedBy.name}</strong>.\n          </p>}\n          <br /><br/>\n        </div>}\n        {onDelete && <div tabIndex={2} className=\"btn btn-warning btn-large pull-right\" onClick={()=>onDelete()}>\n          Ta bort resurs/länk\n        </div>}\n        <a tabIndex={1} className={\"btn btn-large\" + (isValidUrl ? \"\" : \" btn-inactive\")} onClick={isValidUrl && (() => onSave(resource))}>Spara</a>\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { Course, CourseModule, Ability, Task, Document } from 'kedbackend/models';\nimport { createUUID } from 'kedbackend/client';\nimport { KnowledgeMatrix } from '../sub-components/knowledge-matrix';\nimport update from 'react-addons-update';\nimport { Dialog, ICourseEditorHost } from \"../interfaces/course-editor-host\";\nimport { hasWriteAccess } from '../../../access-control';\nimport { SelectRelatedDocs } from '../sub-components/select-related-docs';\nimport validUrl from 'valid-url';\nimport { L, showError } from \"../../../utils/utils\";\nimport { CachedResponse } from \"../../../utils/cached-response\";\nimport { EditableResourceList } from \"../sub-components/editable-resource-list\";\nimport { dtFormat } from \"../utils\";\nimport { futureAbilities } from \"../../../contracts/ked-models\";\nimport env from '../../../globals/KED.env';\nimport { Spinner } from \"../sub-components/spinner\";\nimport { Wysiwyg } from '../../utility-components/wysiwyg';\nimport actions_swedish from '../../utility-components/wysiwyg/actions-sv';\nimport ReactDatePicker from 'react-datepicker';\nimport moment from 'moment';\nimport { Features } from '../../../features';\n\ninterface Props {\n  searchMode?: boolean;\n  task?: Task;\n  taskCustomization?: Partial<Task>;\n  module: CourseModule;\n  course: Course;\n  host: ICourseEditorHost;\n  idsNotCoveredByAnyTask: { [id: string]: true };\n  onSave: (task: Task, taskCustomization: Partial<Task>) => Promise<any>;\n  onSaveCustomization: (taskCustomization: Partial<Task>) => Promise<any>;\n  onReplace: (taskId: string, task: Task) => Promise<any>;\n  onCancel: () => void;\n  onDelete: () => void;\n}\n\ninterface State {\n  title: string;\n  task: Task;\n  taskCustomization: Partial<Task>\n  futureAbilitiesOpen: boolean;\n  searchResult?: Task[];\n  searchMarkedIds?: string[];\n  isSearching: boolean;\n  previewTaskContent?: string;\n}\n\nexport class EditTask extends React.Component<Props, State> implements Dialog {\n  searchResponse?: CachedResponse<Task[]>;\n  dialogElem: HTMLDivElement;\n  features = new Features();\n\n  setStatePromised(state: Partial<State>) {\n    return new Promise(resolve => super.setState(() => state as State, resolve));\n  }\n\n  constructor(props: Props) {\n    super(props);\n    const writeAccess = !props.task || hasWriteAccess(props.task);\n    this.state = {\n      title: props.task ?\n        writeAccess ?\n          L`Redigera uppgift till \"${props.module.name}\"` :\n          L`Visa uppgift till \"${props.module.name}\"` :\n        props.searchMode ?\n          L`Sök ny uppgift till \"${props.module.name}\"` :\n          L`Lägg till egen uppgift till \"${props.module.name}\"`,\n      futureAbilitiesOpen: false,\n      taskCustomization: props.taskCustomization || {},\n      task: props.task ?\n        // A task was given. Clone it and add $meta: 'update' to it\n        // to inform EditCourse.save() to update it on its own entity.\n        {\n          $meta: props.task.$meta || 'update',\n          ...props.task\n        } : props.searchMode ? null :\n          // No task was given. Set $meta = 'add' to inform EditCourse.save()\n          // to add the task to the tasks table.\n          {\n            id: createUUID(),\n            $meta: 'add',\n            tags: [\"sub:\" + props.course.subjectCode],\n            school: !props.course.isTemplate && env.currentUser.school,\n            resources: [],\n            abilities: [],\n            centralContent: [],\n            futureAbilities: [],\n            knowledgeRequirements: [],\n            name: \"\",\n            url: \"\",\n            acl: props.course.isTemplate ? [\n              `role:USER:R`// (OK to keep after kursbygg-changes). Templates (which will be empty!) will not have tasks. If they had, might not tasks should not be possible to modify. (An ADMIN could belong to a school! Other non-admins at that school should not be able to edit it)\n            ] : [\n                `role:USER:R`,\n                `schoolRole:${env.currentUser.school}/EMPLOYEE:S`\n              ]\n          },\n      searchMarkedIds: props.searchMode && [],\n      searchResult: props.searchMode && [],\n      isSearching: props.searchMode\n    };\n    if (props.searchMode) {\n      this.searchResponse = new CachedResponse(() =>\n        env.kedBackendClient.list<Task>(\"tasks\", {\n          tags: `sub:${props.course.subjectCode}`,\n          include: ['knowledgeRequirements', 'abilities', 'centralContent'],\n          flags: ['includeIdsOnly']\n        })); // TODO: includeIds istead of include?\n    }\n  }\n\n  async componentDidMount() {\n    if (this.props.searchMode) {\n      this.setStatePromised({ isSearching: true });\n      try {\n        await this.searchResponse.query();\n        if (this.state.searchMarkedIds && this.state.searchMarkedIds.length === 0) {\n          await this.updateSearchResult(this.state.searchMarkedIds);\n        }\n      } catch (err) {\n        showError(err);\n      } finally {\n        await this.setStatePromised({ isSearching: false });\n      }\n    }\n  }\n\n  async updateSearchMarkedIds(searchMarkedIds: string[]) {\n    const setStatePromise = this.setStatePromised({ task: null, searchMarkedIds, previewTaskContent: null });\n    if (!this.searchResponse.result) {\n      await this.searchResponse.promise;\n      // Refresh searchMarkedIds now as user might have clicked around while waiting for\n      // tasks to load...\n      await setStatePromise; // So we know state has been reflected...\n      searchMarkedIds = this.state.searchMarkedIds;\n    }\n    await this.updateSearchResult(searchMarkedIds);\n  }\n\n  async updateSearchResult(searchMarkedIds: string[]) {\n    const allTasksForSubject = await this.searchResponse.query();\n\n    const searchResult = allTasksForSubject.filter(t =>\n      searchMarkedIds.every(id =>\n        t.knowledgeRequirements.some(kr => kr.id === id) ||\n        t.abilities.some(a => a.id === id) ||\n        t.centralContent.some(c => c.id === id)));\n\n    this.setStatePromised({\n      searchResult\n    });\n  }\n\n  onMarkChanged(id: string, isMarked: boolean) {\n    const { searchMode } = this.props;\n    if (searchMode) {\n      const { searchMarkedIds } = this.state;\n      this.updateSearchMarkedIds(isMarked ?\n        searchMarkedIds.concat(id) :\n        searchMarkedIds.filter(x => x !== id)).catch(showError);\n      return;\n    }\n    const { course } = this.props;\n    const { task } = this.state;\n    // One of the following three will be found:\n    const ability = course.abilities.find(a => a.id === id);\n    const knowledgeRequirement = course.knowledgeRequirements.find(r => r.id === id);\n    const centralContent = course.centralContent.find(cc => cc.id === id);\n\n    const [collectionProp, item] =\n      ability ?\n        [\"abilities\", ability] :\n        knowledgeRequirement ?\n          [\"knowledgeRequirements\", knowledgeRequirement] :\n          centralContent ?\n            [\"centralContent\", centralContent] :\n            [null, null];\n\n    if (!collectionProp) {\n      console.error(\"Could not find marked id \" + id);\n      return;\n    }\n\n    const updatedCollection: Document[] = task[collectionProp].slice();\n    if (isMarked)\n      updatedCollection.push(item);\n    else\n      updatedCollection.splice(updatedCollection.findIndex(doc => doc.id === id), 1);\n\n    const updatedTask = { ...task };\n    updatedTask[collectionProp] = updatedCollection;\n\n    this.setStatePromised({\n      task: updatedTask\n    });\n  }\n\n  async save() {\n    const { task, taskCustomization } = this.state;\n    const writeAccess = hasWriteAccess(task);\n    if (writeAccess) {\n      if (!task.url && !task.content)\n        throw new Error(L`Uppgiften måste antingen ha en URL eller ett innehåll`);\n      if (task.url && !validUrl.isUri(task.url))\n        throw new Error(L`Angiven URL '${task.url}' är ogiltig. Den ska börja med http: eller https:`);\n      if (this.props.task && this.props.task.id !== task.id) {\n        // Replace existing task with copy\n        await this.props.onReplace(this.props.task.id, task);\n      } else {\n        // Update existing task\n        await this.props.onSave(task, null);\n      }\n    } else if (this.props.searchMode) {\n      await this.props.onSave(task, taskCustomization);\n    } else {\n      if (this.props.course.isTemplate && task.$meta === 'add')\n        throw new Error(L`Du saknar behörighet för att spara nya versioner av uppgifter i kursmallen`);\n\n      await this.props.onSaveCustomization(taskCustomization);\n    }\n  }\n\n  async copyTask() {\n    const taskCopy = {\n      ...this.state.task,\n      ...(this.state.taskCustomization || {}),\n      id: createUUID(),\n      acl: this.props.course.isTemplate ? [\n        `role:USER:R` // (OK to keep but this check might become unnescesary if we totally remove the possibility to edit templates) Template tasks should not be possible to modify. (An ADMIN could belong to a school! Other non-admins at that school should not be able to edit it)\n      ] : [\n          `role:USER:R`,\n          `schoolRole:${env.currentUser.school}/EMPLOYEE:S`\n        ]\n    };\n    taskCopy.$meta = 'add';\n\n    await this.setStatePromised({\n      task: taskCopy,\n      title: L`Redigera kopierad uppgift till \"${this.props.module.name}\"`,\n      taskCustomization: undefined\n    });\n  }\n\n  getTaskProp<T extends keyof Task>(taskProp: T) : Task[T] {\n    const {task, taskCustomization} = this.state;\n    const customization = taskCustomization && taskCustomization[taskProp];\n    return customization !== undefined ?\n      customization :\n      task[taskProp];\n  }\n\n  updateTaskOrCustomization (taskProp: keyof Task, updates) {\n    const {task, taskCustomization} = this.state;\n    const writeAccess = task && hasWriteAccess(task);\n    if (writeAccess && (!taskCustomization || taskCustomization[taskProp] === undefined)) {\n      const newTask = {...task};\n      newTask[taskProp] = update(task[taskProp], updates);\n      this.setStatePromised({task: newTask});\n    } else {\n      const newCustomization = {...taskCustomization};\n      newCustomization[taskProp] = update (\n        newCustomization[taskProp] || task[taskProp],\n        updates\n      );\n      this.setStatePromised({taskCustomization: newCustomization});\n    }\n  }\n\n  render() {\n    const { course, module, onCancel, onDelete, idsNotCoveredByAnyTask, searchMode } = this.props;\n    const { task, taskCustomization, title, searchResult, searchMarkedIds, isSearching } = this.state;\n    const markedIds = searchMode ?\n      searchMarkedIds :\n      task.centralContent.map(x => x.id)\n        .concat(task.abilities.map(x => x.id))\n        .concat(task.knowledgeRequirements.map(x => x.id));\n\n    const writeAccess = task && hasWriteAccess(task);\n    const taskUrlValid = task && validUrl.isUri(task.url);\n    const {features} = this;\n\n    return <div className=\"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer\">\n      <div className=\"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer\">\n        <div className=\"sv-text-portlet sv-use-margins sv-skip-spacer\">\n          <div className=\"sv-text-portlet-content\">\n            <h1 className=\"h1\">{title}</h1>\n          </div>\n        </div>\n        <div className=\"sv-fluid-grid sv-grid-ksgs12 sv-layout\">\n          <div className=\"sv-layout sv-skip-spacer sv-column-6\">\n            <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n              <div className=\"ked_boxed\">\n                <h3>{searchMode ?\n                  \"Filtrera på kunskapskrav\" : writeAccess ?\n                    \"Välj kunskapskrav\" :\n                    \"Kunskapskrav\"}</h3>\n                {searchMode ?\n                  <p>\n                    Markera de kunskapskrav som uppgiften måste täcka.\n                  </p> : writeAccess &&\n                  <p>\n                    Markera de kunskapskrav som din uppgift täcker.\n                  </p>\n                }\n                <KnowledgeMatrix\n                  knowledgeRequirements={course.knowledgeRequirements}\n                  markedIds={markedIds}\n                  idsToMarkNotOk={idsNotCoveredByAnyTask}\n                  markMode={searchMode || writeAccess}\n                  onMarkChanged={this.onMarkChanged.bind(this)}\n                />\n              </div>\n            </div>\n\n            <div className=\"sv-html-portlet sv-portlet\">\n              <SelectRelatedDocs\n                options={course.abilities}\n                title={writeAccess || searchMode ? \"Välj förmågor\" : \"Förmågor\"}\n                markedIds={markedIds}\n                markMode={writeAccess || searchMode}\n                onMarkChanged={this.onMarkChanged.bind(this)} />\n            </div>\n\n            <div className=\"sv-html-portlet sv-portlet\">\n              <SelectRelatedDocs\n                options={course.centralContent}\n                title={writeAccess || searchMode ? \"Välj centralt innehåll\" : \"Centralt innehåll\"}\n                markedIds={markedIds}\n                markMode={writeAccess || searchMode}\n                onMarkChanged={this.onMarkChanged.bind(this)} />\n            </div>\n\n            {!searchMode && <div className=\"sv-html-portlet sv-portlet\"><div className={\"openClose larger\" + (this.state.futureAbilitiesOpen ? \" open\" : \"\")}>\n              <div className=\"openHeader\" onClick={() => this.setStatePromised({ futureAbilitiesOpen: !this.state.futureAbilitiesOpen })}>\n                {writeAccess ?\n                  <p>Välj ytterligare alternativ</p> :\n                  <p>Ytterligare alternativ</p>}\n              </div>\n              <div className=\"openContent\">\n                <h4>Framtidsförmågor</h4>\n\n                <div className=\"taskContainer\">\n                  {futureAbilities.map(fa => {\n                    const selected = task.futureAbilities.indexOf(fa) >= 0;\n                    return <div className=\"align-horizontal\" key={fa}>\n                      <div className=\"horizontalItem top\">\n                        <div\n                          className={\"checkBox\" + (selected ? \" checked\" : \"\")}\n                          onClick={writeAccess ? () => {\n                            const updatedTask = { ...task };\n                            updatedTask.futureAbilities =\n                              selected ?\n                                task.futureAbilities.filter(a => a != fa) :\n                                task.futureAbilities.concat(fa);\n                            this.setStatePromised({ task: updatedTask });\n                          } : undefined} />\n                      </div>\n                      <div className=\"horizontalItem top\">{fa}\n                      </div>\n                    </div>\n                  })}\n                </div>\n              </div>\n\n            </div></div>}\n          </div>\n          <div className=\"sv-layout sv-column-6\">\n            <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n              {isSearching && <p><Spinner /> Laddar uppgifter...</p>}\n              {searchResult ? <div className={\"task-search-result\" + (!this.state.task && !this.state.previewTaskContent ? \" fixed\" : \"\")}>\n                {searchMarkedIds.length === 0 ?\n                  <h2>Samtliga uppgifter för ämnet</h2> :\n                  <h2>Uppgifter som täcker valda filter</h2>}\n                <div className=\"taskContainer\">\n                  {searchResult.map(foundTask => <div key={foundTask.id} className=\"align-horizontal\">\n                    <div className=\"horizontalItem top\">\n                      <div\n                        className={\"checkBox\" + (task && task.id === foundTask.id ? \" checked\" : \"\")}\n                        onClick={() => findDOMNode(this).parentElement.scrollTop = 0 || this.setStatePromised({ task: foundTask, previewTaskContent: null })} />\n                    </div>\n                    <div className=\"horizontalItem top\">\n                      {foundTask.content ?\n                        <a href=\"#\" onClick={ev => {\n                          this.setState({ previewTaskContent: foundTask.content, task: null });\n                          ev.preventDefault();\n                          ev.stopPropagation();\n                        }}>{foundTask.name}</a> :\n                        <a href={foundTask.url} target=\"_blank\">{foundTask.name}</a>}\n                    </div>\n                  </div>)}\n                </div>\n                <br />\n                <hr />\n              </div> : task && <div>\n                <h2>Uppgiftens namn och länk</h2>\n                <div className=\"align-horizontal spaced\">\n                  <div className=\"horizontalItem top\">\n                    <p>Uppgiftens namn:</p>\n                  </div>\n                  <div className=\"horizontalItem top\">\n                    <input autoFocus type=\"text\" size={35} value={task.name} disabled={!writeAccess} readOnly={!writeAccess} onChange={ev => {\n                      const newTask = { ...task };\n                      newTask.name = ev.target.value;\n                      this.setStatePromised({ task: newTask });\n                    }} />\n                  </div>\n                </div>\n                <div className=\"align-horizontal spaced\">\n                  <div className=\"horizontalItem top\">\n                    <p>URL:</p>\n                  </div>\n                  <div className={\"horizontalItem top\"}>\n                    <input type=\"text\" size={35} value={task.url} disabled={!writeAccess} readOnly={!writeAccess} onChange={ev => {\n                      const newTask = { ...task };\n                      newTask.url = ev.target.value;\n                      this.setStatePromised({ task: newTask });\n                    }} />\n                  </div>\n                </div>\n\n                {features.AssignmentTasks && <><h2>Inlämningsuppgift</h2>\n                <div className=\"align-horizontal\">\n                  <div className=\"horizontalItem top\">\n                    <div className={\"checkBox\" + (this.getTaskProp(\"assignment\") ? \" checked\" : \"\")}\n                      onClick={() => {\n                        this.updateTaskOrCustomization(\"assignment\", {$set: !this.getTaskProp(\"assignment\")});\n                      }}\n                    />\n                  </div>\n                  <div className=\"horizontalItem top\">\n                      <p>Den här uppgiften är en inlämningsuppgift</p>\n                  </div>\n                </div>\n                {this.getTaskProp(\"assignment\") && <>\n                  <p>Inlämningsdatum</p>\n                    <div className=\"align-horizontal\">\n                      <div className=\"horizontalItem top\">\n                        <ReactDatePicker\n                          selected={this.getTaskProp(\"deadline\") && moment(this.getTaskProp(\"deadline\"))}\n                          dateFormat=\"YYYY-MM-DD\"\n                          locale={\"sv\"}\n                          popperPlacement=\"bottom-start\"\n                          onChange={value => {\n                            this.updateTaskOrCustomization(\"deadline\", {$set: value.format(\"YYYY-MM-DD\")});\n                          }}\n                        />\n                      </div>\n                      <div className=\"horizontalItem top\">\n                        {this.getTaskProp(\"deadline\") && <a className=\"deleteDate\" href=\"#\" title=\"Ta bort inlämningsdatum\" onClick={ev=>{\n                          ev.preventDefault();\n                          this.updateTaskOrCustomization(\"deadline\", {$set: null});\n                        }}></a>}\n                      </div>\n                    </div>\n                </>}\n              </>}\n              </div>}\n\n              {this.state.previewTaskContent ? \n                <div dangerouslySetInnerHTML={{__html: this.state.previewTaskContent}} />\n               : task && <>\n                    <h3>Uppgiftens lärandemål</h3>\n                    <div>\n                      <textarea\n                        className=\"inputTextBox learning-goal-box\"\n                        disabled={!writeAccess}\n                        value={task.learningGoal}\n                        onChange={ev => {\n                          const newTask = { ...task };\n                          newTask.learningGoal = ev.target.value;\n                          this.setStatePromised({ task: newTask });\n                        }}\n                      />\n                    </div>\n\n                    <br />\n                    {(writeAccess || !!task.content) && <>\n                      <h3>Uppgiftens innehåll</h3>\n                        {writeAccess && <p>\n                          Om uppgiften inte länkar till något dokument kan du lägga innehåll här.\n                        </p>}\n                        <Wysiwyg\n                          actions={[\n                            \"bold\",\n                            \"italic\",\n                            \"underline\",\n                            \"strikethrough\",\n                            \"heading2\",\n                            \"heading3\",\n                            \"olist\",\n                            \"ulist\",\n                            \"line\",\n                            \"link\",\n                            \"image\"]}\n                          defaultActions={actions_swedish}\n                          readOnly={!writeAccess}\n                          html={task.content}\n                          onChange={html => {\n                            const newTask = { ...task };\n                            newTask.content = html;\n                            this.setState({ task: newTask });\n                          }}\n                        />\n                    </>}\n\n                  {taskCustomization && taskCustomization.resources ?\n                    <h3>Resurser för uppgiften (modifierad för denna kursinstans)</h3> :\n                    <h3>Resurser kopplade till uppgiften</h3>}\n\n                  <EditableResourceList\n                    resources={\n                      (taskCustomization && taskCustomization.resources) || task.resources}\n                    host={this.props.host}\n                    onUpdate={resourceUpdates => {\n                      this.updateTaskOrCustomization(\"resources\", resourceUpdates);\n                    }} />\n                </>}\n            </div>\n            {task && <div className=\"sv-html-portlet sv-portlet\"><hr />\n              <h3>Uppgiftens status</h3>\n\n              {task.createdBy && task.createdDate && <p>\n                Uppgiften skapades {dtFormat(task.createdDate)} av <strong>{task.createdBy.name}</strong>.\n              </p>}\n              {task.modifiedBy && task.modifiedDate && <p>\n                Uppgiften redigerades senast {dtFormat(task.modifiedDate)} av <strong>{task.modifiedBy.name}</strong>.\n              </p>}\n\n              <br />\n              {!!this.props.onDelete && <div\n                className=\"btn btn-warning btn-large pull-right\"\n                onClick={() => this.props.onDelete()}>\n                Ta bort från kursmodul\n              </div>}\n              <div className=\"pull-right\">&nbsp;</div>\n              <div className=\"btn btn-warning btn-large pull-right\" onClick={() => this.props.onCancel()}>\n                Avbryt\n              </div>\n\n              <div className=\"btn btn-large\" onClick={() => this.save().catch(showError)}>\n                Spara\n              </div>\n              {!writeAccess && <div className=\"btn btn-large\" onClick={() => this.copyTask().catch(showError)}>\n                Skapa kopia av den här uppgiften\n              </div>}\n            </div>}\n          </div>\n        </div>\n        <div className=\"sv-layout\">\n          <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\"></div>\n        </div>\n      </div></div>\n  }\n\n}","import * as React from 'react';\nimport { L } from '../../../utils/utils';\nimport { Resource } from 'kedbackend/models';\nimport { Dialog } from '../interfaces/course-editor-host';\nimport validUrl from 'valid-url';\n\ninterface Props {\n  url?: string;\n  onSave: (newUrl: string) => void;\n  onDelete?: ()=>void;\n}\n\ninterface State {\n  url: string;\n}\n\nexport class EditWorkflowLink extends React.Component<Props,State> implements Dialog {\n  constructor(props: Props) {\n    super(props);\n    this.state = {url: this.props.url || ''};\n  }\n\n  save() {\n    const {url} = this.state;\n    if (!validUrl.isUri(url)) throw new Error(L`Angiven URL '${url}' är ogiltig. Ska börja med http: eller https:`);\n    this.props.onSave(url);\n  }\n\n  render() {\n    const {onSave, onDelete} = this.props;\n    const state = this.state;\n    const isValidUrl = validUrl.isUri(this.state.url);\n\n    return <div><div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n      <h2>Koppla en arbetsgång till kursen</h2>\n      <p>Det går bara att lägga in en arbetsgång per kurs.</p>\n      <br />\n      <div className=\"align-horizontal\">\n        <div className=\"horizontalItem top\">Länk:</div>\n        <div className=\"horizontalItem top \">\n          <input type=\"text\"\n            tabIndex={1}\n            size={50}\n            value={state.url}\n            onChange={ev=>this.setState({url: ev.target.value})} />\n        </div>\n        <div className=\"horizontalItem top spaced\"></div>\n      </div>\n      <br /></div>\n      <div className=\"sv-html-portlet sv-portlet\" id=\"svid12_492422d515badf36646e4ff1\">\n        {onDelete && <div tabIndex={2} className=\"btn btn-warning btn-large pull-right\" onClick={()=>onDelete()}>\n          Ta bort arbetsgång\n        </div>}\n        <a\n          tabIndex={1}\n          className={\"btn btn-large\" + (isValidUrl ? \"\" : \" btn-inactive\")}\n          onClick={isValidUrl && (() => onSave(state.url))}>Spara</a>\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { School } from \"kedbackend/models\";\nimport { CourseBanner } from \"../courses/course-banner\";\nimport { showError, L } from \"../../../utils/utils\";\nimport env from '../../../globals/KED.env';\nimport { createUUID, DocumentAccess, BatchRunner } from \"kedbackend/client\";\nimport { Link } from 'react-router-dom';\n\ninterface Props {\n  id?: string\n  title: string\n  feedbackUrl: string\n}\n\ntype State = School;\n\nexport class EditSchool extends React.Component<Props,State> {\n  origSchool: School;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = null;\n  }\n\n  componentDidMount() {\n    this.load().catch(err => showError(err));\n  }\n\n  async load() {\n    if (this.props.id) {\n      // ID given, load it.\n      const { id } = this.props;\n      const school = await env.kedBackendClient.get<School>(\"schools\", id);\n      this.origSchool = { ...school };\n      this.setState({ ...school });\n    } else {\n      // No id, create new instead.\n      this.setState({\n        id: createUUID()\n      });\n    }\n  }\n\n  async save() {\n    const r = new BatchRunner();\n    let school = { ...this.state };\n    if (!this.origSchool) {\n      school.acl = [\"role:USER:R\"];\n      school.acl.push(\n        new DocumentAccess(\n          \"schoolRole\",\n          `${school.name}/EMPLOYEE`, \"W\").toString());\n      r.add(\"schools\", school);\n    } else if (this.origSchool.name !== this.state.name) {\n\n      // Unshare the old name\n      r.unshare(\"schools\", school.id, [\n        new DocumentAccess(\"schoolRole\", `${this.origSchool.name}/EMPLOYEE`, \"W\")\n      ].map(a => a.toString()));\n      // BUG workaround - renaming a school to a new name where just casing matters:\n      if (this.origSchool.name.toLowerCase() === this.state.name.toLowerCase()) {\n        // Workaround for bug with renaming when it differs just by casing:\n        await env.kedBackendClient.batch(r.mutationRequests);\n        r.mutationRequests = [];\n      }\n      // Share the new name\n      r.share(\"schools\", this.state.id, [\n        new DocumentAccess(\"schoolRole\", `${this.state.name}/EMPLOYEE`, \"W\")\n      ].map(a => a.toString()));\n      r.put(\"schools\", school);\n    } else {\n      r.put(\"schools\", school);\n    }\n\n    await env.kedBackendClient.batch(r.mutationRequests);\n\n    location.hash = \"#/schools\";\n  }\n\n  async deleteSchool() {\n    if (confirm(L`Är du säker på att ta bort skolan \"${this.state.name}\"`)) {\n      await env.kedBackendClient.delete(\"schools\", this.state.id);\n      location.hash= \"#/schools\";\n    }\n  }\n\n  render() {\n    const { title, id } = this.props;\n    const editExisting = !!id;\n    const school = this.state;\n    const origSchool = this.origSchool;\n    const isAdmin = env.currentUser.roles.some(role => role === \"ADMIN\");\n    return <div style={{ outline: 0 }}>\n      <CourseBanner\n        title=\"Skolor\" activePage=\"schools\" callbacks={{schools: ()=>location.hash=\"#/schools\"}}\n        routes={{feedback: this.props.feedbackUrl}} />\n      <div className=\"sv-row sv-layout\">\n        <div className=\"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer\">\n          <h2>{title}</h2>\n          <hr />\n          <div className=\"align-horizontal\">\n            <div className=\"horizontalItem top\">Namn:</div>\n            <div className=\"horizontalItem top\">\n              <input type=\"text\" autoFocus\n                disabled={!isAdmin}\n                tabIndex={1}\n                size={50}\n                value={school ? school.name : \"\"}\n                onChange={ev => this.setState({ name: ev.target.value })} />\n            </div>\n            <div className=\"horizontalItem top spaced\"></div>\n          </div>\n          {isAdmin && editExisting && <div tabIndex={2} className=\"btn btn-warning btn-large pull-right\" onClick={() =>\n            this.deleteSchool().catch(showError)}>\n            Ta bort skola\n          </div>}\n          <div className=\"pull-right\">&nbsp;</div>\n          <Link className=\"btn btn-warning btn-large pull-right\" to=\"/schools\">\n            Avbryt\n          </Link>\n          \n          {isAdmin && <a tabIndex={1} className={\"btn btn-large\"} onClick={() => {\n            if (origSchool && origSchool.name !== school.name) {\n              if (!confirm(L`Är du säker på att du vill döpa om skolan? Detta påverkar portalens funktion för lärare och elever som tillhör skolan. Namnet måste stämma exakt överens med namngivningen av skolan på användarobjekten.\n\nDet som händer annars är att elever och lärare på skolan inte längre hittar några kurser.\n\nBlir det fel kan du dock alltid bara döpa tillbaka skolans namn.`)) {\n                return;\n              }\n            }\n            this.save().catch(showError);\n          }}>Spara</a>}\n        </div>\n      </div>\n    </div>;\n  }\n}","import * as React from 'react';\nimport { School } from 'kedbackend/models';\nimport { DialogContainer } from \"../interfaces/course-editor-host\";\nimport { L } from \"../../../utils/utils\";\nimport env from '../../../globals/KED.env';\nimport { updateModificationAndCreationStamps } from \"../utils\";\nimport { EditSchool } from './edit-school';\nimport { Link } from 'react-router-dom';\nimport { actAs } from \"../../../access-control\";\nimport { Spinner } from \"../sub-components/spinner\";\n\ninterface Props {\n  schools?: School[]\n  viewCourseUrl: string\n}\n\nexport const EditableSchoolList = (props: Props) => {\n  const { schools, viewCourseUrl } = props;\n  const isAdmin = env.currentUser.roles.some(role => role === \"ADMIN\");\n  return <div className=\"editable-school-list\">\n    <div>\n      {schools ? <table>\n        <tbody>\n          {schools.map(school =>\n            <tr className=\"align-horizontal\" key={school.id}>\n              <td>\n                <Link className=\"editItem\" to={`/schools/${school.id}/edit`}></Link>\n              </td>\n              <td>\n                <p>{school.name}</p>\n              </td>\n              <td>\n                <p><a style={{cursor: 'pointer'}} onClick={()=>actAs({role: \"EMPLOYEE\", school: school.name})}>Agera som lärare på denna skola</a></p>\n              </td>\n              <td>\n                <p><a style={{cursor: 'pointer'}} onClick={()=>actAs({role: \"STUDENT\", school: school.name, url: viewCourseUrl})}>Agera som elev på denna skola</a></p>\n              </td>\n            </tr>)}\n        </tbody>\n      </table> : <p><Spinner />V.g. vänta medan skolor laddas</p>}\n    </div>\n    <br />\n    {schools && isAdmin && <Link to=\"/schools/new\" className=\"btn\">Lägg till skola</Link>}\n  </div >\n}\n","import * as React from 'react';\nimport { CourseBanner } from \"../courses/course-banner\";\nimport env from '../../../globals/KED.env';\nimport { School } from 'kedbackend/models';\nimport { EditableSchoolList } from './editable-school-list';\nimport { showError, compareProp } from \"../../../utils/utils\";\n\ninterface Props {\n  viewCourseUrl: string;\n  feedbackUrl: string;\n}\n\ninterface State {\n  schools: School[] | null\n}\n\nexport class Schools extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      schools: null\n    }\n  }\n\n  componentDidMount() {\n    this.load().catch(err => showError(err.message || err));\n  }\n\n  async load() {\n    const schools = await env.kedBackendClient.list<School>(\"schools\");\n    this.setState({ schools });\n  }\n\n  render() {\n    const { schools } = this.state;\n    schools && schools.sort(compareProp(\"name\"));\n    return <div style={{ outline: 0 }}>\n      <CourseBanner title=\"Skolor\" activePage=\"schools\" routes={{feedback: this.props.feedbackUrl}} />\n      <div className=\"sv-row sv-layout\">\n        <div className=\"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer\">\n          <EditableSchoolList schools={schools} viewCourseUrl={this.props.viewCourseUrl} />\n        </div>\n      </div>\n    </div>\n\n  }\n}\n","import * as React from 'react';\nimport {EditSchool} from './edit-school';\n\ninterface Props {\n  feedbackUrl: string;\n}\n\nexport const NewSchool = (props: Props)=><EditSchool title=\"Lägg till skola\" feedbackUrl={props.feedbackUrl} />;\n","import * as React from 'react';\nimport {Resource} from 'kedbackend/models';\nimport {Link} from 'react-router-dom';\nimport {ICourseEditorHost} from '../interfaces/course-editor-host';\nimport {EditResource} from '../modal-pages/edit-resource';\nimport { updateModificationAndCreationStamps } from '../utils';\nimport env from '../../../globals/KED.env';\n\ninterface Props {\n  resources: Resource[];\n  onUpdate: (resourcesUpdates) => void;\n  host: ICourseEditorHost;\n}\n\ninterface State {\n\n}\n\nexport class EditableResourceList extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state={};\n  }\n\n  render() {\n    const {host, onUpdate, resources} = this.props;\n    return <div>\n      <div className=\"taskContainer\">\n        {resources.map((resource, idx) => \n          <div className=\"align-horizontal\" key={idx}>\n            <div className=\"horizontalItem top\">\n              <a className=\"editItem\" onClick={()=>host.openDialog({\n                Component: EditResource,\n                props: {\n                  title: \"Redigera resurs\",\n                  resource,\n                  onSave: editedResource => {\n                    const updatedResource = updateModificationAndCreationStamps(editedResource, env.currentUser);\n                    onUpdate({$splice: [[idx, 1, updatedResource]]});\n                    host.closeDialog();\n                  },\n                  onDelete: ()=>{\n                    onUpdate({$splice: [[idx, 1]]});\n                    host.closeDialog();\n                  }\n                }\n              })}></a>\n            </div>\n            <div className=\"horizontalItem top\">\n              <a href={resource.url} target=\"_blank\" >{resource.name}</a>\n            </div>\n          </div>)}\n     </div>\n    <a className=\"btn\" onClick={()=>host.openDialog({\n      Component: EditResource,\n      props: {\n        title: \"Lägg till resurs\",\n        onSave: newResource => {\n          const updatedResource = updateModificationAndCreationStamps(newResource, env.currentUser);\n          onUpdate({$push: [updatedResource]})\n          host.closeDialog();\n        }\n      }\n    })}><i className=\"fa fa-paperclip\" aria-hidden></i> Lägg till resurs</a>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { L } from '../../../utils/utils';\nimport { Task, Course, CourseModule, Ability } from 'kedbackend/models';\nimport { Link } from 'react-router-dom';\nimport { EditTask } from '../modal-pages/edit-task';\nimport { ICourseEditorHost } from '../interfaces/course-editor-host';\nimport { updateModificationAndCreationStamps } from \"../utils\";\nimport env from '../../../globals/KED.env';\nimport { hasWriteAccess } from \"../../../access-control\";\n\ninterface Props {\n  taskIds: string[];\n  taskCustomizations?: { [taskId: string]: Partial<Task> }\n  course: Course;\n  module: CourseModule;\n  idsNotCoveredByAnyTask: {[id: string]: true};\n  onTaskAdded: (task: Task, taskCustomization?: Partial<Task>) => void;\n  onTaskUpdated: (task) => void;\n  onTaskCustomizationUpdated: (taskId, customization) => void;\n  onTaskDeleted: (id) => void;\n  onTaskReplaced: (id, task) => void;\n  host: ICourseEditorHost;\n}\n\ninterface State {\n\n}\n\nexport class EditableTaskList extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {};\n  }\n\n  openTaskDialog(task: Task) {\n    const {\n      taskCustomizations,\n      course,\n      host,\n      module,\n      taskIds,\n      onTaskAdded,\n      onTaskUpdated,\n      onTaskCustomizationUpdated,\n      onTaskDeleted,\n      idsNotCoveredByAnyTask,\n      onTaskReplaced\n    } = this.props;\n\n    host.openDialog({\n      Component: EditTask,\n      props: {\n        task,\n        taskCustomization: taskCustomizations && taskCustomizations[task.id],\n        module,\n        course,\n        host,\n        idsNotCoveredByAnyTask,\n        onSave: task => {\n          const updatedTask = updateModificationAndCreationStamps(task, env.currentUser);\n          onTaskUpdated(updatedTask);\n          host.closeDialog();\n        },\n        onSaveCustomization: customization => {\n          onTaskCustomizationUpdated(task.id, customization);\n          host.closeDialog();\n        },\n        onDelete: () => {\n          onTaskDeleted(task.id);\n          host.closeDialog();\n        },\n        onReplace: (taskId: string, newTask: Task) => {\n          onTaskReplaced(taskId, newTask);\n          host.closeDialog();\n        },\n        onCancel: () => host.closeDialog()\n      }\n    });\n  }\n\n  render() {\n    const props = this.props;\n    return <div>\n      <div className=\"taskContainer\">\n        {props.taskIds.map(id => props.course.tasks.find(t => t.id === id)).map(task => {\n          const canUpdateTask = hasWriteAccess(task);\n\n          return <div className=\"align-horizontal\" key={task.id}>\n            <div className=\"horizontalItem top\">\n              <div className={canUpdateTask ? \"editItem\" : \"viewItem\"} onClick={() =>\n                this.openTaskDialog(task)} />\n            </div>\n            <div className=\"horizontalItem top\">\n              {task.content ?\n                // Rather than linking to url, show the task's content (by opening\n                // the task dialog)\n                <a href=\"#\" onClick={ev=>{\n                  ev.preventDefault();\n                  this.openTaskDialog(task);\n                }}>{task.name}</a> :\n                <a href={task.url} target=\"_blank\">{task.name}</a>}\n            </div>\n          </div>;\n        })}\n      </div>\n      <br />\n      <a className=\"btn\" onClick={() => {\n        const {\n          course,\n          host,\n          idsNotCoveredByAnyTask,\n          module,\n          onTaskAdded,\n          onTaskCustomizationUpdated } = this.props;\n\n        props.host.openDialog({\n          Component: EditTask,\n          props: {\n            searchMode: true,\n            module,\n            course,\n            host,\n            idsNotCoveredByAnyTask,\n            onSave: (choosenTask, taskCustomization) => {\n              choosenTask = updateModificationAndCreationStamps(choosenTask, env.currentUser);\n              onTaskAdded(choosenTask, taskCustomization);\n              host.closeDialog();\n            },\n            onCancel: () => host.closeDialog()\n          }\n        });\n      }}><i className=\"fa fa-search\" aria-hidden /> Sök uppgift</a>\n      &nbsp;\n      <a onClick={() => {\n        const { course, host, module, taskIds, onTaskAdded, onTaskUpdated, onTaskDeleted, idsNotCoveredByAnyTask } = this.props;\n        host.openDialog({\n          Component: EditTask,\n          props: {\n            module,\n            course,\n            host,\n            idsNotCoveredByAnyTask,\n            onSave: newTask => {\n              newTask = updateModificationAndCreationStamps(newTask, env.currentUser);\n              onTaskAdded(newTask);\n              host.closeDialog();\n            },\n            onCancel: () => host.closeDialog()\n          }\n        });\n      }} className=\"btn\">\n        <i className=\"fa fa-plus\" aria-hidden /> Lägg till egen uppgift\n      </a>\n    </div >\n  }\n}","import * as React from 'react';\nimport { Resource } from 'kedbackend/models';\nimport { RemoveItem } from \"./remove-item\";\n\ninterface Props {\n  teachers: Resource[];\n  onUpdate: (teachersUpdates) => void;\n}\n\ninterface State {\n  addEmtpyRow: boolean;\n}\n\nexport class EditableTeacherList extends React.Component<Props,State> {\n  nameElem: HTMLInputElement;\n\n  constructor(props: Props) {\n    super(props);\n    this.state={addEmtpyRow: props.teachers.length === 0};\n  }\n\n  render() {\n    let {teachers, onUpdate} = this.props;\n    const {addEmtpyRow} = this.state;\n    if (addEmtpyRow) teachers = teachers.concat({name: \"\", url: \"\"});\n\n    return <div className=\"teachers-list\">\n      <h3>Ansvariga lärare</h3>\n      <table tabIndex={1} style={{width: \"100%\"}} onBlur={ev=>\n        (!ev.relatedTarget ||\n        (ev.relatedTarget as any).tagName !== 'INPUT') &&\n        this.props.teachers.length > 0 &&\n        this.setState({addEmtpyRow: false})\n      }>\n        <thead>\n          {teachers.length > 0 && <tr>\n            <th style={{width: \"20%\"}}>Namn</th>\n            <th>Länk eller E-postadress</th>\n          </tr>}\n        </thead>\n        <tbody>\n          {teachers.map((teacher, idx) => \n          <tr key={idx}>\n            <td><input type=\"text\" ref={elem => this.nameElem = elem} value={teacher.name} autoFocus={!teacher.name && idx > 0} onChange={\n              ev=>{\n                if (addEmtpyRow && idx == teachers.length - 1) {\n                  onUpdate({$push: [{...teacher, name: ev.target.value}] });\n                  this.setState({addEmtpyRow: false});\n                } else if (ev.target.value || teacher.url) {\n                  onUpdate({$splice: [[idx, 1, {...teacher, name: ev.target.value}]] });\n                } else {\n                  if (this.props.teachers.length === 1)\n                    this.setState({addEmtpyRow: true});\n                  onUpdate({$splice: [[idx, 1]]});\n                }\n              }\n            }/></td>\n            <td><input\n              type=\"text\"\n              style={{width: \"100%\"}}\n              value={teacher.url}\n              onKeyDown={ev =>\n                ev.which === 9 &&\n                !ev.shiftKey &&\n                idx === teachers.length - 1 &&\n                (teachers.length < 1 || !!teachers[teachers.length - 1].name &&\n                  (this.setState({addEmtpyRow: true}),ev.preventDefault()))}\n              onChange={ev => {\n                if (addEmtpyRow && idx == teachers.length - 1) {\n                  onUpdate({$push: [{...teacher, url: ev.target.value}]})\n                  this.setState({addEmtpyRow: false});\n                } else if (ev.target.value || teacher.name) {\n                  onUpdate({$splice: [[idx, 1, {...teacher, url: ev.target.value}]]});\n                } else {\n                  if (this.props.teachers.length === 1)\n                    this.setState({addEmtpyRow: true});\n                  onUpdate({$splice: [[idx, 1]]});\n                }\n              }\n              \n            }/></td>\n          </tr>)}\n        </tbody>\n      </table>\n      <br/>\n      <a className=\"btn\" onClick={() =>\n        this.state.addEmtpyRow ?\n          this.nameElem.focus() :\n          this.setState({addEmtpyRow: true})}>\n            <i className=\"fa fa-user-plus\" aria-hidden /> Lägg till ansvarig lärare</a>\n    </div>\n  }\n}","import * as React from 'react';\nimport {Resource} from 'kedbackend/models';\nimport {Link} from 'react-router-dom';\nimport {ICourseEditorHost} from '../interfaces/course-editor-host';\nimport {EditResource} from '../modal-pages/edit-resource';\nimport { updateModificationAndCreationStamps } from '../utils';\nimport env from '../../../globals/KED.env';\nimport { EditWorkflowLink } from '../modal-pages/edit-workflow-link';\n\ninterface Props {\n  url: string;\n  onUpdate: (updates) => void;\n  host: ICourseEditorHost;\n}\n\nexport class EditableWorkFlowLink extends React.Component<Props> {\n  constructor(props: Props) {\n    super(props);\n    this.state={};\n  }\n\n  render() {\n    const {host, onUpdate, url} = this.props;\n    return <div>\n      <div className=\"taskContainer\">\n        {url &&\n          <div className=\"align-horizontal\">\n            <div className=\"horizontalItem top\">\n              <a className=\"editItem\" onClick={()=>host.openDialog({\n                Component: EditWorkflowLink,\n                props: {\n                  url,\n                  onSave: newUrl => {\n                    onUpdate({$set: newUrl});\n                    host.closeDialog();\n                  },\n                  onDelete: ()=>{\n                    onUpdate({$set: undefined});\n                    host.closeDialog();\n                  }\n                }\n              })}></a>\n            </div>\n            <div className=\"horizontalItem top\">\n              <a href={url} target=\"_blank\" >Nuvarande arbetsgång</a>\n            </div>\n          </div>\n        }\n     </div>\n    {!url && <a className=\"btn\" onClick={()=>host.openDialog({\n      Component: EditWorkflowLink,\n      props: {\n        onSave: newUrl => {\n          onUpdate({$set: newUrl})\n          host.closeDialog();\n        }\n      }\n    })}><i className=\"fa fa-paperclip\" aria-hidden></i> Koppla en arbetsgång till kursen</a>}\n    </div>\n  }\n}\n","import * as React from 'react';\nimport {Ability, KnowledgeRequirement} from 'kedbackend/models';\nimport env from '../../../globals/KED.env';\nimport {RemoveItem} from './remove-item';\nimport update from 'react-addons-update';\n\ninterface Props {\n  knowledgeRequirements: KnowledgeRequirement[];\n  idsToMarkNotOk?: {[id: string]: true};\n  // Props used in edit mode (editing course templates)\n  coveredIds?: string[];\n  // Props used in mark mode (editing tasks)\n  markMode?: boolean;\n  markedIds?: string[];\n  onMarkChanged: (id: string, isMarked: boolean) => void;\n}\n\nexport class KnowledgeMatrix extends React.Component<Props, {}> {\n  constructor(props: Props) {\n    super(props);\n  }\n\n  render() {\n    const { knowledgeRequirements, markedIds } = this.props;\n    const { idsToMarkNotOk, markMode, onMarkChanged } = this.props;\n\n    const columns = [\"E\", \"C\", \"A\"];\n    const rows: KnowledgeRequirement[][] = [];\n    const reqs = knowledgeRequirements.slice();\n    let row: KnowledgeRequirement[] | null = null;\n    while (true) {\n      row = columns.map(grade => {\n        const pNext = reqs.findIndex(r => r.gradeStep.toUpperCase() === grade);\n        if (pNext < 0) return null;\n        const rv = reqs[pNext];\n        reqs.splice(pNext, 1);\n        return rv;\n      });\n      if (row.every(r => r === null))\n        break;\n      rows.push(row);\n    }\n\n    return <div>\n      <table>\n        <thead>\n          <tr>\n            {columns.map(c => <th key={c}>{c}</th>)}\n          </tr>\n        </thead>\n        <tbody>\n          {rows.map((row,i) =>\n            <tr key={i}>\n              {row.map((requirement,j) => {\n                const isMarkedOK = requirement && markedIds && markedIds.indexOf(requirement.id) >= 0;\n                const isMarkedNotOK = requirement && idsToMarkNotOk && idsToMarkNotOk[requirement.id];\n                return <td\n                  key={j}\n                  dangerouslySetInnerHTML={{__html: requirement ? requirement.name : \"\"}}\n                  className={(markMode ? \"selectable\" : \"\") +\n                  (isMarkedOK ?\n                    \" markedGreen\" :\n                    (isMarkedNotOK ?\n                      \" markedRed\":\n                      \"\"))}\n                    onClick={markMode && requirement ?\n                      ()=>onMarkChanged(requirement.id, !isMarkedOK) :\n                      undefined} />\n              })}\n            </tr>\n          )}\n        </tbody>\n      </table>\n    </div>\n\n    {/*return <div>\n      <table>\n        <thead>\n          <tr>\n            <th>E</th>\n            <th>C</th>\n            <th>A</th>\n          </tr>\n        </thead>\n        <tbody>\n          {tbody.map((row, i) => \n          <tr key={i}>{row.map((cell, j) => {\n            const isMarkedOK = props.markedIds && props.markedIds.indexOf(cell.id) >= 0;\n            const isMarkedNotOK = props.idsToMarkNotOk && props.idsToMarkNotOk[cell.id];\n            return <td\n              key={j}\n              rowSpan={cell.rowSpan}\n              className={(props.markMode ? \"selectable\" : \"\") +\n                (isMarkedOK ?\n                  \" markedGreen\" :\n                  (isMarkedNotOK ?\n                    \" markedRed\":\n                    \"\"))}\n              onClick={props.markMode && (()=>props.onMarkChanged(cell.id, !isMarkedOK))}>\n              {cell.html && <div style={{position: 'relative'}}>\n                <p\n                  className={cell.type === 'ability' ? 'abilityText' : 'criteriaText'}\n                  dangerouslySetInnerHTML={{__html: cell.html}} />\n                {props.editMode && <RemoveItem className=\"upperRight\" onClick={()=>\n                  this.setCellIds(\n                    cell.type,\n                    cell.rowIndex,\n                    this.getCellIds(\n                      cell.type,\n                      cell.rowIndex).filter(id => id != cell.id) )} /> }\n              </div>}\n            </td>})}\n          </tr>)}\n        </tbody>\n      </table>\n    </div>*/}\n  }\n}\n","import * as React from 'react';\nimport { L } from \"../../../utils/utils\";\n\ninterface Props {\n  onClick,\n  className?,\n  style?,\n  title?\n};\n\nexport const RemoveItem = ({ onClick, className, style, title }: Props) =>\n\n  <div\n    title={title || L`Radera`}\n    className={\"removeItem \" + (className || \"\")}\n    onClick={onClick} style={style} />\n","import * as React from 'react';\nimport { L, showError, compareProp } from '../../../utils/utils';\nimport { Course } from \"kedbackend/models\";\nimport { mySchoolCoursesRepo } from \"../../../repos/school-courses\";\nimport { Spinner } from \"./spinner\";\nimport { Link } from 'react-router-dom';\nimport { shortDateFormat } from \"../utils\";\n\ninterface Props {\n}\n\ninterface State {\n  schoolCourses: Course[] | null;\n}\n\nexport class SchoolCourses extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      schoolCourses: null\n    }\n    this.onSchoolCoursesUpdated = this.onSchoolCoursesUpdated.bind(this);\n  }\n\n  componentDidMount() {\n    mySchoolCoursesRepo.subscribe(this.onSchoolCoursesUpdated).catch(showError);\n  }\n\n  componentWillUnmount() {\n    mySchoolCoursesRepo.unsubscribe(this.onSchoolCoursesUpdated);\n  }\n\n  onSchoolCoursesUpdated(schoolCourses: Course[]) {\n    const compareName = compareProp(\"name\");\n    const compareCreatedDate = compareProp(\"createdDate\");\n    schoolCourses.sort((a,b) => compareName(a,b) || compareCreatedDate(a,b));\n    this.setState({schoolCourses});\n  }\n\n  render() {\n    const {schoolCourses} = this.state;\n    return <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n      <div className=\"ked_boxed\">\n        <h3>Skolans kurser</h3>\n        <div className=\"taskContainer odd-even\">\n          {!schoolCourses ?\n            <p><Spinner /> Laddar skolans kurser</p> :\n            schoolCourses.map(course => <div className=\"schoolCourse\" key={course.id}>\n            <div className=\"align-horizontal\">\n              <div className=\"horizontalItem top pull-right\">\n                <Link\n                  to={`/courses/${course.id}/edit`}\n                  className=\"editItem\"\n                />\n              </div>\n              <div className=\"horizontalItem top\">\n                <Link to={`/courses/${course.id}/edit`}>{course.name}</Link></div>\n              <div className=\"horizontalItem top\">\n                {course.active && <div className=\"pill active\">Aktiv</div>}\n              </div>\n              {course.active && !course.publishable && <div className=\"horizontalItem top\">\n                <div className=\"pill incomplete\">Inkomplett</div>\n              </div>}\n            </div>\n            <div className=\"horizontalItem top\">\n              <p>{course.description}</p>\n            </div>\n            <div className=\"horizontalItem top\">\n              {course.modifiedBy ?\n                <p className=\"small\">Redigerad av {course.modifiedBy.name} / {shortDateFormat(course.modifiedDate)}</p> :\n                <p className=\"small\" style={{fontStyle: 'italic'}}> </p>}\n            </div>\n          </div>)}\n        </div>\n        {location.hash !== \"#/courses/new\" && <Link\n          className=\"btn\"\n          to=\"/courses/new\"\n          onClick={()=>window.scroll(0, 0)}>\n          Skapa ny kurs\n        </Link>}\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { Course, CourseModule, Task, Document } from 'kedbackend/models';\nimport { OpenCloseBox } from \"../../utility-components/open-close-box\";\n\ninterface Props {\n  options: Document[];\n  title;\n  markMode: boolean;\n  markedIds: string[];\n  onMarkChanged: (id: string, isMarked: boolean) => void;\n}\n\ninterface State {\n}\n\nexport class SelectRelatedDocs extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    const {options, title, markedIds, markMode} = this.props;\n    return <OpenCloseBox title={<p>{title}</p>} className=\"larger\">\n        {options.map(option => {\n          const isMarked = markedIds.some(x => x === option.id);\n          return <div className=\"align-horizontal\" key={option.id} onClick={()=>\n            markMode && this.props.onMarkChanged(option.id, !isMarked)}>\n            <div className={\"horizontalItem top spaced\" +\n              (markMode ? \" selectable\" : \"\") +\n              (isMarked ? \" markedGreen\" : \"\")}>\n              <p dangerouslySetInnerHTML={{__html: option.name}} />\n              <br />\n            </div>\n          </div>;\n        })}\n    </OpenCloseBox>\n  }\n}","import * as React from 'react';\n\nexport const Spinner = ()=> <span><i className=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i>&nbsp;</span>;\n","import * as React from 'react';\nimport { Course } from 'kedbackend/models';\nimport { getTasksPerId } from \"../courses/business-logic\";\nimport { futureAbilities } from \"../../../contracts/ked-models\";\nimport { OpenCloseBox } from \"../../utility-components/open-close-box\";\n\ninterface Props {\n  course: Course;\n}\n\ninterface State {\n  isOpen: boolean;\n}\n\nexport class WeightedItemsTable extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isOpen: false\n    };\n  }\n\n  render() {\n    const { course } = this.props;\n    const { isOpen } = this.state;\n    const rows = [];\n    const tasksPerId = getTasksPerId(course);\n\n    rows.push(<tr key=\"centralContent\" className=\"covered-item-label\"><td colSpan={2}>Centralt innehåll</td></tr>);\n    course.centralContent.forEach((cc,idx) => rows.push(<tr key={cc.id} className={idx % 2 ? \"tableOdd\" : \"\"}>\n      <td><p className=\"criteriaText\" dangerouslySetInnerHTML={{__html: cc.name}}/></td>\n      <td><p>{(tasksPerId[cc.id] || []).length}</p></td>\n    </tr>));\n\n    rows.push(<tr key=\"abilities\" className=\"covered-item-label\"><td colSpan={2}>Förmågor</td></tr>);\n    course.abilities.forEach((ability,idx) => rows.push(<tr key={ability.id} className={idx % 2 ? \"tableOdd\" : \"\"}>\n      <td><p className=\"abilityText\" dangerouslySetInnerHTML={{__html: ability.name}}/></td>\n      <td><p>{(tasksPerId[ability.id] || []).length}</p></td>\n    </tr>));\n\n    rows.push(<tr key=\"futureAbilities\" className=\"covered-item-label\"><td colSpan={2}>Framtidsförmågor</td></tr>);\n     futureAbilities.forEach((futureAbilityText, idx) => rows.push(<tr key={futureAbilityText} className={idx % 2 ? \"tableOdd\" : \"\"}>\n      <td><p className=\"abilityText\">{futureAbilityText}</p></td>\n      <td><p>{(tasksPerId[futureAbilityText] || []).length}</p></td>\n    </tr>));\n\n    return <OpenCloseBox\n      className=\"larger\"\n      title={<p>Kursens täckningstabell</p>}\n      contentClassName=\"weighted-items-table\">\n        <p>Tabellen anger hur många uppgifter som berör varje del.</p>\n        <table><tbody>{rows}</tbody></table>\n    </OpenCloseBox>\n  }\n}","import * as React from 'react';\nimport { L, showInfo, compareProp } from '../../../utils/utils';\nimport env from '../../../globals/KED.env';\nimport { Subject } from 'kedbackend/models';\nimport $ from 'jquery';\nimport { SkolverketSubject } from './skolverket-subject';\nimport { UploadedSubject } from './uploaded-subject';\nexport { ShowSubject } from './show-subject';\nimport { HashRouter as Router, Route, Link, Redirect } from 'react-router-dom';\nimport { readBlobAsText, allowCopy } from \"../utils\";\nimport { CourseBanner } from \"../courses/course-banner\";\nimport { Spinner } from \"../sub-components/spinner\";\n\ninterface Props {\n  feedbackUrl: string\n}\n\ninterface State {\n  subjects: Subject[];\n  isListingSubjects: boolean;\n  uploadedSubject: SkolverketSubject | null;\n}\n\nexport class Subjects extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isListingSubjects: true,\n      subjects: [],\n      uploadedSubject: null\n    };\n  }\n\n  componentWillMount() {\n    this.load();\n  }\n\n  async load() {\n    const subjects = await env.kedBackendClient.list(\"subjects\");\n    subjects.sort(compareProp(\"name\"));\n    this.setState({ subjects, isListingSubjects: false });\n  }\n\n  async handleFileSelect(ev: React.DragEvent<HTMLDivElement>) {\n    ev.stopPropagation();\n    ev.preventDefault();\n    const files = ev.dataTransfer.files;\n    const xml = await readBlobAsText(files[0]);\n    const doc = $($.parseXML(xml));\n    const model : SkolverketSubject = {\n      name: doc.find(\"subject>name\").text(),\n      code: doc.find(\"subject>code\").text(),\n      purpose: doc.find(\"subject>purpose\").text(),\n      courses: []\n    };\n    const courses = doc.find(\"subject>courses\");\n    for (let i=0; i<courses.length; ++i) {\n      const course = $(courses[i]);\n      const knownledgeRequirements = [].slice.call(course.find(\"knowledgeRequirements\"))\n        .map(r => ({gradeStep: $(r).find('gradeStep').text(), text: $(r).find('text').text()}));\n\n      model.courses.push({\n        name: course.find(\"name\").text(),\n        code: course.find(\"code\").text(),\n        centralContent: course.find(\"centralContent\").text(),\n        points: parseInt(course.find(\"point\").text()),\n        knownledgeRequirements,\n      });\n    }\n    this.setState({uploadedSubject: model});\n  }\n\n  onImportSuccess(subject) {\n     showInfo(L`Importen av ${subject} lyckades`);\n     this.setState({uploadedSubject: null});\n     this.load();\n  }\n\n  render() {\n    return <div><CourseBanner\n      title={L`Ämnen`}\n      activePage=\"subjects\"\n      routes={{feedback: this.props.feedbackUrl}}\n     />\n      {this.state.uploadedSubject ?\n      <UploadedSubject\n        onCancel={()=>this.setState({uploadedSubject: null})}\n        onImportSuccess={subject => this.onImportSuccess(subject)}\n        {...this.state.uploadedSubject} />\n    : this.state.isListingSubjects ?\n      <div><p><Spinner/>Var god vänta medan ämnen hämtas...</p></div> :\n      <div>\n        <h2>{L`Ämnen`}</h2>\n        <ul>{this.state.subjects.map(s =>\n          <li key={s.id} className={s.publishable ? \"complete\" : \"incomplete\"}>\n            <Link to={\"/subjects/\" + s.id}>{s.name}</Link>\n          </li>)}\n        </ul>\n        <div className=\"drop-zone\" onDragOver={allowCopy} onDrop={ev=>this.handleFileSelect(ev)}>\n          Droppa Subject-fil här från skolverket (Hämtas från <a href=\"http://opendata.skolverket.se\" target=\"skolverket\">opendata.skolverket.se</a>)\n        </div>\n      </div>\n    }</div>\n  }\n}\n","import * as React from 'react';\nimport { L } from '../../../utils/utils';\nimport { Subject } from 'kedbackend/models';\nimport env from '../../../globals/KED.env';\nimport { HashRouter as Router, Route, Link, Redirect } from 'react-router-dom';\nimport { CourseBanner } from \"../courses/course-banner\";\nimport { Spinner } from \"../sub-components/spinner\";\n\ninterface Props {\n  id: string\n  feedbackUrl: string\n}\n\ninterface State {\n  subject: Subject\n}\n\nexport class ShowSubject extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {subject: null};\n  }\n\n  componentWillMount() {\n    this.load();\n  }\n\n  async load() {\n    const subject = await env.kedBackendClient.get<Subject>('subjects', this.props.id, { include: 'courseTemplates' });\n    this.setState({ subject });\n  }\n\n  render() {\n    if (!this.state.subject) return <p><Spinner /></p>;\n    const { name, code, courseTemplates } = this.state.subject;\n    return <div><CourseBanner\n      title={name}\n      activePage=\"subjects\"\n      routes={{feedback: this.props.feedbackUrl}}\n       />\n      <h2>Kurser för ämnet {name} ({code})</h2>\n      <ul className=\"entity-list\">\n        {courseTemplates.map(({id, name, code, publishable, points}) =>\n          <li key={id} className=\"complete\">\n            {name} - {points}p\n          </li>)}\n      </ul>\n    </div>;\n  }\n}\n","import * as React from 'react';\nimport { L } from '../../../utils/utils';\nimport { SkolverketSubject, SkolverketCourse } from './skolverket-subject';\nimport $ from 'jquery';\nimport env from '../../../globals/KED.env';\nimport { Subject, Course, Ability, KnowledgeRequirement, CentralContent } from 'kedbackend/models';\nimport { MutationRequest, BatchRunner, createUUID } from 'kedbackend/client';\nimport { SubjectToImport } from './subject-to-import';\nimport { loadCourse } from '../utils';\n\ninterface Props extends SkolverketSubject {\n  onCancel: () => void;\n  onImportSuccess: (subject: string) => void;\n}\n\ninterface Change {\n  change?: string;\n  content?: string;\n  mutations: (r: BatchRunner) => void;\n}\n\ninterface State {\n  showFullText: boolean;\n  changes: Change[];\n  isWorking: boolean,\n  isImporting: boolean\n}\n\nexport class UploadedSubject extends React.Component<Props, State> {\n  purposeElem: HTMLElement;\n  coursesElems: { [courseCode: string]: { course: SkolverketCourse, elem: HTMLElement } };\n  centralContentElems: HTMLElement[];\n  knowledgeRequirementElems: HTMLElement[];\n\n  constructor(props: Props) {\n    super(props);\n    this.coursesElems = {};\n    this.centralContentElems = [];\n    this.knowledgeRequirementElems = [];\n    this.state = {\n      showFullText: false,\n      changes: [],\n      isWorking: true,\n      isImporting: false\n    };\n  }\n\n  async componentDidMount() {\n    this.addClassesForCherryPickedElements();\n    try {\n      const changes = await this.diffWithExisting();\n      this.setState({ changes });\n    } finally {\n      this.setState({ isWorking: false });\n    }\n  }\n\n  addClassesForCherryPickedElements() {\n    const abilities = $(this.purposeElem).find('li').first().parent().children('li');\n    abilities.addClass('ability');\n    const centralContents = $(this.centralContentElems).find('li');\n    centralContents.addClass('central-content');\n    const knowledgeRequirements = $(this.knowledgeRequirementElems).find('p');\n    knowledgeRequirements.addClass('knowledge-requirement');\n    const all = $([abilities, centralContents, knowledgeRequirements]);\n    all.addClass('marked-area');\n  }\n\n  cherryPickData(): SubjectToImport {\n    //\n    // Reads elements (tagged by classes in addClassesForCherryPickedElements()) and converts their inner HTML to the corresponding\n    // model SubjectToImport. Note that if we need to adjust how to pick the right LI or P elements, we\n    // will only need to change the code in addClassesForCherryPickedElements(), not this code.\n    //\n    const skolSubject = this.props;\n    const abilities = Array.from($(this.purposeElem).find('li').first().parent().children('li'));\n\n    return {\n      name: skolSubject.name,\n      code: skolSubject.code,\n      abilities: abilities.map((a, i) => `${i + 1}. ${$(a).html()}`),\n      courses: Object.keys(this.coursesElems)\n        .map(courseCode => this.coursesElems[courseCode])\n        .map(({ course, elem }) => ({\n          name: course.name,\n          code: course.code,\n          points: course.points,\n          centralContent: Array.from($(elem).find('.central-content')).map(c => $(c).html()),\n          knowledgeRequirements:\n          Array.from($(elem).find('.grade-step-E .knowledge-requirement')).map(r => $(r).html())\n            .map(html => ({ gradeStep: \"E\", html }))\n            .concat(\n            Array.from($(elem).find('.grade-step-C .knowledge-requirement')).map(r => $(r).html())\n              .map(html => ({ gradeStep: \"C\", html })))\n            .concat(\n            Array.from($(elem).find('.grade-step-A .knowledge-requirement')).map(r => $(r).html())\n              .map(html => ({ gradeStep: \"A\", html })))\n        }))\n    };\n  }\n\n  async diffWithExisting(): Promise<Change[]> {\n    const subjectToImport = this.cherryPickData();\n    let changes: Change[] = [];\n    // Find existing Subject\n    const existingSubjects = await env.kedBackendClient.list<Subject>(\"subjects\");\n    let existingSubject = existingSubjects.filter(s => s.code === this.props.code)[0];\n    let centralContent = [] as CentralContent[],\n      knowledgeRequirements = [] as KnowledgeRequirement[];\n\n    let createTime = Date.now();\n    function ct() {\n      const rv = createTime;\n      createTime += 2;\n      return rv;\n    }\n\n    if (existingSubject) {\n      // Include abilities and standardCourses with the found Subject:\n      existingSubject = await env.kedBackendClient.get(\n        'subjects',\n        existingSubject.id, { include: \"courseTemplates\" });\n      // Lazily load all central contents and knowledgeRequirements on\n      // each course template\n      const expandedCourseTemplates = await Promise.all(\n        existingSubject.courseTemplates.map(ct => env.kedBackendClient.get<Course>(\"courses\", ct.id, {\n          include: [\n            'centralContent',\n            'knowledgeRequirements'\n          ]\n        })));\n\n      for (const courseTemplate of expandedCourseTemplates) {\n        // We don't have to include graphs. We already know that all courses\n        // with the same name and subjectCode will point to the same centralContent and\n        // same knowledgeRequirements.\n\n        // Now go through the XML data and record the order of centralContent\n        // and knowledgeRequirements:\n        const xmlCourse = subjectToImport.courses.find(c => c.name === courseTemplate.name);\n\n        const centralContentOrder = xmlCourse.centralContent\n          .map(html => courseTemplate.centralContent\n            .filter(cc => cc.name === html)\n            .map(cc => cc.id)[0]);\n\n        if (centralContentOrder.some(id => !id)) throw new Error(\n          \"Could not lookup all central contents!\");\n\n        const knowledgeRequirementsOrder = xmlCourse.knowledgeRequirements\n          .map(xmlKR => courseTemplate.knowledgeRequirements\n            .filter(kr => kr.name === xmlKR.html && kr.gradeStep === xmlKR.gradeStep)\n            .map(kr => kr.id)[0]);\n\n        if (knowledgeRequirementsOrder.some(id => !id)) throw new Error(\n          \"Could not lookup all knowledge requirements!\");\n\n        let derivedCourses = await env.kedBackendClient.list<Course>(\n          \"courses\", { name: courseTemplate.name });\n        // Just for sure - filter away courses with same name but different course code...\n        derivedCourses = derivedCourses.filter(c => c.subjectCode === subjectToImport.code);\n\n        for (const course of derivedCourses) {\n          if (!course.centralContentOrder ||\n            !course.knowledgeRequirementsOrder ||\n            course.centralContentOrder.join(',') !== centralContentOrder.join(',') ||\n            course.knowledgeRequirementsOrder.join(',') !== knowledgeRequirementsOrder.join(',')) {\n            course.centralContentOrder = centralContentOrder;\n            course.knowledgeRequirementsOrder = knowledgeRequirementsOrder;\n            changes.push({\n              change: \"Uppdatera ordningen för centralt innehåll och kunskapskrav\",\n              content: `${course.name} på ${course.school} (${course.description})`,\n              mutations: r => {\n                r.put(\"courses\", { ...course });\n              }\n            });\n          }\n        }\n      }\n    } else {\n      // Subject not imported before. Add it!\n      const newSubject: Subject = existingSubject = {\n        id: createUUID(),\n        acl: [\"role:USER:R\"],\n        code: subjectToImport.code,\n        name: subjectToImport.name,\n        publishable: false,\n        dateTime: ct()\n      };\n      changes.push({\n        change: \"Nytt ämne\",\n        content: `${subjectToImport.name} (${subjectToImport.code})`,\n        mutations: r => r.add(\"subjects\", newSubject)\n      });\n\n      const subjectAbilities = [];\n\n      for (let a of subjectToImport.abilities) {\n        const newAbility: Ability = {\n          id: createUUID(),\n          name: a,\n          acl: [\"role:USER:R\"],\n          dateTime: ct()\n        };\n\n        subjectAbilities.push(newAbility); // To refer from in courses later on!\n\n        changes.push({\n          change: \"Ny förmåga\",\n          content: a,\n          mutations: r => {\n            r.add(\"abilities\", newAbility);\n            r.link(\"subjects\", newSubject.id, \"abilities\", newAbility.id, \"abilities\");\n          }\n        });\n      }\n\n      for (let c of subjectToImport.courses) {\n        const newCourse: Course = {\n          id: createUUID(),\n          subjectCode: newSubject.code,\n          tags: [\"sub:\" + newSubject.code],\n          dateTime: ct(),\n          isTemplate: true,\n          acl: [\"role:EMPLOYEE:R\"], // Standardkurser endast synliga för lärare\n          name: c.name,\n          code: c.code,\n          points: c.points,\n          modules: [],\n          subjectId: newSubject.id,\n          resources: [],\n          createdBy: { name: env.currentUser.displayName, url: \"mailto:\" + env.currentUser.mail },\n          createdDate: Date.now(),\n          knowledgeRequirementsOrder: [],\n          centralContentOrder: []\n        };\n\n        changes.push({\n          change: \"Ny kurs\",\n          content: c.name,\n          mutations: r => {\n            r.add(\"courses\", newCourse);\n            r.link(\"subjects\", newSubject.id, \"courses\", newCourse.id, \"courseTemplates\");\n          }\n        });\n\n        for (let html of c.centralContent) {\n          // Check if there exists an identical central content on previous course first\n          let newCentralContent = centralContent.filter(cc => cc.name === html)[0];\n          if (!newCentralContent) {\n            newCentralContent = {\n              id: createUUID(),\n              dateTime: ct(),\n              name: html,\n              acl: [\"role:USER:R\"]\n            };\n            centralContent.push(newCentralContent);\n\n            changes.push({\n              change: \"Nytt centralt innehåll\",\n              content: html,\n              mutations: r => {\n                r.add(\"central-content\", newCentralContent);\n                r.link(\"courses\", newCourse.id, \"central-content\", newCentralContent.id, \"centralContent\");\n              }\n            });\n          } else {\n\n            changes.push({\n              mutations: r => {\n                r.link(\"courses\", newCourse.id, \"central-content\", newCentralContent.id, \"centralContent\");\n              }\n            });\n          }\n          // Register the order in which this central content appeared in the XML:\n          newCourse.centralContentOrder.push(newCentralContent.id);\n        }\n\n        for (let cr of c.knowledgeRequirements) {\n          let newKnowledgeRequirement = knowledgeRequirements.filter(kr => kr.name === cr.html && kr.gradeStep === cr.gradeStep)[0];\n          if (!newKnowledgeRequirement) {\n            newKnowledgeRequirement = {\n              id: createUUID(),\n              dateTime: ct(),\n              name: cr.html,\n              gradeStep: cr.gradeStep,\n              acl: [\"role:USER:R\"]\n            };\n\n            knowledgeRequirements.push(newKnowledgeRequirement);\n\n            changes.push({\n              change: \"Nytt kunskapskrav för betyget \" + cr.gradeStep,\n              content: cr.html,\n              mutations: r => {\n                r.add(\"knowledge-requirements\", newKnowledgeRequirement);\n                r.link(\"courses\", newCourse.id, \"knowledge-requirements\", newKnowledgeRequirement.id, \"knowledgeRequirements\");\n              }\n            });\n          } else {\n            changes.push({\n              mutations: r => {\n                r.link(\"courses\", newCourse.id, \"knowledge-requirements\", newKnowledgeRequirement.id, \"knowledgeRequirements\");\n              }\n            })\n          }\n          // Register the order in which this knowledge requirement appeared in the XML:\n          newCourse.knowledgeRequirementsOrder.push(newKnowledgeRequirement.id);\n        }\n        // Build knowledge matrix\n\n        // Link directly from course template to all abilities that the subject has:\n        for (const a of subjectAbilities) {\n          changes.push({\n            mutations: r => {\n              r.link(\"courses\", newCourse.id, \"abilities\", a.id, \"abilities\");\n            }\n          })\n        }\n      }\n    }\n    return changes;\n  }\n\n  cancel() {\n    this.props.onCancel();\n  }\n\n  async import() {\n    this.setState({ isWorking: true, isImporting: true });\n    const allMutations = this.state.changes.map(change => change.mutations);\n    try {\n      await env.kedBackendClient.do(r => {\n        allMutations.forEach(mut => mut(r));\n      });\n    } finally {\n      this.setState({ isWorking: false, isImporting: false });\n    }\n    this.props.onImportSuccess(this.props.name);\n  }\n\n  fixL(html: string) {\n    return html;//.replace('<l fromat=\"OL\">')\n  }\n\n  render() {\n    return <div><h1>{L`Uppladdat Ämne`}</h1>\n      {this.state.isWorking ? <p>Arbetar...</p> :\n        this.state.isImporting ? <p>Importerar...</p> :\n          this.state.changes.length === 0 ?\n            <div>\n              <p>Ämnet redan importerat.</p>\n              <button onClick={() => this.cancel()}> OK </button>\n            </div> :\n        <div>\n          <table><thead><tr>\n          <th colSpan={2}>Granskning av ändringar i grund-data</th>\n        </tr><tr>\n            <th>Ändring</th>\n            <th>Innehåll</th>\n          </tr></thead><tbody>\n            {this.state.changes.filter(change => change.change).map(change => <tr key={change.change + change.content}>\n              <td>{change.change}</td>\n              <td dangerouslySetInnerHTML={{ __html: change.content }} />\n            </tr>)}\n          </tbody></table>\n        <button onClick={() => this.cancel()} disabled={this.state.isImporting}>Avbryt</button>\n        <button onClick={() => this.import()} disabled={this.state.isImporting}>Importera</button>\n        <br />\n        </div>} \n      <button\n        onClick={() => this.setState({ showFullText: !this.state.showFullText })}>\n        {this.state.showFullText ?\n          L`Dölj nedan` :\n          L`Visa hela texten från Skolverket`}\n      </button>\n\n      {/* The table below is NOT just for show!\n          Functionality is dependent on its existence for importing stuff using jQuery to cherry-pick data. */}          \n      <table style={{ display: this.state.showFullText ? '' : 'none' }}><tbody><tr>\n        <th>\n          Namn\n          </th>\n        <td>\n          {this.props.name}\n        </td>\n      </tr><tr>\n          <th>\n            Ämneskod\n          </th>\n          <td>\n            {this.props.code}\n          </td>\n        </tr><tr>\n          <th>\n            Syfte\n          </th>\n          <td ref={elem => this.purposeElem = elem} dangerouslySetInnerHTML={{ __html: this.fixL(this.props.purpose) }} />\n        </tr><tr>\n          <th>\n            Kurser\n          </th>\n          <td>\n            {this.props.courses.map(course => <table key={course.code} ref={elem => this.coursesElems[course.code] = { course, elem }}><tbody>\n              <tr><th>Kursens namn</th><td>{course.name}</td></tr>\n              <tr><th>Kurskod</th><td>{course.code}</td></tr>\n              <tr><th>Poäng</th><td>{course.points}</td></tr>\n              <tr><th>Centralt innehåll</th><td ref={elem => this.centralContentElems.push(elem)} dangerouslySetInnerHTML={{ __html: this.fixL(course.centralContent) }} /></tr>\n              <tr><th>Kunskapskrav Betyg E</th><td className=\"grade-step-E\" ref={elem => this.knowledgeRequirementElems.push(elem)} dangerouslySetInnerHTML={{ __html: this.fixL(course.knownledgeRequirements.filter(r => r.gradeStep === 'E')[0].text) }} /></tr>\n              <tr><th>Kunskapskrav Betyg C</th><td className=\"grade-step-C\" ref={elem => this.knowledgeRequirementElems.push(elem)} dangerouslySetInnerHTML={{ __html: this.fixL(course.knownledgeRequirements.filter(r => r.gradeStep === 'C')[0].text) }} /></tr>\n              <tr><th>Kunskapskrav Betyg A</th><td className=\"grade-step-A\" ref={elem => this.knowledgeRequirementElems.push(elem)} dangerouslySetInnerHTML={{ __html: this.fixL(course.knownledgeRequirements.filter(r => r.gradeStep === 'A')[0].text) }} /></tr>\n            </tbody></table>)}\n          </td>\n        </tr></tbody></table>\n    </div>\n  }\n}\n","import moment from 'moment';\nimport { L } from '../../utils/utils';\nimport { Document, Resource, ModificationTracked, Course, Task } from 'kedbackend/models';\nimport { BatchRunner, createUUID } from 'kedbackend/client';\nimport update from 'react-addons-update';\nimport { User } from '../../contracts/ked-models';\nimport $ from 'jquery';\nimport env from '../../globals/KED.env';\n\nexport function updateDocumentGraphs(oldDoc, newDoc, table: string, graphs: { [label: string]: string }, batch: BatchRunner) {\n  const docUpdates = {};\n  const docId = newDoc.id;\n  for (let navProp of Object.keys(graphs)) {\n    const foreignTable = graphs[navProp];\n    const oldList: Document[] = oldDoc[navProp] || [];\n    const newList: Document[] = newDoc[navProp];\n    if (!newList) continue;\n    const tuples = newList\n      .map((doc, idx)=>({doc, idx})); // Create tubles of {doc, array-index} so we can update result\n    const added = tuples.filter(tuple => !oldList.some(o => o.id === tuple.doc.id)); // Find added items\n\n    for (let a of added) {\n      const mutatedSubDoc = {...a.doc};\n      const meta = mutatedSubDoc.$meta;\n      delete mutatedSubDoc.$meta; // Delete $meta so that \"add\" or \"update\" does not persiste to next state.\n      if (meta === 'add') {\n        if (!mutatedSubDoc.id) mutatedSubDoc.id = createUUID(); // Generate ID if not done yet.\n        // Now put an 'add' mutation in the batch queue.\n        batch.add(foreignTable, mutatedSubDoc);\n      } else if (meta === 'update') {\n        batch.put(foreignTable, mutatedSubDoc);\n      }\n      batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);\n\n      // Update result so that state is reflected after succesful POST to server.\n      if (!docUpdates[navProp]) docUpdates[navProp] = {};\n      docUpdates[navProp][a.idx] = {$set: mutatedSubDoc};\n    }\n    const removed = oldList.filter(o => !newList.some(n => n.id === o.id));\n    for (let r of removed) {\n      batch.unlink(table, docId, foreignTable, r.id, navProp);\n    }\n    const updated = tuples.filter(tuple => oldList.some(o => o.id === tuple.doc.id && tuple.doc.$meta === 'update'));\n    for (let u of updated) {\n      const mutatedSubDoc = {...u.doc};\n      delete mutatedSubDoc.$meta;\n      batch.put(foreignTable, mutatedSubDoc);\n\n      // Update result so that $meta is removed from navigation prop after successful POST to server.\n      if (!docUpdates[navProp]) docUpdates[navProp] = {};\n      docUpdates[navProp][u.idx] = {$set: mutatedSubDoc};\n    }\n  }\n  return update(newDoc, docUpdates);\n}\n\nexport function dtFormat(dateTime: number | Date | moment.Moment) {\n  return moment(dateTime).format('YYMMDD HH:mm');\n}\n\nexport function shortDateFormat(dateTime: number | Date | moment.Moment) {\n  return moment(dateTime).format('YYMMDD');\n}\n\nexport function updateModificationStamp (now: number, obj: ModificationTracked, user: User) {\n  return update(obj, {\n    dateTime: {$set: now}, // For queries...\n    modifiedDate: {$set: now},\n    modifiedBy: {\n      $set: {\n        name: user.displayName,\n        url: \"mailto:\" + user.mail\n      }\n    }\n  });\n}\n\nexport function updateCreationStamp (now: number, obj: ModificationTracked, user: User) {\n  return update(obj, {\n    createdDate: {$set: Date.now()},\n    createdBy: {\n      $set: {\n        name: user.displayName,\n        url: \"mailto:\" + user.mail\n      }\n    }\n  });\n}\n\nexport function updateModificationAndCreationStamps(obj: ModificationTracked, user: User) {\n  const now = Date.now();\n  obj = updateModificationStamp(now, obj, user);\n  if (!obj.createdBy) obj = updateCreationStamp(now, obj, user);\n  return obj;\n}\n\nexport function applyEtags(doc: Document, newEtags: {[id: string]: string}, graphs: string[]) {\n  const res = {...doc};\n  const etag = newEtags[doc.id];\n  if (etag)\n    res.$etag = etag;\n  for (let label of graphs) {\n    const newList = doc[label].map(d => applyEtags(d, newEtags, []));\n    res[label] = newList;\n  }\n  return res;\n}\n\nexport function readBlob(blob: Blob, m: (r:FileReader)=>void) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = ev => resolve((ev.target as any).result);\n    reader.onabort = ev => reject(new Error(\"file read aborted\"));\n    reader.onerror = ev => reject((ev.target as any).error);\n    m(reader);\n  });\n}\n\nexport function readBlobAsText (blob: Blob) {\n  return readBlob(blob, r=>r.readAsText(blob));\n}\n\nexport function readBlobAsDataUrl (blob: Blob) {\n  return readBlob(blob, r=>r.readAsDataURL(blob));\n}\n\nexport function allowCopy(e: React.DragEvent<HTMLDivElement>) {\n  e.stopPropagation();\n  e.preventDefault();\n  e.dataTransfer.dropEffect = 'copy';\n}\n\nexport function updateCourseBuilderStatus(status: 'unsaved' | 'saved' | 'error' | '') {\n  const div = $('div.course-builder')[0];\n  if (div) div.className = \"course-builder\" + (status ? \" status \" + status : \"\");\n}\n\nexport async function loadCourse(id: string, options?: {\n    includeTemplateChain?: boolean\n  }): Promise<Course>\n{\n  const client = env.kedBackendClient;\n  const includeTemplateChain = options && options.includeTemplateChain;\n  const [course, courseTasks, templateChain] = (await Promise.all([\n    client.get(\"courses\", id, {\n      include: [\n        \"centralContent\",\n        \"knowledgeRequirements\",\n        \"abilities\",\n        \"images\",\n        \"acl\" // Don't include tasks here...\n      ]\n    }),\n    // ... but include tasks here instead so that we can load the graphs for the\n    // tasks as well!\n    client.list(\"tasks\", {\n      hasEdgesFrom: id,\n      include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],\n      flags: ['includeIdsOnly'] // Don't need redundant info that's already on course\n    }),\n    includeTemplateChain && client.list(\"courses\", {\n      hasEdgesFrom: id,\n      flags: ['idsOnly']\n    })\n  ])) as [Course, Task[], Course[]];\n  course.tasks = courseTasks;\n\n  // Correct the order of KnowledgeRequirements\n  if (course.knowledgeRequirementsOrder) {\n    course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(id =>\n      course.knowledgeRequirements.find(c => c.id === id));\n  }\n\n  // Correct the order of CentralContent\n  if (course.centralContentOrder) {\n    course.centralContent = course.centralContentOrder.map(id =>\n      course.centralContent.find(cc => cc.id === id));\n  }\n  \n  // Include template chain if requested.\n  if (includeTemplateChain) course.templateChain = templateChain;\n  return course;\n}\n\n","/* REFACTOR: Move this component outside coursebuilder!\n   This is a general-purpose component\n*/\n\nimport * as React from 'react';\n\ninterface Props {\n  title: string | JSX.Element;\n  className?: string;\n  headerClassName?: string;\n  contentClassName?: string;\n  headerOpen?: boolean;\n  onOpenClose?: (becameOpen: boolean) => void;\n  children;\n}\n\ninterface State {\n  headerOpen: boolean;\n}\n\nexport class OpenCloseBox extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      headerOpen: props.headerOpen || false\n    };\n  }\n\n  componentWillReceiveProps (nextProps: Props) {\n    if (nextProps.headerOpen !== this.props.headerOpen) {\n      this.setState({headerOpen: nextProps.headerOpen});\n    }\n  }\n\n  render() {\n    const { title, className, children, headerClassName, contentClassName } = this.props;\n    const { headerOpen } = this.state;\n\n    return <div className={(className||'') + \" openClose\" + (headerOpen ? \" open\" : \"\")}>\n      <div className={\"openHeader\" + (headerClassName ? \" \" + headerClassName : \"\")}\n        onClick={() => {\n          if (this.props.onOpenClose) this.props.onOpenClose(!this.state.headerOpen);\n          this.setState({ headerOpen: !this.state.headerOpen });\n        }} >\n        {title}\n      </div>\n      <div className={\"openContent\" + (contentClassName ? \" \" + contentClassName : \"\")}>\n        {children}\n      </div>\n    </div>;\n  }\n}\n","import * as React from 'react';\nimport { L } from '../../utils/utils';\nimport $ from 'jquery';\n\ninterface Props {\n    text: string;\n    tag?: 'input' | 'textarea'\n    eager?: boolean;\n    onChange: (newName: string) => void;\n    placeholder?: string; // If text is empty, this will be the placeholder\n    clickAdvertiseText?: string;\n    maxChars?: number;\n    readOnly?: boolean;\n}\n\ninterface State {\n    editMode: boolean;\n    runtimeStyle: Object;\n    text: string | null;\n}\n\n/** \n * Makes a text element (such as an A or P tag) possible to replace with an input element of the same CSS style, for example by clicking on it.\n * \n*/\nexport class RenameableText extends React.Component<Props,State> {\n    label: HTMLElement;\n    input: HTMLInputElement | HTMLTextAreaElement;\n\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            editMode: false,\n            runtimeStyle: null,\n            text: props.text || \"\"\n        }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (this.props.text !== nextProps.text) {\n            this.setState({text: nextProps.text || \"\"});\n        }\n    }\n\n    render() {\n        const text = this.state.text || \"\";\n        return <div\n                className={\"renameable-text\" + (text ? \"\" : \" unnamed\") + (this.props.readOnly ? \" disabled\" : \"\")}\n                tabIndex={!this.state.editMode && 0}\n                onFocus={(e)=>{this.rename()}}\n                style={{width: \"100%\"}}\n            >\n            <div\n                ref={label => this.label = label}                \n                style={{\n                    display: this.state.editMode ? 'none' : ''\n                }}\n            >\n                {text || this.props.clickAdvertiseText}\n            </div>\n            {this.props.tag === 'textarea' ?\n                <textarea ref={input => this.input = input}\n                    maxLength={this.props.maxChars}\n                    style={{...this.state.runtimeStyle, display: this.state.editMode ? '' : 'none'}}\n                    onFocus={ev=>$(ev.target).select()}\n                    onBlur={this.onBlur.bind(this)}\n                    value={text}\n                    onKeyDown={this.onKeyDown.bind(this)}\n                    onChange={this.onChange.bind(this)}\n                    tabIndex={this.state.editMode && 0}\n                    placeholder={this.props.placeholder}\n                /> : \n                <input ref={input => this.input = input}\n                    type=\"text\"\n                    maxLength={this.props.maxChars}\n                    style={{...this.state.runtimeStyle, display: this.state.editMode ? '' : 'none'}}\n                    onFocus={ev=>$(ev.target).select()}\n                    onBlur={this.onBlur.bind(this)}\n                    value={text}\n                    onKeyDown={this.onKeyDown.bind(this)}\n                    onChange={this.onChange.bind(this)}\n                    tabIndex={this.state.editMode ? 0 : undefined}\n                    placeholder={this.props.placeholder}\n                />\n            }\n        </div>\n    }\n\n    onKeyDown(e: KeyboardEvent) {\n        if (e.keyCode === 27) { // ESC\n            this.input.value = this.props.text || \"\";\n            this.input.blur();\n            e.stopPropagation();\n        } else if (e.keyCode === 13) { // ENTER\n            this.propagateOnChange(this.input.value);\n            this.setState({ editMode: false, text: this.input.value });\n        }\n    }\n\n    onBlur(e: Event) {\n        this.propagateOnChange(this.input.value);\n        this.setState({ editMode: false, text: this.input.value });\n    }\n\n    propagatedOnChange: string;\n\n    propagateOnChange(newValue) {\n        if (this.propagatedOnChange != newValue) {\n            this.propagatedOnChange = newValue;\n            this.props.onChange(newValue);\n        }\n    }\n\n    onChange(e: Event) {\n        this.setState({ text: this.input.value });\n        if (this.props.eager) this.propagateOnChange(this.input.value);\n    }\n\n    rename(txt?: string) {\n        if (this.state.editMode || this.props.readOnly) return;\n        txt = txt || this.state.text || \"\";\n        const label = $(this.label);\n        this.setState({\n            text: txt,\n            editMode: true,\n            runtimeStyle: {\n                textAlign: label.css('textAlign'),\n                fontSize: label.css('font-size'),\n                paddingTop: label.css('paddingTop'),\n                paddingBottom: label.css('paddingBottom'),\n                paddingLeft: label.css('paddingLeft'),\n                paddingRight: label.css('paddingRight'),\n                marginTop: label.css('marginTop'),\n                marginBottom: label.css('marginBottom'),\n                marginLeft: label.css('marginLeft'),\n                marginRight: label.css('marginRight'),\n                borderRadius: label.css('borderRadius'),\n                backgroundColor: label.css('backgroundColor'),\n                lineHeight: label.css('lineHeight'),\n                fontWeight: label.css('fontWeight'),\n                outLine: 0,\n                borderStyle: 'none',\n                height: \"100%\",\n                width: \"100%\",\n                boxSizing: \"border-box\",\n            }\n        }, ()=>$(this.input).focus());\n    }\n}\n","import exec from './exec';\n\nexport default {\n  bold: {\n    icon: '<b>F</b>',\n    title: 'Fetstil',\n    result: () => exec('bold')\n  },\n  italic: {\n    icon: '<i>K</i>',\n    title: 'Kursiv',\n    result: () => exec('italic')\n  },\n  underline: {\n    icon: '<u>U</u>',\n    title: 'Understruken',\n    result: () => exec('underline')\n  },\n  strikethrough: {\n    icon: '<strike>S</strike>',\n    title: 'Struken',\n    result: () => exec('strikeThrough')\n  },\n  heading1: {\n    icon: '<b>H<sub>1</sub></b>',\n    title: 'Rubrik 1',\n    result: () => exec('formatBlock', '<H1>')\n  },\n  heading2: {\n    icon: '<b>H<sub>2</sub></b>',\n    title: 'Rubrik 2',\n    result: () => exec('formatBlock', '<H2>')\n  },\n  heading3: {\n    icon: '<b>H<sub>3</sub></b>',\n    title: 'Rubrik 3',\n    result: () => exec('formatBlock', '<H3>')\n  },\n  paragraph: {\n    icon: '&#182;',\n    title: 'Paragraf',\n    result: () => exec('formatBlock', '<P>')\n  },\n  quote: {\n    icon: '&#8220; &#8221;',\n    title: 'Citat',\n    result: () => exec('formatBlock', '<BLOCKQUOTE>')\n  },\n  olist: {\n    icon: '<i class=\"fa fa-list-ol\" aria-hidden=\"true\"></i>',\n    title: 'Ordnad lista',\n    result: () => exec('insertOrderedList')\n  },\n  ulist: {\n    icon: '<i class=\"fa fa-list\" aria-hidden=\"true\"></i>',\n    title: 'Punktlista',\n    result: () => exec('insertUnorderedList')\n  },\n  code: {\n    icon: '&lt;/&gt;',\n    title: 'Programkod',\n    result: () => exec('formatBlock', '<PRE>')\n  },\n  line: {\n    icon: '&#8213;',\n    title: 'Vågrät linje',\n    result: () => exec('insertHorizontalRule')\n  },\n  link: {\n    icon: '<i class=\"fa fa-link\" aria-hidden=\"true\"></i>',\n    title: 'Infoga länk',\n    result: () => {\n      const url = window.prompt('Ange länkens URL')\n      if (url) exec('createLink', url)\n    }\n  },\n  image: {\n    icon: '<i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>',\n    title: 'Infoga bild',\n    result: (ev, component) => {\n      const url = window.prompt('Ange bildens URL')\n      if (url) {\n        //exec('insertImage', url);\n        const img = document.createElement(\"img\");\n        img.src = url;\n        img.tabIndex = 1;\n        insertElement(img);\n        img.onfocus = component.onFocus;\n        img.onblur = component.onBlur;\n        component.props.onChange(component.contentDiv.innerHTML);\n      }\n    }\n  }\n}\n\nfunction insertElement(element: HTMLElement) {\n    var sel, range;\n    if (window.getSelection && (sel = window.getSelection()).rangeCount) {\n        range = sel.getRangeAt(0);\n        range.collapse(true);\n        range.insertNode(element);\n        // Move the caret immediately after the inserted span\n        range.setStartAfter(element);\n        range.collapse(true);\n        sel.removeAllRanges();\n        sel.addRange(range);\n    }\n}\n","import exec from './exec';\n\nexport default {\n  bold: {\n    icon: '<b>B</b>',\n    title: 'Bold',\n    result: () => exec('bold')\n  },\n  italic: {\n    icon: '<i>I</i>',\n    title: 'Italic',\n    result: () => exec('italic')\n  },\n  underline: {\n    icon: '<u>U</u>',\n    title: 'Underline',\n    result: () => exec('underline')\n  },\n  strikethrough: {\n    icon: '<strike>S</strike>',\n    title: 'Strike-through',\n    result: () => exec('strikeThrough')\n  },\n  heading1: {\n    icon: '<b>H<sub>1</sub></b>',\n    title: 'Heading 1',\n    result: () => exec('formatBlock', '<H1>')\n  },\n  heading2: {\n    icon: '<b>H<sub>2</sub></b>',\n    title: 'Heading 2',\n    result: () => exec('formatBlock', '<H2>')\n  },\n  heading3: {\n    icon: '<b>H<sub>3</sub></b>',\n    title: 'Heading 3',\n    result: () => exec('formatBlock', '<H3>')\n  },\n  paragraph: {\n    icon: '&#182;',\n    title: 'Paragraph',\n    result: () => exec('formatBlock', '<P>')\n  },\n  quote: {\n    icon: '&#8220; &#8221;',\n    title: 'Quote',\n    result: () => exec('formatBlock', '<BLOCKQUOTE>')\n  },\n  olist: {\n    icon: '&#35;',\n    title: 'Ordered List',\n    result: () => exec('insertOrderedList')\n  },\n  ulist: {\n    icon: '&#8226;',\n    title: 'Unordered List',\n    result: () => exec('insertUnorderedList')\n  },\n  code: {\n    icon: '&lt;/&gt;',\n    title: 'Code',\n    result: () => exec('formatBlock', '<PRE>')\n  },\n  line: {\n    icon: '&#8213;',\n    title: 'Horizontal Line',\n    result: () => exec('insertHorizontalRule')\n  },\n  link: {\n    icon: '&#128279;',\n    title: 'Link',\n    result: () => {\n      const url = window.prompt('Enter the link URL')\n      if (url) exec('createLink', url)\n    }\n  },\n  image: {\n    icon: '&#128247;',\n    title: 'Image',\n    result: () => {\n      const url = window.prompt('Enter the image URL')\n      if (url) exec('insertImage', url)\n    }\n  }\n}\n","export default (command, value = null) => {\n  document.execCommand(command, false, value)\n}\n","export default function imageEditActions(cb) {\n  return [{\n    name: 'float-left',\n    icon: `<div style=\"position:relative\">\n      <i class=\"fa fa-align-right\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; left:-4px;top:0; transform: scale(0.5); transform-origin: left top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>`,\n    title: 'Låt bilden flyta vänster om text',\n    result: () => cb('float-left')\n  }, {\n    name: 'float-right',\n    icon: `<div style=\"position:relative\">\n      <i class=\"fa fa-align-left\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; right:-4px;top:0; transform: scale(0.5); transform-origin: right top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>`,\n    title: 'Låt bilden flyta höger om text',\n    result: () => cb('float-right')\n  }, {\n    name: 'unfloat',\n    icon: `<div style=\"position:relative;\" aria-hidden=\"true\">\n      <div style=\"position:absolute;top:0;left:0\">&#8254;</div>\n      <div style=\"position:absolute;top:0:left:0;transform: scale(0.5); transform-origin: left bottom\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n      <div style=\"position:absolute;top:0;left:0\">_</div>\n    </div>`,\n    title: 'Placera bilden på egen rad',\n    result: () => cb('unfloat')\n  }];\n}\n\n","import * as React from 'react';\nimport exec from './exec';\nimport {washHtml} from './wash-html';\nimport imageEditActions from './image-edit-actions';\nimport actions from './actions';\n\nexport interface Action {\n  name?: string;\n  icon: string;\n  title: string;\n  result: (ev: React.MouseEvent<HTMLButtonElement>, component: Wysiwyg) => void;\n}\n\ninterface Props {\n  className?: string;\n  html: string;\n  onChange?: (html: string) => void;\n  defaultActions?: {[name: string]: Action};\n  actions?: (Partial<Action> | string)[];\n  readOnly?: boolean;\n}\n\ninterface State {\n  focusRect: ClientRect | null;\n}\n\nconst classes = {\n  actionbar: 'wysiwyg-actionbar',\n  button: 'wysiwyg-button',\n  content: 'wysiwyg-content',\n  focusrect: 'wysiwyg-focusrect',\n  focuspoint: 'wysiwyg-focuspoint',\n  readonlyContent: 'wysiwyg-content readonly'\n}\n\nexport class Wysiwyg extends React.Component<Props,State> {\n  contentDiv: HTMLDivElement;\n  focusRectDiv: HTMLDivElement;\n  focusElem: HTMLElement | null;\n  corner: string;\n  resizeStartX: number;\n\n  constructor (props: Props) {\n    super(props);\n    this.state = {focusRect: null};\n    this.onFocus = this.onFocus.bind(this);\n    this.onBlur = this.onBlur.bind(this);\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n  }\n\n  componentDidMount() {\n    Array.from(this.contentDiv.querySelectorAll(\"img,a\")).map(elem => (elem as (HTMLImageElement | HTMLAnchorElement)))\n    .forEach(elem => {\n      elem.tabIndex = 1;\n      elem.onfocus = this.onFocus;\n      elem.onblur = this.onBlur as any;\n    });\n    document.addEventListener('mousedown', this.onMouseDown);\n    document.addEventListener('mousemove', this.onMouseMove);\n    document.addEventListener('mouseup', this.onMouseUp);\n  }\n\n  componentDidUpdate() {\n    Array.from(this.contentDiv.querySelectorAll(\"img,a\")).map(elem => (elem as (HTMLImageElement | HTMLAnchorElement)))\n    .forEach(elem => {\n      elem.tabIndex = 1;\n      elem.onfocus = this.onFocus;\n      elem.onblur = this.onBlur as any;\n    });\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMouseDown);\n    document.removeEventListener('mousemove', this.onMouseMove);\n    document.removeEventListener('mouseup', this.onMouseUp);\n  }\n\n  shouldComponentUpdate(nextProps: Props, nextState: State) {\n    //this.contentDiv.onfocus = this.onFocus;\n    //this.contentDiv.onblur = this.onBlur;\n    return !this.contentDiv ||\n      nextState != this.state ||\n      nextProps.readOnly !== this.props.readOnly ||\n      nextProps.html !== this.contentDiv.innerHTML;\n  }\n\n  triggerOnChange(html: string) {\n    this.props.onChange && this.props.onChange(washHtml(html));\n  }\n\n  onFocus(ev: FocusEvent) {\n    const elem = ev.target as HTMLElement;\n    if (!elem || !elem.tagName) return;\n    if (elem.tagName !== 'IMG' && elem.tagName !== 'A') return;\n    const contentParent = this.contentDiv.parentElement;\n    const newState = {\n      focusRect: getRelatativeClientRect(contentParent, elem),\n    }\n    switch (elem.tagName) {\n      case 'A':\n      case 'IMG':\n\n      default: break;\n    }\n    this.setState(newState);\n    this.focusElem = elem;\n  }\n\n  onBlur(ev: React.FocusEvent<HTMLDivElement>) {\n    /*if (ev.relatedTarget) {\n      const relatedTarget = ev.relatedTarget as HTMLElement;\n      if (relatedTarget.className && relatedTarget.className.split(' ').indexOf(classes.button) >= 0) {\n        // A image action button was pressed\n        set\n        return;\n      }\n    }*/\n    if ((ev.target === this.focusElem && ev.relatedTarget !== this.focusRectDiv) ||\n      ev.target === this.focusRectDiv)\n    {\n      this.setState({focusRect: null});\n    }\n  }\n\n  makeClickable(elem: HTMLElement) {\n     elem.tabIndex = 1;\n  }\n\n  onMouseDown(ev) {\n    if ((ev.target.className || \"\").split(' ').indexOf(classes.focuspoint) >= 0) {\n      const corner = this.getRectCorner(ev);\n      this.corner = corner;\n      this.resizeStartX = ev.clientX;\n    }\n  }\n\n  onMouseMove(ev: MouseEvent) {\n    if (this.corner && this.state.focusRect && this.focusElem) {\n      ev.preventDefault();\n      // TODO: Räkna ut baserat på this.corner hur bildens storlek borde ändras.\n      // Leta upp bilden per ID från this.contentDiv\n      // Sätt DIV:ens style attribut width till ny width.\n      // Om DIV:en redan hade height, sätt ny height med samma aspect ratio som innan,\n      // annars, sätt inte height alls (eller möjligtvis till auto))\n      const focusRect = this.focusRectDiv.getBoundingClientRect();\n      if (focusRect.width < 32) return;\n      //const currentWidth = focusRect.width;\n      //const currentHeight = focusRect.height;\n      //const hasHeightStyle = !this.focusElem.style.height || this.focusElem.style.height === \"auto\";\n      const newWidth = Math.max(32, this.corner.endsWith('l') ?\n        focusRect.width + (this.resizeStartX - ev.clientX) :\n        //focusRect.right - ev.clientX :\n        focusRect.width - (this.resizeStartX - ev.clientX));\n      this.resizeStartX = ev.clientX;\n        //ev.clientX - focusRect.left;\n      const factor = newWidth / focusRect.width;\n      const newHeight = focusRect.height * factor;\n      this.focusElem.style.width = newWidth + \"px\";\n      this.focusElem.style.height = newHeight + \"px\";\n      this.setState({\n        focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem),\n      });\n    }\n  }\n\n  onMouseUp(ev) {\n    if (this.corner && this.state.focusRect && this.focusElem) {\n      this.corner = null;\n      this.triggerOnChange(this.contentDiv.innerHTML);\n    }\n  }\n\n  getRectCorner(ev) {\n    for (const className of (ev.target.className || '').split(' ')) {\n      switch (className) {\n        case 'fpul':\n          return 'ul';\n        case 'fpur':\n          return 'fpur';\n        case 'fplr':\n          return 'lr';\n        case 'fpll':\n          return 'll';\n      }\n    }\n    return null;\n  }\n\n  execImageEditAction (cmd: string) {\n    //console.log(cmd);\n    if (!this.focusElem) return;\n    //console.log(\"doing it\");\n    switch (cmd) {\n      case 'float-left':\n        this.focusElem.style.cssFloat = 'left';\n        break;\n      case 'float-right':\n        this.focusElem.style.cssFloat = 'right';\n        break;\n      case 'unfloat':\n        this.focusElem.style.cssFloat = '';\n        break;\n    }\n    this.triggerOnChange(this.contentDiv.innerHTML);\n    this.setState({focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem)});\n  }\n\n  render() {\n    const defaultActions = this.props.defaultActions || actions;\n    let actionsToUse = this.props.actions ? this.props.actions.map(action =>\n      typeof action === 'string' ?\n        defaultActions[action] :\n        defaultActions[action.name] ?\n          { ...defaultActions[action.name], ...action } :\n          action)\n    : Object.keys(defaultActions).map(action => defaultActions[action]);\n\n    if (this.state.focusRect) {\n      actionsToUse = actionsToUse.concat(imageEditActions(cmd => this.execImageEditAction(cmd)));\n    }\n\n    const {focusRect} = this.state;\n    const {readOnly} = this.props;\n\n    return <div className={this.props.className}>\n      {!readOnly && <div className={classes.actionbar}>\n        {actionsToUse.map((action, idx) =>\n          <button key={idx} className={classes.button}\n            dangerouslySetInnerHTML={{__html: action.icon}}\n            title={action.title}\n            onMouseDown={ev=>{action.result(ev, this)}}\n            onMouseUp={ev=>setTimeout(()=>this.contentDiv.focus(), 10)}\n          />)}\n      </div>}\n      <div className={readOnly ? classes.readonlyContent : classes.content} style={{position: 'relative', top: 0, left: 0}}>\n        <div className=\"editor\"\n          ref={div => this.contentDiv = div}\n          dangerouslySetInnerHTML={{__html: washHtml(this.props.html)}}\n          contentEditable={!readOnly}\n          onInput={ev => this.triggerOnChange((ev.target as any).innerHTML)}\n          onKeyDown={ev => {\n            if (readOnly) return;\n            //console.log(\"Key: \" + ev.which);\n            if (ev.which >= 35 && ev.which <= 40) {// home/end/up/down/left/right\n              ev.stopPropagation(); // Prevent entire page from scrolling??\n            }\n            if (ev.which === 9) ev.preventDefault();\n            if ((ev.keyCode === 8 || ev.keyCode === 46) && this.focusElem && this.state.focusRect) {\n              if (this.focusElem && this.focusElem.parentElement) {\n                this.focusElem.parentElement.removeChild(this.focusElem);\n              }\n              this.focusElem = null;\n              this.setState({focusRect: null});\n              this.triggerOnChange(this.contentDiv.innerHTML);\n            }\n          }}\n        />\n        {focusRect && <div\n          ref={div => this.focusRectDiv = div}\n          className={classes.focusrect}\n          onBlur={this.onBlur}\n          tabIndex={1}\n          style={{\n            outline: 0,\n            position: 'absolute',\n            top: this.state.focusRect.top,\n            left: this.state.focusRect.left,\n            width: this.state.focusRect.width,\n            height: this.state.focusRect.height}}>\n          <div className={classes.focuspoint + \" fpul\"} style={{position:'absolute', top:0, left:0}} />\n          <div className={classes.focuspoint + \" fpur\"} style={{position:'absolute', top:0, right:0}} />\n          <div className={classes.focuspoint + \" fplr\"} style={{position:'absolute', bottom:0, right:0}} />\n          <div className={classes.focuspoint + \" fpll\"} style={{position:'absolute', bottom:0, left:0}} />\n        </div>}\n      </div>\n    </div>\n  }\n}\n\nfunction getRelatativeClientRect (parent: HTMLElement, child: HTMLElement) : ClientRect {\n  const parentRect = parent.getBoundingClientRect();\n  const childRect = child.getBoundingClientRect();\n  return {\n    top: childRect.top - parentRect.top + parent.scrollTop,\n    left: childRect.left - parentRect.left + parent.scrollLeft,\n    bottom: childRect.bottom - parentRect.top + parent.scrollTop,\n    right: childRect.right - parentRect.left + parent.scrollLeft,\n    width: childRect.width,\n    height: childRect.height\n  };\n}\n","import $ from 'jquery';\n\nconst parser = new DOMParser();\n\ntype HTMLPolicy = {[tagNameLower: string]: {[attributeLower: string]: boolean}};\n\n/** Tags / Attributes Whitelist\n * \n */\nconst HTML_WASH_POLICY: HTMLPolicy = {\n  b: {},  // bold\n  i: {},  // italic\n  p: {},  // paragraph\n  u: {},  // underline\n  strike: {}, // strike-through\n  pre: {}, // unformatted\n  h1: {}, // heading 1\n  h2: {}, // heading 2\n  h3: {}, // heading 3\n  h4: {}, // heading 4\n  h5: {}, // heading 5\n  img: {src: true, class: true, style: true, tabindex: true}, // image. We set style and tabindex ourselves. Accept that.\n  a: {href: true, target: true}, // link\n  ul: {}, // Unordered list\n  ol: {}, // Ordered list\n  li: {}, // list item\n  hr: {}, // Horizontal rule\n  br: {}, // Break line\n  div: {},// Of some reason, divs are sometimes inserted when pressing ENTER in the wysiwyg editor.\n  span: {},// Spans are harmless, just remove their style and other attributes and I feel great.\n  // table tags:\n  table: {border: true},\n  tbody: {},\n  thead: {},\n  tfoot: {},\n  tr: {},\n  td: {headers: true, colspan: true, rowspan: true},\n  th: {abbr: true, headers: true, scope: true, sorted: true, colspan: true, rowspan: true}\n};\n\nexport function washHtml (html: string): string {\n  const doc = parser.parseFromString(html, \"text/html\");\n  const {childNodes} = doc.body;\n  let modified = false;\n  for (let i=0; i<childNodes.length; ++i) {\n    if (washNode(childNodes.item(i))) {\n      modified = true;\n    }\n  }\n  return modified ?\n    doc.body.innerHTML :\n    html; // By returning the original HTML string, we spare the user from refreshing the edit area,\n          // which would otherwise put the cursor at the top, losing the position where user where.\n}\n\nfunction washNode(node: Node | Element | HTMLElement): boolean {\n  let modified = false;\n  if (isElement(node)) {\n    if (washElement(node)) {\n      modified = true;\n    }\n  }\n  if (washChildNodes(node)) {\n    modified = true;\n  }\n  return modified;\n}\n\nfunction washChildNodes(node: Node) {\n  let modified = false;\n  const {childNodes} = node;\n  for (let i=0; i<childNodes.length; ++i) {\n    if (washNode(childNodes.item(i))) {\n      modified = true;\n    }\n  }\n  return modified;\n} \n\n/** Replace an element with its child nodes.\n * \n */\nfunction removeMiddleElement(element: Element) {\n  const {childNodes} = element;\n  for (let i=0; i<childNodes.length; ++i) {\n    element.parentNode.insertBefore(childNodes.item(i), element);\n  }\n  element.remove();\n}\n\nfunction washElement(element: Element): boolean {\n  const policy = element.tagName && HTML_WASH_POLICY[element.tagName.toLowerCase()];\n  if (!policy) {\n    console.warn(\"Wysiwyg: not allowed tag\", element.tagName);\n    washChildNodes(element);\n    removeMiddleElement(element);\n    return true;\n  }\n  let modified = false;\n  for (let i=0; i<element.attributes.length; ++i) {\n    const attr = element.attributes.item(i);\n    const allowed = attr.name && !!policy[attr.name.toLowerCase()];\n    if (!allowed) {\n      modified = true;\n      console.warn(\"Wysiwyg: not allowed attribute\", attr.name);\n      element.removeAttribute(attr.name);\n    }\n  }\n  return modified;\n}\n\nfunction isElement(node: Node) : node is Element {\n  return !!(node as Element).tagName;\n}\n","import {TC} from '../utils/utils';\n\nexport type Term = 'AT' | 'ST';\nexport type AcademicYear = string; // \"2016/2017\", \"2017/2018\", ...\nexport type SchoolGrade = number; // 0-9 (grundskola), 10-13 (gymnasium)\nexport type Grade = 'A' | 'B' | 'C' | 'D' | 'E';\n\nexport interface User {\n    username?: string;\n    mail: string;\n    displayName: string;\n    roles: string[];\n    schoolGrade?: number;\n    school?: string;\n    schoolType?: string;\n}\n\nexport interface LearningModuleTasks {\n    moduleName: string;\n    url?: string;\n    subject: SchoolSubject;\n    commonTasks?: LearningTask[];\n    learningGoals: LearningGoal[];\n}\n\nexport interface LearningGoal {\n    name: string;\n    tasks?: LearningTask[];\n}\n\nexport interface CustomGoal {\n  name: string,\n  url: string,\n  course: string,\n  description: string\n}\n\n\n/*export interface LearningGoal {\n    id?: string;\n    name: string;\n    courseId?: string;\n    subjectId?: string;\n}*/\n\n\nexport interface LearningTask {\n    name: string;\n    url?: string;\n    description?: string;\n    done?: boolean;\n}\n\nexport interface LearningCourse {\n    name: string;\n    url?: string;\n}\n\nexport interface SchoolSubject {\n    name: string;\n    course: LearningCourse;\n}\n\nexport class Course {\n    //Schema: \"[year+term+schoolYear+name],sortorder\";\n    id?: string;\n    //aYear: string; // Academic Year / Läsår / \"2016/2017\", \"2017/2018\", ...\n    //schoolGrade: number; // Årskurs (0-9 grundskola, 10-13 gymnasium). 100 = ej bundet till årskurs.\n    //term?: Term; // AT (Autumn Term) / ST (Spring Term)\n    name: string;\n    points?: number;\n    modules?: CourseModule[];\n    learningGoals?: LearningGoal[];\n    url?: string;\n}\n\n\nexport interface CourseModule {\n    id?: string;\n    courseId: string;\n    name: string;\n    readonly url: string;\n}\n\nexport interface TargetGrade {\n    id?: string;\n    user: string;\n    courseId?: string;\n    subjectId?: string;\n    aYear?: AcademicYear; // Läsår, tex \"2016/2017\". null means final goal.\n    term?: Term; // null means final goal.\n    grade: Grade;\n}\n\n\nexport const futureAbilities = [\n    \"Lära att lära\",\n    \"Samarbeta\",\n    \"Agera globalt\",\n    \"Visa handlingskraft\",\n    \"Vara innovativ\",\n    \"Leva digitalt\"];\n","import '../../global-setters/set-bearer-providers';\nconst bearerPromise = env.bearerProvider.getBearer(); // Start getting bearer as soon as possible.\nimport '../../global-setters/set-ked-backend-client';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport env from '../../globals/KED.env';\nimport { CourseBuilder } from '../../components/course-builder';\nimport $ from 'jquery';\nimport { showError, showInfo } from \"../../utils/utils\";\nimport { Spinner } from \"../../components/course-builder/sub-components/spinner\";\n\ninterface Props {\n  viewCourseUrl: string;\n  feedbackUrl: string;\n}\n\ninterface State {\n  isTokenLoaded: boolean;\n}\n\nexport class KEDAppCourseBuilder extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isTokenLoaded: false\n    }\n  }\n\n  componentWillMount() {\n    bearerPromise.then(()=>{\n      this.setState({isTokenLoaded: true});\n    }).catch(err => {\n      showError(err);\n    });\n  }\n\n  render() {\n    return this.state.isTokenLoaded ?\n      <CourseBuilder\n        viewCourseUrl={this.props.viewCourseUrl}\n        feedbackUrl={this.props.feedbackUrl} /> :\n      <p><Spinner/>V.g. vänta... autenticerar...</p>\n  }\n}\n","import KED from '../../globals/KED';\nimport * as components from './app.coursebuilder.client';\nKED.components = {...KED.components, ...components};\n","import { User } from '../contracts/ked-models';\nimport { parseQueryString } from '../utils/query-string';\nimport env from '../globals/KED.env';\n\nexport class Features {\n  EditUserTasksViaPenOnly?: boolean;\n  SubTasks?: boolean;\n  AssignmentTasks?: boolean;\n\n  constructor () {\n    const user = env.currentUser!;\n    const query = parseQueryString(location.search, {toLower: true});\n    const features = ((query.features||'').split(',') as string[])\n      .map(feature => feature.toLowerCase()); // Can be used on forwards...\n\n    this.EditUserTasksViaPenOnly =\n      user.schoolType !== 'Grundskolor' && query.schooltype !== \"Grundskolor\";\n    this.SubTasks =\n      user.schoolType !== 'Grundskolor' && query.schooltype !== \"Grundskolor\";\n    this.AssignmentTasks = !!query.testversion;\n  }\n}\n","export * from './features';\n","import { parseQueryString, generateQueryString, splitUrlAndQuery } from \"../utils/query-string\";\nimport { KedBackendClientWeb, WebServerBearerProvider, isomorphic, storage } from 'kedbackend/clientweb';\nimport { BearerProvider, KedBearerProvider } from 'kedbackend/client';\nimport cfg from '../globals/KED.cfg';\nimport env from '../globals/KED.env';\nimport { User } from \"../contracts/ked-models\";\nimport { IMPERSONATION_QUERY_PARAMS } from \"../access-control/index\";\nimport { cherryPickProps } from \"../utils/utils\";\n\nfunction getMergedTokenPath(tokenPath: string, locationSearch: string, scopes: string[]) {\n  // Merge configured query params of token path with params given to current page\n  const currentQuery = parseQueryString(locationSearch);\n  const impersonationProps = cherryPickProps(currentQuery, IMPERSONATION_QUERY_PARAMS);\n  const [tokenPathWithoutQuery, tokenQueryString] = splitUrlAndQuery(tokenPath);\n  const tokenPathQuery = parseQueryString(tokenQueryString);\n  return tokenPathWithoutQuery + generateQueryString({\n    ...tokenPathQuery,\n    ...impersonationProps,\n    scopes: scopes.join(',')\n  });\n}\n\nfunction getTokenId(mergedTokenPath: string, userEmail: string) {\n  return mergedTokenPath + \"/\" + userEmail;\n}\n\nfunction saveUserInfo(user: User, tokenId: string) {\n  env.currentUser = user;\n  sessionStorage.setItem(\"userInfo\" + tokenId, JSON.stringify(user));\n}\n\nfunction loadUserInfo(tokenId: string) {\n  const storedSessionUser = sessionStorage.getItem(\"userInfo\" + tokenId);\n  if (storedSessionUser) {\n    env.currentUser = JSON.parse(storedSessionUser);\n  }\n}\n\nfunction createBearerProvider(mergedTokenPath: string, userEmail: string) {\n  const tokenId = getTokenId(mergedTokenPath, userEmail);\n  return new WebServerBearerProvider(mergedTokenPath, responseText => {\n    const res = JSON.parse(responseText) as { ok: boolean, error?: string, token?: string, user?: User };\n    if (!res.ok) throw new Error(res.error);\n    if (res.user) {\n      saveUserInfo(res.user, tokenId);\n    }\n    return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };\n  }, tokenId);\n}\n\nfunction createGoogleTokenProvider(mergedTokenPath: string, userEmail: string) {\n  const tokenId = getTokenId(mergedTokenPath, userEmail);\n  return new WebServerBearerProvider(mergedTokenPath, responseText => {\n    const res = JSON.parse(responseText) as { ok: boolean, error?: string, token?: string, user?: User };\n    if (!res.ok) throw new Error(res.error);\n    return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };\n  }, tokenId);\n}\n\nfunction createTestTokenProvider(tokenUrl: string, user: User, scopes: string[]) {\n  return new KedBearerProvider(\n    isomorphic,\n    storage,\n    tokenUrl + user.mail + location.search,\n    cfg.KED_CLIENT_ID,\n    cfg.KED_CLIENT_SECRET,\n    tokenUrl, {\n      email: user.mail.toLowerCase(),\n      roles: user.roles,\n      school: user.school,\n      schoolType: user.schoolType,\n      scopes\n    });\n}\n\n// env.currentUser.mail is set by SiteVision server initially.\n// A response from /api/token may change the mail attribute of the current\n// user, so env.currentUser.mail may be different after getting a response.\n// However, the initial value is valuable always in order to distinguish the case\n// when one normal user logs out and another user logs in.\nconst initialUserEmail = env.currentUser && env.currentUser.mail; // Initial value of mail. May change.\nif (initialUserEmail) {\n  // KED\n  if (cfg.KED_TOKEN_PATH) {\n    //\n    //\n    // Production / SiteVision proxied /api/token to request tokens from:\n    //\n    //\n    const mergedTokenPath = getMergedTokenPath(\n      cfg.KED_TOKEN_PATH,\n      location.search, [\n        \"kedbackend\",\n        \"EDS\",\n      ]);\n    env.bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);\n    loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));\n\n    // Google\n    const googleMergedPath = getMergedTokenPath(\n      cfg.KED_TOKEN_PATH,\n      location.search, [\n        \"https://www.googleapis.com/auth/calendar.readonly\",\n      ]);\n    env.googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);\n  } else if (cfg.KED_TOKEN_URL && cfg.KED_CLIENT_ID && cfg.KED_CLIENT_SECRET) {\n    //\n    //\n    // Test - go directly to KEDAUTH server to retrieve tokens\n    //\n    //\n    env.bearerProvider = createTestTokenProvider(cfg.KED_TOKEN_URL, env.currentUser, [\n      \"kedbackend\",\n      \"EDS\",\n    ]);\n    env.googleTokenProvider = createTestTokenProvider(cfg.KED_TOKEN_URL + \"/google\", env.currentUser, [\n      \"https://www.googleapis.com/auth/calendar.readonly\",\n    ]);\n  } else {\n    throw new Error(`Missing configuration parameter KED_TOKEN_PATH`);\n  }\n}\n","import env from '../globals/KED.env';\nimport cfg from '../globals/KED.cfg';\nimport { KedBackendClientWeb } from 'kedbackend/clientweb';\n\nenv.kedBackendClient = new KedBackendClientWeb (\n  cfg.KED_API_URL,\n  env.bearerProvider);\n\n","import KED from './KED';\n\n/* This default configuration is used as a fallback.\nNormally both test pages and production pages will override these configrations\n*/\n/*const defaultConfiguration = {\n  // Environment\n  ENVIRONMENT: 'development' as 'production' | 'development' | 'test',\n  // Authentication Server:\n  KED_TOKEN_URL: 'https://kedauthtest.azurewebsites.net/token',\n  KED_TOKEN_PATH: '/api/token.Skript.portlet?sv.contenttype=application/json',\n  KED_CLIENT_ID: 'devclient',\n  KED_CLIENT_SECRET: '4fRdfQpWtJqjTWf',\n  // Services:\n  KED_API_URL: 'https://kedbackendtest.azurewebsites.net/api/',  \n  EDS_API_URL: 'https://edsportalowinapi.azurewebsites.net/api/'\n}*/\n\nexport interface IKedConfiguration {\n  ENVIRONMENT: 'production' | 'development' | 'test';\n  KED_TOKEN_URL: string;\n  KED_TOKEN_PATH: string;\n  KED_CLIENT_ID: string;\n  KED_CLIENT_SECRET: string;\n  KED_API_URL: string;\n  EDS_API_URL: string;\n};\n\nif (!KED.cfg) KED.cfg = {};\n\nexport default KED.cfg as IKedConfiguration;\n","import {User, LearningModuleTasks} from '../contracts/ked-models';\nimport { KedBackendClient, BearerProvider } from 'kedbackend/client';\nimport {UserTask} from 'kedbackend/models';\nimport {KedRepo} from '../repos/ked-repo';\nimport {EdsClient} from '../apis/edsclient';\nimport KED from './ked';\n\nexport interface Env {\n    currentUser?: User;\n    learningModuleTasks?: LearningModuleTasks;\n    bearerProvider?: BearerProvider;\n    googleTokenProvider?: BearerProvider;\n    kedBackendClient?: KedBackendClient;\n    edsClient?: EdsClient;\n    userTasksRepo?;\n    hiddenCoursesRepo?;\n}\n\nif (!KED.env) KED.env = {};\n\nexport default KED.env as Env;\n","\nexport const KED_NAMESPACE = \"KED\";\n\ndeclare var KED: any;\n\nvar result = typeof KED === 'undefined' ? {} : KED;\n\nif (typeof window !== 'undefined' && typeof KED === 'undefined') {\n    window[KED_NAMESPACE] = result;\n}\n\nexport default result;\n","\nexport const KED_NAMESPACE = \"KED\";\n\ndeclare var KED: any;\n\nvar result = typeof KED === 'undefined' ? {} : KED;\n\nif (typeof window !== 'undefined' && typeof KED === 'undefined') {\n    window[KED_NAMESPACE] = result;\n}\n\nexport default result;\n","\n\nexport interface RepoCommunicator<T extends {id: string}> {\n  query(): Promise<T[]>;\n}\n\ntype Subscriber<T> = (items:T[]) => any;\n\nexport class Repo<T extends {id: string}> {\n  listPromise: Promise<void>;\n  items: T[];\n  subscribers: Subscriber<T>[];\n\n  constructor(public comm: RepoCommunicator<T>) {\n    this.listPromise = null;\n    this.items = null;\n    this.subscribers = [];\n  }\n\n  subscribe(subscriber: Subscriber<T>) {\n    return this.ensureHasData().then(()=>{\n      subscriber(this.items);\n      this.subscribers.push(subscriber);\n    });\n  }\n\n  unsubscribe(subscriber: Subscriber<T>) {\n    this.subscribers = this.subscribers.filter (s => s !== subscriber);\n  }\n\n  notifySubscribers() {\n    this.subscribers.forEach(s => s(this.items));\n  }\n\n  ensureHasData() {\n    if (!this.listPromise) this.refreshFromServer();\n    return this.listPromise;\n  }\n\n  refreshFromServer() {\n    this.listPromise = this.comm.query().then(items => {\n      this.items = items;\n      this.notifySubscribers();\n    });\n    return this.listPromise;\n  }\n  \n  async update(item: T | T[]) {\n    await this.ensureHasData();\n    const items = Array.isArray(item) ? item : [item];\n    this.items = this.items.map(it => {\n      const item = items.find(({id}) => it.id === id);\n      return item ?\n        Object.assign({}, item) :\n        it;\n    });\n    this.notifySubscribers();\n  }\n\n  insert(item: T | T[]) {\n    return this.ensureHasData().then(()=>{\n      this.items = this.items.concat(item);\n      this.notifySubscribers();\n    });\n  }\n\n  delete(id: string | string[]) {\n    const ids = Array.isArray(id) ? id : [id];\n    return this.ensureHasData().then(()=>{\n      this.items = this.items.filter(it => !ids.some(id => it.id === id));\n      this.notifySubscribers();\n    });\n  }\n}\n","import { Repo, RepoCommunicator } from './repo';\nimport { Course, School } from 'kedbackend/models';\nimport env from '../globals/KED.env';\nimport { flatten, L } from \"../utils/utils\";\n\nclass SchoolCoursesRepo extends Repo<Course> {\n  private _schoolId: string;\n  getSchoolId() {\n    return this.ensureHasData().then(()=>this._schoolId);\n  }\n\n  constructor(getSchoolName: ()=>string) {\n    super({\n      query: async () => {\n        const schoolName = getSchoolName();\n        const schools = await env.kedBackendClient.list<School>(\n          \"schools\", {\n            name: schoolName,\n            include: [\"courses\"]\n          });\n        this._schoolId = schools.length > 0 && schools[0].id;\n        if (!this._schoolId) throw new Error(L`Skolan ${schoolName} finns inte registrerad i systemet.\n          Kontakta en administratör för Kursbyggarverktyget och be om att lägga till skolan med namnet \"${schoolName}\"`);\n        return flatten(schools.map(school => school.courses));\n      }\n    })\n  }\n}\n\nexport const mySchoolCoursesRepo = new SchoolCoursesRepo(()=>env.currentUser.school);\n","\nexport class CachedResponse<T> {\n    promise: Promise<T> | null;\n    result: T | null;\n    constructor(public queryer: ()=>Promise<T>) {\n        this.promise = null;\n        this.result = null;\n    }\n\n    query() {\n        return this.promise ?\n            this.promise :\n            (this.promise = this.queryer().then(x => this.result = x));\n    }\n\n    reset() {\n        this.promise = null;\n    }\n}\n","import * as React from 'react';\nimport {L} from './utils';\nimport $ from 'jquery';\n\ninterface Props {\n}\n\ninterface State {\n  error: string | undefined;\n  info: string | undefined;\n}\n\nexport class ErrorSuccessFeedback extends React.Component<Props,State> {\n  constructor (props: Props) {\n    super(props);\n    this.state={\n      error: undefined,\n      info: undefined\n    };\n    this._unhandledRejection = this._unhandledRejection.bind(this);\n    this._error = this._error.bind(this);\n    this._customError = this._customError.bind(this);\n    this._onInfo = this._onInfo.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener('unhandledrejection', this._unhandledRejection);\n    window.addEventListener('error', this._error);\n    window.addEventListener('customerror', this._customError);\n    window.addEventListener('info', this._onInfo);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('unhandledrejection', this._unhandledRejection);\n    window.removeEventListener('error', this._error);\n    window.removeEventListener('customerror', this._customError);\n    window.removeEventListener('info', this._onInfo);\n  }\n\n  _unhandledRejection (ev: Event & {reason: Error}) {\n    this.setState({error: ev.reason ? ev.reason.message : L`Ett okänt fel inträffade...`, info: null});\n    setTimeout(()=>this.setState({error: null}), 10000);\n  }\n\n  _error (ev: Event & {error: Error}) {\n    this.setState({error: ev.error ? ev.error.message : L`Ett okänt fel inträffade...`, info: null});\n    setTimeout(()=>this.setState({error: null}), 10000);\n  }\n\n  _customError (ev: CustomEvent) {\n    this.setState({error: ev.detail, info: null});\n    setTimeout(()=>this.setState({error: null}), 10000);\n  }\n\n  _onInfo(ev: CustomEvent) {\n    this.setState({error: null, info: ev.detail });\n    setTimeout(()=>this.setState({info: null}), 10000);\n  } \n\n  render() {\n    return <div className=\"error-success-feedback\" style={{\n      position: \"fixed\",\n      left: 0,\n      top: 0,\n      width: \"100%\",\n      pointerEvents: 'none'\n    }}>\n      <div style={{display: 'table', margin: \"0 auto\"}}>\n        <p className=\"error\" style={{display: this.state.error ? \"\" : \"none\"}}>{this.state.error && this.state.error}</p>\n        <p className=\"info\" style={{display: this.state.info ? \"\" : \"none\"}}>{this.state.info}</p>\n      </div>\n    </div>;\n  }\n}\n","import $ from 'jquery';\n\nconst HEARTBEAT_INTERVAL = 5 * 60 * 1000; // 5 minutes.\nconst HEARTBEAT_URL = \"/4.4b4cce2a160e445593f16043.html\"; // Could be any protected resource. BUGBUG: Configurable.\n\nlet lastActivity = Date.now();\n\nexport function keepSessionAlive() {\n  setInterval(onTimeout, HEARTBEAT_INTERVAL);\n  setTimeout(()=>$('body')\n    .mousemove(onUserActive)\n    .keypress(onUserActive)\n    .scroll(onUserActive), 100);\n}\n\nfunction onUserActive() {\n  lastActivity = Date.now();\n}\n\nfunction onTimeout() {\n  const inactivityTime = Date.now() - lastActivity;\n  if (inactivityTime < HEARTBEAT_INTERVAL) {\n    heartbeat();\n  }\n}\n\nasync function heartbeat() {\n  console.log(`Sending heartbeat request to ${HEARTBEAT_URL}`);\n  try {\n    const res = await fetch(HEARTBEAT_URL, {\n      cache: 'no-cache',\n      credentials: 'same-origin'\n    });\n    console.log(`Response from ${HEARTBEAT_URL}: ${res.status} ${res.statusText}`);\n  } catch (err) {\n    console.warn(`Request to ${HEARTBEAT_URL} failed: ${err}`);\n  }\n}\n","export interface ParseQueryStringOptions {\n  toLower?: boolean;\n}\n\nexport function parseQueryString(locationSearch: string, options?: ParseQueryStringOptions): { [key: string]: string } {\n  const {toLower} = (options || {}) as ParseQueryStringOptions;\n  const result = {};\n  if (locationSearch && locationSearch.length > 1)\n    locationSearch.substr(1)\n      .split('&')\n      .map(part => part.split('=').map(s => decodeURIComponent(s.trim())))\n      .forEach(([key, value]) => result[toLower ? key.toLowerCase() : key] = value);\n  return result;\n}\n\nfunction encodeParams(params: {[key: string]:string}) {\n  return Object.keys(params).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`).join('&');\n}\n\nexport function generateQueryString(params: {[key: string]:string}) {\n  return \"?\" + encodeParams(params);\n}\n\nexport function parseHashQueryString(locationHash: string, options?: ParseQueryStringOptions) {\n  return parseQueryString(locationHash, options);\n}\n\nexport function generateHashQueryString(params: {[key: string]:string}) {\n  return \"#\" + encodeParams(params);\n}\n\nexport function splitUrlAndQuery (urlWithPossibleQuery: string) {\n  const pQuery = urlWithPossibleQuery.indexOf('?');\n  return pQuery >= 0 ?\n    [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :\n    [urlWithPossibleQuery, \"\"];\n}\n","\nexport function capitalizeFirst (str) {\n    for (let i=0, l=str.length; i<l; ++i) {\n        if (str.charCodeAt(i) < 0x2000) {\n            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);\n        }\n    }\n    return str;\n}\n\nexport function extend(obj, extension) {\n    if (typeof extension !== 'object') return obj;\n    Object.keys(extension).forEach(key => {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\n\nexport function clone<T,E> (obj : T, extension?: E) {\n    let clone = {};\n    Object.getOwnPropertyNames(obj).forEach(key => {\n        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));\n    });\n    if (extension) extend(clone, extension);\n    return clone as (T & E);\n}\n\nconst concat = [].concat;\nexport function flatten<T> (a : (T | T[])[]) {\n    return concat.apply([], a) as T[];\n}\n\nexport function compareProp(prop:string) {\n    return (a,b) => {\n        const aProp = a[prop], bProp = b[prop];\n        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;\n    }\n}\n\nexport function compareProps(props: string | string[], locales?: string | string[], options?: Intl.CollatorOptions) {\n    props = Array.isArray(props) ? props : [props];\n\n    const localeCompare = (a,b) =>\n        typeof a === 'string' ?\n            a.localeCompare(b, locales, options) :\n            a < b ? -1 : a > b ? 1 : 0;\n\n    return props\n        .map(prop => (a,b) => localeCompare(a[prop], b[prop]))\n        .reduce((cmp1, cmp2) =>\n            (a,b) => cmp1(a,b) || cmp2(a,b));\n}\n\nexport function L(text, ...args) {\n    let first = text[0];\n    return buildMessage(text, args);\n}\n\nfunction buildMessage (text, args) {\n    let rv = text[0];\n    for (let i=1, l=text.length; i<l; ++i) {\n        rv += args[i-1] + text[i];\n    }\n    return rv;\n}\n\nexport class TC<T> {\n    constructor(template: T) {\n        extend(this, template);\n    }\n}\n\nexport function dateTimeReviver (key, value) {\n    var a;\n    if (typeof value === 'string') {\n        a = /\\/Date\\((\\d*)\\)\\//.exec(value);\n        if (a) {\n            return new Date(+a[1]);\n        }\n    }\n    return value;\n}\n\nexport function showInfo (msg) {\n    var event = new CustomEvent('info', { 'detail': msg });\n    window.dispatchEvent(event);\n}\n\nexport function showError (errMsg: string | Error) {\n    const msg = typeof errMsg === 'string' ? errMsg : errMsg.message;\n    var event = new CustomEvent('customerror', { 'detail': msg });\n    console.error(errMsg);\n    window.dispatchEvent(event);\n}\n\nexport function maxLength(str: string, maxLen: number) {\n    return str.length > maxLen ?\n        str.substr(0, maxLen - 3) + \"...\" :\n        str;\n}\n\nexport function arrayToLookup<T>(a: T[], keyAccessor: (item: T) => string | number) {\n    const result : {[key: string] : T[]} = {};\n    for (let i=0, l=a.length; i<l; ++i) {\n        const item = a[i];\n        const key = keyAccessor(item);\n        let array = result[key];\n        if (array) array.push(item);\n        else result[key] = [item];\n    }\n    return result;\n}\n\nexport function arrayToMap<T>(a: T[], keyAccessor: (item: T) => string | number) {\n    const result : {[key: string] : T} = {};\n    for (let i=0, l=a.length; i<l; ++i) {\n        const item = a[i];\n        const key = keyAccessor(item);\n        result[key] = item;\n    }\n    return result;\n}\n\nexport function cherryPickProps<T> (obj: T, propsToPick: string[]): Partial<T> {\n    const result = {};\n    for (const param of propsToPick) {\n      if (param in obj) result[param] = obj[param];\n    }\n    return result as Partial<T>;\n}\n\nexport function distinct<T> (a: T[], keyAccessor: (item: T) => any) {\n    const map = arrayToMap(a, keyAccessor);\n    return Object.keys(map).map(key => map[key]);\n}\n","module.exports = jQuery;","module.exports = React;","module.exports = ReactDOM;"],"sourceRoot":""}