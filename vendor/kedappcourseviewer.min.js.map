{"version":3,"sources":["webpack://[name]/webpack/bootstrap","webpack://[name]/external \"React\"","webpack://[name]/./src/utils/utils.ts","webpack://[name]/./src/globals/ked.ts","webpack://[name]/./src/globals/KED.env.ts","webpack://[name]/./src/components/weekplanner/weekplanner-persisted-state.ts","webpack://[name]/./src/repos/user-tasks-repo.ts","webpack://[name]/external \"jQuery\"","webpack://[name]/./src/globals/KED.cfg.ts","webpack://[name]/./src/utils/query-string.ts","webpack://[name]/./src/components/course-builder/utils.ts","webpack://[name]/./src/access-control/get-user-claims.ts","webpack://[name]/./src/access-control/index.ts","webpack://[name]/./src/components/course-builder/sub-components/spinner.tsx","webpack://[name]/../kedbackend/js/ked-backend-client/utils.ts","webpack://[name]/./src/utils/school-moment.ts","webpack://[name]/../kedbackend/js/ked-backend-client-web/bearer-storage-sessionstorage.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate-task.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/migrate-course.ts","webpack://[name]/../kedbackend/js/ked-model-migrator/index.ts","webpack://[name]/../kedbackend/js/ked-backend-client-web/index.ts","webpack://[name]/../kedbackend/js/ked-backend-client/restclient.ts","webpack://[name]/external \"ReactDOM\"","webpack://[name]/./src/globals/KED.ts","webpack://[name]/../kedbackend/js/ked-backend-client/ked-bearer-provider.ts","webpack://[name]/../kedbackend/js/ked-backend-client/access-control.ts","webpack://[name]/../kedbackend/js/ked-backend-client/http-error.ts","webpack://[name]/../kedbackend/js/ked-backend-client/index.ts","webpack://[name]/./src/apis/eds-stubdata/ActiveCourses.ts","webpack://[name]/./src/apis/eds-stubdata/LatestAssessments.ts","webpack://[name]/./src/apis/eds-stubdata/StudentGoals.ts","webpack://[name]/./src/apis/edsclient.ts","webpack://[name]/./src/components/utility-components/open-close-box.tsx","webpack://[name]/./src/utils/weekutil.ts","webpack://[name]/./src/repos/hidden-courses-repo.ts","webpack://[name]/./src/repos/ked-repo.ts","webpack://[name]/./src/utils/school-term.ts","webpack://[name]/./src/components/course-builder/sub-components/remove-item.tsx","webpack://[name]/./src/globals/moment-sv-locale.ts","webpack://[name]/./src/components/course-viewer/subcomponents/confirmation.tsx","webpack://[name]/./src/components/course-viewer/subcomponents/task-list.tsx","webpack://[name]/./src/features/features.ts","webpack://[name]/./src/repos/repo.ts","webpack://[name]/./src/components/utility-components/dialogs.tsx","webpack://[name]/./src/components/calendar/course-name-to-css-class.ts","webpack://[name]/./src/components/weekplanner/get-task-type.ts","webpack://[name]/./src/components/weekplanner/user-tasks-box.tsx","webpack://[name]/./src/components/weekplanner/add-custom-goal.tsx","webpack://[name]/./src/components/utility-components/form-field.tsx","webpack://[name]/./src/components/utility-components/form-field-text-input.tsx","webpack://[name]/./src/components/utility-components/form-field-textarea.tsx","webpack://[name]/./src/components/weekplanner/add-custom-task.tsx","webpack://[name]/./src/components/weekplanner/add-or-edit-sub-task.tsx","webpack://[name]/./src/components/weekplanner/edit-user-task.tsx","webpack://[name]/./src/utils/pending-job.ts","webpack://[name]/./src/components/weekplanner/weekplanner.tsx","webpack://[name]/./src/components/weekplanner/refiner.ts","webpack://[name]/./src/global-setters/set-ked-backend-client.ts","webpack://[name]/./src/global-setters/set-bearer-providers.ts","webpack://[name]/./src/components/list-courses/list-courses.tsx","webpack://[name]/./src/utils/error-success-feedback.tsx","webpack://[name]/./src/components/course-viewer/subcomponents/learning-goals-list.tsx","webpack://[name]/./src/global-setters/set-eds-client.ts","webpack://[name]/./node_modules/moment/locale sync sv|en","webpack://[name]/./src/components/course-viewer/course-page/course-banner.tsx","webpack://[name]/./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx","webpack://[name]/./src/components/course-viewer/subcomponents/abilities-box.tsx","webpack://[name]/./src/components/course-viewer/subcomponents/central-content-box.tsx","webpack://[name]/./src/components/course-viewer/course-page/get-customized-task.ts","webpack://[name]/./src/components/course-viewer/course-page/course-module-page.tsx","webpack://[name]/./src/components/course-viewer/utils/get-included-ids.ts","webpack://[name]/./src/components/course-viewer/subcomponents/resource-list.tsx","webpack://[name]/./src/components/course-viewer/course-page/run-up-page.tsx","webpack://[name]/./src/components/course-viewer/utils/manual-scroll-restoration.ts","webpack://[name]/./src/components/course-viewer/course-page/task-assignments.tsx","webpack://[name]/./src/components/course-viewer/course-page/task-page.tsx","webpack://[name]/./src/components/course-viewer/course-page/index.tsx","webpack://[name]/./src/components/list-courses/list-courses-page.tsx","webpack://[name]/./src/components/course-viewer/index.tsx","webpack://[name]/./src/elements/KEDAppCourseViewer/app.courseviewer.client.tsx","webpack://[name]/./src/elements/KEDAppCourseViewer/webpack-entry.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","4","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","p","jsonpArray","window","oldJsonpFunction","bind","slice","React","capitalizeFirst","str","charCodeAt","substr","toLocaleUpperCase","extend","obj","extension","keys","forEach","key","clone","getOwnPropertyNames","getOwnPropertyDescriptor","concat","flatten","a","compareProp","prop","b","aProp","bProp","compareProps","props","locales","options","Array","isArray","map","localeCompare","reduce","cmp1","cmp2","L","text","args","_i","arguments","rv","buildMessage","dateTimeReviver","exec","Date","showInfo","msg","event","CustomEvent","detail","dispatchEvent","showError","errMsg","message","console","error","maxLength","maxLen","arrayToLookup","keyAccessor","item","array","arrayToMap","cherryPickProps","propsToPick","propsToPick_1","param","distinct","KED","ked","env","__webpack_exports__","weekplanner_persisted_state_WeekPlannerPersistedState","WeekPlannerPersistedState","userOrCopy","this","user","lastWrite","now","weekDate","moment_sv_locale","startOf","valueOf","openCourses","assign","load","cookie","localStorage","getItem","storedData","JSON","parse","state","isExpired","moment_default","save","json","stringify","setItem","asOf","isBefore","add","EXPIRATION_HOURS","VERSION","user_tasks_repo_userTasksRepo","KED_env","userTasksRepo","user_tasks_repo_UserTasksRepo","_super","UserTasksRepo","_this","getClient","kedBackendClient","optimistic","table","currentUser","mail","getQueryOptions","tslib_es6","userEmail","persistedState","_a","_b","sent","weekNumber","week","from","kedWeek","weekutil","year","notBefore","to","notAfter","role","include","flags","updatePersistedState","stateChanges","mem","notifySubscribers","setTaskDoneState","userTask","done","client","modifiedItem","update","$meta","list","cache","similarTasks","identicalTasks","filter","t","courseName","learningGoal","task","id","join","course","setSubTaskDoneState","subTaskId","subTasks","st","setWeekPlannerBoxOpen","isOpen","changeWeek","newPersisted","refreshFromServer","subscribe","subscriber","proxySubscriber","userTasks","ut","weekTexts","kedbackend_client","dateTime","assessment","strategy","acl","school","ac","toString","unsubscribe","subscribers","ked_repo","ensureHasData","jQuery","_KED__WEBPACK_IMPORTED_MODULE_0__","cfg","parseQueryString","locationSearch","toLower","split","part","decodeURIComponent","trim","toLowerCase","encodeParams","params","encodeURIComponent","generateQueryString","splitUrlAndQuery","urlWithPossibleQuery","pQuery","indexOf","updateDocumentGraphs","oldDoc","newDoc","graphs","batch","docUpdates","docId","navProp","foreignTable","oldList","newList","tuples","doc","idx","added_1","tuple","some","meta","mutatedSubDoc","tslib__WEBPACK_IMPORTED_MODULE_0__","kedbackend_client__WEBPACK_IMPORTED_MODULE_2__","put","link","$set","removed_1","unlink","updated_1","u","react_addons_update__WEBPACK_IMPORTED_MODULE_3___default","dtFormat","moment__WEBPACK_IMPORTED_MODULE_1___default","format","shortDateFormat","updateModificationStamp","modifiedDate","modifiedBy","displayName","url","updateCreationStamp","createdDate","createdBy","updateModificationAndCreationStamps","applyEtags","newEtags","res","etag","$etag","graphs_1","label","readBlob","blob","Promise","resolve","reject","reader","FileReader","onload","ev","target","onabort","Error","onerror","readBlobAsText","readAsText","readBlobAsDataUrl","readAsDataURL","allowCopy","e","stopPropagation","preventDefault","dataTransfer","dropEffect","updateCourseBuilderStatus","status","div","jquery__WEBPACK_IMPORTED_MODULE_4___default","className","loadCourse","_globals_KED_env__WEBPACK_IMPORTED_MODULE_5__","includeTemplateChain","all","hasEdgesFrom","courseTasks","templateChain","tasks","knowledgeRequirementsOrder","knowledgeRequirements","find","centralContentOrder","centralContent","cc","getUserClaims","type","roles","access_control_IMPERSONATION_QUERY_PARAMS","access_control_hasAccess","requestedRight","claims","fromStringArray","access_control_hasWriteAccess","access_control_isTeacherAtSchool","isTeacher","belongsToSchool","access_control_impersonationEnv","actAs","currentQuery","query_string","location","search","newQuery","newQueryString","href","hash","access_control_actAs","access_control_preserveImpersonationQuery","query","IMPERSONATION_QUERY_PARAMS_1","Spinner","react__WEBPACK_IMPORTED_MODULE_0__","aria-hidden","createUUID","replace","Math","random","floor","avoidSimultanousCalls","method","ongoingPromise","then","getFirstAndLastWeekOfTerm","term","getTermStartAndEnd","month","moment__WEBPACK_IMPORTED_MODULE_0___default","getSchoolMoment","thisYear","isAutumn","academicYear","addYear","aYear","numYearsToAdd","yearStr","parseInt","BearerStorageSessionStorage","tokenInfo","sessionStorage","token","expires","ex","migrateTask","resources","migrate_migrate","taskIds","responsibleTeachers","resourses","migrate_course_migrateCourse","__migrator_mixed_in","ked_model_migrator_KedModelMigratorMixin","ked_backend_client","ked_backend_client_web_storage","ked_backend_client_web_timeOfPageLoad","ked_backend_client_web_WebServerBearerProvider","WebServerBearerProvider","tokenPath","tokenResponseMapper","tokenId","getBearer","utils","refreshBearer","fetch","headers","Accept","redirect","credentials","_e","wantsRedirect","log","reload","_c","_d","ked_backend_client_web_isomorphic","self","btoa","ked_backend_client_web_KedBackendClientWeb","KedBackendClientWeb","apiBaseUrl","providerOrTokenPath","bearerProvider","x","ked_backend_client_web_extends","_utils__WEBPACK_IMPORTED_MODULE_0__","RestClient","isomorphic","baseUrl","fetchOptions","mode","authHeader","bearer","username","password","path","__assign","nocache","queryStr","Authorization","wwwauth","test","post","Content-Type","body","delete","ReactDOM","ked_bearer_provider_KedBearerProvider","KedBearerProvider","storage","clientId","clientSecret","tokenUrl","tokenQuery","restclient","retries","warn","statusText","DocumentAccess","accessClaimType","accessClaimValue","right","fromString","claimType","unescape","claimValue","escape","accessComponent","toStringArray","hasAccess","userClaims","claim","HttpError","code","__extends","ked_backend_client_KedBackendClient","KedBackendClient","http","getMyClaims","reqs","sort","req1","req2","op","do","scopeFn","runner","ked_backend_client_BatchRunner","mutationRequests","deleteRealm","realm","share","unshare","sourceTable","sourceId","targetTable","targetId","link2","unlink2","BatchRunner","ked_backend_client_assign","courses","courseId","periodName","periodGoalGrade","shortName","courseSteps","stepId","isCompleted","completedDate","assessments","publishDateTime","gradeName","courseUnitName","studyPlans","StudyPlans","finalGoalGrade","strategyText","periodGoals","edsclient_privatizingCacheBust","edsclient_EdsClient","EdsClient","getActiveCourses","edsclient_avoidSimultanousCalls","getLatestAssessments","getStudentGoals","getStudentFutureAbilities","q","courseCode","CourseCode","PeriodName","ex_1","edsclient_templateObject_1","limit","isNaN","Count","studentGoals","studentFutureAbilities","edsclient_EDSPeriod","EDSPeriod","periodStringOrSchoolTerm","period","startsWith","schoolTerm","school_term","StubEdsClient","ongoingPromises","argsJson","react__WEBPACK_IMPORTED_MODULE_1__","OpenCloseBox","headerOpen","componentWillReceiveProps","nextProps","setState","render","title","children","headerClassName","contentClassName","onClick","onOpenClose","KEDWeek","locale","toDate","getTime","getAdjustedWeek","weekday","hiddenCoursesRepo","_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__","HiddenCoursesRepo","fullCourse","notifySubscriber","visible","err","kedRepo","_ked_repo__WEBPACK_IMPORTED_MODULE_1__","initPromise","init","kedCoursesPromise","edsCoursesPromise","catch","_utils_utils__WEBPACK_IMPORTED_MODULE_3__","bearerPromise","listKedCourses","listEDSCourses","userHiddenCoursesResolved","userHiddenCoursesPromise","resolveUserHiddenCoursesPromise","userHiddenCourses","activeCourses","edsActiveCourses","createCoursesList","cacheBust","schools","_apis_edsclient__WEBPACK_IMPORTED_MODULE_5__","_utils_school_moment__WEBPACK_IMPORTED_MODULE_6__","moment__WEBPACK_IMPORTED_MODULE_7___default","edsClient","hiddenCoursesMap","hc","show","visibleCoursesMap","isStudent","edsCourseMap","description","edsCourse","defaultVisible","hideCourse","overrides","items","insert","kedbackend_client__WEBPACK_IMPORTED_MODULE_4__","ov","showCourse","KedRepo","_repo__WEBPACK_IMPORTED_MODULE_1__","queryOptions","getCacheBust","regenerateCacheBust","upsert","updater","updatedItem","modifiedItems","memRepoItem","it","br","ids","freshItems","freshItem","modified","undefined","stripGraphs","graph","stripped","foreignItems","stripped_1","SchoolTerm","dateOrSchoolMoment","schoolMoment","_school_moment__WEBPACK_IMPORTED_MODULE_1__","nextTerm","prevTerm","toLocaleString","shortYear","locales_1","RemoveItem","style","_utils_utils__WEBPACK_IMPORTED_MODULE_2__","templateObject_1","updateLocale","months","monthsShort","weekdays","weekdaysShort","weekdaysMin","longDateFormat","LT","LTS","LL","LLL","LLLL","lll","llll","calendar","sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse","relativeTime","future","past","ss","mm","h","hh","dd","M","MM","y","yy","dayOfMonthOrdinalParse","ordinal","number","dow","doy","localMoment","confirmation_Confirmation","external_React_","onConfirm","onCancel","task_list_TaskList","TaskList","confirmations","onChange","persisted","componentDidMount","user_tasks_repo","componentWillUnmount","toggleTask","learningTask","siteVisionPageId","latestTimeStamp","max","deadline","step","learningTasks","weekPlannerWeek","currentWeek","forWeekString","task_list_templateObject_1","task_list_templateObject_2","task_list_templateObject_3","taskLookupId","isWorking","selected","describedAction","task_list_templateObject_4","task_list_templateObject_5","confirmationVisible","tid","opacity","features_Features","features","feature","EditUserTasksViaPenOnly","schoolType","schooltype","SubTasks","AssignmentTasks","testversion","Repo","comm","listPromise","Dialogs","componentDidUpdate","prevProps","lastDiv","dialogs","react_dom__WEBPACK_IMPORTED_MODULE_3__","first","focus","popDialog","attr","css","dialog","ref","elem","tabIndex","aria-disabled","onKeyPress","which","tagName","click","onKeyDown","ctrlKey","metaKey","domNode","_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__","courseNameToCssClass","cssPrefix","getTaskType","user_tasks_box_UserTasksBox","UserTasksBox","learningGoals","src_features","open_close_box","user_tasks_box_templateObject_1","course_name_to_css_class","becameOpen","setIsOpen","lg","removeLearningGoal","taskType","expired","setTaskDone","viewCourseUrl","courseUrl","access_control","user_tasks_box_getTaskUrl","editTask","host","subTask","setSubTaskDone","editSubTask","addOwnTask","user_tasks_box_templateObject_2","add_custom_goal_AddCustomGoal","AddCustomGoal","onSave","size","autoFocus","form_field_FormField","FormField","htmlFor","node","recucheck","Set","findId","has","child","childId","form_field_text_input_TextInput","TextInput","placeholder","form_field_textarea_TextAreaFormField","TextAreaFormField","cols","rows","add_custom_task_AddCustomTask","AddCustomTask","isTask","add_or_edit_sub_task_AddOrEditSubTask","AddOrEditSubTask","closeDialog","newSubTask_1","isEditMode","edit_user_task_EditUserTask","EditUserTask","onUserTasksChanged","myUserTask","isModified","addSubTask","openDialog","showCalendar","onUpdate","onDelete","isCustomTask","es","datePicker","dateFormat","popperPlacement","onBlur","setOpen","pending_job_PendingJob","PendingJob","callback","timeoutId","cancelled","pending","isJobExecuting","jobCallback","triggerChange","throttle","clearTimeout","setTimeout","launchJob","stop","weekplanner_WeekPlanner","WeekPlanner","saving","weekTextsUT","isLoading","weekTextsSavingJob","saveWeekTexts","newState","isWeekTextsEdited","prevWeek","openAddGoalDialog","weekplanner_templateObject_1","addCustomGoal","openAddOwnTaskDialog","learningGoalName","weekplanner_templateObject_2","addCustomTask","weekplanner_templateObject_3","confirm","allTasks","copyFromPreviousWeek","prevWeekNo","prevKEDWeek","prevTasks","prevTask","taskOfCurrentWeek","copies","copy","taskSets","tasksPerCourse","tasksPerLearningGoal","resultLearningGoals","lgTasks","learningGoalTask","refiner_refine","isSaving","isStrategyEdited","isAssessmentEdited","enableSaveButton","weekplanner_templateObject_4","weekplanner_templateObject_5","spinner","weekplanner_templateObject_6","weekplanner_templateObject_7","weekplanner_templateObject_8","utility_components_dialogs","_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__","kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__","_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__","KED_API_URL","getMergedTokenPath","scopes","_utils_query_string__WEBPACK_IMPORTED_MODULE_1__","impersonationProps","_utils_utils__WEBPACK_IMPORTED_MODULE_7__","_access_control_index__WEBPACK_IMPORTED_MODULE_6__","tokenPathWithoutQuery","tokenQueryString","tokenPathQuery","getTokenId","mergedTokenPath","createTestTokenProvider","kedbackend_client__WEBPACK_IMPORTED_MODULE_3__","_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__","KED_CLIENT_ID","KED_CLIENT_SECRET","email","storedSessionUser","initialUserEmail","KED_TOKEN_PATH","responseText","ok","saveUserInfo","createBearerProvider","googleMergedPath","googleTokenProvider","createGoogleTokenProvider","KED_TOKEN_URL","ListCourses","updateHiddenCourses","componentWillMount","_repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_6__","templateObject_2","_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__","visibleCourses","hiddenCourses","_utils_query_string__WEBPACK_IMPORTED_MODULE_4__","_access_control_index__WEBPACK_IMPORTED_MODULE_5__","ErrorSuccessFeedback","info","_unhandledRejection","_error","_customError","_onInfo","addEventListener","removeEventListener","reason","_utils__WEBPACK_IMPORTED_MODULE_2__","position","left","top","width","pointerEvents","display","margin","LearningGoalsList","commonTasks","_task_list__WEBPACK_IMPORTED_MODULE_2__","_apis_edsclient__WEBPACK_IMPORTED_MODULE_3__","EDS_API_URL","./en-au","./en-au.js","./en-ca","./en-ca.js","./en-gb","./en-gb.js","./en-ie","./en-ie.js","./en-nz","./en-nz.js","./sv","./sv.js","webpackContext","req","webpackContextResolve","course_banner_CourseBanner","backgroundImage","tabs","activeTab","isActive","knowledge_requirements_table_KnowledgeRequirementsTable","KnowledgeRequirementsTable","requirements","includedIds","columns","row","grade","pNext","findIndex","gradeStep","toUpperCase","every","column","dangerouslySetInnerHTML","__html","abilities_box_AbilitiesBox","AbilitiesBox","subTitle","abilities","central_content_box_CentralContentBox","CentralContentBox","get_customized_task_getCustomizedTask","taskCustomizations","course_module_page_CourseModulePage","CourseModulePage","incluedIds","getIncludedIds","assignmentTasks","assignment","nonAssignmentTasks","mandatoryContent","startWeek","endWeek","task_list","learning_goals_list","resource_list_ResourceList","ResourceList","resource","run_up_page_RunUpPage","RunUpPage","runUpText","teacher","workFlowLink","initialized","task_assignments_ALLOWED_EXTENSIONS","task_assignments_TaskAssignments","TaskAssignments","assignments","loading","setStatePromised","cb","taskId","err_1","error_1","onDrag","onDrop","file_1","files","filename","uploadingFile","upload","error_2","file","task_assignments_MAX_FILE_SIZE_MB","lowerFilename","ext","endsWith","FormData","append","userDisplayName","download","mediaLink","download_default","contentType","err_2","metadata","err_3","teacherAtThisSchool","virtualFile_1","uploadDate","sensitivity","onDragOver","task_page_TaskPage","TaskPage","userTask_1","ab","k","kr","task_page_templateObject_1","task_page_templateObject_2","task_page_templateObject_3","deadlineTooLate","endOf","content","task_page_templateObject_4","task_page_templateObject_5","document","documentElement","history","replaceState","pageYOffset","scrollRestoration","course_page_CoursePage","CoursePage","onHashChange","getModuleAndTaskFromHash","moduleName","getOrderedModules","fallbackScrollPosition","taskAnchor","getElementById","getBoundingClientRect","scrollTo","restoreScrollPosition","moduleOrder","courseBuilderUrl","orderedModules","points","images","img","imageId","weekplanner","list_courses_page_ListCoursesPage","list_courses","course_viewer_CourseViewer","CourseViewer","course_builder_utils","error_success_feedback","app_courseviewer_client_bearerPromise","app_courseviewer_client_KEDAppCourseViewer","KEDAppCourseViewer","isTokenLoaded","course_viewer","components","app_courseviewer_client_namespaceObject"],"mappings":"mCACA,SAAAA,EAAAC,GAOA,IANA,IAKAC,EAAAC,EALAC,EAAAH,EAAA,GACAI,EAAAJ,EAAA,GACAK,EAAAL,EAAA,GAGAM,EAAA,EAAAC,KACQD,EAAAH,EAAAK,OAAoBF,IAC5BJ,EAAAC,EAAAG,GACAG,EAAAP,IACAK,EAAAG,KAAAD,EAAAP,GAAA,IAEAO,EAAAP,GAAA,EAEA,IAAAD,KAAAG,EACAO,OAAAC,UAAAC,eAAAC,KAAAV,EAAAH,KACAc,EAAAd,GAAAG,EAAAH,IAIA,IADAe,KAAAhB,GACAO,EAAAC,QACAD,EAAAU,OAAAV,GAOA,OAHAW,EAAAR,KAAAS,MAAAD,EAAAb,OAGAe,IAEA,SAAAA,IAEA,IADA,IAAAC,EACAf,EAAA,EAAiBA,EAAAY,EAAAV,OAA4BF,IAAA,CAG7C,IAFA,IAAAgB,EAAAJ,EAAAZ,GACAiB,GAAA,EACAC,EAAA,EAAkBA,EAAAF,EAAAd,OAA2BgB,IAAA,CAC7C,IAAAC,EAAAH,EAAAE,GACA,IAAAf,EAAAgB,KAAAF,GAAA,GAEAA,IACAL,EAAAQ,OAAApB,IAAA,GACAe,EAAAM,IAAAC,EAAAN,EAAA,KAGA,OAAAD,EAIA,IAAAQ,KAGApB,GACAqB,EAAA,GAGAZ,KAGA,SAAAS,EAAA1B,GAGA,GAAA4B,EAAA5B,GACA,OAAA4B,EAAA5B,GAAA8B,QAGA,IAAAC,EAAAH,EAAA5B,IACAK,EAAAL,EACAgC,GAAA,EACAF,YAUA,OANAhB,EAAAd,GAAAa,KAAAkB,EAAAD,QAAAC,IAAAD,QAAAJ,GAGAK,EAAAC,GAAA,EAGAD,EAAAD,QAKAJ,EAAAO,EAAAnB,EAGAY,EAAAQ,EAAAN,EAGAF,EAAAS,EAAA,SAAAL,EAAAM,EAAAC,GACAX,EAAAY,EAAAR,EAAAM,IACA1B,OAAA6B,eAAAT,EAAAM,GACAI,cAAA,EACAC,YAAA,EACAC,IAAAL,KAMAX,EAAAiB,EAAA,SAAAb,GACApB,OAAA6B,eAAAT,EAAA,cAAiDc,OAAA,KAIjDlB,EAAAmB,EAAA,SAAAd,GACA,IAAAM,EAAAN,KAAAe,WACA,WAA2B,OAAAf,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAL,EAAAS,EAAAE,EAAA,IAAAA,GACAA,GAIAX,EAAAY,EAAA,SAAAS,EAAAC,GAAsD,OAAAtC,OAAAC,UAAAC,eAAAC,KAAAkC,EAAAC,IAGtDtB,EAAAuB,EAAA,GAEA,IAAAC,EAAAC,OAAA,mBAAAA,OAAA,uBACAC,EAAAF,EAAAzC,KAAA4C,KAAAH,GACAA,EAAAzC,KAAAX,EACAoD,IAAAI,QACA,QAAAjD,EAAA,EAAgBA,EAAA6C,EAAA3C,OAAuBF,IAAAP,EAAAoD,EAAA7C,IACvC,IAAAU,EAAAqC,EAMA,OAFAnC,EAAAR,MAAA,OAEAU,oBCnIAY,EAAAD,QAAAyB,qCCCM,SAAAC,EAA2BC,GAC7B,IAAK,IAAIpD,EAAE,EAAG2B,EAAEyB,EAAIlD,OAAQF,EAAE2B,IAAK3B,EAC/B,GAAIoD,EAAIC,WAAWrD,GAAK,KACpB,OAAOoD,EAAIE,OAAO,EAAGtD,GAAKoD,EAAIpD,GAAGuD,oBAAsBH,EAAIE,OAAOtD,EAAI,GAG9E,OAAOoD,EAGL,SAAAI,EAAiBC,EAAKC,GACxB,MAAyB,iBAAdA,EAA+BD,GAC1CpD,OAAOsD,KAAKD,GAAWE,QAAQ,SAAAC,GAC3BJ,EAAII,GAAOH,EAAUG,KAElBJ,GAGL,SAAAK,EAAsBL,EAASC,GACjC,IAAII,KAKJ,OAJAzD,OAAO0D,oBAAoBN,GAAKG,QAAQ,SAAAC,GACpCxD,OAAO6B,eAAe4B,EAAOD,EAAKxD,OAAO2D,yBAAyBP,EAAKI,MAEvEH,GAAWF,EAAOM,EAAOJ,GACtBI,kcAGX,IAAMG,KAAYA,OACZ,SAAAC,EAAsBC,GACxB,OAAOF,EAAOpD,SAAUsD,GAGtB,SAAAC,EAAsBC,GACxB,OAAO,SAACF,EAAEG,GACN,IAAMC,EAAQJ,EAAEE,GAAOG,EAAQF,EAAED,GACjC,OAAOE,EAAQC,EAAQ,EAAID,EAAQC,GAAS,EAAI,GAIlD,SAAAC,EAAuBC,EAA0BC,EAA6BC,GAQhF,OAPAF,EAAQG,MAAMC,QAAQJ,GAASA,GAASA,IAQnCK,IAAI,SAAAV,GAAQ,gBAACF,EAAEG,GAAM,OANJ,SAACH,EAAEG,GACrB,MAAa,iBAANH,EACHA,EAAEa,cAAcV,EAAGK,EAASC,GAC5BT,EAAIG,GAAK,EAAIH,EAAIG,EAAI,EAAI,EAGPU,CAAcb,EAAEE,GAAOC,EAAED,OAC9CY,OAAO,SAACC,EAAMC,GACX,gBAAChB,EAAEG,GAAM,OAAAY,EAAKf,EAAEG,IAAMa,EAAKhB,EAAEG,MAGnC,SAAAc,EAAYC,OAAM,IAAAC,KAAAC,EAAA,EAAAA,EAAAC,UAAAtF,OAAAqF,IAAAD,EAAAC,EAAA,GAAAC,UAAAD,GACRF,EAAK,GACjB,OAGJ,SAAuBA,EAAMC,GAEzB,IADA,IAAIG,EAAKJ,EAAK,GACLrF,EAAE,EAAG2B,EAAE0D,EAAKnF,OAAQF,EAAE2B,IAAK3B,EAChCyF,GAAMH,EAAKtF,EAAE,GAAKqF,EAAKrF,GAE3B,OAAOyF,EARAC,CAAaL,EAAMC,GAiBxB,SAAAK,EAA2B9B,EAAKtB,GAClC,IAAI4B,EACJ,MAAqB,iBAAV5B,IACP4B,EAAI,oBAAoByB,KAAKrD,IAElB,IAAIsD,MAAM1B,EAAE,IAGpB5B,EAGL,SAAAuD,EAAoBC,GACtB,IAAIC,EAAQ,IAAIC,YAAY,QAAUC,OAAUH,IAChDjD,OAAOqD,cAAcH,GAGnB,SAAAI,EAAqBC,GACvB,IAAMN,EAAwB,iBAAXM,EAAsBA,EAASA,EAAOC,QACrDN,EAAQ,IAAIC,YAAY,eAAiBC,OAAUH,IACvDQ,QAAQC,MAAMH,GACdvD,OAAOqD,cAAcH,GAGnB,SAAAS,EAAoBrD,EAAasD,GACnC,OAAOtD,EAAIlD,OAASwG,EAChBtD,EAAIE,OAAO,EAAGoD,EAAS,GAAK,MAC5BtD,EAGF,SAAAuD,EAA2BxC,EAAQyC,GAErC,IADA,IAAM7F,KACGf,EAAE,EAAG2B,EAAEwC,EAAEjE,OAAQF,EAAE2B,IAAK3B,EAAG,CAChC,IAAM6G,EAAO1C,EAAEnE,GACT6D,EAAM+C,EAAYC,GACpBC,EAAQ/F,EAAO8C,GACfiD,EAAOA,EAAM1G,KAAKyG,GACjB9F,EAAO8C,IAAQgD,GAExB,OAAO9F,EAGL,SAAAgG,EAAwB5C,EAAQyC,GAElC,IADA,IAAM7F,KACGf,EAAE,EAAG2B,EAAEwC,EAAEjE,OAAQF,EAAE2B,IAAK3B,EAAG,CAChC,IAAM6G,EAAO1C,EAAEnE,GAEfe,EADY6F,EAAYC,IACVA,EAElB,OAAO9F,EAGL,SAAAiG,EAA8BvD,EAAQwD,GAExC,IADA,IAAMlG,KACcwE,EAAA,EAAA2B,EAAAD,EAAA1B,EAAA2B,EAAAhH,OAAAqF,IAAW,CAA1B,IAAM4B,EAAKD,EAAA3B,GACV4B,KAAS1D,IAAK1C,EAAOoG,GAAS1D,EAAI0D,IAExC,OAAOpG,EAGL,SAAAqG,EAAuBjD,EAAQyC,GACjC,IAAM7B,EAAMgC,EAAW5C,EAAGyC,GAC1B,OAAOvG,OAAOsD,KAAKoB,GAAKA,IAAI,SAAAlB,GAAO,OAAAkB,EAAIlB,oCCpIpC,IAIH9C,EAAwB,oBAARsG,OAA2BA,IAEzB,oBAAXvE,QAAyC,oBAARuE,MACxCvE,OAAoB,IAAI/B,GAG5B,IAAAuG,EAAA,ECOKA,EAAIC,MAAKD,EAAIC,QAElBC,EAAA,EAAeF,EAAc,4UCf7BG,EAAA,WASE,SAAAC,EAAaC,GACe,iBAAfA,GACTC,KAAKC,KAAOF,EACZC,KAAKE,UAAYjC,KAAKkC,MACtBH,KAAKI,SAAW3H,OAAA4H,EAAA,EAAA5H,GAAc6H,QAAQ,QAAQC,UAC9CP,KAAKQ,gBAEL/H,OAAOgI,OAAOT,KAAMD,GA2B1B,OAvBeD,EAAAY,KAAb,SAAkBT,kFAMhB,OALMU,EAASC,aAAaC,QAAQ,8BAC9BC,EAAaH,GAAWI,KAAKC,MAAML,GACnCM,EAAQ,IAAInB,EAA0BG,GACxCa,GAAYrI,OAAOgI,OAAOQ,EAAOH,IAErC,EAAOG,EAAMhB,OAASA,GAASgB,EAAMC,UAAUC,OACrC,IAAIrB,EAA0BG,GAAtCgB,QAGEnB,EAAApH,UAAA0I,KAAN,6FACEpB,KAAKE,UAAYjC,KAAKkC,MAChBkB,EAAON,KAAKO,UAAUtB,MAC5BY,aAAaW,QAAQ,6BAA8BF,YAGrDvB,EAAApH,UAAAwI,UAAA,SAAWM,GACP,OAAOL,IAAOnB,KAAKE,WAChBuB,SACGD,EAAKE,IACD,EAAE5B,EAA0B6B,iBAAkB,WAvCrD7B,EAAA6B,iBAAmB,GACnB7B,EAAA8B,QAAU,EAyCnB9B,EA3CA,kDCGO,IAAI+B,EAAgBC,EAAA,EAAIC,cAE/BC,EAAA,SAAAC,GAGE,SAAAC,IAAA,IAAAC,EACEF,EAAArJ,KAAAoH,MACEoC,UAAS,WAAK,OAAON,EAAA,EAAIO,kBACzBC,YAAY,EACZC,MAAO,YACPtC,KAAM6B,EAAA,EAAIU,YAAcV,EAAA,EAAIU,YAAYC,KAAO,GAC/CC,gBAAiB,kBAAAC,EAAA,EAAAR,OAAA,4FACTS,EAAYd,EAAA,EAAIU,YAAcV,EAAA,EAAIU,YAAYC,KAAO,GACtDzC,KAAK6C,gBAAN,MACFC,EAAA9C,MAAsB,EAAMH,EAA0Ba,KAAKkC,YAA3DE,EAAKD,eAAiBE,EAAAC,wBAOtB,OANM5C,EAAaJ,KAAK6C,eAAczC,SAClC6C,EAAa9B,IAAOf,GAAU8C,QAKlC,GACEC,MALEC,EAAU3K,OAAA4K,EAAA,EAAA5K,CAAQ0I,IAAOf,GAAUkD,OAAQL,IAK/BM,UACdC,GAAIJ,EAAQK,SACZC,KAAM,OACNC,SAAU,OAAQ,UAClBC,OAAQ,6BAGd5D,YACFmC,EAAKU,eAAiB,OAwF1B,OApH4BF,EAAA,EAAAT,EAAAD,GA+BpBC,EAAAxJ,UAAAmL,qBAAN,SAA2BC,+FAEzB,OADArL,OAAOgI,OAAOT,KAAK6C,eAAgBiB,IACnC,EAAM9D,KAAK6C,eAAezB,sBAA1B0B,EAAAE,OACAhD,KAAK+D,IAAIC,8BAGL9B,EAAAxJ,UAAAuL,iBAAN,SAAuBC,EAAoBC,wHACnCrB,EAAiC9C,KAAKhD,QAArCoF,EAASU,EAAAV,UAAEE,EAAUQ,EAAAR,WAAOQ,EAAAP,MAC7B6B,EAAShC,IACTiC,EAAe5L,OAAOgI,UAAWyD,GAAWC,KAAIA,IAClD7B,GAAY,EAAMtC,KAAK+D,IAAIO,OAAO7L,OAAOgI,UAAW4D,GAAeE,MAAO,gBAA1E,YAAYxB,EAAAC,wBAEK,SAAMoB,EAAOI,KAAe,aAC/CrK,KAAM+J,EAAS/J,KACfuJ,KAAM,OACNC,SAAU,OAAO,UACjBC,OAAQ,kBACRT,KAAMhC,IAAOnB,KAAK6C,eAAezC,UAAUsB,KAAK,EAAG,SAASnB,UAC5DiD,GAAIrC,IAAOnB,KAAK6C,eAAezC,UAAUsB,IAAI,EAAG,SAASnB,YAEzDkE,MAAO,qBAOT,OAfMC,EAAe3B,EAAAC,OAUf2B,EAAiBD,EAAaE,OAAO,SAAAC,GACzC,QAAAA,EAAEC,aAAeZ,EAASY,YAC1BD,EAAEE,eAAiBb,EAASa,cAC1Bb,EAASc,MAAQH,EAAEG,KAAK7H,IAAI,SAAA0H,GAAG,OAAAA,EAAEI,KAAIC,KAAK,MAAQhB,EAASc,KAAK7H,IAAI,SAAA0H,GAAG,OAAAA,EAAEI,KAAIC,KAAK,KAClFhB,EAASiB,QAAUN,EAAEM,OAAOhI,IAAI,SAAAlD,GAAG,OAAAA,EAAEgL,KAAIC,KAAK,MAAQhB,EAASiB,OAAOhI,IAAI,SAAAlD,GAAG,OAAAA,EAAEgL,KAAIC,KAAK,QAC5F,EAAMlF,KAAKsE,OAAOK,EAAgB,SAAAE,GAAK,OAAAA,EAAEV,KAAOA,mBAAhDpB,EAAAC,iBAGId,EAAAxJ,UAAA0M,oBAAN,SAA2BlB,EAAoBmB,EAAmBlB,uGAGhE,OAFMrB,EAAiC9C,KAAKhD,QAArCoF,EAASU,EAAAV,UAAYU,EAAAR,WAAOQ,EAAAP,MACpBH,KACf,EAAMpC,KAAKsE,QAAQJ,GACjB,SAAAW,GAAK,OAAAA,EAAES,UAAYT,EAAES,SAASV,OAAO,SAAAW,GAAM,OAAAA,EAAGN,KAAOI,IAClDrJ,QAAQ,SAAAuJ,GAAM,OAAAA,EAAGpB,KAAOA,qBAF7BpB,EAAAC,iBAKId,EAAAxJ,UAAA8M,sBAAN,SAA4BV,EAAoBW,qGAM9C,OALMjF,EAAWmC,EAAA,KAAQ3C,KAAK6C,eAAerC,aACzCiF,EACFjF,EAAYsE,IAAc,SAEnBtE,EAAYsE,IACrB,EAAM9E,KAAK6D,sBAAsBrD,YAAWA,mBAA5CsC,EAAAE,iBAGId,EAAAxJ,UAAAgN,WAAN,SAAiBtF,8GACXyC,EAAiB7C,KAAK6C,iBACtB,MACe,EAAMhD,EAA0Ba,KAAKoB,EAAA,EAAIU,YAAYC,cAAtEI,EAAiBC,EAAAE,wBAMnB,OAJM2C,EAAe,IAAI9F,EAA0BgD,IACtCzC,SAAWe,IAAOf,GAAUE,QAAQ,QAAQC,UACzDoF,EAAavE,OACbpB,KAAK6C,eAAiB8C,GACtB,EAAM3F,KAAK+D,IAAI6B,mCAAf9C,EAAAE,iBAGFd,EAAAxJ,UAAAmN,UAAA,SAAUC,GAAV,IAAA3D,EAAAnC,KACQ+F,EAAkB,SAACC,GACvBF,EACEE,EAAUpB,OAAO,SAAAqB,GAAM,OAACA,EAAGC,YAC3B/D,EAAKU,eACLmD,EAAUpB,OAAO,SAAAqB,GAAM,QAAEA,EAAGC,YAAW,KACrCjB,GAAIxM,OAAA0N,EAAA,EAAA1N,GACJ2N,SAAUjE,EAAKU,eAAezC,SAC9B8F,WAAYG,WAAW,GAAIC,SAAS,IACpCC,KAEE,IAAIJ,EAAA,EAAe,QAASrE,EAAA,EAAIU,YAAYC,KAAM,KAGlD,IAAI0D,EAAA,EAAe,aAAiBrE,EAAA,EAAIU,YAAYgE,OAAM,YAAa,MACvErJ,IAAI,SAAAsJ,GAAM,OAAAA,EAAGC,gBAGrBX,EAA4B,WAAID,EAChC9F,KAAK+D,IAAI8B,UAAUE,IAGrB7D,EAAAxJ,UAAAiO,YAAA,SAAYb,GACV9F,KAAK+D,IAAI6C,YAAc5G,KAAK+D,IAAI6C,YAAYhC,OAAQ,SAAAlL,GAAK,OAAAA,EAAc,aAAMoM,KAGjF5D,EApHA,CAA4B2E,EAAA,GAsHvBhF,IACHA,EAAgBC,EAAA,EAAIC,cAAgB,IAAIC,GAC1B+B,IAAI+C,+BClIpBhN,EAAAD,QAAAkN,iDC4BKC,EAAA,EAAIC,MAAKD,EAAA,EAAIC,QAElBrH,EAAA,EAAeoH,EAAA,EAA4B,kCC1BrC,SAAAE,EAA2BC,EAAwBnK,GAChD,IAAAoK,GAAApK,OAAAoK,QACDjO,KAMN,OALIgO,GAAkBA,EAAe7O,OAAS,GAC5C6O,EAAezL,OAAO,GACnB2L,MAAM,KACNlK,IAAI,SAAAmK,GAAQ,OAAAA,EAAKD,MAAM,KAAKlK,IAAI,SAAAzD,GAAK,OAAA6N,mBAAmB7N,EAAE8N,YAC1DxL,QAAQ,SAAC8G,OAAC7G,EAAA6G,EAAA,GAAKnI,EAAAmI,EAAA,GAAW,OAAA3J,EAAOiO,EAAUnL,EAAIwL,cAAgBxL,GAAOtB,IACpExB,EAGT,SAAAuO,EAAsBC,GACpB,OAAOlP,OAAOsD,KAAK4L,GAAQxK,IAAI,SAAAlB,GAAO,OAAG2L,mBAAmB3L,GAAI,IAAI2L,mBAAmBD,EAAO1L,MAASiJ,KAAK,KAGxG,SAAA2C,EAA8BF,GAClC,MAAO,IAAMD,EAAaC,GAWtB,SAAAG,EAA4BC,GAChC,IAAMC,EAASD,EAAqBE,QAAQ,KAC5C,OAAOD,GAAU,GACdD,EAAqBrM,OAAO,EAAGsM,GAASD,EAAqBrM,OAAOsM,KACpED,EAAsB,4kBC1BrB,SAAAG,EAA+BC,EAAQC,EAAQ7F,EAAe8F,EAAqCC,GAGvG,IAFA,IAAMC,KACAC,EAAQJ,EAAOnD,cACZwD,GACP,IAAMC,EAAeL,EAAOI,GACtBE,EAAsBR,EAAOM,OAC7BG,EAAsBR,EAAOK,GACnC,IAAKG,mBAKL,IAJA,IAAMC,EAASD,EACZzL,IAAI,SAAC2L,EAAKC,GAAM,OAAED,IAAGA,EAAEC,IAAGA,KAGfpL,EAAA,EAAAqL,EAFAH,EAAOjE,OAAO,SAAAqE,GAAS,OAACN,EAAQO,KAAK,SAAA7O,GAAK,OAAAA,EAAE4K,KAAOgE,EAAMH,IAAI7D,OAE7DtH,EAAAqL,EAAA1Q,OAAAqF,IAAK,CAAd,IAAIpB,EAACyM,EAAArL,GAEFwL,GADAC,EAAaC,EAAA,KAAO9M,EAAEuM,MACDvE,aACpB6E,EAAc7E,MACR,QAAT4E,GACGC,EAAcnE,KAAImE,EAAcnE,GAAKxM,OAAA6Q,EAAA,EAAA7Q,IAE1C6P,EAAM5G,IAAIgH,EAAcU,IACN,WAATD,GACTb,EAAMiB,IAAIb,EAAcU,GAE1Bd,EAAMkB,KAAKjH,EAAOiG,EAAOE,EAAcU,EAAcnE,GAAIwD,GAGpDF,EAAWE,KAAUF,EAAWE,OACrCF,EAAWE,GAASlM,EAAEwM,MAAQU,KAAML,GAGtC,IADA,IACctG,EAAA,EAAA4G,EADEf,EAAQ/D,OAAO,SAAAvK,GAAK,OAACuO,EAAQM,KAAK,SAAAtO,GAAK,OAAAA,EAAEqK,KAAO5K,EAAE4K,OACpDnC,EAAA4G,EAAApR,OAAAwK,IAAO,CAAhB,IAAIpI,EAACgP,EAAA5G,GACRwF,EAAMqB,OAAOpH,EAAOiG,EAAOE,EAAchO,EAAEuK,GAAIwD,GAGjD,IADA,IACc1F,EAAA,EAAA6G,EADEf,EAAOjE,OAAO,SAAAqE,GAAS,OAAAN,EAAQO,KAAK,SAAA7O,GAAK,OAAAA,EAAE4K,KAAOgE,EAAMH,IAAI7D,IAA0B,WAApBgE,EAAMH,IAAIvE,UAC9ExB,EAAA6G,EAAAtR,OAAAyK,IAAO,CAAhB,IACGqG,EADCS,EAACD,EAAA7G,UACFqG,EAAaC,EAAA,KAAOQ,EAAEf,MACPvE,MACrB+D,EAAMiB,IAAIb,EAAcU,GAGnBb,EAAWE,KAAUF,EAAWE,OACrCF,EAAWE,GAASoB,EAAEd,MAAQU,KAAML,KAtCpBzL,EAAA,EAAAmF,EAAArK,OAAOsD,KAAKsM,GAAZ1K,EAAAmF,EAAAxK,OAAAqF,IAAmB,GAAvBmF,EAAAnF,IAyChB,OAAOmM,IAAO1B,EAAQG,GAGlB,SAAAwB,EAAmB3D,GACvB,OAAO4D,IAAO5D,GAAU6D,OAAO,gBAG3B,SAAAC,EAA0B9D,GAC9B,OAAO4D,IAAO5D,GAAU6D,OAAO,UAG3B,SAAAE,EAAmChK,EAAatE,EAA0BoE,GAC9E,OAAO6J,IAAOjO,GACZuK,UAAWqD,KAAMtJ,GACjBiK,cAAeX,KAAMtJ,GACrBkK,YACEZ,MACEtP,KAAM8F,EAAKqK,YACXC,IAAK,UAAYtK,EAAKwC,SAMxB,SAAA+H,EAA+BrK,EAAatE,EAA0BoE,GAC1E,OAAO6J,IAAOjO,GACZ4O,aAAchB,KAAMxL,KAAKkC,OACzBuK,WACEjB,MACEtP,KAAM8F,EAAKqK,YACXC,IAAK,UAAYtK,EAAKwC,SAMxB,SAAAkI,EAA8C9O,EAA0BoE,GAC5E,IAAME,EAAMlC,KAAKkC,MAGjB,OAFAtE,EAAMsO,EAAwBhK,EAAKtE,EAAKoE,IAC/ByK,YAAW7O,EAAM2O,EAAoBrK,EAAKtE,EAAKoE,IACjDpE,EAGH,SAAA+O,EAAqB9B,EAAe+B,EAAkCxC,GAC1E,IAAMyC,EAAGzB,EAAA,KAAOP,GACViC,EAAOF,EAAS/B,EAAI7D,IACtB8F,IACFD,EAAIE,MAAQD,GACd,IAAkB,IAAApN,EAAA,EAAAsN,EAAA5C,EAAA1K,EAAAsN,EAAA3S,OAAAqF,IAAM,CAAnB,IAAIuN,EAAKD,EAAAtN,GACNiL,EAAUE,EAAIoC,GAAO/N,IAAI,SAAAjD,GAAK,OAAA0Q,EAAW1Q,EAAG2Q,QAClDC,EAAII,GAAStC,EAEf,OAAOkC,EAGH,SAAAK,EAAmBC,EAAYpR,GACnC,OAAO,IAAIqR,QAAQ,SAACC,EAASC,GAC3B,IAAMC,EAAS,IAAIC,WACnBD,EAAOE,OAAS,SAAAC,GAAM,OAAAL,EAASK,EAAGC,OAAezS,SACjDqS,EAAOK,QAAU,SAAAF,GAAM,OAAAJ,EAAO,IAAIO,MAAM,uBACxCN,EAAOO,QAAU,SAAAJ,GAAM,OAAAJ,EAAQI,EAAGC,OAAehN,QACjD5E,EAAEwR,KAIA,SAAAQ,EAA0BZ,GAC9B,OAAOD,EAASC,EAAM,SAAA1Q,GAAG,OAAAA,EAAEuR,WAAWb,KAGlC,SAAAc,EAA6Bd,GACjC,OAAOD,EAASC,EAAM,SAAA1Q,GAAG,OAAAA,EAAEyR,cAAcf,KAGrC,SAAAgB,EAAoBC,GACxBA,EAAEC,kBACFD,EAAEE,iBACFF,EAAEG,aAAaC,WAAa,OAGxB,SAAAC,EAAoCC,GACxC,IAAMC,EAAMC,IAAE,sBAAsB,GAChCD,IAAKA,EAAIE,UAAY,kBAAoBH,EAAS,WAAaA,EAAS,KAGxE,SAAAI,EAA2B9H,EAAYjI,+GAMG,OAFxCoH,EAAS4I,EAAA,EAAI3K,iBACb4K,EAAuBjQ,GAAWA,EAAQiQ,sBACF,EAAM5B,QAAQ6B,KAC1D9I,EAAO3J,IAAI,UAAWwK,GACpBtB,SACE,iBACA,wBACA,YACA,SACA,SAKJS,EAAOI,KAAK,SACV2I,aAAclI,EACdtB,SAAU,wBAAyB,iBAAkB,YAAa,OAClEC,OAAQ,oBAEVqJ,GAAwB7I,EAAOI,KAAK,WAClC2I,aAAclI,EACdrB,OAAQ,uBAmBZ,OAtCMd,EAAwCC,EAAAC,OAAvCmC,EAAMrC,EAAA,GAAEsK,EAAWtK,EAAA,GAAEuK,EAAavK,EAAA,GAsBzCqC,EAAOmI,MAAQF,EAGXjI,EAAOoI,6BACTpI,EAAOqI,sBAAwBrI,EAAOoI,2BAA2BpQ,IAAI,SAAA8H,GACnE,OAAAE,EAAOqI,sBAAsBC,KAAK,SAAAxT,GAAK,OAAAA,EAAEgL,KAAOA,OAIhDE,EAAOuI,sBACTvI,EAAOwI,eAAiBxI,EAAOuI,oBAAoBvQ,IAAI,SAAA8H,GACrD,OAAAE,EAAOwI,eAAeF,KAAK,SAAAG,GAAM,OAAAA,EAAG3I,KAAOA,OAI3CgI,IAAsB9H,EAAOkI,cAAgBA,IACjD,EAAOlI,yDCnLK,SAAA0I,EAAyB5N,GACrC,QACE6N,KAAM,QACNnT,MAAOsF,EAAKwC,OAEZqL,KAAM,SACNnT,MAAOsF,EAAKuG,SACXnK,OAAO4D,EAAK8N,MAAM5Q,IAAI,SAAAuG,GAAQ,OAC/BoK,KAAM,OACNnT,MAAO+I,MACJrH,OAAO4D,EAAK8N,MAAM5Q,IAAI,SAAAuG,GAAQ,OACjCoK,KAAM,aACNnT,MAAOsF,EAAKuG,OAAS,IAAM9C,wNCPxB,IAAMsK,GAA8B,OAAO,OAAO,SAAS,QAAQ,cAAc,cAAc,aAAa,cAE7G,SAAAC,EAAoBnF,EAAeoF,GACvC,IAAIC,EAASN,EAAc/L,EAAA,EAAIU,aAG/B,OAFa/J,OAAA2L,EAAA,EAAA3L,CAAW2L,EAAA,EAAegK,gBAAgBtF,EAAIvC,SAAY4H,EAAQD,GAS3E,SAAAG,EAAyBvF,GAC7B,OAAOmF,EAAUnF,EAAK,KAOlB,SAAAwF,EAA4B9H,GAChC,IAAM+H,EAAYzM,EAAA,EAAIU,YAAYuL,MAAM7E,KAAK,SAAAxF,GAAQ,MAAS,aAATA,GAAgC,UAATA,IACtE8K,GAAmBhI,GAAQ,IAAIiB,gBAAkB3F,EAAA,EAAIU,YAAYgE,OAAOiB,cAC9E,OAAQ8G,GAAaC,EAGhB,IAAMC,GACXC,MAAK,SAAE1R,GACE,IAAA0G,EAAA1G,EAAA0G,KAAM8C,EAAAxJ,EAAAwJ,OAAQ+D,EAAAvN,EAAAuN,IACfoE,EAAelW,OAAAmW,EAAA,EAAAnW,CAAiBoW,SAASC,QACzCC,EAAQpM,EAAA,KAAOgM,GAAcjL,KAAIA,EAAE8C,OAAMA,IACzCwI,EAAiBvW,OAAAmW,EAAA,EAAAnW,CAAoBsW,GACvCxE,EACFsE,SAASI,KAAO,GAAG1E,EAAMyE,GAEzBH,SAASK,KAAO,IAChBL,SAASC,OAASE,KAKlB,SAAAG,EAAgBnS,GACpByR,EAAiBC,MAAM1R,GAGnB,SAAAoS,EAAsC7E,EAAa8E,GAGvD,IAFA,IAAMV,EAAelW,OAAAmW,EAAA,EAAAnW,CAAiBoW,SAASC,QACzCC,EAAQpM,EAAA,KAAO0M,GACD1R,EAAA,EAAA2R,EAAAtB,EAAArQ,EAAA2R,EAAAhX,OAAAqF,IAA0B,CAAzC,IAAM4B,EAAK+P,EAAA3R,GACVgR,EAAapP,KAAQwP,EAASxP,GAASoP,EAAapP,IAG1D,MAAO,GAAGgL,EADa9R,OAAAmW,EAAA,EAAAnW,CAAoBsW,6ECzDhCQ,EAAU,WAAK,OAAAC,EAAA,0BAAMA,EAAA,mBAAG1C,UAAU,wBAAuB2C,cAAa,6CCD7E,SAAAC,IAEJ,IAAIxV,EAAI+D,KAAKkC,MAMb,MALW,uCAAuCwP,QAAQ,QAAS,SAAA1V,GACjE,IAAIS,GAAKR,EAAoB,GAAhB0V,KAAKC,UAAiB,GAAK,EAExC,OADA3V,EAAI0V,KAAKE,MAAM5V,EAAI,KACL,MAAND,EAAYS,EAAS,EAAJA,EAAU,GAAMgM,SAAS,MAKhD,SAAAqJ,EAAqCC,GACzC,IAAIC,EAA6B,KACjC,OAAO,WAOH,OANKA,IACDA,EAAiBD,EAAO/W,MAAM+G,KAAMpC,WAAWsS,KAAK,SAAA/W,GAEhD,OADA8W,EAAiB,KACV9W,KAGR8W,qPCZP,SAAAE,EAAoCC,GACxC,MAAgB,OAATA,GACJ,GAAI,KACJ,EAAG,IAGF,SAAAC,EAA6BlQ,GACjC,OAAOA,EAAImQ,SAAW,GACnBC,IAAO,IAAItS,KAAKkC,EAAImD,OAAQ,EAAG,IAAKiN,IAAO,IAAItS,KAAKkC,EAAImD,OAAQ,GAAI,OACpEiN,IAAO,IAAItS,KAAKkC,EAAImD,OAAQ,EAAG,IAAKiN,IAAO,IAAItS,KAAKkC,EAAImD,OAAQ,EAAG,MAGlE,SAAAkN,EAA0BxW,GAC9B,IAAMyW,EAAWzW,EAAEsJ,OACboN,EAAW1W,EAAEsW,SAAW,EACxBxN,EAAA4N,kBAMN,OAASC,aANF7N,EAAA,GAGgC,IAHpBA,EAAA,GAMIsN,KAFVM,EAAW,KAAO,KAEFxN,KADhBlJ,EAAEkJ,QAIX,SAAA0N,EAAkBC,EAAqBC,GAC3C,OAAOD,EAAMxJ,MAAM,KAChBlK,IAAI,SAAA4T,GAAW,OAAAC,SAASD,GAAWD,IACnC3T,IAAI,SAAAmG,GAAQ,SAAKA,IACjB4B,KAAK,iDCnCV+L,EAAA,oBAAAA,KAaA,OAZIA,EAAAvY,UAAA0I,KAAA,SAAK6D,EAAYiM,GACbC,eAAe5P,QAAQ,UAAY0D,EAAIlE,KAAKO,UAAU4P,KAG1DD,EAAAvY,UAAAgI,KAAA,SAAKuE,GACD,IACI,IAAM5D,EAAO8P,eAAetQ,QAAQ,UAAYoE,GAChD,OAAOoG,QAAQC,QAAQjK,EAAON,KAAKC,MAAMK,IAAS+P,MAAO,KAAMC,QAAS,IAC1E,MAAOC,GACL,OAAOjG,QAAQC,SAAS8F,MAAO,KAAMC,QAAS,MAG1DJ,EAbA,WCAc,SAAAM,EAAsBvM,GAC3BA,EAAKwM,YAAWxM,EAAKwM,cCChB,SAAAC,EAAkB3I,EAAKvG,EAAe8F,GAClD,OAAQ9F,GACN,IAAK,WCHK,SAAwB4C,EAAgBkD,GAC/ClD,EAAOtM,UAASsM,EAAOtM,YAC5BsM,EAAOtM,QAAQmD,QAAQ,SAAAlC,GAChBA,EAAO0X,YACV1X,EAAO0X,cAEJ1X,EAAO4X,UACV5X,EAAO4X,cAINvM,EAAOwM,sBACVxM,EAAOwM,wBAIL,cAAgBxM,KAAoB,cAAgBA,KACtDA,EAAOqM,UAAarM,EAAeyM,iBAC3BzM,EAAeyM,WAEpBzM,EAAOqM,YACVrM,EAAOqM,cAGLnJ,GACFA,EAAOrM,QAAQ,SAAAkP,GACb,OAAQA,GACN,IAAK,QACH/F,EAAOmI,MAAMtR,QAAQ,SAAAgJ,GAAQ,OAAAuM,EAAYvM,QDxB7C6M,CAAc/I,EAAKT,GACnB,MACF,IAAK,QACHkJ,EAAYzI,IEPX,0iDAA8B,SAAC1E,GAClC,IAAKA,EAAe0N,oBAApB,CACC1N,EAAe0N,qBAAsB,EAEtC,IAAMrX,EAAM2J,EAAO3J,IACb+J,EAAOJ,EAAOI,KAEpBJ,EAAO3J,IAAM,SAAU8H,EAAO0C,EAAIjI,GAC9B,IAAM2G,EAAU3G,GAAWA,EAAQ2G,QACnC,OAAOlJ,EAAIxB,MAAM+G,KAAMpC,WAAWsS,KAAK,SAAA/W,GAEnC,OADAsY,EAAQtY,EAAQoJ,EAAOoB,GAAWA,EAAQ+C,WAAWW,MAAM,MACpDlO,KAIfiL,EAAOI,KAAO,SAAUjC,EAAOvF,GAC3B,IAAM2G,EAAU3G,GAAWA,EAAQ2G,QACnC,OAAOa,EAAKvL,MAAM+G,KAAMpC,WAAWsS,KAAK,SAAA/W,GAEpC,OADAA,EAAO6C,QAAQ,SAAA8M,GAAO,OAAA2I,EAAQ3I,EAAKvG,EAAOoB,GAAWA,EAAQ+C,WAAWW,MAAM,QACvElO,MClBnB4Y,CAAsBC,EAAA,EAAiBtZ,WAEhC,IAAMuZ,EAAU,IAAIhB,EAErBiB,EAAiBjU,KAAKkC,MAE5BgS,EAAA,WAII,SAAAC,EACWC,EACAC,EACAC,GAFAvS,KAAAqS,YACArS,KAAAsS,sBACAtS,KAAAuS,UAEPvS,KAAKkR,WAAaE,MAAO,KAAMC,QAAS,GACxCrR,KAAKwS,UAAY/Z,OAAAga,EAAA,EAAAha,CAAsBuH,KAAKwS,UAAUpX,KAAK4E,OAC3DA,KAAK0S,cAAgBja,OAAAga,EAAA,EAAAha,CAAsBuH,KAAK0S,cAActX,KAAK4E,OAmC3E,OAhCUoS,EAAA1Z,UAAA8Z,UAAN,gHACSxS,KAAKkR,UAAUE,OAAhB,KACIpR,KAAKuS,SAASzP,EAAA9C,MAAiB,EAAMiS,EAAQvR,KAAKV,KAAKuS,YAAvD,YAAczP,EAAKoO,UAAYnO,EAAAC,+BAEnChD,KAAKkR,UAAUG,QAAUpT,KAAKkC,OAC9B,EAAMH,KAAK0S,kBADX,YACA3P,EAAAC,wBAEJ,SAAOhD,KAAKkR,iBAGVkB,EAAA1Z,UAAAga,cAAN,iHACgB,SAAMC,MAAM3S,KAAKqS,WACzBO,SAAUC,OAAQ,gCAClBC,SAAU,SACVrO,MAAO,WACPsO,YAAa,+BAEE,OANbjI,EAAMkI,EAAAhQ,QAMJ2J,SAAoB7B,EAAI6B,QAAuB,mBAAb7B,EAAIgD,OAItC7P,KAAKkC,MAAQ+R,EAAiB,MAC9BlS,KAAKiT,eAAgB,EACrBtU,QAAQuU,IAAI,iCACZhY,OAAO2T,SAASsE,QAAO,IAGb,KAAdrI,EAAI6B,QAAJ,QAA6Bb,MAAK1Q,KAAC2H,EAAA,OAAO+H,EAAI6B,OAAS,KAAM,EAAM7B,EAAIrN,gBAApD,MAAM,IAAAqF,EAAA7J,MAAI6S,YAAK,EAAC/I,EAA0BiQ,EAAAhQ,iBACvB,OAA1CoQ,EAAApT,KAAiBqT,EAAArT,KAAKsS,qBAAoB,EAAMxH,EAAIrN,eAEpD,OAFA2V,EAAKlC,UAAYmC,EAAApa,MAAA+G,MAAyBgT,EAAAhQ,SAC1CiP,EAAQ7Q,KAAKpB,KAAKuS,QAASvS,KAAKkR,YAChC,EAAOlR,KAAKkR,iBAEpBkB,EA9CA,GAgDakB,GAAcX,MAAOA,MAAMvX,KAAKmY,MAAOC,KAAMA,KAAKpY,KAAKmY,OAEpEE,EAAA,SAAAxR,GACI,SAAAyR,EACIC,EACAC,EACA5W,GAHJ,IAQU6W,EAAgD,iBAAxBD,EAC1BA,EACA,IAAIzB,EACAyB,EACC5W,GAAWA,EAAQsV,qBAAwB,SAACwB,GAAG,OAAE1C,MAAO0C,EAAGzC,QAASpT,KAAKkC,MAAQ,SAClFnD,GAAWA,EAAQuV,gBAC3BtQ,EAAArJ,KAAAoH,KAAMsT,EAAYO,EAAgBF,IAAW3T,KAErD,OAjByC+T,EAAAL,EAAAzR,GAiBzCyR,EAjBA,CAAyC1B,EAAA,kMC5DzC,IAAAgC,EAAAva,EAAA,o7CAuBAwa,EAAA,WAMI,SAAAA,EACWC,EACAC,EACAnX,GAFAgD,KAAAkU,aACAlU,KAAAmU,UACAnU,KAAAhD,UAOPgD,KAAKoU,cAAgBC,KAAM,QAC3BrU,KAAKsU,WAAatX,EAAQuX,OACtB,UAAYvX,EAAQuX,OACpBvX,EAAQwX,SACJ,SAAWN,EAAWV,KAAKxW,EAAQwX,SAAW,KAAOxX,EAAQyX,UAAY,KACzE,KACRzU,KAAK6T,eAAiB7W,EAAQ6W,gBAAkB,KAkExD,OA/DUI,EAAAvb,UAAAia,MAAN,SAAY+B,EAAc1E,EAAgB4C,EAASvD,EAAQ+E,4HACnDA,GAAuC,aAAvBA,EAAa3P,QAG7B4K,EAAKsF,KAAOtF,GAAOuF,QAASnc,OAAAub,EAAA,EAAAvb,MAE1Boc,EAAWxF,GAAS5W,OAAOsD,KAAKsT,GAAOlS,IAAI,SAAAlB,GAC7C,OAAA2L,mBAAmB3L,GACnB,IACA2L,mBAAmByH,EAAMpT,MACxBiJ,KAAK,KAELoP,GAADxR,EAA0C9C,MAA/BsU,WAAEpD,EAASpO,EAAAoO,UAAE2C,EAAc/Q,EAAA+Q,eAGrCS,GAAepD,IAAa2C,GAA7B,MACA9Q,EAAA/C,MAA6B,EAAM6T,EAAerB,qBAAlDzP,EAAKmO,UAAYA,EAAY8B,EAAAhQ,+BAM7BkO,EACIA,EAAUG,QAAUpT,KAAKkC,OACzBxB,QAAQuU,IAAI,8BACZE,EAAApT,MAA6B,EAAM6T,EAAenB,mBAFlD,MADJ,YAGIU,EAAKlC,UAAYA,EAAY8B,EAAAhQ,wBAEjCsR,EAAa,UAAYpD,EAAUE,uBASnB,OALhBkD,IACA1B,EAAQkC,cAAgBR,GAGtB/J,EAAMvK,KAAKmU,QAAUO,GAAQG,EAAW,IAAMA,EAAW,KAC3C,EAAM7U,KAAKkU,WAAWvB,MAAMpI,EAAGoK,KAAO3U,KAAKoU,cAAcxB,QAAOA,EAAE5C,OAAMA,GAAKoE,mBAC/E,MADdtJ,EAAgBkI,EAAAhQ,QACZ2J,QAAiB3M,KAAK6T,gBACpBkB,EAAUjK,EAAI8H,QAAQnY,IAAI,oBAChCkE,QAAQuU,IAAI,OAAOpI,EAAI6B,OAAM,UAAS3M,KAAKmU,QAAUO,IACjDK,GAAW,UAAUC,KAAKD,IAC1B1B,EAAArT,MAAiB,EAAMA,KAAK6T,eAAenB,mBAD3C,OAHJ,YAMU,OAFNW,EAAKnC,UAAY8B,EAAAhQ,OACjB4P,EAAQkC,cAAgB,UAAY9U,KAAKkR,UAAUE,OAC7C,EAAMpR,KAAKkU,WAAWvB,MAAMpI,EAAGoK,KAAO3U,KAAKoU,cAAcxB,QAAOA,EAAE5C,OAAMA,GAAKoE,YAAnFtJ,EAAMkI,EAAAhQ,wBAGd,SAAO8H,SAGXmJ,EAAAvb,UAAA+B,IAAA,SAAIia,EAAcrF,EAAQ+E,GACtB,OAAOpU,KAAK2S,MAAM+B,EAAM,OAAS7B,OAAQ,gCAAkCxD,EAAO+E,IAGtFH,EAAAvb,UAAAuc,KAAA,SAAKP,EAAc5c,EAAMsc,GACrB,OAAOpU,KAAK2S,MAAM+B,EAAM,QACpBQ,eAAgB,mBAChBrC,OAAU,oBACX,KAAI8B,KAAMP,GAAce,KAAMpU,KAAKO,UAAUxJ,OAGpDmc,EAAAvb,UAAA0c,OAAA,SAAOV,EAAcrF,EAAQ8F,EAAOf,GAChC,OAAOpU,KAAK2S,MAAM+B,EAAM,UAAY7B,OAAQ,gCAAkCxD,EAAKsF,KAAMP,GAAce,KAAIA,MAEnHlB,EAxFA,kBCvBAna,EAAAD,QAAAwb,uCCCO,IAIHlc,EAAwB,oBAARsG,OAA2BA,IAEzB,oBAAXvE,QAAyC,oBAARuE,MACxCvE,OAAoB,IAAI/B,GAG5ByG,EAAA,o0CCDA0V,EAAA,WAII,SAAAC,EACWrB,EACAsB,EACAjD,EACAkD,EACAC,EACAC,EACAC,GANA5V,KAAAkU,aACAlU,KAAAwV,UACAxV,KAAAuS,UACAvS,KAAAyV,WACAzV,KAAA0V,eACA1V,KAAA2V,WACA3V,KAAA4V,aAEP5V,KAAKkR,WAAaE,MAAO,KAAMC,QAAS,GACxCrR,KAAKoE,OAAS,IAAIyR,EAAA,EAAW3B,EAAY,IACrCM,SAAUxU,KAAKyV,SACfhB,SAAUzU,KAAK0V,eAEnB1V,KAAKwS,UAAY/Z,OAAAga,EAAA,EAAAha,CAAsBuH,KAAKwS,UAAUpX,KAAK4E,OAC3DA,KAAK0S,cAAgBja,OAAAga,EAAA,EAAAha,CAAsBuH,KAAK0S,cAActX,KAAK4E,OAiC3E,OA9BUuV,EAAA7c,UAAA8Z,UAAN,+GAEI,GADM1P,EAAmB9C,KAAKkR,UAAvBE,EAAKtO,EAAAsO,MAAEC,EAAOvO,EAAAuO,QACjBD,GAASC,GAAWpT,KAAKkC,MAAO,OAAM,EAACH,KAAKkR,4BAE3B,6BAAjBnO,EAAA/C,MAAiB,EAAMA,KAAKwV,QAAQ9U,KAAKV,KAAKyV,SAAW,IAAMzV,KAAKuS,iBACpE,OADAxP,EAAKmO,UAAYkC,EAAApQ,OACbhD,KAAKkR,UAAUE,OAASpR,KAAKkR,UAAUG,SAAWpT,KAAKkC,OAAa,EAACH,KAAKkR,YAC9E,EAAMlR,KAAK0S,wBACX,OADAU,EAAApQ,QACA,EAAOhD,KAAKkR,kBAEZ,mBAAMlR,KAAK0S,wBACX,OADAU,EAAApQ,QACA,EAAOhD,KAAKkR,kCAIdqE,EAAA7c,UAAAga,cAAN,+GAEaoD,EAAQ,0BAAEA,EAAQ,GACvBnX,QAAQuU,IAAI,wBAAwBlT,KAAKuS,UACnC,EAAMvS,KAAKoE,OAAO3J,IAAIuF,KAAK2V,SAAU3V,KAAK4V,YAAanR,MAAO,cAF5C,YAGxB,OAAmB,OADnBqG,EAAMsI,EAAApQ,QACE2J,QACJhO,QAAQoX,KAAK,OAAOjL,EAAI6B,OAAM,IAAI7B,EAAIkL,aAChC,OAEVlT,EAAA9C,WAAyB,EAAM8K,EAAIrN,gBAGnC,OAHAqF,EAAKoO,WAAanO,EAAAqO,MAAOgC,EAAApQ,OAAkBD,EAAAsO,QAASpT,KAAKkC,MAAQ,MAAc4C,GAC/EpE,QAAQuU,IAAI,iBAAiBlT,KAAKuS,QAAO,KAAKxR,KAAKO,UAAUtB,KAAKkR,YAClElR,KAAKwV,QAAQpU,KAAKpB,KAAKyV,SAAW,IAAMzV,KAAKuS,QAASvS,KAAKkR,YAC3D,EAAOlR,KAAKkR,0BAVe4E,eAY/B,MAAM,IAAIhK,MAAM,gCAAkC/K,KAAKO,UAAUtB,KAAKuS,gBAE9EgD,EApDA,GCHAU,EAAA,WACE,SAAAA,EACSC,EACAC,EACAC,GAFApW,KAAAkW,kBACAlW,KAAAmW,mBACAnW,KAAAoW,QAyCX,OAtCSH,EAAAI,WAAP,SAAkB5P,GAChB,IAAKA,EAAI,OAAO,KAChB,IAAIY,EAAQZ,EAAGY,MAAM,KACrB,GAAIA,EAAM/O,OAAS,EAAG,MAAM,IAAIwT,MAAM,0BAA4BrF,GAClE,IAAI6P,EAAYL,EAAeM,SAASlP,EAAM,IAC1CmP,EAAaP,EAAeM,SAASlP,EAAM,IAC3C+O,EAAQ/O,EAAM,GAClB,GAAc,MAAV+O,GAA2B,MAAVA,GAA2B,MAAVA,EACpC,MAAM,IAAItK,MAAM,0BAA4BrF,GAC9C,OAAO,IAAIwP,EACTK,EACAE,EACAJ,IAGGH,EAAAQ,OAAP,SAAcC,GACZ,OAAOA,EAAgB/G,QAAQ,MAAO,OAAOA,QAAQ,MAAO,QAGvDsG,EAAAM,SAAP,SAAgBG,GACd,OAAOA,EAAgB/G,QAAQ,QAAS,KAAKA,QAAQ,QAAS,MAGhEsG,EAAAvd,UAAAgO,SAAA,WACE,OAAOuP,EAAeQ,OAAOzW,KAAKkW,iBAAmB,IACnDD,EAAeQ,OAAOzW,KAAKmW,kBAAoB,IAC/CnW,KAAKoW,OAGFH,EAAA7H,gBAAP,SAAuB7H,GACrB,OAAOA,EACJpJ,IAAI,SAAAsJ,GAAM,OAAAwP,EAAeI,WAAW5P,KACpC7B,OAAO,SAAA6B,GAAM,OAAAA,KAGXwP,EAAAU,cAAP,SAAqBpQ,GACnB,OAAOA,EAAIpJ,IAAI,SAAAsJ,GAAM,OAAAA,EAAGC,cAE5BuP,EA7CA,GA+CM,SAAAW,EAAoBrQ,EAAuBsQ,EAA2B3I,GAC1E,QAAI2I,EAAW3N,KAAK,SAAA4N,GAAS,MAAe,SAAfA,EAAMhJ,MAAmC,UAAhBgJ,EAAMnc,SAGrD4L,EAAI2C,KAAK,SAAA3M,GACd,OAAAsa,EAAW3N,KAAK,SAAAjP,GACd,OAAAsC,EAAE2Z,kBAAoBjc,EAAE6T,MACxBvR,EAAE4Z,mBAAqBlc,EAAEU,QACV,MAAZ4B,EAAE6Z,OAAoC,MAAnBlI,GACP,MAAZ3R,EAAE6Z,QAAkB,IAAI,KAAKnO,QAAQiG,IAAmB,GAC5C,MAAZ3R,EAAE6Z,uSC/DXW,EAAA,SAAA9U,GACI,SAAA8U,EAAoBC,EAAqBtY,GAAzC,IAAAyD,EACEF,EAAArJ,KAAAoH,KAAM,OAASgX,EAAO,IAAMtY,IAAQsB,YADlBmC,EAAA6U,OAAqB7U,EAAAzD,UAEvCyD,EAAKhI,KAAO,OAAS6c,IAE3B,OAL+BC,EAAAF,EAAA9U,GAK/B8U,EALA,CAA+BjL,6pDC2B/BoL,EAAA,WAGI,SAAAC,EACIjD,EACAL,EACAM,GAEAnU,KAAKoX,KAAO,IAAIvB,EAAA,EACZ3B,EACAC,GACCN,eAAcA,IAwE3B,OArEUsD,EAAAze,UAAA2e,YAAN,SAAkB9U,EAAgB6R,qGAElB,SAAMpU,KAAKoX,KAAK3c,IAAI,cAAgB8H,GAAQ,IAAK,KAAM6R,kBACjD,MADZtJ,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BoK,EAAS3b,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAI8d,EAAShU,EAAA1G,QAAa+W,EAAApQ,kBAChD,SAAM8H,EAAIzJ,eAAjB,SAAO+R,EAAApQ,cAGLmU,EAAAze,UAAA+B,IAAN,SAAmB8H,EAAO0C,EAAIjI,EAAyCoX,qGACvD,SAAMpU,KAAKoX,KAAK3c,IAAO8H,EAAK,IAAI0C,EAAMjI,EAASoX,kBACzC,MADZtJ,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BoK,EAAS3b,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAI8d,EAAShU,EAAA1G,QAAa+W,EAAApQ,kBAChD,SAAM8H,EAAIzJ,eAAjB,SAAO+R,EAAApQ,cAGLmU,EAAAze,UAAA8L,KAAN,SAAoBjC,EAAevF,EAAuBoX,qGAE1C,SAAMpU,KAAKoX,KAAK3c,IAAI,GAAG8H,EAASvF,EAASoX,kBACnC,MADZtJ,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BoK,EAAS3b,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAI8d,EAAShU,EAAA1G,QAAa+W,EAAApQ,kBAChD,SAAM8H,EAAIzJ,eAAjB,SAAO+R,EAAApQ,cAGLmU,EAAAze,UAAA4P,MAAN,SAAYgP,EAAyBlD,qGAKrB,OAHZkD,EAAOA,EAAKjc,QAAQkc,KAAK,SAACC,EAAMC,GAC5B,MAAY,QAAZD,EAAKE,IAAgB,EAAgB,QAAZD,EAAKC,GAAe,EACjC,WAAZF,EAAKE,GAAkB,EAAgB,WAAZD,EAAKC,IAAmB,EAAI,KAC/C,EAAM1X,KAAKoX,KAAKnC,KAAK,QAASqC,EAAMlD,kBAC9B,MADZtJ,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BoK,EAAS3b,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAI8d,EAAShU,EAAA1G,QAAa+W,EAAApQ,kBAChD,SAAM8H,EAAIzJ,eAAjB,SAAO+R,EAAApQ,cAGLmU,EAAAze,UAAAif,GAAN,SAASC,iGAGE,OAFDC,EAAS,IAAIC,EACnBF,EAAQC,IACD,EAAM7X,KAAKsI,MAAMuP,EAAOE,0BAA/B,SAAOjV,EAAAE,cAGLmU,EAAAze,UAAAsf,YAAN,SAAkBC,qGACF,SAAMjY,KAAKoX,KAAKhC,OAAO,UAAY6C,kBAC7B,MADZnN,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BoK,EAAS3b,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAI8d,EAAShU,EAAA1G,QAAa+W,EAAApQ,kBAChD,SAAM8H,EAAIzJ,eAAjB,SAAO+R,EAAApQ,cAGXmU,EAAAze,UAAAgJ,IAAA,SAAIa,EAAcuG,GACd,OAAO9I,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAEgH,IAAIa,EAAOuG,MAEnCqO,EAAAze,UAAA6Q,IAAA,SAAIhH,EAAcuG,GACd,OAAO9I,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAE6O,IAAIhH,EAAOuG,MAEnCqO,EAAAze,UAAA0c,OAAA,SAAQ7S,EAAc0C,GAClB,OAAOjF,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAE0a,OAAO7S,EAAO0C,MAEtCkS,EAAAze,UAAAwf,MAAA,SAAM3V,EAAc0C,EAAWsB,GAC3B,OAAOvG,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAEwd,MAAM3V,EAAO0C,EAAIsB,MAEzC4Q,EAAAze,UAAAyf,QAAA,SAAS5V,EAAc0C,EAAWsB,GAC9B,OAAOvG,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAEyd,QAAQ5V,EAAO0C,EAAIsB,MAE3C4Q,EAAAze,UAAA8Q,KAAA,SAAM4O,EAAoBC,EAAiBC,EAAoBC,EAAiBrN,GAC5E,OAAOlL,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAE8O,KAAK4O,EAAaC,EAAUC,EAAaC,EAAUrN,MAE3EiM,EAAAze,UAAA8f,MAAA,SAAOJ,EAAoBC,EAAiBE,EAAiBrN,GACzD,OAAOlL,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAE8d,MAAMJ,EAAaC,EAAUnN,EAAOqN,MAE5DpB,EAAAze,UAAAiR,OAAA,SAAQyO,EAAoBC,EAAiBC,EAAoBC,EAAiBrN,GAC9E,OAAOlL,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAEiP,OAAOyO,EAAaC,EAAUC,EAAaC,EAAUrN,MAE7EiM,EAAAze,UAAA+f,QAAA,SAASL,EAAoBC,EAAiBE,EAAiBrN,GAC3D,OAAOlL,KAAK2X,GAAG,SAAAjd,GAAG,OAAAA,EAAE+d,QAAQL,EAAaC,EAAUnN,EAAOqN,MAElEpB,EAnFA,GAqFAW,EAAA,WAGI,SAAAY,IACI1Y,KAAK+X,oBAwCb,OArCIW,EAAAhgB,UAAAgJ,IAAA,SAAKa,EAAcuG,GAEf,OADA9I,KAAK+X,iBAAiBvf,MAAMkf,GAAI,MAAOnV,MAAKA,EAAEuG,IAAGA,IAC1C9I,MAEX0Y,EAAAhgB,UAAA6Q,IAAA,SAAKhH,EAAcuG,GAIf,cAHAA,EAAG6P,KAAO7P,IACCvC,IACXvG,KAAK+X,iBAAiBvf,MAAMkf,GAAI,MAAOnV,MAAKA,EAAEuG,IAAGA,IAC1C9I,MAEX0Y,EAAAhgB,UAAA0c,OAAA,SAAQ7S,EAAc0C,GAElB,OADAjF,KAAK+X,iBAAiBvf,MAAMkf,GAAI,SAAUnV,MAAKA,EAAE0C,GAAEA,IAC5CjF,MAEX0Y,EAAAhgB,UAAAwf,MAAA,SAAO3V,EAAc0C,EAAWsB,GAE5B,OADAvG,KAAK+X,iBAAiBvf,MAAMkf,GAAI,QAASnV,MAAKA,EAAE0C,GAAEA,EAAEsB,IAAGA,IAChDvG,MAEX0Y,EAAAhgB,UAAAyf,QAAA,SAAS5V,EAAc0C,EAAWsB,GAE9B,OADAvG,KAAK+X,iBAAiBvf,MAAMkf,GAAI,UAAWnV,MAAKA,EAAE0C,GAAEA,EAAEsB,IAAGA,IAClDvG,MAEX0Y,EAAAhgB,UAAA8Q,KAAA,SAAM4O,EAAoBC,EAAiBC,EAAoBC,EAAiBrN,GAE5E,OADAlL,KAAK+X,iBAAiBvf,MAAMkf,GAAI,OAAQU,YAAWA,EAAEC,SAAQA,EAAEC,YAAWA,EAAEC,SAAQA,EAAErN,MAAKA,IACpFlL,MAEX0Y,EAAAhgB,UAAA8f,MAAA,SAAOJ,EAAoBC,EAAiBnN,EAAcqN,GACtDvY,KAAK+X,iBAAiBvf,MAAMkf,GAAI,OAAQU,YAAWA,EAAEC,SAAQA,EAAEE,SAAQA,EAAErN,MAAKA,KAElFwN,EAAAhgB,UAAAiR,OAAA,SAAQyO,EAAoBC,EAAiBC,EAAoBC,EAAiBrN,GAE9E,OADAlL,KAAK+X,iBAAiBvf,MAAMkf,GAAI,SAAUU,YAAWA,EAAEC,SAAQA,EAAEC,YAAWA,EAAEC,SAAQA,EAAErN,MAAKA,IACtFlL,MAEX0Y,EAAAhgB,UAAA+f,QAAA,SAASL,EAAoBC,EAAiBnN,EAAcqN,GAExD,OADAvY,KAAK+X,iBAAiBvf,MAAMkf,GAAI,SAAUU,YAAWA,EAAEC,SAAQA,EAAEE,SAAQA,EAAErN,MAAKA,IACzElL,MAEf0Y,EA5CA,0EC/GaE,IAODC,SAAY,uCACZC,WAAc,SACdC,gBAAmB,IACnB5e,KAAQ,kBACR6e,UAAa,MACbC,iBAIAJ,SAAY,uCACZC,WAAc,SACdC,gBAAmB,IACnB5e,KAAQ,WACR6e,UAAa,KACbC,cAEQC,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,cACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,0BACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,YACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,YACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,aACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kCACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,aACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,uBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,uBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,0BACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,8BACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,gCACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,4BAKzBP,SAAY,uCACZC,WAAc,SACdC,gBAAmB,IACnB5e,KAAQ,YACR6e,UAAa,KACbC,cAEQC,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,4BACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,+BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,uBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,wBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,wDACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,6BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,0BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,2CACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,4BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,WACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,6BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,4BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,+BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,+BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,wBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,uBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,0BACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,4BAKzBP,SAAY,uCACZC,WAAc,SACdC,gBAAmB,IACnB5e,KAAQ,oBACR6e,UAAa,OACbC,cAEQC,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,aACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,aACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,0BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,YACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,aACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,6BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,YACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,WACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,qCACR6e,UAAa,IACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oBACR6e,UAAa,IACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,WACR6e,UAAa,IACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,aACR6e,UAAa,IACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,IACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,cACR6e,UAAa,IACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iBACR6e,UAAa,IACbG,YAAe,KACfC,cAAiB,SAKzBP,SAAY,uCACZC,WAAc,SACdC,gBAAmB,IACnB5e,KAAQ,UACR6e,UAAa,KACbC,cAEQC,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,iBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,iBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,mCACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,sBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,8BACR6e,UAAa,KACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,yCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,iCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,wBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,8BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,wBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,2BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,0BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,sCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,4CACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mDACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,4BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,oBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,UACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,kBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,4BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,mBACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,+BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,yCACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,gDACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,8BACR6e,UAAa,KACbG,YAAe,KACfC,cAAiB,OAGjBF,OAAU,uCACV/e,KAAQ,8BACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,eACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,0BACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,YACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,0BAGjBF,OAAU,uCACV/e,KAAQ,qBACR6e,UAAa,IACbG,aAAe,EACfC,cAAiB,4BCrtCxBC,GAGTA,cAEIC,gBAAmB,yBACnB7b,KAAQ,0BACR8b,UAAa,IACbC,eAAkB,0BAGlBF,gBAAmB,0BACnB7b,KAAQ,iCACR8b,UAAa,IACbC,eAAkB,WAGlBF,gBAAmB,0BACnB7b,KAAQ,OACR8b,UAAa,IACbC,eAAkB,aCpBbC,GAGTC,aAEQF,eAAkB,4BAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,WAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,QAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,WAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,YAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,kBAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,WAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,mBAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,mBAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,UAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,UAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,SAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,OAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,oBAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,OAKrBC,eAAkB,OAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,QAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,QAKrBC,eAAkB,QAClBG,eAAkB,IAClBC,aAAgB,GAChBC,cAEQf,WAAc,SACdS,UAAa,MAGbT,WAAc,SACdS,UAAa,gBCpPjC,SAAAO,IACE,OAAQ7Z,KAAM6B,EAAA,EAAIU,YAAYC,sEAEhC,IAAAsX,EAAA,WAGE,SAAAC,EACE9F,EACAC,EACAN,GAEA7T,KAAKoX,KAAO,IAAIvB,EAAA,EAAY3B,EAAYC,GAAUN,eAAcA,IAChE7T,KAAKia,iBAAmBC,EAAsBla,KAAKia,kBACnDja,KAAKma,qBAAuBD,EAAsBla,KAAKma,sBACvDna,KAAKoa,gBAAkBF,EAAsBla,KAAKoa,iBAClDpa,KAAKqa,0BAA4BH,EAAsBla,KAAKqa,2BAuDhE,OA/CQL,EAAAthB,UAAAuhB,iBAAN,SAAuBK,6GAOP,6BALNjL,EAAYyK,IACdQ,IACEA,EAAEC,aAAYlL,EAAMmL,WAAaF,EAAEC,YACnCD,EAAExB,aAAYzJ,EAAMoL,WAAaH,EAAExB,cAE7B,EAAM9Y,KAAKoX,KAAK3c,IAAI,uBAAwB4U,kBACtC,MADZvE,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BvI,EAAA,EAAShJ,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAImL,EAAA,EAASrB,EAAA1G,QAAa+W,EAAApQ,kBAC1C,SAAM8H,EAAIzJ,eACvB,SADa+R,EAAApQ,OACD4V,gBAGZ,iBADAja,QAAQC,MAAM,mBAAqB8b,GAC7B,IAAI5O,MAAMrT,OAAAga,EAAA,EAAAha,CAACkiB,MAAAhY,EAAA,qNASfqX,EAAAthB,UAAAyhB,qBAAN,SAA2BS,2GAGb,OAFNvL,EAAYyK,IACbe,MAAMD,KAAQvL,EAAMyL,MAAQF,IACrB,EAAM5a,KAAKoX,KAAK3c,IAAI,qBAAsB4U,kBACpC,MADZvE,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BvI,EAAA,EAAShJ,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAImL,EAAA,EAASrB,EAAA1G,QAAa+W,EAAApQ,kBAC1C,SAAM8H,EAAIzJ,eACvB,SADa+R,EAAApQ,OACDqW,mBAMRW,EAAAthB,UAAA0hB,gBAAN,iHACc,SAAMpa,KAAKoX,KAAK3c,IAAI,eAAgBqf,oBAC9B,MADZhP,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BvI,EAAA,EAAShJ,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAImL,EAAA,EAASrB,EAAA1G,QAAa+W,EAAApQ,kBAC1C,SAAM8H,EAAIzJ,eACvB,SADa+R,EAAApQ,OACD+X,oBAGRf,EAAAthB,UAAA2hB,0BAAN,iHACc,SAAMra,KAAKoX,KAAK3c,IAAI,yBAA0Bqf,oBACxC,MADZhP,EAAMsI,EAAApQ,QACJ2J,QAAJ,QAA6BvI,EAAA,EAAShJ,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAqF,EAAA7J,MAAImL,EAAA,EAASrB,EAAA1G,QAAa+W,EAAApQ,kBAC1C,SAAM8H,EAAIzJ,eACvB,SADa+R,EAAApQ,OACDgY,8BAEhBhB,EAnEA,GAqEAiB,EAAA,WAIE,SAAAC,EAAaC,GACX,GAAwC,iBAA7BA,GAIT,GAHAnb,KAAKob,OAASD,EACdnb,KAAKoQ,KAAOpQ,KAAKob,OAAOC,WAAW,MAAQ,KAAO,KAClDrb,KAAKsD,KAAO0N,SAAShR,KAAKob,OAAO1f,OAAO,IACpCmf,MAAM7a,KAAKsD,MAAO,MAAM,IAAIwI,MAAO,mBAAmB9L,KAAKob,YAC1D,CACL,IAAME,EAAa,IAAIC,EAAA,EAAWJ,GAClCnb,KAAKob,QAA8B,OAApBE,EAAWlL,KAAgB,KAAO,MAAQkL,EAAWhY,KACpEtD,KAAKoQ,KAAOkL,EAAWlL,KACvBpQ,KAAKsD,KAAOgY,EAAWhY,MAoB7B,OAhBE7K,OAAA6B,eAAI4gB,EAAAxiB,UAAA,kBAAJ,WACE,OAAO,IAAI6iB,EAAA,GACT5K,aAA4B,OAAd3Q,KAAKoQ,KACdpQ,KAAKsD,KAAI,KAAItD,KAAKsD,KAAO,GACzBtD,KAAKsD,KAAK,EAAC,IAAItD,KAAKsD,KACzB8M,KAAMpQ,KAAKoQ,wCAIf8K,EAAAxiB,UAAAgO,SAAA,WACE,OAAO1G,KAAKob,QAGdF,EAAAxiB,UAAA6H,QAAA,WACE,OAAOP,KAAKsD,KAAO,KAAqB,OAAdtD,KAAKoQ,KAAgB,IAAM,MAEzD8K,EAlCA,GA0CA,kBAGE,SAAAM,IACExb,KAAKoX,KAAO,KAGRoE,EAAA9iB,UAAAuhB,iBAAN,SAAuBK,8EAMnB,OALEnhB,EAASyf,EACP0B,IACEA,EAAEC,aAAYphB,EAASA,EAAOyL,OAAQ,SAAA3K,GAAK,OAAAA,EAAE+e,YAAcsB,EAAEC,cAC7DD,EAAExB,aAAY3f,EAASA,EAAOyL,OAAO,SAAA3K,GAAK,OAAAA,EAAE6e,aAAewB,EAAExB,gBAEnE,EAAO3f,QAGLqiB,EAAA9iB,UAAAyhB,qBAAN,SAA2BS,wEACzB,SAAOA,EACHvB,EAAYA,YAAYhe,MAAM,EAAGuf,GACjCvB,EAAYA,kBAGZmC,EAAA9iB,UAAA0hB,gBAAN,gFACE,SAAOX,EAAWC,iBAGd8B,EAAA9iB,UAAA2hB,0BAAN,gFACE,kBA3BJ,GA+BA,SAAAH,EAAoClK,GAClC,IAAIyL,KACJ,OAAO,WACL,IAAMC,EAAW3a,KAAKO,aAAajG,MAAMzC,KAAKgF,YAO9C,OANK6d,EAAgBC,KACnBD,EAAgBC,GAAY1L,EAAO/W,MAAM+G,KAAMpC,WAAWsS,KAAK,SAAA/W,GAE7D,cADOsiB,EAAgBC,GAChBviB,KAGJsiB,EAAgBC,8ECxK3BC,EAAAliB,EAAA,GAoBAmiB,EAAA,SAAA3Z,GACE,SAAA2Z,EAAY9e,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH4a,WAAY/e,EAAM+e,aAAc,KA2BtC,OA/BkCxS,EAAA,EAAAuS,EAAA3Z,GAQhC2Z,EAAAljB,UAAAojB,0BAAA,SAA2BC,GACrBA,EAAUF,aAAe7b,KAAKlD,MAAM+e,YACtC7b,KAAKgc,UAAUH,WAAYE,EAAUF,cAIzCD,EAAAljB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAlD,MAAEof,EAAApZ,EAAAoZ,MAAOpP,EAAAhK,EAAAgK,UAAWqP,EAAArZ,EAAAqZ,SAAUC,EAAAtZ,EAAAsZ,gBAAiBC,EAAAvZ,EAAAuZ,iBAC7CR,EAAA7b,KAAAiB,MAAA4a,WAER,OAAOF,EAAA,qBAAK7O,WAAYA,GAAW,IAAM,cAAgB+O,EAAa,QAAU,KAC9EF,EAAA,qBAAK7O,UAAW,cAAgBsP,EAAkB,IAAMA,EAAkB,IACxEE,QAAS,WACHna,EAAKrF,MAAMyf,aAAapa,EAAKrF,MAAMyf,aAAapa,EAAKlB,MAAM4a,YAC/D1Z,EAAK6Z,UAAWH,YAAa1Z,EAAKlB,MAAM4a,eAEzCK,GAEHP,EAAA,qBAAK7O,UAAW,eAAiBuP,EAAmB,IAAMA,EAAmB,KAC1EF,KAITP,EA/BA,CAAkCD,EAAA,6HClB5B,SAAAa,EAAmBlZ,EAAcJ,GACrC,IAAMlJ,EAAIuW,IAAO,IAAItS,KAAKqF,EAAM,EAAG,IAAImZ,OAAO,MAAMvZ,KAAKA,GAOzD,OALEI,KAAIA,EACJJ,KAAIA,EACJK,UAAWvJ,EAAEkC,QAAQoE,QAAQ,QAAQoB,KAAK,EAAG,QAAQgb,SAASC,UAC9DlZ,SAAUzJ,EAAEkC,QAAQoE,QAAQ,QAAQoB,IAAI,EAAG,QAAQgb,SAASC,WAK1D,SAAAC,EAA0B5iB,GAChBA,EAAEkC,QAAQugB,OAAO,MAC/B,OAAOziB,EAAE6iB,WAAa,EAClB7iB,EAAEkJ,OAAS,EACXlJ,EAAEkJ,+ICRG4Z,EAAoBC,EAAA,EAAID,kBAiBnCE,EAAA,WASE,SAAAA,IAAA,IAAA7a,EAAAnC,KARAA,KAAA7G,OAAyC,KACzC6G,KAAA4G,eACA5G,KAAAid,YAAsB,EAsKtBjd,KAAAkd,iBAAmB,SAACpX,EAAqC9I,GACvD,IACE8I,EAAW9I,EAAQigB,WAAa9a,EAAKhJ,OAASgJ,EAAKhJ,OAAOyL,OAAO,SAAA3K,GAAK,OAAAA,EAAEkjB,WACxE,MAAOC,GACPze,QAAQC,MAAMwe,KAnKhBpd,KAAKqd,QAAU,IAAIC,EAAA,GACjBlb,UAAW,WAAM,OAAA2a,EAAA,EAAI1a,kBACrBC,YAAY,EACZC,MAAO,oBACPtC,KAAM8c,EAAA,EAAIva,YAAcua,EAAA,EAAIva,YAAYC,KAAO,GAC/CC,gBAAiB,kBAAA2G,EAAA,EAAAlH,OAAA,2BAAAkH,EAAA,EAAArJ,KAAA,SAAA8C,GAAY,UAAEY,KAAM,gBAGvC,IAAM6Z,EAAcvd,KAAKwd,OAEzBnS,QAAQ6B,KACNqQ,EACAvd,KAAKyd,kBACLzd,KAAK0d,oBACJC,MAAM,SAAAP,GAAO,OAAA3kB,OAAAmlB,EAAA,EAAAnlB,CAAU2kB,KAgL9B,OA7KQJ,EAAAtkB,UAAA8kB,KAAN,wHAqBE,OAnBMK,EAAgBd,EAAA,EAAIlJ,eAAiBkJ,EAAA,EAAIlJ,eAAerB,YAAcnH,QAAQC,YAOpFtL,KAAKyd,kBAAoBI,EAAc3N,KAAK,WAAI,OAAA/N,EAAK2b,mBACrD9d,KAAK0d,kBAAoBG,EAAc3N,KAAK,WAAI,OAAA/N,EAAK4b,mBAEjDC,GAA4B,EAChChe,KAAKie,yBAA2B,IAAI5S,QAAQ,SAAAC,GAAW,OAAA4S,EAAkC,SAAApK,GACnFkK,EACF7b,EAAK8b,yBAA2B5S,QAAQC,QAAQwI,IAEhDkK,GAA4B,EAC5B1S,EAAQwI,QAGZ,EAAM+J,iBAAN/a,EAAAE,OAEAhD,KAAKqd,QAAQtZ,IAAI8B,UAAU,SAAMsY,GAAiB,OAAA9U,EAAA,EAAAlH,OAAA,0FAGN,SAAMkJ,QAAQ6B,KACtDlN,KAAKyd,kBACLzd,KAAK0d,4BAGO,OALR5a,EAAoCsQ,EAAApQ,OAAnCob,EAAatb,EAAA,GAAEub,EAAgBvb,EAAA,GAKtCC,EAAA/C,MAAc,EAAMA,KAAKse,kBAAkBD,EAAkBF,EAAmBC,kBAAhFrb,EAAK5J,OAASia,EAAApQ,OAEdhD,KAAK4G,YAAY5K,QAAQ,SAAA8J,GAAc,OAAA3D,EAAK+a,iBAAiBpX,EAAWA,WAAYA,EAAW9I,WAC/FkhB,EAAgCC,wBAI9BnB,EAAAtkB,UAAAolB,eAAN,+GAGkB,OAFVb,EAAajd,KAAKid,WACxBte,QAAQuU,IAAI,eAAgB+J,IACZ,EAAMF,EAAA,EAAI1a,iBAAiBmC,KAAa,WACtDd,KAAM,OACNvJ,KAAM4iB,EAAA,EAAIva,YAAYgE,OACtB7C,QAAS,gBACTC,MAAOqZ,MAAmB,0BAC1BsB,UAAWxB,EAAA,EAAIva,YAAYgS,mBAG7B,OARMgK,EAAU1b,EAAAE,QAQhB,EADsBvK,OAAAmlB,EAAA,EAAAnlB,CAAQ+lB,EAAQrhB,IAAI,SAAAqJ,GAAU,OAAAA,EAAO4X,iBAAgB7G,KAAK9e,OAAAmlB,EAAA,EAAAnlB,CAAY,gBAI9FukB,EAAAtkB,UAAAqlB,eAAA,WACE,IAAMjF,EAAa,IAAI2F,EAAA,EAAUhmB,OAAAimB,EAAA,EAAAjmB,CAAgBkmB,QAAWvD,OAC5D,OAAsD,IAA/C2B,EAAA,EAAIva,YAAYuL,MAAM9F,QAAQ,YAEnC8U,EAAA,EAAI6B,UAAU3E,kBAAkBnB,WAAUA,IAE1C,MAGEkE,EAAAtkB,UAAA4lB,kBAAN,SACED,EACAF,EACAC,kHAWe,OATTS,EAAmBpmB,OAAAmlB,EAAA,EAAAnlB,CAAW0lB,EAAkBvZ,OAAO,SAAAka,GAAM,OAACA,EAAGC,OAAO,SAAAD,GAAM,OAAAA,EAAG3kB,OACjF6kB,EAAoBvmB,OAAAmlB,EAAA,EAAAnlB,CAAW0lB,EAAkBvZ,OAAO,SAAAka,GAAM,OAAAA,EAAGC,OAAO,SAAAD,GAAM,OAAAA,EAAG3kB,OAEjF8kB,EAAYlC,EAAA,EAAIva,YAAYuL,MAAM7E,KAAK,SAAAxF,GAAQ,MAAS,YAATA,IAE/Cwb,EAAeb,EACnB5lB,OAAAmlB,EAAA,EAAAnlB,CAAW4lB,EAAkB,SAAApkB,GAAK,OAAAA,EAAEE,KAAKuB,OAAO,EAAG,UAGtC,EAAM2P,QAAQ6B,IAAIkR,EAAcjhB,IAAI,SAAO2F,OAACmC,EAAAnC,EAAAmC,GAAI9K,EAAA2I,EAAA3I,KAAMglB,EAAArc,EAAAqc,YAAa9U,EAAAvH,EAAAuH,uHAE1E+U,EAAYF,EAAa/kB,EAAKuB,OAAO,EAAG,KAMxCyhB,GAJAkC,GAAiBJ,GACR,MAAbG,IAICP,EAAiB5Z,KAChB+Z,EAAkB/Z,IAEjBjF,KAAKid,YAAc9iB,EAAK7B,QAAU,GAEjC8mB,GAEFjlB,EAAOilB,EAAUjlB,aAFf,MAFF,mBAKSgjB,GAGU,EAAMJ,EAAA,EAAI1a,iBAAiB5H,IAAI,UAAWwK,KAHpD,YAGHgY,EAAala,EAAAC,OACnB7I,EAAO8iB,EAAW9iB,sBAStB,OAJIkQ,GAAcA,EAAWlQ,OAASglB,IACpCA,EAAiB9U,EAAWlQ,KAAI,cAGlC,GACE8K,GAAEA,EACF9K,KAAIA,EACJglB,YAAWA,EACXhC,QAAOA,EACPkC,eAAcA,oBAIlB,SAvCevc,EAAAE,cA0CXga,EAAAtkB,UAAA4mB,WAAN,SAAiBrlB,4GACTslB,EAAYvf,KAAKqd,QAAQtZ,IAAIyb,MAAM5a,OAAO,SAAAka,GAAM,OAAAA,EAAG3kB,OAASF,EAAEgL,KAChEhL,EAAEolB,gBACJ,EAAMrf,KAAKqd,QAAQoC,SACjBxa,GAAIxM,OAAAinB,EAAA,EAAAjnB,GACJ0B,KAAMF,EAAEgL,QAHR,mBACFnC,EAAAE,oBAKA,SAAMhD,KAAKqd,QAAQjI,OAAOmK,EAAUpiB,IAAI,SAAAwiB,GAAM,OAAAA,EAAG1a,cAAjDnC,EAAAE,wCAIEga,EAAAtkB,UAAAknB,WAAN,SAAiB3lB,4GACTslB,EAAYvf,KAAKqd,QAAQtZ,IAAIyb,MAAM5a,OAAO,SAAAka,GAAM,OAAAA,EAAG3kB,OAASF,EAAEgL,KAChEhL,EAAEolB,gBACJ,EAAMrf,KAAKqd,QAAQjI,OAAOmK,EAAUpiB,IAAI,SAAAwiB,GAAM,OAAAA,EAAG1a,QAD/C,mBACFnC,EAAAE,oBAEA,SAAMhD,KAAKqd,QAAQoC,SACjBxa,GAAIxM,OAAAinB,EAAA,EAAAjnB,GACJ0B,KAAMF,EAAEgL,GACR8Z,MAAM,aAHRjc,EAAAE,wCAgBEga,EAAAtkB,UAAAmN,UAAN,SAAiBC,EAAqC9I,oHAC/CgD,KAAKid,aAAcjgB,EAAQigB,YAA5B,MAIFjd,KAAKid,WAAajgB,EAAQigB,WAC1Bjd,KAAKyd,kBAAoBzd,KAAK8d,kBAE+B,EAAMzS,QAAQ6B,KACzElN,KAAKyd,kBACLzd,KAAK0d,kBACL1d,KAAKie,oCAEO,OALRnb,EAAuDsQ,EAAApQ,OAAtDob,EAAatb,EAAA,GAAEub,EAAgBvb,EAAA,GAAEqb,EAAiBrb,EAAA,GAKzDC,EAAA/C,MAAc,EAAMA,KAAKse,kBAAkBD,EAAkBF,EAAmBC,WAAhFrb,EAAK5J,OAASia,EAAApQ,wBAEhB,SAAMhD,KAAKie,wCAAX7K,EAAApQ,OACAhD,KAAKkd,iBAAiBpX,EAAY9I,GAClCgD,KAAK4G,YAAYpO,MAAMsN,WAAUA,EAAE9I,QAAOA,cAG5CggB,EAAAtkB,UAAAiO,YAAA,SAAab,GACX9F,KAAK4G,YAAc5G,KAAK4G,YAAYhC,OAAO,SAAAlL,GAAK,OAAAA,EAAEoM,aAAeA,KAErEkX,EAxMA,GA0MKF,IACHA,EAAoBC,EAAA,EAAID,kBAAoB,IAAIE,2FCzNlD6C,EAAA,WAIE,SAAAA,EAAY7iB,GAAZ,IAAAmF,EAAAnC,KACSuC,EAAAvF,EAAAuF,MAAOH,EAAApF,EAAAoF,UAAWM,EAAA1F,EAAA0F,gBACzB1C,KAAK+D,IAAM,IAAI+b,EAAA,GAASzQ,MAAO,kBAAAhG,EAAA,EAAAlH,OAAA,6EACR,SAAMO,YACpB,OADDqd,EAAejd,EAAAE,QACd,EAAMZ,IAAYoC,KAAQjC,EAAK8G,EAAA,KACjC0W,GACHxB,UAAWve,KAAKggB,0BAFlB,SAAOld,EAAAE,gBAIThD,KAAKhD,QAAUA,EAiJnB,OA9IU6iB,EAAAnnB,UAAAsnB,aAAR,WACQ,IAAAld,EAAA9C,KAAAhD,QAACuF,EAAAO,EAAAP,MAAOtC,EAAA6C,EAAA7C,KAEd,OADkBW,aAAaC,QAAQ,cAAgB0B,EAAQ,IAAMtC,IACjDD,KAAKigB,uBAGnBJ,EAAAnnB,UAAAunB,oBAAR,WACQ,IAAAnd,EAAA9C,KAAAhD,QAACuF,EAAAO,EAAAP,MAAOtC,EAAA6C,EAAA7C,KACRse,EAAY9lB,OAAA6Q,EAAA,EAAA7Q,GAElB,OADAmI,aAAaW,QAAQ,cAAgBgB,EAAQ,IAAMtC,EAAMse,GAClDA,GAGHsB,EAAAnnB,UAAAwnB,OAAN,SAAajhB,EAASkhB,mHACflhB,EAAK+L,OAAN,MAEIoV,EAAc3nB,OAAOgI,UAAWxB,GACtCkhB,EAAQC,IACD,EAAMpgB,KAAKyf,QAAQW,aAA1B,SAAOtd,EAAAE,eAKP,SAAMhD,KAAKsE,QAAQrF,GAAOkhB,GAASxC,MAAM,SAAAtR,GACvC,GAAe,YAAXA,EAAElS,MAAiC,YAAXkS,EAAElS,KAAoB,CAChD,IAAMimB,EAAc3nB,OAAOgI,UAAWxB,GAEtC,OADAkhB,EAAQC,GACDje,EAAKsd,QAAQW,IAEtB,OAAO/U,QAAQE,OAAOc,aANxBvJ,EAAAE,wCAWE6c,EAAAnnB,UAAA4L,OAAN,SAAakb,EAAYW,+HACjBrd,EAAiC9C,KAAKhD,QAArCoF,EAASU,EAAAV,UAAEE,EAAUQ,EAAAR,WAAEC,EAAKO,EAAAP,MAC7B6B,EAAShC,IACTie,EAAqBb,EAAMriB,IAAI,SAAA8B,GACnC,IAAMqhB,EAAcne,EAAK4B,IAAIyb,MAAM/R,KAAK,SAAA8S,GAAM,OAAAA,EAAGtb,KAAOhG,EAAKgG,KAG7D,OAFAhG,EAAOxG,OAAOgI,UAAW6f,GAAerhB,GACxCkhB,EAAQlhB,GACDA,IAELqD,GAAY,EAAMtC,KAAK+D,IAAIO,OAAO+b,EAAcljB,IAAI,SAAA2W,GAAK,OAAArb,OAAOgI,UAAWqT,GAAIvP,MAAO,kBAAtF,YAAYxB,EAAAC,wBACJ,SAAMoB,EAAOuT,GAAI,SAAA6I,GAAM,OAAAH,EAAcrkB,QAAQ,SAAAiD,GAAQ,OAAAuhB,EAAGjX,IAAIhH,EAAOtD,OAC9E0e,MAAM,SAAAtR,GAAK,MAAW,YAAXA,EAAElS,KAEZiK,EAAOI,KAAQjC,GAAQke,IAAKjB,EAAMriB,IAAI,SAAA8B,GAAQ,OAAAA,EAAKgG,OAAOR,MAAO,aAAayL,KAAK,SAAAwQ,GAEjF,IAAML,EAAgBK,EAAWvjB,IAAI,SAAAwjB,GAEnC,IAAMC,EAAWnoB,OAAOgI,UAAWkgB,GAGnC,OADAR,EAAQS,GACDA,IAGT,OAAOxc,EAAOuT,GAAG,SAAA6I,GAAM,OAAAH,EAAcrkB,QAAQ,SAAAiD,GAAQ,OAAAuhB,EAAGjX,IAAIhH,EAAOtD,SAGrEoM,QAAQC,QAAQhJ,GACdH,EAAK4B,IAAIO,OAAOkb,IACjBtP,KAAK,WACJ,OAAO7E,QAAQE,OAAOc,eAO1B,OA1BMvB,EAAM/H,EAAAC,OAqBZhD,KAAKigB,sBACLI,EAAcrkB,QAAQ,SAAAiD,GACpBA,EAAK+L,MAAQF,EAAID,SAAS5L,EAAKgG,IAC/BhG,EAAKsF,WAAQsc,KAEf,EAAM7gB,KAAK+D,IAAIO,OAAO+b,kBAAtBtd,EAAAC,iBAGF6c,EAAAnnB,UAAAooB,YAAA,SAAatB,EAAYnX,GACvB,OAAOmX,EAAMriB,IAAI,SAAA8B,GACf,IAAM/C,EAAQzD,OAAOgI,UAAWxB,GAMhC,OALAoJ,EAAOrM,QAAQ,SAAA+kB,GACT9hB,EAAK8hB,KACP7kB,EAAM6kB,GAAU9hB,EAAK8hB,GAAyB5jB,IAAK,SAAA2L,GAAO,OAAE7D,GAAI6D,EAAI7D,SAGjE/I,KAIL2jB,EAAAnnB,UAAA+mB,OAAN,SAAaD,wIAGU,OAFf1c,EAAkD9C,KAAKhD,QAAtDoF,EAASU,EAAAV,UAAEE,EAAUQ,EAAAR,WAAEC,EAAKO,EAAAP,MAAEG,EAAeI,EAAAJ,gBAC9C0B,EAAShC,KACM,EAAMM,mBAArBqd,EAAehd,EAAAC,OACfqF,KAAYhM,OAAO0jB,EAAapc,SAEtC6b,EAAQA,EAAMriB,IAAI,SAAA8B,GAAQ,OAAAA,EAAKgG,GAAKhG,EAAOxG,OAAOgI,UAAWxB,GAAOgG,GAAIxM,OAAA6Q,EAAA,EAAA7Q,OAClEuoB,EAAWhhB,KAAK8gB,YAAYtB,EAAOnX,GACrC/F,GAAY,EAAMtC,KAAK+D,IAAI0b,OAAOuB,EAAS7jB,IAAI,SAAA2W,GAAK,OAAArb,OAAOgI,UAAWqT,GAAIvP,MAAO,gBAAjF,YAAYxB,EAAAC,wBAEhB,IADMwd,EAAK,IAAIlX,EAAA,aACJrK,GAET,mBAAW8hB,GACT,IAAME,EAA2BhiB,EAAK8hB,GAClCE,GACFA,EAAajlB,QAAQ,SAAA8M,GACnB0X,EAAGhI,MAAMjW,EAAOtD,EAAKgG,GAAI8b,EAAOjY,EAAI7D,OAJtBtH,EAAA,EAAAsN,EAAA5C,EAAA1K,EAAAsN,EAAA3S,OAAAqF,IAAM,GAAVsN,EAAAtN,IAQhB6iB,EAAG9e,IAAIa,EAAOtD,IAVZtB,EAAA,EAAeujB,EAAAF,EAAArjB,EAAAujB,EAAA5oB,OAAAqF,IAARsB,EAAIiiB,EAAAvjB,KAAJsB,GAYC,SAAMmF,EAAOkE,MAAMkY,EAAGzI,kBAAkB4F,MAAM,SAAAtR,GAExD,OADI/J,GAAYH,EAAK4B,IAAIqR,OAAOoK,EAAMriB,IAAI,SAAA8B,GAAQ,OAAAA,EAAKgG,MAChDoG,QAAQE,OAAOc,oBAFlBvB,EAAM/H,EAAAC,OAIZhD,KAAKigB,sBACLT,EAAMxjB,QAAQ,SAAAiD,GAAQ,OAAAA,EAAK+L,MAAQF,EAAID,SAAS5L,EAAKgG,MACjD3C,GACF,EAAMtC,KAAK+D,IAAIO,OAAOkb,KADpB,mBACFzc,EAAAC,oBAEA,SAAMhD,KAAK+D,IAAI0b,OAAOD,WAAtBzc,EAAAC,wCAGE6c,EAAAnnB,UAAA0c,OAAN,SAAcqL,2HACN3d,EAAiC9C,KAAKhD,QAArCoF,EAASU,EAAAV,UAAEE,EAAUQ,EAAAR,WAAEC,EAAKO,EAAAP,MAC7B6B,EAAShC,IACXE,GAAY,EAAMtC,KAAK+D,IAAIO,OAAOmc,EACnCtjB,IAAI,SAAA8H,GAAM,OAAA9C,EAAK4B,IAAIyb,MAAM/R,KAAK,SAAAqG,GAAK,OAAAA,EAAE7O,KAAOA,MAC5CL,OAAO,SAAAkP,GAAK,OAAAA,IACZ3W,IAAI,SAAA2W,GAAK,OAAArb,OAAOgI,UAAWqT,GAAIvP,MAAO,kBAHrC,YAAYxB,EAAAC,wBAIJ,SAAMoB,EAAOuT,GAAI,SAAA6I,GAAM,OAAAC,EAAIzkB,QAAQ,SAAAiJ,GAAM,OAAAub,EAAGpL,OAAO7S,EAAO0C,OAAM0Y,MAAM,SAAMtR,GAAC,OAAAhD,EAAA,EAAAlH,OAAA,yFACnFG,GACF,EAAMtC,KAAK+D,IAAIO,OAAOmc,EACnBtjB,IAAI,SAAA8H,GAAM,OAAA9C,EAAK4B,IAAIyb,MAAM/R,KAAK,SAAAqG,GAAK,OAAAA,EAAE7O,KAAOA,MAC5CL,OAAO,SAAAkP,GAAK,OAAAA,IACZ3W,IAAI,SAAA2W,GAGH,cAFAA,EAAIrb,OAAOgI,UAAWqT,IACbvP,MACFuP,OAPT,YACFhR,EAAAE,wBASF,MAAMqJ,iBAGR,OAdYtJ,EAAAC,OAaZhD,KAAKigB,uBACL,EAAMjgB,KAAK+D,IAAIqR,OAAOqL,kBAAtB1d,EAAAC,iBAEJ6c,EA7JA,6FCFA,IAAAsB,EAAA,WAIE,SAAAA,EAAYC,GACV,IAAMC,EARD,iBAQ+BD,EAClCA,EAAqB3oB,OAAA6oB,EAAA,EAAA7oB,CAAgB8X,IAAO6Q,IAC9CphB,KAAK2Q,aAAe0Q,EAAa1Q,aACjC3Q,KAAKoQ,KAAOiR,EAAajR,KAkD7B,OA/CE3X,OAAA6B,eAAI6mB,EAAAzoB,UAAA,YAAJ,WACE,OAAOsY,SAAShR,KAAK2Q,aAChBtJ,MAAM,KAAmB,OAAdrH,KAAKoQ,KAAgB,EAAI,qCAG3C+Q,EAAAzoB,UAAA6oB,SAAA,WACE,OAAO,IAAIJ,EAAyB,OAAdnhB,KAAKoQ,MAEvBA,KAAM,KACNO,aAAc3Q,KAAK2Q,eAGnBP,KAAM,KACNO,aAAclY,OAAA6oB,EAAA,EAAA7oB,CAAQuH,KAAK2Q,aAAc,MAI/CwQ,EAAAzoB,UAAA8oB,SAAA,WACE,OAAO,IAAIL,EAAyB,OAAdnhB,KAAKoQ,MAEvBA,KAAM,KACNO,aAAclY,OAAA6oB,EAAA,EAAA7oB,CAAQuH,KAAK2Q,cAAe,KAG1CP,KAAM,KACNO,aAAc3Q,KAAK2Q,gBAKzBwQ,EAAAzoB,UAAA+oB,eAAA,SAAe1kB,EAAmB2kB,GAChC,IAAIpe,EAAqB,OAAdtD,KAAKoQ,KACdpQ,KAAK2Q,aAAatJ,MAAM,KAAK,GAC7BrH,KAAK2Q,aAAatJ,MAAM,KAAK,GAE3Bqa,IACFpe,EAAOA,EAAK5H,OAAO,IAErB,IAAmB,IAAAiC,EAAA,EAAAgkB,EAAA5kB,EAAAY,EAAAgkB,EAAArpB,OAAAqF,IAAO,CACxB,OADagkB,EAAAhkB,GACE0J,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGI,eACzC,IAAK,KACH,OAAwB,OAAdzH,KAAKoQ,KAAgB,KAAO,MAAI,IAAI9M,EAChD,IAAK,KACH,OAAwB,OAAdtD,KAAKoQ,KAAgB,KAAO,MAAI,IAAI9M,KAIxD6d,EA1DA,4FCAaS,EAAa,SAAC9e,OAAEwZ,EAAAxZ,EAAAwZ,QAASxP,EAAAhK,EAAAgK,UAAW+U,EAAA/e,EAAA+e,MAAO3F,EAAApZ,EAAAoZ,MAEtD,OAAAP,EAAA,qBACEO,MAAOA,GAASzjB,OAAAqpB,EAAA,EAAArpB,CAACspB,MAAA1Y,EAAA,2BACjByD,UAAW,eAAiBA,GAAa,IACzCwP,QAASA,EAASuF,MAAOA,wFCb7BtR,EAAAhU,EAAOylB,aAAa,MAChBC,OAAS,wFAAwF5a,MAAM,KACvG6a,YAAc,kDAAkD7a,MAAM,KACtE8a,SAAW,oDAAoD9a,MAAM,KACrE+a,cAAgB,8BAA8B/a,MAAM,KACpDgb,YAAc,uBAAuBhb,MAAM,KAC3Cib,gBACIC,GAAK,QACLC,IAAM,WACNhlB,EAAI,aACJilB,GAAK,cACLC,IAAM,0BACNC,KAAO,+BACPC,IAAM,mBACNC,KAAO,wBAEXC,UACIC,QAAS,YACTC,QAAS,eACTC,QAAS,YACTC,SAAU,eACVC,SAAU,iBACVC,SAAU,KAEdC,cACIC,OAAS,QACTC,KAAO,eACP7pB,EAAI,iBACJ8pB,GAAK,cACLxpB,EAAI,WACJypB,GAAK,aACLC,EAAI,WACJC,GAAK,YACLzpB,EAAI,SACJ0pB,GAAK,WACLC,EAAI,WACJC,GAAK,aACLC,EAAI,SACJC,GAAK,SAETC,uBAAwB,eACxBC,QAAU,SAAUC,GAChB,IAAIznB,EAAIynB,EAAS,GAKjB,OAAOA,GAJiC,MAAvBA,EAAS,IAAM,IAAa,IAClC,IAANznB,EAAW,IACL,IAANA,EAAW,IACA,MAGpBwG,MACIkhB,IAAM,EACNC,IAAM,KAIP,IAAMC,EAAc,WACvB,OAAO/T,EAAAhU,EAAOtD,MAAM+G,KAAMpC,WAAW6e,OAAO,mGChD1C,SAAA8H,EAAwBznB,GAC5B,OAAO0nB,EAAA,qBACL1X,UAAW,oBAAoBhQ,EAAMgQ,WAAYhQ,EAAMqgB,QAAU,WAAa,KAC9EqH,EAAA,uBAAI1nB,EAAMW,MACV+mB,EAAA,wBAAQlI,QAAS,WAAI,OAAAxf,EAAM2nB,cAAW,MACtCD,EAAA,wBAAQlI,QAAS,WAAI,OAAAxf,EAAM4nB,aAAU,2CCmCzC,cAAAC,EAAA,SAAA1iB,GACE,SAAA2iB,EAAY9nB,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH+E,aACA5F,SAAUnC,KAAKkC,MACf0kB,kBAEF1iB,EAAK2iB,SAAW3iB,EAAK2iB,SAAS1pB,KAAK+G,KAoIvC,OA5I8BQ,EAAA,EAAAiiB,EAAA3iB,GAW5B2iB,EAAAlsB,UAAAosB,SAAA,SAAU9e,EAAuB+e,GAC3BA,EAAU3kB,WAAaJ,KAAKiB,MAAMb,UACpCJ,KAAKgc,UACH6I,mBAGJ7kB,KAAKgc,UACHhW,UAASA,EACT5F,SAAU2kB,EAAU3kB,YAIxBwkB,EAAAlsB,UAAAssB,kBAAA,WACEC,EAAA,EAAcpf,UAAU7F,KAAK8kB,WAG/BF,EAAAlsB,UAAAwsB,qBAAA,WACED,EAAA,EAActe,YAAY3G,KAAK8kB,WAG3BF,EAAAlsB,UAAAysB,WAAN,SAAkBC,kHACVpf,EAAYhG,KAAKiB,MAAM+E,UAAUpB,OAAO,SAAAqB,GAC5C,OAAOmf,EAAapgB,KAClBiB,EAAGjB,MAAQiB,EAAGjB,KAAKkE,KAAK,SAAArE,GAAK,OAAAA,EAAEI,KAAOmgB,EAAangB,KACnDgB,EAAGof,mBAAqBD,EAAangB,KAElC7E,EAAYJ,KAAKiB,MAAKb,SAEJ,IAArB4F,EAAU1N,QAAV,MAEEgtB,EAAkB1V,KAAK2V,IAAItsB,MAC7B2W,KAAK2V,KACJnlB,GAAU/D,OAAO2D,KAAKiB,MAAM+E,UAAU7I,IAAI,SAAA0H,GAAK,OAAAA,EAAEuB,aAE9ClC,GACJe,GAAIxM,OAAA2L,EAAA,EAAA3L,GACJqM,WAAYsgB,EAAatgB,WACzBsB,SAAUkf,EAAkB,IAC5BvgB,aAAcqgB,EAAargB,aAC3B5K,KAAMirB,EAAajrB,KACnBoQ,IAAK6a,EAAa7a,IAClBhE,KAEE,IAAInC,EAAA,EAAe,QAAStC,EAAA,EAAIU,YAAYC,KAAM,KAGlD,IAAI2B,EAAA,EAAe,aAAiBtC,EAAA,EAAIU,YAAYgE,OAAM,YAAa,MACvErJ,IAAI,SAAAsJ,GAAM,OAAAA,EAAGC,cAEb0e,EAAapgB,MAAQogB,EAAapgB,KAAKwgB,WACzCthB,EAASshB,SAAWJ,EAAapgB,KAAKwgB,UAEpCJ,EAAapgB,MAAQogB,EAAajgB,QACpCjB,EAASc,MAAQogB,EAAapgB,MAC9Bd,EAASiB,QAAUigB,EAAajgB,SAEhCjB,EAASmhB,iBAAmBD,EAAangB,GAEvCmgB,EAAaK,OACfvhB,EAASuhB,KAAOL,EAAaK,OAE/B,EAAMpa,QAAQ6B,KACZ+X,EAAA,EAAczf,sBAAsB4f,EAAatgB,YAAY,GAC7DmgB,EAAA,EAAcxF,QAAQvb,sBAFxBpB,EAAAE,oBAKA,SAAMiiB,EAAA,EAAc7P,OAAOpP,EAAU7I,IAAI,SAAA0H,GAAK,OAAAA,EAAEI,cAAhDnC,EAAAE,wCAKJ4hB,EAAAlsB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACS0lB,EAAA1lB,KAAAlD,MAAA4oB,cACD1f,EAAYvN,OAAAga,EAAA,EAAAha,CAAWuH,KAAKiB,MAAM+E,UAAW,SAAAC,GAAM,OAAAA,EAAGjB,MAAQiB,EAAGjB,KAAK1M,OAAS,EACnF2N,EAAGjB,KAAK7H,IAAI,SAAA0H,GAAK,OAAAA,EAAEI,KAAI,GACvBgB,EAAGof,iBAAmBpf,EAAGof,iBACzBpf,EAAGsE,MACEsa,EAAA7kB,KAAAiB,MAAA4jB,cACDc,EAAkBxkB,IAAOnB,KAAKiB,MAAMb,UAAU8C,OAC9C0iB,EAAczkB,MAAS+B,OACvB2iB,EAAgBF,IAAoBC,EAAc,GACxDD,IAAoBC,EAAc,EAAIntB,OAAAga,EAAA,EAAAha,CAACqtB,MAAAnjB,EAAA,mDAAoC,OAAfgjB,GAC5DA,IAAoBC,EAAc,EAAIntB,OAAAga,EAAA,EAAAha,CAACstB,MAAApjB,EAAA,qDAAqC,OAAfgjB,GAC7DltB,OAAAga,EAAA,EAAAha,CAACutB,MAAArjB,EAAA,kCAA4B,MAAfgjB,GAEd,OAAOnB,EAAA,qBAAK1X,UAAU,iBACnB4Y,EAAcvoB,IAAI,SAACioB,EAAcrc,GAChC,IAAMkd,EAAeb,EAAangB,GAC5Bf,EAAW8B,EAAUigB,KAAkB1hB,MAAO,WAC9C2hB,EAA+B,WAAnBhiB,EAASK,OAAyC,aAAnBL,EAASK,MACpD4hB,EAA8B,YAAnBjiB,EAASK,OAA0C,aAAnBL,EAASK,MACpD6hB,EAAkBD,EACd1tB,OAAAga,EAAA,EAAAha,CAAC4tB,MAAA1jB,EAAA,oGAA2D,MAAbkjB,GAC/CptB,OAAAga,EAAA,EAAAha,CAAC6tB,MAAA3jB,EAAA,kGAA0D,MAAbkjB,GAClDU,EACJ1B,EAAc3b,KAAK,SAAAsd,GAAO,OAAAP,IAAiBO,IAE7C,OAAOhC,EAAA,qBAAKvoB,IAAKmpB,EAAangB,IAAIuf,EAAA,qBAAKvoB,IAAKgqB,EAAcnZ,UAAU,oBAClE0X,EAAA,qBAAK1X,UAAU,sBACX0X,EAAA,qBACE1X,UAAW,eAAcqZ,EAAW,YAAc,IAClDtE,MAAOqE,GAAaO,QAAS,OAC7BnK,QAAS,WAAI,OAAC4J,GAAaP,IAAoBC,EAE7CW,EACEpkB,EAAK6Z,UAAU6I,cAAeA,EAAcjgB,OAAO,SAAA4hB,GAAO,OAAAA,IAAQP,MAClE9jB,EAAK6Z,UAAU6I,cAAmBA,EAAaxpB,QAAEgB,OAAO4pB,KAH1D9jB,EAAKgjB,WAAWC,IAIlBlJ,MAAOkK,KAGb5B,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,mBAAGvV,KAAMmW,EAAa7a,KAAM6a,EAAajrB,QAG7CqqB,EAAA,cAACD,GACGpH,QAASoJ,EACT9oB,KAAM2oB,EACN3B,UAAW,WACTtiB,EAAKgjB,WAAWC,GAChBjjB,EAAK6Z,UAAU6I,cAAeA,EAAcjgB,OAAO,SAAA4hB,GAAO,OAAAA,IAAQP,OAEpEvB,SAAU,WACRviB,EAAK6Z,UAAU6I,cAAeA,EAAcjgB,OAAO,SAAA4hB,GAAO,OAAAA,IAAQP,cAOhFrB,EA5IA,CAA8BJ,EAAA,6DC9C9BkC,EAAA,WAiBA,OAZE,WACE,IAAMzmB,EAAO6B,EAAA,EAAIU,YACX6M,EAAQ5W,OAAAmW,EAAA,EAAAnW,CAAiBoW,SAASC,QAAS1H,SAAS,KACvCiI,EAAMsX,UAAU,IAAItf,MAAM,KAC1ClK,IAAI,SAAAypB,GAAW,OAAAA,EAAQnf,gBAE1BzH,KAAK6mB,wBACiB,gBAApB5mB,EAAK6mB,YAAqD,gBAArBzX,EAAM0X,WAC7C/mB,KAAKgnB,SACiB,gBAApB/mB,EAAK6mB,YAAqD,gBAArBzX,EAAM0X,WAC7C/mB,KAAKinB,kBAAoB5X,EAAM6X,aAfnC,4GCIAC,EAAA,WAKE,SAAAA,EAAmBC,GAAApnB,KAAAonB,OACjBpnB,KAAKqnB,YAAc,KACnBrnB,KAAKwf,MAAQ,KACbxf,KAAK4G,eAyDT,OAtDEugB,EAAAzuB,UAAAmN,UAAA,SAAUC,GAAV,IAAA3D,EAAAnC,KACE,OAAOA,KAAK8G,gBAAgBoJ,KAAK,WAC/BpK,EAAW3D,EAAKqd,OAChBrd,EAAKyE,YAAYpO,KAAKsN,MAI1BqhB,EAAAzuB,UAAAiO,YAAA,SAAYb,GACV9F,KAAK4G,YAAc5G,KAAK4G,YAAYhC,OAAQ,SAAAlL,GAAK,OAAAA,IAAMoM,KAGzDqhB,EAAAzuB,UAAAsL,kBAAA,eAAA7B,EAAAnC,KACEA,KAAK4G,YAAY5K,QAAQ,SAAAtC,GAAK,OAAAA,EAAEyI,EAAKqd,UAGvC2H,EAAAzuB,UAAAoO,cAAA,WAEE,OADK9G,KAAKqnB,aAAarnB,KAAK4F,oBACrB5F,KAAKqnB,aAGdF,EAAAzuB,UAAAkN,kBAAA,eAAAzD,EAAAnC,KAKE,OAJAA,KAAKqnB,YAAcrnB,KAAKonB,KAAK/X,QAAQa,KAAK,SAAAsP,GACxCrd,EAAKqd,MAAQA,EACbrd,EAAK6B,sBAEAhE,KAAKqnB,aAGRF,EAAAzuB,UAAA4L,OAAN,SAAarF,qGACX,SAAMe,KAAK8G,+BAAXhE,EAAAE,OACMwc,EAAQviB,MAAMC,QAAQ+B,GAAQA,GAAQA,GAC5Ce,KAAKwf,MAAQxf,KAAKwf,MAAMriB,IAAI,SAAAojB,GAC1B,IAAMthB,EAAOugB,EAAM/R,KAAK,SAAC3K,OAACmC,EAAAnC,EAAAmC,GAAQ,OAAAsb,EAAGtb,KAAOA,IAC5C,OAAOhG,EACLxG,OAAOgI,UAAWxB,GAClBshB,IAEJvgB,KAAKgE,8BAGPmjB,EAAAzuB,UAAA+mB,OAAA,SAAOxgB,GAAP,IAAAkD,EAAAnC,KACE,OAAOA,KAAK8G,gBAAgBoJ,KAAK,WAC/B/N,EAAKqd,MAAQrd,EAAKqd,MAAMnjB,OAAO4C,GAC/BkD,EAAK6B,uBAITmjB,EAAAzuB,UAAA0c,OAAA,SAAOnQ,GAAP,IAAA9C,EAAAnC,KACQygB,EAAMxjB,MAAMC,QAAQ+H,GAAMA,GAAMA,GACtC,OAAOjF,KAAK8G,gBAAgBoJ,KAAK,WAC/B/N,EAAKqd,MAAQrd,EAAKqd,MAAM5a,OAAO,SAAA2b,GAAM,OAACE,EAAIvX,KAAK,SAAAjE,GAAM,OAAAsb,EAAGtb,KAAOA,MAC/D9C,EAAK6B,uBAGXmjB,EAjEA,mHCEAG,EAAA,SAAArlB,GAGE,SAAAqlB,EAAYxqB,UACVmF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KA0DhB,OA9D6BqJ,EAAA,EAAAie,EAAArlB,GAO3BqlB,EAAA5uB,UAAA6uB,mBAAA,SAAmBC,GACI,OAAjBxnB,KAAKynB,SAAoBD,EAAUE,QAAQpvB,OAAS0H,KAAKlD,MAAM4qB,QAAQpvB,QAEzEuU,IAAEpU,OAAAkvB,EAAA,YAAAlvB,CAAYuH,KAAKynB,UAAUha,KAAK,UAAUma,QAAQC,SAIxDP,EAAA5uB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACEA,KAAKynB,QAAU,KACT,IAAA3kB,EAAA9C,KAAAlD,MAAC4qB,EAAA5kB,EAAA4kB,QAASI,EAAAhlB,EAAAglB,UAIhB,OAHAjb,IAAE,QAAQkb,KAAK,gBAAiBL,EAAQpvB,OAAS,GACjDuU,IAAE,QAAQmb,IAAI,WAAYN,EAAQpvB,OAAS,EAAI,SAAW,QAEnDovB,EAAQpvB,OAAS,GAAKqjB,EAAA,yBAC1B+L,EAAQvqB,IAAI,SAAC8qB,EAAQlf,GACpB,IAAI6D,EAqBJ,OAAO+O,EAAA,qBAAK1f,IAAK8M,GACnB4S,EAAA,qBAAK7O,UAAU,WACf6O,EAAA,qBAAK7O,UAAU,mBACb6O,EAAA,qBAAK7O,UAAU,aAAaob,IAAK,SAAAC,GAC/Bvb,EAAMub,EACFpf,IAAQ2e,EAAQpvB,OAAS,IAAG6J,EAAKslB,QAAUU,IAE7CC,SAAU,EAACC,gBACItf,EAAM2e,EAAQpvB,OAAS,EACtCgwB,WA7BJ,SAAoB3c,GACD,KAAbA,EAAG4c,OAAkB5c,EAAGC,QAAiD,aAAtCD,EAAGC,OAAuB4c,SAC/D3b,IAAEpU,OAAAkvB,EAAA,YAAAlvB,CAAYmU,IAAMa,KAAK,gBAAgBgb,QAE3C9c,EAAGW,mBA0BDoc,UAxBJ,SAAmB/c,GACjB,GAAiB,KAAbA,EAAG4c,MAGL,OAFAT,SACAnc,EAAGW,kBAGL,GAAiB,KAAbX,EAAG4c,QAAiB5c,EAAGgd,SAAWhd,EAAGid,SAAU,CACjD,IAAMC,EAAUpwB,OAAAkvB,EAAA,YAAAlvB,CAAYmU,GAC5BjB,EAAGY,iBACmBM,IAAEgc,GAASpb,KAAK,gBACxBgb,QACd9c,EAAGW,qBAcJ2b,EACDtM,EAAA,cAACmN,EAAA,GAAWxM,QAASwL,IACrBnM,EAAA,qBAAK7O,UAAU,sBAMzBwa,EA9DA,CAA6B3L,EAAA,yCCVvB,SAAAoN,EAA+BC,EAAmBlkB,GACtD,MAAO,GAAGkkB,EAAYlkB,EAAWpJ,OAAO,EAAE,GAAG+L,8HCCzC,SAAAwhB,EAAuB/kB,GAC3B,OAAOA,EAASiB,QAAUjB,EAASc,MAAQd,EAASiB,OAAO7M,OAAS,GAAK4L,EAASc,KAAK1M,OAAS,EAC9F,oBACA4L,EAASmhB,iBACP,iBACA,6CCkBN6D,EAAA,SAAAjnB,GACE,SAAAknB,EAAYrsB,UACVmF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KA8HhB,OAhIkC2C,EAAA,EAAAwmB,EAAAlnB,GAKhCknB,EAAAzwB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAlD,MACJgI,EAAAhC,EAAAgC,WACAskB,EAAAtmB,EAAAsmB,cAEI3jB,IAAWzF,KAAKlD,MAAM0D,YAAYsE,GAClC6hB,EAAW,IAAI0C,EAAA,EAErB,OAAO7E,EAAA,cAAC8E,EAAA,GACNpN,MAAOsI,EAAA,wBAAK1f,GAAcrM,OAAAga,EAAA,EAAAha,CAAC8wB,MAAA5mB,EAAA,8CAC3BkZ,WAAYpW,EACZqH,UAAWhI,GAAcrM,OAAA+wB,EAAA,EAAA/wB,CAAqB,aAAcqM,GAC5DyX,YAAa,SAAAkN,GAAc,OAAAtnB,EAAKrF,MAAM4sB,UAAU5kB,EAAY2kB,KAC3DL,EAAcjsB,IAAI,SAAAwsB,GACjB,OAAAnF,EAAA,qBAAKvoB,IAAK0tB,EAAGxvB,KAAM2S,UAAU,yBAC1B6c,EAAGlE,MAAQjB,EAAA,qBAAK1X,UAAU,iBAAiB6c,EAAGlE,MAC/CjB,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,uCAAuC6c,EAAGxvB,MACzDqqB,EAAA,qBAAK1X,UAAU,sBACP0X,EAAA,mBACJ1X,UAAU,QACVmC,KAAK,IACLiN,MAAM,0CACNI,QAAS,SAAA3Q,GACPA,EAAGY,iBACHpK,EAAKrF,MAAM8sB,mBAAmBD,KAGhCnF,EAAA,mBAAG1X,UAAU,mBAKnB0X,EAAA,qBAAK1X,UAAU,qBACb0X,EAAA,qBAAK1X,UAAU,iBACZ6c,EAAGrc,MAAMnQ,IAAI,SAAA+G,GACZ,IAAMgiB,EAA+B,WAAnBhiB,EAASK,OAAyC,aAAnBL,EAASK,OAA2C,aAAnBL,EAASK,MAErFslB,EAAWZ,EAAY/kB,GACvB4lB,EAAU3oB,IAAO+C,EAASshB,UAAUllB,QAAQ,OAASa,MAASb,QAAQ,OAE5E,OAAOkkB,EAAA,qBAAKvoB,IAAKiI,EAASe,GAAI4c,MAAOqE,GAAcO,QAAS,QAC1DjC,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,qBAAK1X,UAAW,YAAc5I,EAASC,KAAO,WAAa,IACzDmY,QAAS,SAAA3Q,GAAM,OAACua,GAAa/jB,EAAKrF,MAAMitB,YAAY7lB,GAAWA,EAASC,UAG5EqgB,EAAA,qBAAK1X,UAAU,sBACC,sBAAb+c,EACCrF,EAAA,mBAAGvV,KA2E3B,SAAoB/K,EAAoB8lB,GACtC,GAAI9lB,EAASiB,QAAUjB,EAASiB,OAAO7M,OAAS,GAAK4L,EAASc,MAAQd,EAASc,KAAK1M,OAAS,EAAG,CAC9F,IAAM2xB,EAAYxxB,OAAAyxB,EAAA,EAAAzxB,CAA2BuxB,GAAiBnR,SAAU3U,EAASiB,OAAO,GAAGF,KAC3F,OAAUglB,EAAS,UAAU/lB,EAASc,KAAK,GAAGC,GAEhD,OAAOf,EAASqG,IAhFe4f,CAAWjmB,EAAU/B,EAAKrF,MAAMktB,gBAAiB9lB,EAAS/J,MACtD,mBAAb0vB,EACErF,EAAA,mBAAGvV,KAAM/K,EAASqG,KAAMrG,EAAS/J,MACjCqqB,EAAA,mBACE1X,UAAW6Z,EAASE,0BAA4B3iB,EAASqG,IAAM,YAAa,GAC5E+R,QAASqK,EAASE,6BAChBhG,EACA,SAAAlV,GACEA,EAAGY,iBACHpK,EAAKrF,MAAMstB,SAASlmB,IAExB+K,KAAM/K,EAASqG,IACfqB,QAAS1H,EAASqG,IAAI,IAAI9C,cAAc4T,WAAWxM,SAASwb,KAAK5iB,eAC/D,QACA,UACFvD,EAAS/J,MACd+J,EAASshB,UAAYhB,EAAA,qBAAK1X,UAAW,WAAagd,EAAU,WAAa,KACxEtF,EAAA,mBAAGtI,MAAO/a,IAAO+C,EAASshB,UAAUvb,OAAO,cAAe6C,UAAU,iBAAgB2C,cAAa,OAE/F6M,QAAS,iBAIbqK,EAASE,wBACTrC,EAAA,qBAAK1X,UAAU,+BACb0X,EAAA,mBAAG1X,UAAU,WAAWwP,QAAS,WAAM,OAAAna,EAAKrF,MAAMstB,SAASlmB,YACpD2c,GAGZ3c,EAASoB,UAAYkf,EAAA,qBAAK1X,UAAU,YAClC5I,EAASoB,SAASnI,IAAI,SAAAmtB,GACrB,OAAA9F,EAAA,qBAAKvoB,IAAKquB,EAAQrlB,IAChBuf,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,qBACE1X,UAAW,YAAcwd,EAAQnmB,KAAO,WAAa,IACrDmY,QAAS,SAAA3Q,GACP,OAACua,GACD/jB,EAAKrF,MAAMytB,eAAermB,EAAUomB,GAAUA,EAAQnmB,UAG5DqgB,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,mBACEvV,KAAMqb,EAAQ/f,UAAOsW,EACrBjV,QAAS1H,EAASqG,IAAI,IAAI9C,cAAc4T,WAAWxM,SAASwb,KAAK5iB,eACjE,QACA,SACAqF,UACEwd,EAAQ/f,SACNsW,EACA,aACHyJ,EAAQnwB,OAEbqqB,EAAA,qBAAK1X,UAAU,+BACb0X,EAAA,mBAAG1X,UAAU,WAAWwP,QAAS,WAAM,OAAAna,EAAKrF,MAAM0tB,YAAYtmB,EAAUomB,gBASxF9F,EAAA,qBAAK1X,UAAU,qBACb0X,EAAA,qBAAK1X,UAAU,iBACbwP,QAAS,WAAM,OAAAna,EAAKrF,MAAM2tB,WAAWtoB,EAAKrF,MAAMgI,WAAY6kB,EAAGxvB,QAC/DqqB,EAAA,mBAAG1X,UAAU,aAAY2C,cAAa,aAAahX,OAAAga,EAAA,EAAAha,CAACiyB,MAAA/nB,EAAA,6CAGxD6hB,EAAA,8BAKV2E,EAhIA,CAAkC3E,EAAA,gDCdlCmG,EAAA,SAAA1oB,GACE,SAAA2oB,EAAa9tB,GAAb,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH8D,aAAcjI,EAAMiI,cAAgB,MA8B1C,OAlCmCpC,EAAA,EAAAioB,EAAA3oB,GAQjC2oB,EAAAlyB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACS+E,EAAA/E,KAAAiB,MAAA8D,aACA8lB,EAAA7qB,KAAAlD,MAAA+tB,OAEP,OAAOrG,EAAA,yBACLA,EAAA,qBAAK1X,UAAU,6CACX0X,EAAA,qDACAA,EAAA,yBACAA,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,sBAAoB,QACnC0X,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,uBAAO1W,KAAK,OAAOsa,SAAU,EAAG0C,KAAM,GAAIC,WAAS,EACjDpwB,MAAOoK,EACP+f,SAAU,SAAAzY,GAAK,OAAAlK,EAAK6Z,UAAUjX,aAAcsH,EAAET,OAAOjR,YAEzD6pB,EAAA,qBAAK1X,UAAU,+BAEjB0X,EAAA,0BACJA,EAAA,qBAAK1X,UAAU,8BACb0X,EAAA,wBACE4D,SAAU,EACVtb,UAAU,4BACVwP,QAAS,WAAI,OAAAuO,EAAO9lB,KAAa,YAI3C6lB,EAlCA,CAAmCpG,EAAA,WCyBnC,oBAAAwG,EAAA,SAAA/oB,GACE,SAAAgpB,EAAanuB,UACXmF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KAShB,OAX+B2C,EAAA,EAAAsoB,EAAAhpB,GAK7BgpB,EAAAvyB,UAAAujB,OAAA,WACE,OAAOuI,EAAA,cAAAA,EAAA,cACHA,EAAA,uBAAO1X,UAAU,UAAUoe,SApCnBC,EAoCmCnrB,KAAKlD,MAAMqf,SAnCtDiP,EAAY,IAAIC,IACf,SAACC,EAAgBH,GACtB,GAAoB,iBAATA,EAAmB,OAAO,KACrC,IAAIC,EAAUG,IAAIJ,GAAlB,CAKA,GADAC,EAAU1pB,IAAIypB,GACVA,EAAKruB,MACP,OAAIquB,EAAKruB,MAAMmI,GAAWkmB,EAAKruB,MAAMmI,GACjCkmB,EAAKruB,MAAMqf,SACNmP,EAAOH,EAAKruB,MAAMqf,eAE3B,EAEF,GAAIgP,EAAK7yB,OACP,IAAK,IAAIF,EAAE,EAAEA,EAAE+yB,EAAK7yB,SAAUF,EAAG,CAC/B,IAAMozB,EAAQL,EAAK/yB,GACnB,GAAIozB,EAAO,CACT,IAAMC,EAAUH,EAAOE,GACvB,GAAIC,EAAS,OAAOA,KAnBrB,CAwBJN,KAUqEnrB,KAAKlD,MAAMoO,OAC5ElL,KAAKlD,MAAMqf,UArCpB,IAAgBgP,EACRC,GAuCRH,EAXA,CAA+BzG,EAAA,WCvB/BkH,EAAA,SAAAzpB,GACE,SAAA0pB,EAAa7uB,UACXmF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KAmBhB,OArB+B2C,EAAA,EAAAgpB,EAAA1pB,GAK7B0pB,EAAAjzB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACE,OACEwkB,EAAA,cAACwG,GAAU9f,MAAOlL,KAAKlD,MAAMoO,OAC3BsZ,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,uBAAO1W,KAAK,OAAOid,UAAW/qB,KAAKlD,MAAMiuB,UAAW9lB,GAAIjF,KAAKlD,MAAMmI,GAAI6lB,KAAM,GAAInwB,MAAOqF,KAAKlD,MAAMnC,MACjGmqB,SAAU,SAAAnZ,GAAM,OAAAxJ,EAAKrF,MAAMgoB,SAASnZ,EAAGC,OAAOjR,QAC9CixB,YAAa5rB,KAAKlD,MAAM8uB,iBAEzB5rB,KAAKlD,MAAMqf,UAAYqI,EAAA,qBAAK1X,UAAU,kBACtC9M,KAAKlD,MAAMqf,aAMxBwP,EArBA,CAA+BnH,EAAA,WCC/BqH,EAAA,SAAA5pB,GACE,SAAA6pB,EAAahvB,UACXmF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KAmBhB,OArBuC2C,EAAA,EAAAmpB,EAAA7pB,GAKrC6pB,EAAApzB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACE,OACEwkB,EAAA,cAACwG,GAAU9f,MAAOlL,KAAKlD,MAAMoO,OAC3BsZ,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,0BAAUuG,UAAW/qB,KAAKlD,MAAMiuB,UAAW9lB,GAAIjF,KAAKlD,MAAMmI,GAAI8mB,KAAM,GAAIC,KAAMhsB,KAAKlD,MAAMkvB,MAAQ,EAAGrxB,MAAOqF,KAAKlD,MAAMnC,MACpHmqB,SAAU,SAAAnZ,GAAM,OAAAxJ,EAAKrF,MAAMgoB,SAASnZ,EAAGC,OAAOjR,QAC9CixB,YAAa5rB,KAAKlD,MAAM8uB,iBAEzB5rB,KAAKlD,MAAMqf,UAAYqI,EAAA,qBAAK1X,UAAU,kBACtC9M,KAAKlD,MAAMqf,aAMxB2P,EArBA,CAAuCtH,EAAA,WCCvCyH,EAAA,SAAAhqB,GACE,SAAAiqB,EAAYpvB,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH9G,KAAM,GACNglB,YAAa,GACb5U,IAAK,MA4CX,OAlDmC5H,EAAA,EAAAupB,EAAAjqB,GAUjCiqB,EAAAxzB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAiB,MAAE9G,EAAA2I,EAAA3I,KAAMglB,EAAArc,EAAAqc,YAAa5U,EAAAzH,EAAAyH,IACrBxH,EAAA/C,KAAAlD,MAAU+tB,GAAR9nB,EAAAopB,OAAQppB,EAAA8nB,QAEhB,OAAOrG,EAAA,yBACLA,EAAA,qBAAK1X,UAAU,6CACb0X,EAAA,oDACAA,EAAA,yBACAA,EAAA,cAACkH,GACCxgB,MAAM,OACNjG,GAAG,qBACH2mB,YAAY,eACZjxB,MAAOR,EACP4wB,WAAS,EACTjG,SAAU,SAAA3qB,GAAQ,OAAAgI,EAAK6Z,UAAU7hB,KAAIA,OAEvCqqB,EAAA,cAACqH,GACCG,KAAM,EACN9gB,MAAM,cACNjG,GAAG,4BACH2mB,YAAY,8BACZjxB,MAAOwkB,EACP2F,SAAU,SAAA3F,GAAa,OAAAhd,EAAK6Z,UAAUmD,YAAWA,OAEnDqF,EAAA,cAACkH,GACCxgB,MAAM,OACNjG,GAAG,oBACH2mB,YAAY,gBACZjxB,MAAO4P,EACPua,SAAU,SAAA3qB,GAAQ,OAAAgI,EAAK6Z,UAAUzR,IAAGA,QAGxCia,EAAA,qBAAK1X,UAAU,8BACb0X,EAAA,wBACE4D,SAAU,EACVtb,UAAU,4BACVwP,QAAS,WAAM,OAAAuO,EAAO1wB,EAAMglB,EAAa5U,KAAI,YAIvD2hB,EAlDA,CAAmC1H,EAAA,mBCUnC4H,SAAA,SAAAnqB,GACE,SAAAoqB,EAAavvB,GAAb,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KACZ,GAAmB,SAAflD,EAAMuX,KAAiB,CAClB,IAAAiW,EAAAxtB,EAAAwtB,QACPnoB,EAAKlB,OACH9G,KAAMmwB,EAAQnwB,MAAQ,GACtBglB,YAAamL,EAAQnL,aAAe,GACpC5U,IAAK+f,EAAQ/f,KAAO,SAGtBpI,EAAKlB,OACH9G,KAAM,GACNglB,YAAa,GACb5U,IAAK,aAyGb,OAvHsC5H,EAAA,EAAA0pB,EAAApqB,GAmBpCoqB,EAAA3zB,UAAA0I,KAAA,WAES,IAAAtE,EAAAkD,KAAAlD,MACAoH,EAAApH,EAAAoH,SAAUooB,EAAAxvB,EAAAwvB,YACXxpB,EAAA9C,KAAAiB,MAAC9G,EAAA2I,EAAA3I,KAAMglB,EAAArc,EAAAqc,YAAa5U,EAAAzH,EAAAyH,IAC1B,GAAmB,SAAfzN,EAAMuX,KAER4Q,EAAA,EAAc3gB,QAAQJ,GAAW,SAAA+B,GACxB,IAAAX,EAAAW,EAAAX,SACHA,IACFW,EAAGX,SAAWA,EAASnI,IAAI,SAAAoI,GACzB,OAAAA,EAAGN,KAAOnI,EAAMwtB,QAAQrlB,GAAItC,EAAA,KAAK4C,GAAIpL,KAAIA,EAAEglB,YAAWA,EAAE5U,IAAGA,IAAG5H,EAAA,KAC1D4C,YAIL,CAEL,IAAMgnB,GACJtnB,GAAIxM,OAAA2L,EAAA,EAAA3L,GACJ0B,KAAIA,EACJglB,YAAWA,EACX5U,IAAGA,GAIL0a,EAAA,EAAc3gB,QAAQJ,GAAW,SAAA+B,GAC1BA,EAAGX,WACNW,EAAGX,aAELW,EAAGX,SAAWW,EAAGX,SAASjJ,OAAOkwB,KAKrCD,KAGFD,EAAA3zB,UAAA0c,OAAA,WAEE,IAAMtY,EAAQkD,KAAKlD,MACnB,GAAmB,SAAfA,EAAMuX,KACR,MAAM,IAAIvI,MAAM,gCAElBmZ,EAAA,EAAc3gB,QAAQxH,EAAMoH,UAAW,SAAA+B,GACjCA,EAAGX,WACLW,EAAGX,SAAWW,EAAGX,SAASV,OAAO,SAAAC,GAAK,OAAAA,EAAEI,KAAOnI,EAAMwtB,QAAQrlB,QAKjEnI,EAAMwvB,eAGRD,EAAA3zB,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAiB,MACCnE,GADAgG,EAAA3I,KAAM2I,EAAAqc,YAAarc,EAAAyH,IACnBvK,KAAAlD,OACD0vB,EAA4B,SAAf1vB,EAAMuX,KAEzB,OAAOmQ,EAAA,cAAAA,EAAA,cACLA,EAAA,qBAAK1X,UAAU,6CACb0X,EAAA,wBAAKgI,EAAa,wBAA0B,0BAC5ChI,EAAA,yBACAA,EAAA,cAACkH,GACCX,WAAS,EACT7f,MAAM,uBACNjG,GAAG,sBACH2mB,YAAY,GACZjxB,MAAOqF,KAAKiB,MAAM9G,KAClB2qB,SAAU,SAAA3qB,GAAQ,OAAAgI,EAAK6Z,UAAU7hB,KAAIA,OAEvCqqB,EAAA,cAACqH,GACC3gB,MAAM,cACNjG,GAAG,6BACH+mB,KAAM,EACNJ,YAAY,GACZjxB,MAAOqF,KAAKiB,MAAMke,YAClB2F,SAAU,SAAA3F,GAAe,OAAAhd,EAAK6Z,UAAUmD,YAAWA,OAErDqF,EAAA,cAACkH,GACCxgB,MAAM,OACNjG,GAAG,qBACH2mB,YAAY,GACZjxB,MAAOqF,KAAKiB,MAAMsJ,IAClBua,SAAU,SAAAva,GAAO,OAAApI,EAAK6Z,UAAUzR,IAAGA,OAErCia,EAAA,0BAEFA,EAAA,qBAAK1X,UAAU,8BAEI,SAAfhQ,EAAMuX,MAAmBmQ,EAAA,wBAAQ1X,UAAU,uCAC3CwP,QAAS,SAAA3Q,GAAM,OAAAxJ,EAAKiT,WACnB,wBACHoP,EAAA,wBACE4D,SAAU,EACVtb,UAAU,4BACVwP,QAAS,WAAI,OAAAna,EAAKf,SAAM,YAIlCirB,EAvHA,CAAsC7H,EAAA,YCStCiI,EAAA,SAAAxqB,GAGE,SAAAyqB,EAAY5vB,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACHiD,SAAUpH,EAAMoH,SAChB/J,KAAM2C,EAAMoH,SAAS/J,KACrBglB,YAAariB,EAAMoH,SAASib,YAC5B5U,IAAKzN,EAAMoH,SAASqG,IACpBib,SAAU1oB,EAAMoH,SAASshB,SACzBlgB,SAAUxI,EAAMoH,SAASoB,UAE3BnD,EAAKwqB,mBAAqBxqB,EAAKwqB,mBAAmBvxB,KAAK+G,KA0M3D,OAvNkCQ,EAAA,EAAA+pB,EAAAzqB,GAgBhCyqB,EAAAh0B,UAAAssB,kBAAA,WACEC,EAAA,EAAcpf,UAAU7F,KAAK2sB,qBAG/BD,EAAAh0B,UAAAi0B,mBAAA,SAAmB3mB,GAAnB,IAAA7D,EAAAnC,KACQ4sB,EAAa5mB,EAAUyH,KAAK,SAAAxH,GAAM,OAAAA,EAAGhB,KAAO9C,EAAKrF,MAAMoH,SAASe,KACjE2nB,EAIL5sB,KAAKgc,UACH9X,SAAU0oB,EACVtnB,SAAUsnB,EAAWtnB,WALrBtF,KAAKlD,MAAMwvB,eASfI,EAAAh0B,UAAAwsB,qBAAA,WACED,EAAA,EAActe,YAAY3G,KAAK2sB,qBAGjCD,EAAAh0B,UAAAm0B,WAAA,WAOQ,IAAA/pB,EAAA9C,KAAAiB,MAACukB,EAAA1iB,EAAA0iB,SAAUrG,EAAArc,EAAAqc,YAAahlB,EAAA2I,EAAA3I,KAAMoQ,EAAAzH,EAAAyH,IAAKrG,EAAApB,EAAAoB,SACzC,OACEshB,IAAathB,EAASshB,UACtBrG,IAAgBjb,EAASib,aACzBhlB,IAAS+J,EAAS/J,MAClBoQ,IAAQrG,EAASqG,KAGrBmiB,EAAAh0B,UAAAo0B,WAAA,WACE9sB,KAAKlD,MAAMiwB,WAAWvI,EAAA,cAAC4H,GACrB/X,KAAK,MACLnQ,SAAUlE,KAAKiB,MAAMiD,SACrBooB,YAAatsB,KAAKlD,MAAMwvB,gBAI5BI,EAAAh0B,UAAA8xB,YAAA,SAAYF,GACVtqB,KAAKlD,MAAMiwB,WAAWvI,EAAA,cAAC4H,GACrB/X,KAAK,OACLiW,QAASA,EACTpmB,SAAUlE,KAAKiB,MAAMiD,SACrBooB,YAAatsB,KAAKlD,MAAMwvB,gBAI5BI,EAAAh0B,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAiB,MAAE9G,EAAA2I,EAAA3I,KAAMglB,EAAArc,EAAAqc,YAAa5U,EAAAzH,EAAAyH,IAAKib,EAAA1iB,EAAA0iB,SAAUlgB,EAAAxC,EAAAwC,SAAU0nB,EAAAlqB,EAAAkqB,aAAc9oB,EAAApB,EAAAoB,SAC1De,EAAAf,EAAAe,GACFlC,GADMmB,EAAAY,WACN9E,KAAAlD,OAAEmwB,EAAAlqB,EAAAkqB,SAAUC,EAAAnqB,EAAAmqB,SACZL,EAAa7sB,KAAK6sB,aAGlBM,EAA4B,eADjBlE,EAAY/kB,GAEvB4lB,EAAU3oB,IAAO+C,EAASshB,UAAYrkB,MAE5C,OAAOqjB,EAAA,qBAAK1X,UAAU,4DACpB0X,EAAA,wBAAK2I,EAAe,qBAAuB,oBAC3C3I,EAAA,yBACAA,EAAA,cAACkH,GACCX,WAAS,EACT7f,MAAOiiB,EAAe,oBAAsB,kBAC5CloB,GAAG,oBACH2mB,YAAauB,EAAe,mBAAqB,0BACjDxyB,MAAOR,EACP2qB,SAAU,SAAA3qB,GAAQ,OAAAgI,EAAK6Z,UAAU7hB,KAAIA,OAEtCgzB,GAAgB3I,EAAA,cAAAA,EAAA,cACfA,EAAA,cAACqH,GACCG,KAAM,EACN9gB,MAAM,cACNjG,GAAG,2BACH2mB,YAAY,8BACZjxB,MAAOwkB,EACP2F,SAAU,SAAA3F,GAAa,OAAAhd,EAAK6Z,UAAUmD,YAAWA,OAEnDqF,EAAA,cAACkH,GACCxgB,MAAM,OACNjG,GAAG,mBACH2mB,YAAY,gBACZjxB,MAAO4P,EACPua,SAAU,SAAAva,GAAO,OAAApI,EAAK6Z,UAAUzR,IAAGA,QAIrCia,EAAA,cAACwG,GAAU9f,MAAM,iBACbsa,GAAYwH,EACZxI,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,cAAC4I,EAAA,GAAgBlF,IAAK,SAAAC,GAAQ,OAAAhmB,EAAKkrB,WAAalF,GAC9CljB,GAAG,wBACHkhB,SAAUX,GAAYrkB,IAAOqkB,GAC7BuF,UAAWiC,EACXM,WAAW,aACXxgB,UAAWgd,EAAU,eAAYjJ,EACjCpE,OAAQ,KACR8Q,gBAAiBJ,EAAe,YAAc,eAC9CK,OAAQ,WAAI,OAAArrB,EAAK6Z,UAAUgR,cAAc,KACzClI,SAAU,SAAAnqB,GACRwH,EAAK6Z,UACHwJ,SAAU7qB,GAASA,EAAMsP,OAAO,cAChC+iB,cAAc,QAKtBxI,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,mBAAG1X,UAAU,aAAamC,KAAK,IAAIiN,MAAM,mBAAmBI,QAAS,SAAA3Q,GACnEA,EAAGY,iBACHpK,EAAK6Z,UAAUwJ,SAAU,KAAMwH,cAAc,SAInDxI,EAAA,qBAAK1X,UAAU,MAAMob,IAAK,WAAK/lB,EAAKkrB,WAAa,OAC7C7I,EAAA,mBAAG1X,UAAU,MAAMwP,QAAS,SAAA3Q,GACtBxJ,EAAKkrB,YACPlrB,EAAKkrB,WAAWI,SAAQ,GAE1BtrB,EAAK6Z,UACHgR,cAAc,MAGlBxI,EAAA,mBAAG1X,UAAU,iBAAgB2C,cAAa,gCAIpD+U,EAAA,cAACwG,GAAU9f,MAAM,kBACfsZ,EAAA,qBAAK1X,UAAU,qBACb0X,EAAA,qBAAK1X,UAAU,iBAEVxH,GAAYA,EAASnI,IAAI,SAAAmtB,GAAW,OAAA9F,EAAA,qBAAKvoB,IAAKquB,EAAQrlB,GAAI6H,UAAU,oBACnE0X,EAAA,qBAAK1X,UAAU,sBAAqB0X,EAAA,mBAClClI,QAAS,WAAI,OAAAna,EAAKqoB,YAAYF,IAC9Brb,KAAK,KAAKqb,EAAQnwB,YAI5BqqB,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,OACb0X,EAAA,wBAAQvf,GAAG,0BAA0B6H,UAAU,MAC7CwP,QAAS,WAAI,OAAAna,EAAK2qB,eAClBtI,EAAA,mBAAG1X,UAAU,aAAY2C,cAAa,uCAK9C+U,EAAA,qBAAK1X,UAAU,kBACf0X,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,wBACb0X,EAAA,wBAAQ4D,SAAU,EAChBtb,UAAU,kBACVwP,QAAS,WACPuQ,EAAaI,EAAS,SAAA/oB,GACpBA,EAAS/J,KAAOA,EAChB+J,EAASib,YAAcA,EACvBjb,EAASqG,IAAMA,EACfrG,EAASshB,SAAWA,IACjBrjB,EAAKrF,MAAMwvB,gBACjB,YAEL9H,EAAA,qBAAK1X,UAAU,wBACb0X,EAAA,wBAAQ4D,SAAU,EAChBtb,UAAU,MACVwP,QAAS,WACPna,EAAKrF,MAAMwvB,gBACZ,aAEL9H,EAAA,qBAAK1X,UAAU,0BACb0X,EAAA,wBACE4D,SAAU,EACVtb,UAAU,kBACVwP,QAAS,WACP4Q,EAASjoB,KACPkoB,EACF,qBACA,kCAkBdT,EAvNA,CAAkClI,EAAA,mBCjClCkJ,EAAA,WAOE,SAAAC,EAAYC,GANJ5tB,KAAA6tB,UAAY,KACZ7tB,KAAA8tB,WAAY,EACZ9tB,KAAA+tB,SAAU,EACV/tB,KAAAguB,gBAAiB,EAIvBhuB,KAAKiuB,YAAcL,EAiCvB,OA9BED,EAAAj1B,UAAAw1B,cAAA,SAAcC,GAAd,IAAAhsB,EAAAnC,KACMA,KAAK8tB,YACT9tB,KAAK+tB,SAAU,EACQ,OAAnB/tB,KAAK6tB,WACPO,aAAapuB,KAAK6tB,WACpB7tB,KAAK6tB,UAAYQ,WAAW,WAAI,OAAAlsB,EAAKmsB,aAAaH,KAGpDR,EAAAj1B,UAAA61B,KAAA,WACyB,OAAnBvuB,KAAK6tB,WACPO,aAAapuB,KAAK6tB,WACpB7tB,KAAK6tB,UAAY,KACjB7tB,KAAK8tB,WAAY,GAGLH,EAAAj1B,UAAA41B,UAAd,uGACE,GAAItuB,KAAK8tB,UAAW,OAAM,GAC1B,IAAK9tB,KAAK+tB,QAAS,OAAM,GACzB,GAAI/tB,KAAKguB,eAAgB,OAAM,GAC/BhuB,KAAK6tB,UAAY,sBAIf,6BAFA7tB,KAAKguB,gBAAiB,EACtBhuB,KAAK+tB,SAAU,GACf,EAAM/tB,KAAKiuB,6BAAXnrB,EAAAE,2BAEAhD,KAAKguB,gBAAiB,oBAEpBhuB,KAAK+tB,SACP,EAAM/tB,KAAKsuB,cADT,YACFxrB,EAAAE,wCAEN2qB,EAzCA,WCsCAa,EAAA,SAAAvsB,GAGE,SAAAwsB,EAAY3xB,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH+E,aACA5F,SAAUnC,KAAKkC,MACfK,eACAknB,WACAgH,QAAQ,EACRC,YAAa,KACbC,WAAW,GAEbzsB,EAAK2iB,SAAW3iB,EAAK2iB,SAAS1pB,KAAK+G,GACnCA,EAAK0sB,mBAAqB,IAAInB,EAAW,WAAI,OAAAvrB,EAAK2sB,oBAoVtD,OAnWiCnsB,EAAA,EAAA8rB,EAAAxsB,GAkB/BwsB,EAAA/1B,UAAAssB,kBAAA,WACEC,EAAA,EAAcpf,UAAU7F,KAAK8kB,WAG/B2J,EAAA/1B,UAAAwsB,qBAAA,WACED,EAAA,EAActe,YAAY3G,KAAK8kB,UAC/B9kB,KAAK6uB,mBAAmBN,QAG1BE,EAAA/1B,UAAAosB,SAAA,SAAS9e,EAAuB+e,EAAsC4J,GACpE,IAAMI,GACJ/oB,UAASA,EACT5F,SAAU2kB,EAAU3kB,SACpBI,YAAaukB,EAAUvkB,YACvBmuB,YAAWA,EACXC,WAAW,GAER5uB,KAAKiB,MAAM0tB,aAAgBA,EAAYvoB,WAAapG,KAAKiB,MAAM0tB,YAAYvoB,WAE9E2oB,EAASzoB,SAAWqoB,EAAYzoB,UAAUI,SAC1CyoB,EAAS1oB,WAAasoB,EAAYzoB,UAAUG,YAE9CrG,KAAKgc,SAAS+S,IAGhBN,EAAA/1B,UAAAs2B,kBAAA,WACQ,IAAAlsB,EAAA9C,KAAAiB,MAAEqF,EAAAxD,EAAAwD,SAAUD,EAAAvD,EAAAuD,WAAYsoB,EAAA7rB,EAAA6rB,YAC9B,QAASA,IAAgBroB,IAAaqoB,EAAYzoB,UAAUI,UAAYD,IAAesoB,EAAYzoB,UAAUG,aAGjGooB,EAAA/1B,UAAAo2B,cAAd,0HACEnwB,QAAQuU,IAAI,mBACNpQ,EAAwC9C,KAAKiB,MAA3CqF,EAAQxD,EAAAwD,SAAED,EAAUvD,EAAAuD,WAAEsoB,EAAW7rB,EAAA6rB,YACrC3uB,KAAKgvB,qBACP,EAAM/J,EAAA,EAAc/E,OAAOyO,EAAa,SAAA1oB,GACtCA,EAAGC,WAAcI,SAAQA,EAAED,WAAUA,OAFrC,YACFtD,EAAAC,wCAMJyrB,EAAA/1B,UAAAu2B,SAAA,WAEEhK,EAAA,EAAcvf,WAAWvE,IAAOnB,KAAKiB,MAAMb,UAAUsB,KAAK,EAAG,QAAQgb,WAGvE+R,EAAA/1B,UAAAwqB,SAAA,WAEE+B,EAAA,EAAcvf,WAAWvE,IAAOnB,KAAKiB,MAAMb,UAAUsB,IAAI,EAAG,QAAQgb,WAGtE+R,EAAA/1B,UAAAq0B,WAAA,SAAW9E,GACTjoB,KAAKgc,UAAW0L,QAAa1nB,KAAKiB,MAAMymB,QAAOrrB,QAAE4rB,OAGnDwG,EAAA/1B,UAAAw2B,kBAAA,eAAA/sB,EAAAnC,KACEA,KAAK+sB,WAAWvI,EAAA,cAACmG,GACfE,OAAQ,SAAO9lB,GAAoB,OAAApC,EAAA,EAAAR,OAAA,uEACjC,IAAK4C,EAAc,MAAM,IAAI+G,MAAOrT,OAAAga,EAAA,EAAAha,CAAC02B,MAAAxsB,EAAA,iFAChC3C,KAAKiB,MAAMytB,OAAZ,YACF1uB,KAAKgc,UAAW0S,QAAQ,qBAEtB,gCAAM1uB,KAAKovB,cAAcrqB,kBAAzBjC,EAAAE,2BAEAhD,KAAKgc,UAAW0S,QAAQ,eAE1B1uB,KAAKssB,mDAKbmC,EAAA/1B,UAAA22B,qBAAA,SAAqBvqB,EAAoBwqB,GAAzC,IAAAntB,EAAAnC,KACEA,KAAK+sB,WAAWvI,EAAA,cAACyH,GACfE,QAASrnB,EACT+lB,OAAQ,SAAO1wB,EAAcglB,EAAqB5U,GAAW,OAAA5H,EAAA,EAAAR,OAAA,uEAC3D,IAAKhI,EAAM,MAAM,IAAI2R,MAAOrT,OAAAga,EAAA,EAAAha,CAAC82B,MAAA5sB,EAAA,qEACxB3C,KAAKiB,MAAMytB,OAAZ,YACF1uB,KAAKgc,UAAW0S,QAAQ,qBAEtB,gCAAM1uB,KAAKwvB,cAAc1qB,EAAYwqB,EAAkBn1B,EAAMglB,EAAa5U,kBAA1EzH,EAAAE,2BAEAhD,KAAKgc,UAAW0S,QAAQ,eAE1B1uB,KAAKssB,mDAKbmC,EAAA/1B,UAAA0xB,SAAA,SAASlmB,GAAT,IAAA/B,EAAAnC,KACEA,KAAK+sB,WAAWvI,EAAA,cAACiI,GACfvoB,SAAUA,EACV+oB,SAAU,SAAO9M,GAA+B,OAAAxd,EAAA,EAAAR,OAAA,6EAG9C,GAFM6S,EAAIrS,EAAA,KAAOuB,GACjBic,EAAQnL,IACHA,EAAK7a,KAAM,MAAM,IAAI2R,MAAOrT,OAAAga,EAAA,EAAAha,CAACg3B,MAAA9sB,EAAA,kEAElC,OADA3C,KAAKssB,eACL,EAAMrH,EAAA,EAAc3gB,QAAQJ,GAAWic,kBAAvCrd,EAAAE,iBAEFkqB,SAAU,SAAMjoB,GAAE,OAAAtC,EAAA,EAAAR,OAAA,uEAEhB,OADAnC,KAAKssB,eACL,EAAMrH,EAAA,EAAc7P,QAAQnQ,mBAA5BnC,EAAAE,iBAEF+pB,WAAY,SAAA9E,GAAQ,OAAA9lB,EAAK4qB,WAAW9E,IACpCqE,YAAa,WAAI,OAAAnqB,EAAKmqB,mBAI1BmC,EAAA/1B,UAAA8xB,YAAA,SAAYtmB,EAAoBomB,GAAhC,IAAAnoB,EAAAnC,KACEA,KAAK+sB,WAAWvI,EAAA,cAAC4H,GACf/X,KAAK,OACLnQ,SAAUA,EACVomB,QAASA,EACTgC,YAAa,WAAI,OAAAnqB,EAAKmqB,mBAI1BmC,EAAA/1B,UAAA4zB,YAAA,WACEtsB,KAAKgc,UAAW0L,QAAS1nB,KAAKiB,MAAMymB,QAAQrsB,MAAM,EAAG2E,KAAKiB,MAAMymB,QAAQpvB,OAAS,MAK7Em2B,EAAA/1B,UAAA02B,cAAN,SAAoBrqB,qGAKlB,OAJIugB,EAAkB1V,KAAK2V,IAAItsB,MAC7B2W,KAAK2V,KACJvlB,KAAKiB,MAAMb,UAAU/D,OAAO2D,KAAKiB,MAAM+E,UAAU7I,IAAI,SAAA0H,GAAK,OAAAA,EAAEuB,cAE/D,EAAM6e,EAAA,EAAcxF,SAClBxa,GAAIxM,OAAA2L,EAAA,EAAA3L,GACJsM,aAAYA,EACZqB,SAAUkf,EAAkB,eAG9B,OANAxiB,EAAAE,QAMA,EAAMiiB,EAAA,EAAczf,sBAAsB,IAAI,kBAA9C1C,EAAAE,iBAGIyrB,EAAA/1B,UAAAkxB,mBAAN,SAAyB7kB,+FACvB,OAAIA,EAAauI,MAAMhV,OAAS,IACzBo3B,QAAQ,2BAA2B3qB,EAAauI,MAAMhV,OAAM,gBACzD,IAGV,EAAM2sB,EAAA,EAAc7P,OAAOrQ,EAAa4qB,SAASxyB,IAAI,SAAA0H,GAAK,OAAAA,EAAEI,qBAA5DnC,EAAAE,iBAGIyrB,EAAA/1B,UAAA82B,cAAN,SAAoB1qB,EAAoBC,EAAsB5K,EAAcglB,EAAqB5U,qGAmB7F,OAlBE+a,EAAkB1V,KAAK2V,IAAItsB,MAC7B2W,KAAK2V,KACJvlB,KAAKiB,MAAMb,UAAU/D,OAAO2D,KAAKiB,MAAM+E,UAAU7I,IAAI,SAAA0H,GAAK,OAAAA,EAAEuB,cAgB7D,EAAM6e,EAAA,EAAcxF,SAClBxa,GAAIxM,OAAA2L,EAAA,EAAA3L,GACJ2N,SAAUkf,EAAkB,IAC5BxgB,WAAUA,EACVC,aAAYA,EACZ5K,KAAIA,EACJglB,YAAWA,EACX5U,IAAGA,oBAPLzH,EAAAE,iBAYJyrB,EAAA/1B,UAAAgxB,UAAA,SAAU5kB,EAAoBW,GAC5Bwf,EAAA,EAAczf,sBAAsBV,EAAYW,IAG5CgpB,EAAA/1B,UAAAqxB,YAAN,SAAkB/kB,EAAgBb,+FAChC,SAAM8gB,EAAA,EAAchhB,iBAAiBe,EAAMb,kBAA3CrB,EAAAE,iBAGIyrB,EAAA/1B,UAAA6xB,eAAN,SAAqBvlB,EAAgBslB,EAAsBnmB,+FACzD,SAAM8gB,EAAA,EAAc7f,oBAAoBJ,EAAMslB,EAAQrlB,GAAId,kBAA1DrB,EAAAE,iBAGIyrB,EAAA/1B,UAAAk3B,qBAAN,2HAKkB,OAJV9sB,EAAuC9C,KAAKiB,MAA1C+E,EAASlD,EAAAkD,UAAalD,EAAAtC,YAAEJ,EAAQ0C,EAAA1C,SAClCyvB,EAAap3B,OAAA4K,EAAA,EAAA5K,CAAiB0I,IAAOf,GAAUsB,KAAK,EAAG,SACvDouB,EAAcr3B,OAAA4K,EAAA,EAAA5K,CAAQ0I,IAAOf,GAAUkD,OAAQusB,IAErC,EAAM/tB,EAAA,EAAIO,iBAAiBmC,KAAe,aACxDrB,KAAM2sB,EAAYvsB,UAClBC,GAAIssB,EAAYrsB,SAChBC,KAAM,OACNC,SAAU,OAAQ,SAAU,OAC5BC,OAAQ,4BAwBV,OAtBAmsB,GAPIA,EAAYhtB,EAAAC,QAQb4B,OAAO,SAAAorB,GAAY,OAACA,EAAS7rB,OAC7BS,OAAO,SAAAorB,GAAY,QAAEA,EAAS71B,OAC9ByK,OAAO,SAAAorB,GAAY,OAAChqB,EAAUkD,KAAK,SAAA+mB,GAClC,OAAAA,EAAkB91B,OAAS61B,EAAS71B,MACpC81B,EAAkBlrB,eAAiBirB,EAASjrB,cAC5CkrB,EAAkBnrB,aAAekrB,EAASlrB,eAG1CwgB,EAAkB1V,KAAK2V,IAAItsB,MAAM2W,KAAK2V,KAAMnlB,GAAU/D,OAAO2J,EAAU7I,IAAI,SAAA0H,GAAK,OAAAA,EAAEuB,aAEhF8pB,EAASH,EAAUxY,KAAK9e,OAAAga,EAAA,EAAAha,CAAY,aAAa0E,IAAI,SAAA6H,GACzD,IAAMmrB,EAAIxtB,EAAA,KAAkBqC,GAAMoB,SAAUkf,GAAmB,MAM/D,OALA6K,EAAKlrB,GAAKxM,OAAA2L,EAAA,EAAA3L,GACN03B,EAAK7qB,WACP6qB,EAAK7qB,SAAW6qB,EAAK7qB,SAASV,OAAO,SAAAW,GAAM,OAACA,EAAGpB,eAE1CgsB,EAAKnlB,MACLmlB,KAIT,EAAMlL,EAAA,EAAcxF,OAAOyQ,kBAA3BntB,EAAAC,iBAGFyrB,EAAA/1B,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQiD,EAAa9B,IAAOnB,KAAKiB,MAAMb,UAAU8C,OAEzC0iB,EAAczkB,MAAS+B,OACvBktB,ECjRJ,SAAiB9iB,GAIrB,IAHA,IAAMnU,KAEAk3B,EAAiB53B,OAAAga,EAAA,EAAAha,CAAc6U,EAAO,SAAAzI,GAAK,OAAAA,EAAEC,YAAc,KACxCnH,EAAA,EAAAmF,EAAArK,OAAOsD,KAAKs0B,GAAgB9Y,OAAO3S,OAAO,SAAAkP,GAAK,OAAAA,IAAGzX,OAAOg0B,EAAe,KAC9F,QADsB1yB,EAAAmF,EAAAxK,OAAAqF,IACb,CAIV,IALG,IAAMmH,EAAUhC,EAAAnF,GAEbyP,EAAcijB,EAAevrB,IAAeurB,EAAe,IAC3DC,EAAuB73B,OAAAga,EAAA,EAAAha,CAAc2U,EAAa,SAAAvI,GAAK,OAAAA,EAAEE,eACzDwrB,KACqBxtB,EAAA,EAAAqQ,EAAA3a,OAAOsD,KAAKu0B,GAAZvtB,EAAAqQ,EAAA9a,OAAAyK,IAAiC,CAAvD,IAAMgC,EAAYqO,EAAArQ,GACfytB,EAAUF,EAAqBvrB,GAAcwS,KAAK9e,OAAAga,EAAA,EAAAha,CAAY,aAC9Dg4B,EAAmBD,EACtB5rB,OAAO,SAAAC,GAAK,OAAU,MAAVA,EAAE1K,OACd,GACGoQ,EAAMkmB,GAAoBA,EAAiBlmB,IACjDgmB,EAAoB/3B,MAClB2B,KAAM4K,EACN4qB,SAAUa,EACVjmB,IAAGA,EACHkb,KAAM+K,EAAQrzB,IAAI,SAAA0H,GAAK,OAAAA,EAAE4gB,OAAM7gB,OAAO,SAAA6gB,GAAQ,OAAAA,IAAM,GACpDnY,MAAOkjB,EAAQ5rB,OAAO,SAAAC,GAAK,OAAAA,EAAE1K,SAGjChB,EAAOX,MACLsM,WAAUA,EACVskB,cAAemH,IAGnB,OAAOp3B,EDqPYu3B,CAAO1wB,KAAKiB,MAAM+E,WAC7BlD,EAAA9C,KAAAiB,MAAEymB,EAAA5kB,EAAA4kB,QAASiH,EAAA7rB,EAAA6rB,YAAaroB,EAAAxD,EAAAwD,SAAUD,EAAAvD,EAAAuD,WAAYuoB,EAAA9rB,EAAA8rB,UAC9C+B,EAAWhC,IAAsC,WAAtBA,EAAYpqB,OAA4C,aAAtBoqB,EAAYpqB,OACzEqsB,IAAqBjC,GAAgBroB,IAAaqoB,EAAYzoB,UAAUI,SACxEuqB,IAAuBlC,GAAgBtoB,IAAesoB,EAAYzoB,UAAUG,WAC5EyqB,GAAoBH,IAAaC,GAAoBC,GAC3D,OAAOrM,EAAA,yBACLA,EAAA,qBAAK1X,UAAW,yBAAwB7J,IAAe2iB,EAAc,eAAiB,IACpF8C,UAAW,SAAA/c,GACQ,KAAbA,EAAG4c,OAAgB5c,EAAGgd,UACxBhd,EAAGY,kBACEokB,GAAYxuB,EAAK6sB,qBACpB7sB,EAAK0sB,mBAAmBX,cAAc,MAI5C1J,EAAA,qBAAK1X,UAAW,cACd0X,EAAA,qBAAK1X,UAAU,kBACb0X,EAAA,uBAAI/rB,OAAAga,EAAA,EAAAha,CAACs4B,MAAApuB,EAAA,0BAAmB,MAAVM,KAEhBuhB,EAAA,qBAAK1X,UAAU,kBACb0X,EAAA,qBAAK1X,UAAU,aACb0X,EAAA,wBAAQ1X,UAAU,MAAMwP,QAAS,WAAM,OAAAna,EAAK8sB,aAC1CzK,EAAA,mBAAG1X,UAAU,mBAAkB2C,cAAa,UAE9C+U,EAAA,wBAAQ1X,UAAU,MAAMwP,QAAS,WAAM,OAAAna,EAAK+gB,aAC1CsB,EAAA,mBAAG1X,UAAU,oBAAmB2C,cAAa,aAMrD+U,EAAA,wBAAK/rB,OAAAga,EAAA,EAAAha,CAACu4B,MAAAruB,EAAA,8BACLytB,EAAS93B,OAAS,GAAKksB,EAAA,yBAEvB4L,EAASjzB,IAAI,SAAAL,GACZ,OAAA0nB,EAAA,cAAC0E,EAAYvmB,EAAA,GACX1G,IAAKa,EAAMgI,YACPhI,GACJgI,WAAYhI,EAAMgI,WAClBskB,cAAetsB,EAAMssB,cACrBY,cAAe7nB,EAAKrF,MAAMktB,cAC1BxpB,YAAa2B,EAAKlB,MAAMT,YACxBiqB,WAAY,SAAC3lB,EAAoBwqB,GAA6B,OAAAntB,EAAKktB,qBAAqBvqB,EAAYwqB,IACpG5F,UAAWvnB,EAAKunB,UAAUtuB,KAAK+G,GAC/B4nB,YAAa5nB,EAAK4nB,YAAY3uB,KAAK+G,GACnCooB,eAAgBpoB,EAAKooB,eAAenvB,KAAK+G,GACzCioB,SAAU,SAAAplB,GAAQ,OAAA7C,EAAKioB,SAASplB,IAChCwlB,YAAa,SAACxlB,EAAMslB,GAAY,OAAAnoB,EAAKqoB,YAAYxlB,EAAMslB,IACvDV,mBAAoB,SAAAD,GAAM,OAAAxnB,EAAKynB,mBAAmBD,SAEtDnF,EAAA,yBAECoK,EAAYpK,EAAA,cAACyM,EAAA,EAAO,MAAMzM,EAAA,yBACzBA,EAAA,qBAAK1X,UAAU,MAAMwP,QAAS,SAAA3Q,GAAM,OAAAxJ,EAAK+sB,sBACvC1K,EAAA,mBAAG1X,UAAU,iBAAgB2C,cAAa,aAAahX,OAAAga,EAAA,EAAAha,CAACy4B,MAAAvuB,EAAA,8CAG1D6hB,EAAA,qBAAK1X,UAAU,MAAMwP,QAAS,SAAA3Q,GAAM,OAAAxJ,EAAKytB,yBACvCpL,EAAA,mBAAG1X,UAAU,cAAa2C,cAAa,aAAahX,OAAAga,EAAA,EAAAha,CAAC04B,MAAAxuB,EAAA,4FAEvD6hB,EAAA,cAAC8E,EAAA,GACCpN,MAAOsI,EAAA,wBAAK/rB,OAAAga,EAAA,EAAAha,CAAC24B,MAAAzuB,EAAA,4DACbkZ,WAAY7b,KAAKiB,MAAMT,YAAsB,SAC7C+b,YAAa,SAAAkN,GAAc,OAAAtnB,EAAKunB,UAAU,WAAYD,KAEtDjF,EAAA,oCACAA,EAAA,6DACAA,EAAA,yBACAA,EAAA,0BACE1X,UAAU,uBACVnS,MAAO2L,EACPwe,SAAU,SAAAnZ,GACRxJ,EAAK6Z,UAAU1V,SAAUqF,EAAGC,OAAOjR,QACnCwH,EAAK0sB,mBAAmBX,cAAc,QAG1C1J,EAAA,uCACAA,EAAA,2IAEAA,EAAA,yBACAA,EAAA,0BACE1X,UAAU,uBACVnS,MAAO0L,EACPye,SAAU,SAAAnZ,GACRxJ,EAAK6Z,UAAU3V,WAAYsF,EAAGC,OAAOjR,QACrCwH,EAAK0sB,mBAAmBX,cAAc,QAE1C1J,EAAA,qBACE1X,UAAU,MACVsb,SAAU,EACVvG,MAAOiP,MAAyBrK,QAAS,IACzCnK,QAAS,WAAI,OAACqU,GAAYxuB,EAAK0sB,mBAAmBX,cAAc,KAC9D1J,EAAA,mBAAG1X,UAAU,iBAAgB2C,cAAa,SACvCqhB,EAAmB,SAAW,cAM3CtM,EAAA,cAAC6M,EAAA,GACC3J,QAASA,EACTI,UAAW,WACP3lB,EAAK6Z,SACH,SAAClZ,OAAC4kB,EAAA5kB,EAAA4kB,QAAa,OAAGA,QAASA,EAAQrsB,MAAM,EAAGqsB,EAAQpvB,OAAS,WAK3Em2B,EAnWA,CAAiCjK,EAAA,0GEnCjC8M,EAAA,EAAIjvB,iBAAmB,IAAIkvB,EAAA,EACzBC,EAAA,EAAIC,YACJH,EAAA,EAAIzd,6GCGN,SAAA6d,EAA4Brf,EAAmBlL,EAAwBwqB,GAErE,IAAMhjB,EAAelW,OAAAm5B,EAAA,EAAAn5B,CAAiB0O,GAChC0qB,EAAqBp5B,OAAAq5B,EAAA,EAAAr5B,CAAgBkW,EAAcojB,EAAA,GACnDjvB,EAAArK,OAAAm5B,EAAA,EAAAn5B,CAAA4Z,GAAC2f,EAAAlvB,EAAA,GAAuBmvB,EAAAnvB,EAAA,GACxBovB,EAAiBz5B,OAAAm5B,EAAA,EAAAn5B,CAAiBw5B,GACxC,OAAOD,EAAwBv5B,OAAAm5B,EAAA,EAAAn5B,CAAmB4Q,EAAA,KAC7C6oB,EACAL,GACHF,OAAQA,EAAOzsB,KAAK,QAIxB,SAAAitB,EAAoBC,EAAyBxvB,GAC3C,OAAOwvB,EAAkB,IAAMxvB,EAoCjC,SAAAyvB,EAAiC1c,EAAkB1V,EAAY0xB,GAC7D,OAAO,IAAIW,EAAA,EACTf,EAAA,EACAA,EAAA,EACA5b,EAAW1V,EAAKwC,KAAOoM,SAASC,OAChCyjB,EAAA,EAAIC,cACJD,EAAA,EAAIE,kBACJ9c,GACE+c,MAAOzyB,EAAKwC,KAAKgF,cACjBsG,MAAO9N,EAAK8N,MACZvH,OAAQvG,EAAKuG,OACbsgB,WAAY7mB,EAAK6mB,WACjB6K,OAAMA,IASZ,IAjDsBpf,EACdogB,EAgDFC,EAAmB5lB,EAAA,EAAIxK,aAAewK,EAAA,EAAIxK,YAAYC,KAC5D,GAAImwB,EAEF,GAAIL,EAAA,EAAIM,eAAgB,CAMtB,IAAMT,EAAkBV,EACtBa,EAAA,EAAIM,eACJhkB,SAASC,QACP,aACA,QAEJ9B,EAAA,EAAI6G,eAzDR,SAA8Bue,EAAyBxvB,GACrD,IAAM2P,EAAU4f,EAAWC,EAAiBxvB,GAC5C,OAAO,IAAI2uB,EAAA,EAAwBa,EAAiB,SAAAU,GAClD,IAAMhoB,EAAM/J,KAAKC,MAAM8xB,GACvB,IAAKhoB,EAAIioB,GAAI,MAAM,IAAIjnB,MAAMhB,EAAIlM,OAIjC,OAHIkM,EAAI7K,MAjBZ,SAAsBA,EAAYsS,GAChCvF,EAAA,EAAIxK,YAAcvC,EAClBkR,eAAe5P,QAAQ,WAAagR,EAASxR,KAAKO,UAAUrB,IAgBxD+yB,CAAaloB,EAAI7K,KAAMsS,IAEhBnB,MAAOtG,EAAIsG,MAAOC,QAASpT,KAAKkC,MAAQ,QAChDoS,GAgDoB0gB,CAAqBb,EAAiBQ,GAhEzCrgB,EAiEL4f,EAAWC,EAAiBQ,IAhErCD,EAAoBxhB,eAAetQ,QAAQ,WAAa0R,MAE5DvF,EAAA,EAAIxK,YAAczB,KAAKC,MAAM2xB,IAiE7B,IAAMO,EAAmBxB,EACvBa,EAAA,EAAIM,eACJhkB,SAASC,QACP,sDAEJ9B,EAAA,EAAImmB,oBAtDR,SAAmCf,EAAyBxvB,GAC1D,IAAM2P,EAAU4f,EAAWC,EAAiBxvB,GAC5C,OAAO,IAAI2uB,EAAA,EAAwBa,EAAiB,SAAAU,GAClD,IAAMhoB,EAAM/J,KAAKC,MAAM8xB,GACvB,IAAKhoB,EAAIioB,GAAI,MAAM,IAAIjnB,MAAMhB,EAAIlM,OACjC,OAASwS,MAAOtG,EAAIsG,MAAOC,QAASpT,KAAKkC,MAAQ,QAChDoS,GAgDyB6gB,CAA0BF,EAAkBN,OACjE,MAAIL,EAAA,EAAIc,eAAiBd,EAAA,EAAIC,eAAiBD,EAAA,EAAIE,mBAcvD,MAAM,IAAI3mB,MAAM,kDARhBkB,EAAA,EAAI6G,eAAiBwe,EAAwBE,EAAA,EAAIc,cAAermB,EAAA,EAAIxK,aAClE,aACA,QAEFwK,EAAA,EAAImmB,oBAAsBd,EAAwBE,EAAA,EAAIc,cAAgB,UAAWrmB,EAAA,EAAIxK,aACnF,kLChGN8wB,EAAA,SAAArxB,GACE,SAAAqxB,EAAYx2B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH2tB,WAAW,EACXhW,WACAiD,YAAY,GAEd1Z,EAAKoxB,oBAAsBpxB,EAAKoxB,oBAAoBn4B,KAAK+G,KA6E7D,OArFiCkH,EAAA,EAAAiqB,EAAArxB,GAW/BqxB,EAAA56B,UAAA86B,mBAAA,WACEC,EAAA,EAAkB5tB,UAAU7F,KAAKuzB,qBAAsBtW,YAAY,KAGrEqW,EAAA56B,UAAAwsB,qBAAA,WACEuO,EAAA,EAAkB9sB,YAAY3G,KAAKuzB,sBAGrCD,EAAA56B,UAAA66B,oBAAA,SAAoB3a,GAClB5Y,KAAKgc,UAAUpD,QAAOA,EAAEgW,WAAW,KAG/B0E,EAAA56B,UAAA4mB,WAAN,SAAiBna,+FAEf,OADA1M,OAAAqpB,EAAA,EAAArpB,CAASA,OAAAqpB,EAAA,EAAArpB,CAACspB,MAAA1Y,EAAA,mCACV,EAAMoqB,EAAA,EAAkBnU,WAAWna,kBAAnCrC,EAAAE,OACAvK,OAAAqpB,EAAA,EAAArpB,CAAS,cAGL66B,EAAA56B,UAAAknB,WAAN,SAAiBza,+FAEf,OADA1M,OAAAqpB,EAAA,EAAArpB,CAASA,OAAAqpB,EAAA,EAAArpB,CAACi7B,MAAArqB,EAAA,mCACV,EAAMoqB,EAAA,EAAkB7T,WAAWza,kBAAnCrC,EAAAE,OACAvK,OAAAqpB,EAAA,EAAArpB,CAAS,cAGX66B,EAAA56B,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACE,GAAIA,KAAKiB,MAAM2tB,UAAW,OAAOjT,EAAA,cAACgY,EAAA,EAAO,MAClC,IAAA/a,EAAA5Y,KAAAiB,MAAA2X,QACDgb,EAAiBhb,EAAQhU,OAAO,SAAAO,GAAU,OAAAA,EAAOgY,UACjD0W,EAAgBjb,EAAQhU,OAAO,SAAAO,GAAU,OAACA,EAAOgY,UACjD9N,EAAQ5W,OAAAq7B,EAAA,EAAAr7B,CAAiBoW,SAASC,QAClCkb,EAAgBhqB,KAAKlD,MAAMktB,eAAiB,GAElD,OAAOrO,EAAA,qBAAK7O,UAAU,aACpB6O,EAAA,0CACAA,EAAA,qBAAK7O,UAAU,0BACZ8mB,EAAez2B,IAAI,SAAAgI,GAClB,OAAAwW,EAAA,qBAAK7O,UAAU,gBAAgB7Q,IAAKkJ,EAAOF,IACzC0W,EAAA,qBAAK7O,UAAU,oBACb6O,EAAA,qBAAK7O,UAAU,iCACb6O,EAAA,mBAAG7O,UAAU,WAAWwP,QAAS,WAAM,OAAAna,EAAKmd,WAAWna,OAEzDwW,EAAA,qBAAK7O,UAAU,sBACb6O,EAAA,mBAAG1M,KAAMxW,OAAAs7B,EAAA,EAAAt7B,CAA2BuxB,GAAgBnR,SAAU1T,EAAOF,MAAOE,EAAOhL,QAGvFwhB,EAAA,qBAAK7O,UAAU,sBACb6O,EAAA,mBAAG7O,UAAU,SAAS3H,EAAOga,kBAKrCxD,EAAA,qBAAK7O,UAAW,aAAe9M,KAAKiB,MAAM4a,WAAa,QAAU,KAC/DF,EAAA,qBAAK7O,UAAU,aAAawP,QAAS,WAAM,OAAAna,EAAK6Z,UAAWH,YAAa1Z,EAAKlB,MAAM4a,eACjFF,EAAA,yCAEFA,EAAA,qBAAK7O,UAAU,eACb6O,EAAA,qBAAK7O,UAAU,0BACZ+mB,EAAc12B,IAAI,SAAAgI,GACnB,OAAAwW,EAAA,qBAAK7O,UAAU,gBAAgB7Q,IAAKkJ,EAAOF,IACzC0W,EAAA,qBAAK7O,UAAU,oBACb6O,EAAA,qBAAK7O,UAAU,iCACb6O,EAAA,mBAAG7O,UAAU,WAAWwP,QAAS,WAAM,OAAAna,EAAKyd,WAAWza,OAEzDwW,EAAA,mBAAG1M,KAAMxW,OAAAq7B,EAAA,EAAAr7B,CAAmB4Q,EAAA,KAAKgG,GAAOwJ,SAAU1T,EAAOF,OAAOE,EAAOhL,OAEzEwhB,EAAA,qBAAK7O,UAAU,sBACb6O,EAAA,mBAAG7O,UAAU,SAAS3H,EAAOga,sBAQ7CmU,EArFA,CAAiC3X,EAAA,sGCRjCqY,EAAA,SAAA/xB,GACE,SAAA+xB,EAAal3B,GAAb,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACHrC,WAAOiiB,EACPoT,UAAMpT,GAER1e,EAAK+xB,oBAAsB/xB,EAAK+xB,oBAAoB94B,KAAK+G,GACzDA,EAAKgyB,OAAShyB,EAAKgyB,OAAO/4B,KAAK+G,GAC/BA,EAAKiyB,aAAejyB,EAAKiyB,aAAah5B,KAAK+G,GAC3CA,EAAKkyB,QAAUlyB,EAAKkyB,QAAQj5B,KAAK+G,KAmDrC,OA7D0CkH,EAAA,EAAA2qB,EAAA/xB,GAaxC+xB,EAAAt7B,UAAAssB,kBAAA,WACE9pB,OAAOo5B,iBAAiB,qBAAsBt0B,KAAKk0B,qBACnDh5B,OAAOo5B,iBAAiB,QAASt0B,KAAKm0B,QACtCj5B,OAAOo5B,iBAAiB,cAAet0B,KAAKo0B,cAC5Cl5B,OAAOo5B,iBAAiB,OAAQt0B,KAAKq0B,UAGvCL,EAAAt7B,UAAAwsB,qBAAA,WACEhqB,OAAOq5B,oBAAoB,qBAAsBv0B,KAAKk0B,qBACtDh5B,OAAOq5B,oBAAoB,QAASv0B,KAAKm0B,QACzCj5B,OAAOq5B,oBAAoB,cAAev0B,KAAKo0B,cAC/Cl5B,OAAOq5B,oBAAoB,OAAQv0B,KAAKq0B,UAG1CL,EAAAt7B,UAAAw7B,oBAAA,SAAqBvoB,GAArB,IAAAxJ,EAAAnC,KACEA,KAAKgc,UAAUpd,MAAO+M,EAAG6oB,OAAS7oB,EAAG6oB,OAAO91B,QAAUjG,OAAAg8B,EAAA,EAAAh8B,CAACspB,MAAA1Y,EAAA,qEAA+B4qB,KAAM,OAC5F5F,WAAW,WAAI,OAAAlsB,EAAK6Z,UAAUpd,MAAO,QAAQ,MAG/Co1B,EAAAt7B,UAAAy7B,OAAA,SAAQxoB,GAAR,IAAAxJ,EAAAnC,KACEA,KAAKgc,UAAUpd,MAAO+M,EAAG/M,MAAQ+M,EAAG/M,MAAMF,QAAUjG,OAAAg8B,EAAA,EAAAh8B,CAACi7B,MAAArqB,EAAA,qEAA+B4qB,KAAM,OAC1F5F,WAAW,WAAI,OAAAlsB,EAAK6Z,UAAUpd,MAAO,QAAQ,MAG/Co1B,EAAAt7B,UAAA07B,aAAA,SAAczoB,GAAd,IAAAxJ,EAAAnC,KACEA,KAAKgc,UAAUpd,MAAO+M,EAAGrN,OAAQ21B,KAAM,OACvC5F,WAAW,WAAI,OAAAlsB,EAAK6Z,UAAUpd,MAAO,QAAQ,MAG/Co1B,EAAAt7B,UAAA27B,QAAA,SAAQ1oB,GAAR,IAAAxJ,EAAAnC,KACEA,KAAKgc,UAAUpd,MAAO,KAAMq1B,KAAMtoB,EAAGrN,SACrC+vB,WAAW,WAAI,OAAAlsB,EAAK6Z,UAAUiY,KAAM,QAAQ,MAG9CD,EAAAt7B,UAAAujB,OAAA,WACE,OAAON,EAAA,qBAAK7O,UAAU,yBAAyB+U,OAC7C6S,SAAU,QACVC,KAAM,EACNC,IAAK,EACLC,MAAO,OACPC,cAAe,SAEfnZ,EAAA,qBAAKkG,OAAQkT,QAAS,QAASC,OAAQ,WACrCrZ,EAAA,mBAAG7O,UAAU,QAAQ+U,OAAQkT,QAAS/0B,KAAKiB,MAAMrC,MAAQ,GAAK,SAAUoB,KAAKiB,MAAMrC,OAASoB,KAAKiB,MAAMrC,OACvG+c,EAAA,mBAAG7O,UAAU,OAAO+U,OAAQkT,QAAS/0B,KAAKiB,MAAMgzB,KAAO,GAAK,SAAUj0B,KAAKiB,MAAMgzB,SAIzFD,EA7DA,CAA0CrY,EAAA,mGCC1CsZ,EAAA,SAAAhzB,GAAA,SAAAgzB,mDAaA,OAbuC5rB,EAAA,EAAA4rB,EAAAhzB,GACrCgzB,EAAAv8B,UAAAujB,OAAA,WACQ,IAAAnZ,EAAA9C,KAAAlD,MAACo4B,EAAApyB,EAAAoyB,YAAa9L,EAAAtmB,EAAAsmB,cACpB,OAAOzN,EAAA,yBAAMyN,EAAcjsB,IAAI,SAAAwsB,GAAM,OAAAhO,EAAA,qBAAK1f,IAAK0tB,EAAGxvB,MAChDwhB,EAAA,wBAAKgO,EAAGxvB,MACRwhB,EAAA,cAACwZ,EAAA,GAASzP,cAAeiE,EAAGjE,mBAE7BwP,EAAY58B,OAAS,GAAKqjB,EAAA,yBACxByN,EAAc9wB,OAAS,GAAKqjB,EAAA,wCAC7BA,EAAA,cAACwZ,EAAA,GAASzP,cAAewP,OAI/BD,EAbA,CAAuCtZ,EAAA,4ECRvC2V,EAAA,EAAI1S,UAAY,IAAIwW,EAAA,EAClB7D,EAAA,EACAC,EAAA,EAAI6D,YACJ/D,EAAA,EAAIzd,mCCRN,IAAA1W,GACAm4B,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,IAIA,SAAAC,EAAAC,GACA,IAAAlxB,EAAAmxB,EAAAD,GAEA,OADA18B,EAAAwL,GAGA,SAAAmxB,EAAAD,GACA,IAAAlxB,EAAA9H,EAAAg5B,GACA,KAAAlxB,EAAA,IACA,IAAAoH,EAAA,IAAAP,MAAA,uBAAAqqB,EAAA,MAEA,MADA9pB,EAAA2K,KAAA,mBACA3K,EAEA,OAAApH,EAEAixB,EAAAn6B,KAAA,WACA,OAAAtD,OAAAsD,KAAAoB,IAEA+4B,EAAA5qB,QAAA8qB,EACAt8B,EAAAD,QAAAq8B,EACAA,EAAAjxB,GAAA,2FCvBaoxB,EAAe,SAACv5B,GACnB,IAAAof,EAAApf,EAAAof,MAAOoa,EAAAx5B,EAAAw5B,gBAAiBC,EAAAz5B,EAAAy5B,KAAMC,EAAA15B,EAAA05B,UAEtC,OAAOhS,EAAA,qBAAK1X,UAAU,mCACpB0X,EAAA,qBAAK1X,UAAU,yCACb0X,EAAA,qBAAK1X,UAAU,+CACZwpB,GAAmB9R,EAAA,2BAAQ,6DAED8R,EAAe,qCAG1C9R,EAAA,qBAAK1X,UAAU,cACb0X,EAAA,uBACEA,EAAA,wBAAKtI,IAEPsI,EAAA,qBAAK1X,UAAU,gBACb0X,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,qBACf0X,EAAA,qBAAK1X,UAAU,kBACb0X,EAAA,wBACG+R,EAAKp5B,IAAI,SAAC2F,EAAmBiG,OAAlB5O,EAAA2I,EAAA3I,KAAM8B,EAAA6G,EAAA7G,IAAKuN,EAAA1G,EAAA0G,KACfitB,EAAWD,IAAchtB,EAC/B,OAAOgb,EAAA,oBAAIvoB,IAAKA,IAAwB,iBAAT9B,EAAoBA,EAAO4O,GAAM+D,UAAW2pB,EAAW,aAAe,IACnGjS,EAAA,mBAAGvV,KAAMzF,GAAOrP,uBCpBtCu8B,EAAA,SAAAz0B,GACE,SAAA00B,EAAY75B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,WA8CT,OAjDgD0B,EAAA,EAAAg0B,EAAA10B,GAM9C00B,EAAAj+B,UAAAujB,OAAA,WAOE,IANM,IAAAnZ,EAAA9C,KAAAlD,MAAEof,EAAApZ,EAAAoZ,MAAO0a,EAAA9zB,EAAA8zB,aAAc9pB,EAAAhK,EAAAgK,UAAW+pB,EAAA/zB,EAAA+zB,YAAahb,EAAA/Y,EAAA+Y,WAE/Cib,GAAW,IAAK,IAAK,KACrB9K,KACA1U,EAAOsf,EAAav7B,QACtB07B,EAAqC,OAEvCA,EAAMD,EAAQ35B,IAAI,SAAA65B,GAChB,IAAMC,EAAQ3f,EAAK4f,UAAU,SAAAx8B,GAAK,OAAAA,EAAEy8B,UAAUC,gBAAkBJ,IAChE,GAAIC,EAAQ,EAAG,OAAO,KACtB,IAAMp5B,EAAKyZ,EAAK2f,GAEhB,OADA3f,EAAK9d,OAAOy9B,EAAO,GACZJ,EACJA,EAAYh5B,EAAGoH,IAAMpH,OAAKgjB,EAC3BhjB,KAEIw5B,MAAM,SAAA38B,GAAK,OAAM,OAANA,KAEdq8B,EAAIM,MAAM,SAAA38B,GAAK,OAACA,KACnBsxB,EAAKxzB,KAAKu+B,GAId,OAAOvS,EAAA,cAAC8E,EAAA,GAAapN,MAAOsI,EAAA,uBAAItI,GAAYpP,UAAWA,EAAW+O,WAAYA,GAC5E2I,EAAA,2BACEA,EAAA,2BACEA,EAAA,wBACGsS,EAAQ35B,IAAI,SAAAlD,GAAK,OAAAuqB,EAAA,oBAAIvoB,IAAKhC,GAAIA,OAGnCuqB,EAAA,2BACGwH,EAAK7uB,IAAI,SAAC45B,EAAI3+B,GACb,OAAAosB,EAAA,oBAAIvoB,IAAK7D,GACN2+B,EAAI55B,IAAI,SAACm6B,EAAOh+B,GACf,OAAAkrB,EAAA,oBAAIvoB,IAAK3C,EAAGi+B,yBAA0BC,OAAQF,EAASA,EAAOn9B,KAAO,eAQrFw8B,EAjDA,CAAgDnS,EAAA,WCAhD,IAAAiT,EAAA,SAAAx1B,GACE,SAAAy1B,EAAY56B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH4a,WAAY/e,EAAM+e,aAAc,KA4BtC,OAhCkClZ,EAAA,EAAA+0B,EAAAz1B,GAQhCy1B,EAAAh/B,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAlD,MAAEof,EAAApZ,EAAAoZ,MAAOyb,EAAA70B,EAAA60B,SAAUC,EAAA90B,EAAA80B,UAAW9qB,EAAAhK,EAAAgK,UAC5B+O,EAAA7b,KAAAiB,MAAA4a,WAER,OAAO2I,EAAA,qBAAK1X,WAAYA,GAAW,IAAM,cAAgB+O,EAAa,QAAU,KAC9E2I,EAAA,qBAAK1X,UAAU,aAAawP,QAAS,WAAM,OAAAna,EAAK6Z,UAAWH,YAAa1Z,EAAKlB,MAAM4a,eACjF2I,EAAA,uBAAItI,IAENsI,EAAA,qBAAK1X,UAAU,eACb0X,EAAA,qBAAK1X,UAAU,eACZ6qB,GAAYnT,EAAA,qBAAK1X,UAAU,iBAC1B0X,EAAA,wBAAKmT,IAENC,EAAUz6B,IAAI,SAAAZ,GACb,OAAAioB,EAAA,qBAAKvoB,IAAKM,EAAE0I,GAAI6H,UAAU,eACxB0X,EAAA,qBAAK1X,UAAU,eACb0X,EAAA,mBAAG+S,yBAA0BC,OAAQj7B,EAAEpC,gBAQvDu9B,EAhCA,CAAkClT,EAAA,WCAlCqT,EAAA,SAAA51B,GACE,SAAA61B,EAAYh7B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH4a,WAAY/e,EAAM+e,aAAc,KA4BtC,OAhCuClZ,EAAA,EAAAm1B,EAAA71B,GAQrC61B,EAAAp/B,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAlD,MAAEof,EAAApZ,EAAAoZ,MAAOyb,EAAA70B,EAAA60B,SAAUhqB,EAAA7K,EAAA6K,eAAgBb,EAAAhK,EAAAgK,UACjC+O,EAAA7b,KAAAiB,MAAA4a,WAER,OAAO2I,EAAA,qBAAK1X,WAAYA,GAAa,IAAM,cAAgB+O,EAAa,QAAU,KAChF2I,EAAA,qBAAK1X,UAAU,aAAawP,QAAS,WAAM,OAAAna,EAAK6Z,UAAWH,YAAa1Z,EAAKlB,MAAM4a,eACjF2I,EAAA,uBAAItI,IAENsI,EAAA,qBAAK1X,UAAU,eACb0X,EAAA,qBAAK1X,UAAU,eACZ6qB,GAAYnT,EAAA,qBAAK1X,UAAU,iBAC1B0X,EAAA,wBAAKmT,IAENhqB,EAAexQ,IAAI,SAAAyQ,GAClB,OAAA4W,EAAA,qBAAKvoB,IAAK2R,EAAG3I,GAAI6H,UAAU,eACzB0X,EAAA,qBAAK1X,UAAU,eACb0X,EAAA,mBAAG+S,yBAA0BC,OAAQ5pB,EAAGzT,gBAQxD29B,EAhCA,CAAuCtT,EAAA,2BCbjC,SAAAuT,EAA4Bj+B,EAAsBkL,GACtD,OAAOlL,EAAOk+B,mBAAoBr1B,EAAA,KAC5BqC,EAASlL,EAAOk+B,mBAAmBhzB,EAAKC,KAC5CD,ECgBJ,IAAAizB,EAAA,SAAAh2B,GACE,SAAAi2B,EAAYp7B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,WAkGT,OArGsC0B,EAAA,EAAAu1B,EAAAj2B,GAOpCi2B,EAAAx/B,UAAAujB,OAAA,WACQ,IAAAnZ,EAAA9C,KAAAlD,MAAEhD,EAAAgJ,EAAAhJ,OAAQqL,EAAArC,EAAAqC,OACVgzB,EC5BI,SAA0Br+B,EAAsBqL,GAC5D,IAAMhM,KAMN,OALAgM,EAAOmI,MAAM1I,OAAO,SAAAC,GAAK,OAAkC,IAAlC/K,EAAO4X,QAAQzJ,QAAQpD,EAAEI,MAAYjJ,QAAQ,SAAAgJ,GACpEA,EAAK4yB,UAAU57B,QAAQ,SAAC8G,OAACmC,EAAAnC,EAAAmC,GAAQ,OAAA9L,EAAO8L,IAAM,IAC9CD,EAAK2I,eAAe3R,QAAQ,SAAC8G,OAACmC,EAAAnC,EAAAmC,GAAQ,OAAA9L,EAAO8L,IAAM,IACnDD,EAAKwI,sBAAsBxR,QAAQ,SAAC8G,OAACmC,EAAAnC,EAAAmC,GAAQ,OAAA9L,EAAO8L,IAAM,MAErD9L,EDqBci/B,CAAet+B,EAAQqL,GACpCugB,EAAgB5rB,EAAO4X,QAC1BvU,IAAI,SAAA8H,GAAM,OAAAE,EAAOmI,MAAMG,KAAK,SAAA5I,GAAK,OAAAA,EAAEI,KAAOA,MAC1CL,OAAO,SAAAI,GAAQ,QAAEA,IACjB7H,IAAI,SAAA6H,GAAQ,OACXC,GAAID,EAAKC,GACTD,KAAM+yB,EAAkBj+B,EAAQkL,GAChCG,OAAMA,EACNhL,KAAM6K,EAAK7K,KACXoQ,IAAK,IAAI3C,mBAAmB9N,EAAOK,KAAKqN,QAAO,IAAIxC,EAAKC,GACxDH,WAAYK,EAAOhL,KACnB4K,aAAcC,EAAKD,cAAgBjL,EAAOK,QAExCk+B,EAAkB3S,EAAc9gB,OAAO,SAAAC,GAAK,OAAAA,EAAEG,MAAQH,EAAEG,KAAKszB,aAC7DC,EAAqB7S,EAAc9gB,OAAO,SAAAC,GAAK,OAACA,EAAEG,OAASH,EAAEG,KAAKszB,aAClEpD,EAAcqD,EAAmB3zB,OAAO,SAAAC,GAAK,OAACA,EAAEG,KAAKD,eACrDqkB,EAAgB3wB,OAAAga,EAAA,EAAAha,CACpB8/B,EAAmB3zB,OAAO,SAAAC,GAAK,QAAEA,EAAEG,KAAKD,eACxC,SAAAF,GAAK,OAAAA,EAAEE,eACT,OAAOyf,EAAA,yBACLA,EAAA,qBAAK1X,UAAU,iDACb0X,EAAA,qBAAK1X,UAAU,2BACb0X,EAAA,oBAAI1X,UAAU,MAAMhT,EAAOK,QAG/BqqB,EAAA,qBAAK1X,UAAU,yBACb0X,EAAA,qBAAK+S,yBAA2BC,OAAQ19B,EAAO0+B,qBAIjDhU,EAAA,qBAAK1X,UAAU,8BACb0X,EAAA,qBAAK1X,UAAU,aACb0X,EAAA,oFACI1qB,EAAO2+B,aAAe3+B,EAAO4+B,UAAYlU,EAAA,qBAAK1X,UAAU,mBAC1D0X,EAAA,uCACAA,EAAA,yBAAM1qB,EAAO2+B,WAAa,MAC1BjU,EAAA,sCACAA,EAAA,yBAAM1qB,EAAO4+B,SAAW,MACxBlU,EAAA,0BAEFA,EAAA,yBAEAA,EAAA,cAACkS,GACCxa,MAAM,iDACN0a,aAAczxB,EAAOqI,sBACrBqpB,YAAasB,IAEf3T,EAAA,cAACiT,GACCvb,MAAM,8CACN0b,UAAWzyB,EAAOyyB,UAAUhzB,OAAO,SAAArI,GAAK,OAAA47B,EAAW57B,EAAE0I,QAEvDuf,EAAA,cAACqT,GACC3b,MAAM,uDACNvO,eAAgBxI,EAAOwI,eAAe/I,OAAO,SAAA3K,GAAK,OAAAk+B,EAAWl+B,EAAEgL,UAKpEnL,EAAO4X,QAAQpZ,OAAS,GAAKksB,EAAA,qBAAK1X,UAAU,gCAC3C0X,EAAA,qBAAK1X,UAAU,aACe,IAA3BurB,EAAgB//B,YAAeuoB,EAAY2D,EAAA,cAAAA,EAAA,cAC1CA,EAAA,+CACAA,EAAA,yBACAA,EAAA,cAACmU,EAAA,GAASjT,cAAe2S,KAEI,IAA9BE,EAAmBjgC,YAAeuoB,EAAY2D,EAAA,cAAAA,EAAA,cAC7CA,EAAA,qCACAA,EAAA,yBACAA,EAAA,cAACoU,EAAA,GACC1D,YAAaA,EACb9L,cAAe3wB,OAAOsD,KAAKqtB,GAAejsB,IAAI,SAAA4H,GAAgB,OAC5D5K,KAAM4K,EACN2gB,cAAe0D,EAAcrkB,WAKtCjL,EAAO0X,UAAUlZ,OAAS,GAAKksB,EAAA,qBAAK1X,UAAU,8BAC7C0X,EAAA,qBAAK1X,UAAU,aACb0X,EAAA,oCACAA,EAAA,yBACAA,EAAA,qBAAK1X,UAAU,iBAAiBhT,EAAO0X,UAAUrU,IAAI,SAACzC,EAAGqO,GACvD,OAAAyb,EAAA,qBAAK1X,UAAU,mBAAmB7Q,IAAK8M,GACrCyb,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,mBAAGvV,KAAMvU,EAAE6P,KAAM7P,EAAEP,eAQnC+9B,EArGA,CAAsC1T,EAAA,WEdtCqU,EAAA,SAAA52B,GACE,SAAA62B,EAAYh8B,UACVmF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KAgBhB,OAlBkC2C,EAAA,EAAAm2B,EAAA72B,GAKhC62B,EAAApgC,UAAAujB,OAAA,WACS,IAAAzK,EAAAxR,KAAAlD,MAAA0U,UACP,OAAOgT,EAAA,yBACLA,EAAA,qBAAK1X,UAAU,iBACZ0E,EAAUrU,IAAI,SAAC47B,EAAUhwB,GACxB,OAAAyb,EAAA,qBAAK1X,UAAU,mBAAmB7Q,IAAK8M,GACrCyb,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,mBAAGvV,KAAM8pB,EAASxuB,KAAMwuB,EAAS5+B,aAM/C2+B,EAlBA,CAAkCtU,EAAA,WCUlCwU,EAAA,SAAA/2B,GACE,SAAAg3B,EAAYn8B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,WA+CT,OAlD+B0B,EAAA,EAAAs2B,EAAAh3B,GAM7Bg3B,EAAAvgC,UAAAujB,OAAA,WACU,IAAA9W,EAAAnF,KAAAlD,MAAAqI,OACR,OAAOqf,EAAA,yBACLA,EAAA,qBAAK1X,UAAU,6CACV3H,EAAO+zB,WAAa1U,EAAA,yBACnBA,EAAA,mCACAA,EAAA,mBAAG1X,UAAU,SAASyqB,yBAA0BC,OAAQryB,EAAO+zB,cAEhE/zB,EAAOwM,qBAAuBxM,EAAOwM,oBAAoBrZ,OAAS,GAAKksB,EAAA,yBACtEA,EAAA,kCACCrf,EAAOwM,oBAAoBxU,IAAI,SAACg8B,EAAS/gC,GACxC,OAAAosB,EAAA,mBAAGvoB,IAAK7D,GAAGosB,EAAA,mBAAGvV,MAmCC1E,EAnCyB4uB,EAAQ5uB,KAoClC,IAAtBA,EAAItC,QAAQ,MAAesC,EAAItC,QAAQ,MAAQ,EAAU,UAAYsC,EAClEA,IArC4D4uB,EAAQh/B,OAmC7E,IAA6BoQ,KAhClBpF,EAAOi0B,cAAgB5U,EAAA,mBAAG1X,UAAU,MAAMmC,KAAM9J,EAAOi0B,cAAY,cACpE5U,EAAA,yBACAA,EAAA,yBACAA,EAAA,cAACiT,GACCvb,MAAM,kBACNyb,SAAS,WACTC,UAAWzyB,EAAOyyB,UAClB9qB,UAAU,WAEZ0X,EAAA,cAACqT,GACC3b,MAAM,4BACNyb,SAAS,oBACThqB,eAAgBxI,EAAOwI,eACvBb,UAAU,WAEZ0X,EAAA,cAACkS,GACCxa,MAAM,uBACN0a,aAAczxB,EAAOqI,sBACrBV,UAAU,YAGb3H,EAAOqM,UAAUlZ,OAAS,GAAKksB,EAAA,qBAAK1X,UAAU,8BAC7C0X,EAAA,qBAAK1X,UAAU,aACb0X,EAAA,oCACAA,EAAA,yBACAA,EAAA,cAACqU,GAAarnB,UAAWrM,EAAOqM,gBAK5CynB,EAlDA,CAA+BzU,EAAA,WCjB/B,IAAI6U,GAAc,sFCWZC,GACJ,OACA,OACA,SAgBFC,EAAA,SAAAt3B,GAEE,SAAAu3B,EAAY18B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACHw4B,eACAC,SAAS,KAuOf,OA7OqC/2B,EAAA,EAAA62B,EAAAv3B,GAUnCu3B,EAAA9gC,UAAAihC,iBAAA,SAAiBC,GAAjB,IAAAz3B,EAAAnC,KACE,OAAO,IAAIqL,QAAQ,SAAAC,GAAW,OAAArJ,EAAAvJ,UAAMsjB,SAAQpjB,KAAAuJ,EAACy3B,EAAWtuB,MAG1DkuB,EAAA9gC,UAAAssB,kBAAA,WACEhlB,KAAKU,QAGD84B,EAAA9gC,UAAAojB,0BAAN,SAAgCC,kIAExBA,EAAU8d,SAAW75B,KAAKlD,MAAM+8B,QAChC9d,EAAUlD,WAAa7Y,KAAKlD,MAAM+b,UADlC,MAGF,EAAM7Y,KAAK25B,iBAAiB,WAAI,OAC9BF,eACAC,SAAS,aAEX,OAJA52B,EAAAE,QAIA,EAAMhD,KAAKU,eAAXoC,EAAAE,6DAGFvK,OAAAga,EAAA,EAAAha,CAAUqhC,gCAIRN,EAAA9gC,UAAAgI,KAAN,+HAKgB,6BAHN0D,EAAStC,EAAA,EAAIO,iBAAiB+U,KAC9BtU,EAA6B9C,KAAKlD,MAAjC+b,EAAQ/V,EAAA+V,SAAEghB,EAAM/2B,EAAA+2B,OAAErzB,EAAM1D,EAAA0D,QAEnB,EADY/N,OAAAyxB,EAAA,EAAAzxB,CAAkB+N,GAExCpC,EAAO3J,IAAI,eAAeoe,EAAQ,IAAIghB,GACtCz1B,EAAO3J,IAAI,eAAeoe,EAAQ,IAAIghB,EAAM,IAAI/3B,EAAA,EAAIU,YAAYC,qBAC/C,OAHbqI,EAAMuI,EAAArQ,QAGJ2J,QAAJ,QACQxG,EAAA,EAAS/K,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAsF,EAAA9J,MAAIkN,EAAA,EAASiN,EAAA/W,QAAagX,EAAArQ,kBAGd,SAAM8H,EAAIzJ,sBAAxBo4B,EAAcpmB,EAAArQ,OACpBhD,KAAKgc,UACHpd,MAAO,KACP86B,SAAS,EACTD,YAAWA,mCAGbz5B,KAAKgc,UACH0d,SAAS,EACT96B,MAAO,uCACP66B,iBAEF96B,QAAQC,MAAMm7B,gCAIlBP,EAAA9gC,UAAAshC,OAAA,SAAQruB,GACNA,EAAGW,kBACHX,EAAGY,iBACHZ,EAAGa,aAAaC,WAAa,QAGzB+sB,EAAA9gC,UAAAuhC,OAAN,SAAatuB,uGAKT,6BAHAA,EAAGW,kBACHX,EAAGY,iBACG2tB,EAAOvuB,EAAGa,aAAa2tB,MAAM,GAC/Bn6B,KAAKiB,MAAMw4B,YAAYvwB,KAAK,SAAA3M,GAC9B,OAAAA,EAAE0D,OAAS6B,EAAA,EAAIU,YAAYC,MAC3BlG,EAAE69B,WAAaF,EAAK//B,SAEfu1B,QAAQ,0BAA0BwK,EAAK//B,KAAI,OACxC,GAGN6F,KAAKlD,MAAM0J,OAAOiB,gBAAkB3F,EAAA,EAAIU,YAAYgE,OAAOiB,eACxDioB,QAAQ,qCAAqC1vB,KAAKlD,MAAM0J,OAAM,+CAMrExG,KAAKgc,UAAUqe,cAAeH,KAC9B,EAAMl6B,KAAKs6B,OAAOJ,MAJR,UAKV,OADAp3B,EAAAE,QACA,EAAMhD,KAAKU,sBAAXoC,EAAAE,OACAhD,KAAKgc,UACHqe,cAAe,sCAGjBr6B,KAAKgc,UACHpd,MAAO,gCAAkC27B,EAAM77B,SAAW67B,GAC1DF,cAAe,OAEjB17B,QAAQC,MAAM27B,gCAIZf,EAAA9gC,UAAA4hC,OAAN,SAAaE,qHAIX,GAHe14B,EAAA,EAAIO,iBAAiB+U,KAC9BtU,EAAqB9C,KAAKlD,MAAzB+b,EAAQ/V,EAAA+V,SAAEghB,EAAM/2B,EAAA+2B,OAChBp3B,EAAQX,EAAA,EAAIU,YAAWC,KAC1B+3B,EAAK1P,KAAO2P,SACd,MAAM,IAAI3uB,MAAM,uCAGlB,GADM4uB,EAAgBF,EAAKrgC,KAAKsN,eAC3B6xB,EAAmBpwB,KAAK,SAAAyxB,GAAO,OAAAD,EAAcE,SAASD,KACzD,MAAM,IAAI7uB,MAAM,6BAA6BwtB,EAAmBp0B,KAAK,QAI3D,OAFNiQ,EAAO,IAAI0lB,UACZC,OAAO,QAASN,IACT,EAAM14B,EAAA,EAAIO,iBAAiB+U,KAAKzE,MAC1C,eAAekG,EAAQ,IAAIghB,EAAM,IAAIp3B,EACrC,UAECs4B,gBAAiBj5B,EAAA,EAAIU,YAAY8H,cAEhC6K,KAAIA,mBAEW,OARbrK,EAAMuI,EAAArQ,QAQJ2J,QAAJ,QACQxG,EAAA,EAAS/K,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,gBAA1C,MAAM,IAAAsF,EAAA9J,MAAIkN,EAAA,EAASiN,EAAA/W,QAAagX,EAAArQ,kCAI9Bw2B,EAAA9gC,UAAAsiC,SAAN,SAAeR,6GAEC,gCAAM14B,EAAA,EAAIO,iBAAiB+U,KAAKzE,MAAM6nB,EAAKS,UAAW,yBAA5DnwB,EAAMsI,EAAApQ,QACJ2J,QAAU,OACNxG,EAAA,EAAS/K,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,UADxC,YACF,MAAM,IAAAqF,EAAA7J,MAAIkN,EAAA,EAASpD,EAAA1G,QAAa+W,EAAApQ,kBAErB,SAAM8H,EAAIM,sBAAjBA,EAAOgI,EAAApQ,OACbk4B,IAAS9vB,EAAMovB,EAAKJ,SAAUI,EAAKW,4CAEnCn7B,KAAKgc,UAAUpd,MAAO,gCAAkCw8B,EAAI18B,SAAW08B,KACvEz8B,QAAQC,MAAMw8B,gCAIZ5B,EAAA9gC,UAAA0c,OAAN,SAAa7K,2GAET,gCAAMvK,KAAK25B,iBAAiB,SAAC72B,GAAkB,OAAE22B,YAAnB32B,EAAA22B,YAA4Ct8B,IAAI,SAAAZ,GAAK,OAAAA,EAAE0+B,YAAc1wB,EAAK5H,EAAA,KAClGpG,GAAG8+B,SAAQ14B,EAAA,KAAMpG,EAAE8+B,UAAU92B,MAAO,aAAY5B,EAAA,KAAKpG,gBAC/C,OAFZ6W,EAAApQ,QAEY,EAAMlB,EAAA,EAAIO,iBAAiB+U,KAAKzE,MAAMpI,EAAK,4BAAjDO,EAAMsI,EAAApQ,QACJ2J,QAAU,OACNxG,EAAA,EAAS/K,eAAC0P,EAAI6B,SAAQ,EAAM7B,EAAIrN,UADxC,YACF,MAAM,IAAAqF,EAAA7J,MAAIkN,EAAA,EAASpD,EAAA1G,QAAa+W,EAAApQ,kBAElC,SAAMhD,KAAKU,sBAAX0S,EAAApQ,sCAEAhD,KAAKgc,UAAUpd,MAAO,8BAAgC08B,EAAI58B,SAAW48B,KACrE38B,QAAQC,MAAM08B,gCAIlB9B,EAAA9gC,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAlD,MAAC+b,EAAA/V,EAAA+V,SAAUghB,EAAA/2B,EAAA+2B,OAAQrzB,EAAA1D,EAAA0D,OACnBzD,EAAA/C,KAAAiB,MAACy4B,EAAA32B,EAAA22B,QAASD,EAAA12B,EAAA02B,YAAa76B,EAAAmE,EAAAnE,MAAOy7B,EAAAt3B,EAAAs3B,cAC9BkB,EAAsB9iC,OAAAyxB,EAAA,EAAAzxB,CAAkB+N,GAC1C2zB,EAAYV,EAAWp+B,QAC3B,GAAIg/B,EAAe,CACjB,IAAMmB,GACJ3iB,SAAQA,EACRghB,OAAMA,EACNO,SAAUC,EAAclgC,KACxB2wB,KAAMuP,EAAcvP,KACpB7qB,KAAM6B,EAAA,EAAIU,YAAYC,KACtB04B,YAAad,EAAcvsB,KAC3B2tB,WAAYx9B,KAAKkC,MACjB86B,UAAW,eAAepiB,EAAQ,IAAIghB,EAAM,IAAI/3B,EAAA,EAAIU,YAAYC,KAAI,IAAI43B,EAAclgC,KACtFkhC,UAAW92B,MAAO,QAGpB41B,GADAA,EAAQA,EAAMv1B,OAAO,SAAA41B,GAAQ,OAAAA,EAAKS,YAAcO,EAAYP,aAC3C5+B,QAAEm/B,IAIrB,OAFArB,EAAQA,EAAM5iB,KAAK9e,OAAAga,EAAA,EAAAha,EAAc,OAAQ,aAAc,KAAM,OAAQijC,YAAa,UAGhFlX,EAAA,qBAAKmX,WAAY,SAAAhwB,GAAM,OAAAxJ,EAAK63B,OAAOruB,IAAKsuB,OAAQ,SAAAtuB,GAAI,OAAAxJ,EAAK83B,OAAOtuB,KAC7D/M,EAAQ4lB,EAAA,cAAAA,EAAA,cACPA,EAAA,mBAAG1X,UAAU,SAASlO,SACnBiiB,EACJ6Y,EAAUlV,EAAA,cAAAA,EAAA,cACTA,EAAA,cAACyM,EAAA,EAAO,oCACa,IAAjBkJ,EAAM7hC,OACVijC,EACE/W,EAAA,2EACA3D,EACF2D,EAAA,cAAAA,EAAA,cACAA,EAAA,uBAAO1X,UAAU,0BAAyB0X,EAAA,2BAAOA,EAAA,wBAC9C+W,EAAsB/W,EAAA,qCAAgB3D,EACvC2D,EAAA,mCACAA,EAAA,wCACAA,EAAA,kCACAA,EAAA,2BACWA,EAAA,2BACX2V,EAAMh9B,IAAI,SAAAq9B,GAAQ,OAAAhW,EAAA,oBAChBvoB,IAAKu+B,EAAKS,UACVpZ,MAAO2Y,EAAKa,SAAS92B,OAASkiB,QAAS,QAEtC8U,EAAsB/W,EAAA,wBACrBA,EAAA,mBAAGvV,KAAM,UAAUurB,EAAKv6B,MACrBu6B,EAAKa,SAASN,iBAAmBP,EAAKv6B,YAEnC4gB,EACR2D,EAAA,wBAAIA,EAAA,mBAAGvV,KAAK,IAAIqN,QAAS,SAAA3Q,GACvBA,EAAGY,iBACHZ,EAAGW,kBACHnK,EAAK64B,SAASR,KACZA,EAAKJ,WACT5V,EAAA,wBAAKrjB,IAAOq5B,EAAKiB,YAAYxxB,OAAO,qBACpCua,EAAA,wBAA6B,QAAxBgW,EAAKa,SAAS92B,MACjBigB,EAAA,cAAAA,EAAA,cAAEA,EAAA,cAACyM,EAAA,EAAO,wBACc,WAAxBuJ,EAAKa,SAAS92B,MACdigB,EAAA,cAAAA,EAAA,cAAEA,EAAA,cAACyM,EAAA,EAAO,sBACVzM,EAAA,cAAAA,EAAA,cAAEA,EAAA,mBAAG1X,UAAU,kCAEjB0X,EAAA,yBAAMgW,EAAKa,SAAS92B,OAASi2B,EAAKv6B,OAAS6B,EAAA,EAAIU,YAAYC,MACzD+hB,EAAA,mBAAGvV,KAAK,IAAIqN,QAAS,SAAA3Q,GACnBA,EAAGW,kBACHX,EAAGY,iBACHpK,EAAKiT,OAAOolB,EAAKS,aAChBzW,EAAA,mBAAG1X,UAAU,wBAIvByuB,OAAsB1a,EAAY2D,EAAA,qBAAK1X,UAAU,wEAChB0X,EAAA,yBAC9BA,EAAA,qDAMZgV,EA7OA,CAAqChV,EAAA,WCPrCoX,EAAA,SAAA35B,GACE,SAAA45B,EAAY/+B,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACHiD,cAAU2c,EACV8E,gBAAiBxkB,MAAS+B,QAE5Bf,EAAKwqB,mBAAqBxqB,EAAKwqB,mBAAmBvxB,KAAK+G,KA+K3D,OAtL8BQ,EAAA,EAAAk5B,EAAA55B,GAU5B45B,EAAAnjC,UAAAssB,kBAAA,WACEC,EAAA,EAAcpf,UAAU7F,KAAK2sB,qBAG/BkP,EAAAnjC,UAAAwsB,qBAAA,WACED,EAAA,EAActe,YAAY3G,KAAK2sB,qBAGjCkP,EAAAnjC,UAAAojB,0BAAA,SAA0BC,GACxB,GAAIA,EAAU/W,KAAKC,KAAOjF,KAAKlD,MAAMkI,KAAKC,GAAI,CAC5C,IAAMf,EAAW+gB,EAAA,EAAclhB,IAAIyb,MAAM/R,KAAK,SAAAxH,GAAM,OAAAA,EAAGjB,MAAQiB,EAAGjB,KAAK1M,OAAS,GAAK2N,EAAGjB,KAAK,GAAGC,KAAO8W,EAAU/W,KAAKC,MAAO,KAC7HjF,KAAKgc,UACH9X,SAAQA,EACRyhB,gBAAiBxkB,IAAO8jB,EAAA,EAAcpiB,eAAezC,UAAU8C,WAKrE24B,EAAAnjC,UAAAi0B,mBAAA,SAAmB3mB,GAAnB,IAAA7D,EAAAnC,KACQkE,EAAW8B,EAAUyH,KAAK,SAAAxH,GAAM,OAAAA,EAAGjB,MAAQiB,EAAGjB,KAAK1M,OAAS,GAAK2N,EAAGjB,KAAK,GAAGC,KAAO9C,EAAKrF,MAAMkI,KAAKC,MAAO,KAChHjF,KAAKgc,UACH9X,SAAQA,EACRyhB,gBAAiBxkB,IAAO8jB,EAAA,EAAcpiB,eAAezC,UAAU8C,UAI7D24B,EAAAnjC,UAAAysB,WAAN,2HAKE,OAJQ/kB,EAAa6kB,EAAA,EAAcpiB,eAAczC,SACzC8D,EAAalE,KAAKiB,MAAKiD,SACzBpB,EAAmB9C,KAAKlD,MAAtBqI,EAAMrC,EAAAqC,OAAEH,EAAIlC,EAAAkC,MACdlL,EAASqL,EAAOtM,QAAQ4U,KAAK,SAAAzT,GAAK,OAAAA,EAAE0X,QAAQxI,KAAK,SAAAjE,GAAM,OAAAA,IAAOD,EAAKC,aAExD4b,IAAb3c,GAA8B,GAC7BA,GAAD,MACEohB,EAAkB1V,KAAK2V,IAAItsB,MAC7B2W,KAAK2V,KACJnlB,GAAU/D,OAAO4oB,EAAA,EAAclhB,IAAIyb,MAAMriB,IAAI,SAAA0H,GAAK,OAAAA,EAAEuB,aAEjD01B,GACJ72B,GAAIxM,OAAA0N,EAAA,EAAA1N,GACJqM,WAAYK,EAAOhL,KACnBiM,SAAUkf,EAAkB,IAC5BvgB,aAAcC,EAAKD,cAAgBjL,EAAOK,KAC1CA,KAAM6K,EAAK7K,KACXoQ,IAAKvF,EAAKuF,IACVvF,MAAOA,GACPG,QAASA,GACToB,KAEE,IAAIJ,EAAA,EAAe,QAASrE,EAAA,EAAIU,YAAYC,KAAM,KAGlD,IAAI0D,EAAA,EAAe,aAAiBrE,EAAA,EAAIU,YAAYgE,OAAM,YAAa,MACvErJ,IAAI,SAAAsJ,GAAM,OAAAA,EAAGC,cAEb1B,EAAKwgB,WACPsW,EAAStW,SAAWxgB,EAAKwgB,WAE3B,EAAMna,QAAQ6B,KACZ+X,EAAA,EAAczf,sBAAsBxF,KAAKlD,MAAMqI,OAAOhL,MAAM,GAC5D8qB,EAAA,EAAcxF,QAAQqc,SA7BP,iBA2BjB/4B,EAAAC,oBAIA,SAAMiiB,EAAA,EAAc7P,QAAQlR,EAASe,aAArClC,EAAAC,wCAIJ64B,EAAAnjC,UAAAujB,OAAA,eAAA9Z,EAAAnC,KACQ8C,EAAA9C,KAAAlD,MAAEkI,EAAAlC,EAAAkC,KAAMG,EAAArC,EAAAqC,OACRpC,EAAA/C,KAAAiB,MAAEiD,EAAAnB,EAAAmB,SAAUyhB,EAAA5iB,EAAA4iB,gBACZiS,EAAY5yB,EAAK4yB,UAAUz6B,IAAI,SAAAZ,GAAK,OAAA4I,EAAOyyB,UAAUnqB,KAAK,SAAAsuB,GAAM,OAAAA,EAAG92B,KAAO1I,EAAE0I,OAAKL,OAAO,SAAArI,GAAK,QAAEA,IAC/FoR,EAAiB3I,EAAK2I,eAAexQ,IAAI,SAAAlD,GAAK,OAAAkL,EAAOwI,eAAeF,KAAK,SAAAG,GAAM,OAAAA,EAAG3I,IAAMhL,EAAEgL,OAAKL,OAAO,SAAA3K,GAAK,QAAEA,IAC7G28B,EAAe5xB,EAAKwI,sBAAsBrQ,IAAI,SAAA6+B,GAAK,OAAA72B,EAAOqI,sBAAsBC,KAAK,SAAAwuB,GAAM,OAAAA,EAAGh3B,KAAO+2B,EAAE/2B,OAAKL,OAAO,SAAAo3B,GAAK,QAAEA,IAC1H9V,EAAYhiB,IAAgC,WAAnBA,EAASK,OAAyC,aAAnBL,EAASK,OACjEqhB,EAAczkB,MAAS+B,OACvB2iB,EAAgBF,IAAoBC,EAAc,YACtDD,IAAoBC,EAAc,EAAIntB,OAAAga,EAAA,EAAAha,CAACyjC,MAAAv5B,EAAA,+DACvCgjB,IAAoBC,EAAc,EAAIntB,OAAAga,EAAA,EAAAha,CAAC0jC,MAAAx5B,EAAA,iEACvClK,OAAAga,EAAA,EAAAha,CAAC2jC,MAAAz5B,EAAA,2CAAgC,OAAfgjB,GACd0W,EAAkBr3B,EAAKwgB,UAAYrkB,IAAO6D,EAAKwgB,UAAU8W,MAAM,OAASn7B,MAE9E,OAAOqjB,EAAA,yBACLA,EAAA,qBAAK1X,UAAU,iDACb0X,EAAA,qBAAK1X,UAAU,2BACb0X,EAAA,oBAAI1X,UAAU,MAAM9H,EAAK7K,QAG7BqqB,EAAA,qBAAK1X,UAAU,8BACZ9H,EAAKu3B,SAAW/X,EAAA,cAAAA,EAAA,cACfA,EAAA,qBAAK+S,yBAA0BC,OAAQxyB,EAAKu3B,YAE7Cv3B,EAAKD,cAAgByf,EAAA,yBAAKA,EAAA,iDACzBA,EAAA,uBAAIxf,EAAKD,eAEVC,EAAKuF,KAAOia,EAAA,mBAAGvV,KAAMjK,EAAKuF,IAAKuC,UAAU,iBAAe,sBAE3D0X,EAAA,yBACCxf,EAAKszB,WAAa9T,EAAA,cAAAA,EAAA,cACjBA,EAAA,6CACC/rB,OAAAyxB,EAAA,EAAAzxB,CAAkB0M,EAAOqB,QACxBge,EAAA,gFACOA,EAAA,cAAAA,EAAA,cACLA,EAAA,mJAGCxf,EAAKwgB,SAAWhB,EAAA,uBAAGA,EAAA,4CACC6X,EAAkB,yBAA2B,uBAC/Dl7B,IAAO6D,EAAKwgB,UAAUvb,OAAO,qBACrB4W,GAEb2D,EAAA,cAAC+U,GACC1gB,SAAU1T,EAAOF,GACjB40B,OAAQ70B,EAAKC,GACbuB,OAAQrB,EAAOqB,SAEnBge,EAAA,+BACI3D,EACN2D,EAAA,qBAAK1X,UAAU,6CACZ8qB,EAAUt/B,OAAS,GAAKksB,EAAA,cAACiT,GACtBvb,MAAM,gDACNpP,UAAU,SACV+O,YAAY,EACZ+b,UAAWA,IAEdjqB,EAAerV,OAAS,GAAKksB,EAAA,cAACqT,GAC3B3b,MAAM,yDACNpP,UAAU,SACV+O,YAAY,EACZlO,eAAgBA,IAEnBipB,EAAat+B,OAAS,GAAKksB,EAAA,cAACkS,GAC3Bxa,MAAM,mDACNpP,UAAU,SACV+O,YAAY,EACZ+a,aAAcA,KAGlBpS,EAAA,8BACc3D,IAAb3c,GAA0BsgB,EAAA,qBAAK1X,UAAU,iBACtC0X,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,sBACX0X,EAAA,qBACE1X,UAAW,eAAc5I,GAA+B,aAAnBA,EAASK,MAAuB,YAAc,IACnFsd,MAAOqE,GAAaO,QAAS,OAC7BnK,QAAS,WAAI,OAAC4J,GAAa/jB,EAAKgjB,iBAGtCX,EAAA,qBAAK1X,UAAU,sBACZ5I,EACCzL,OAAAga,EAAA,EAAAha,CAAC+jC,MAAA75B,EAAA,4DAAuC,MAAbkjB,GAC3BptB,OAAAga,EAAA,EAAAha,CAACgkC,MAAA95B,EAAA,0DAAsC,MAAbkjB,MAIpCrB,EAAA,yBACCxf,EAAKwM,WAAaxM,EAAKwM,UAAUlZ,OAAS,GAAKksB,EAAA,qBAAK1X,UAAU,8BAC7D0X,EAAA,4DACAA,EAAA,qBAAK1X,UAAU,iBACZ9H,EAAKwM,UAAUrU,IAAI,SAACzC,EAAGqO,GACtB,OAAAyb,EAAA,qBAAKvoB,IAAK8M,EAAK+D,UAAU,oBACvB0X,EAAA,qBAAK1X,UAAU,sBACb0X,EAAA,mBAAGvV,KAAMvU,EAAE6P,KAAM7P,EAAEP,WAK3BqqB,EAAA,0BAIFA,EAAA,yBAAMA,EAAA,yBAAMA,EAAA,yBAAMA,EAAA,yBAAMA,EAAA,yBAAMA,EAAA,yBAAMA,EAAA,yBAAMA,EAAA,yBAAMA,EAAA,2BAGtDqX,EAtLA,CAA8BrX,EAAA,WFpBvB6U,IACHA,GAAc,EACdqD,SAASC,gBAAgBrI,iBAAiB,QAAS,SAAA3oB,GACjD,IAAMC,EAASD,EAAGC,OACdA,GAA6B,MAAnBA,EAAO4c,SACnBoU,QAAQC,cAAeC,YAAa5hC,OAAO4hC,aAAe,KAAM,QAGhEF,QAAQG,oBAAmBH,QAAQG,kBAAoB,WGe/D,IAAAC,EAAA,SAAA/6B,GACE,SAAAg7B,EAAYngC,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,KACZmC,EAAK+6B,aAAe/6B,EAAK+6B,aAAa9hC,KAAK+G,GACrC,IAAAW,EAAAX,EAAAg7B,2BAACrjC,EAAAgJ,EAAAhJ,OAAQkL,EAAAlC,EAAAkC,YACf7C,EAAKlB,OACHnH,OAAMA,EACNkL,KAAIA,KAkHV,OAzHgCrC,EAAA,EAAAs6B,EAAAh7B,GAW9Bg7B,EAAAvkC,UAAAykC,yBAAA,WACE,IAAI91B,GAASwH,SAASK,KAAKxT,OAAO,IAAM,IAAI2L,MAAM,KAC9CA,EAAM/O,OAAS,IAAM+O,EAAM,KAAIA,EAAQA,EAAMhM,MAAM,IACjD,IAAAyH,EAAAuE,EAAAlK,IAAA,SAAAmK,GAAA,OAAAC,mBAAAD,KAAC81B,EAAAt6B,EAAA,GAAY+2B,EAAA/2B,EAAA,GACfhJ,EAASkG,KAAKlD,MAAMqI,OAAOtM,QAC5B+L,OAAO,SAAA5K,GAAK,OAACA,EAAEG,MAAQ,IACrBqN,OAAOC,iBAAmB21B,GAAc,IAAI51B,OAAOC,gBAAe,IAAM,KACzEzC,EAAO60B,GACT75B,KAAKlD,MAAMqI,OAAOmI,MAAMG,KAAK,SAAA5I,GAAK,OAAAA,EAAEI,KAAO40B,KAC3C,KAUF,OATI70B,IAASlL,IAEXA,EAASkG,KAAKq9B,oBACXz4B,OAAO,SAAA5K,GAAK,OAAAA,EAAE0X,QACZxI,KAAK,SAAA2wB,GAAU,OAAA70B,EAAKC,KAAO40B,MAAS,IAEvC70B,GAAQlL,IACVkL,EAAO+yB,EAAkBj+B,EAAQkL,KAE3BlL,OAAMA,EAAEkL,KAAIA,IAGtBi4B,EAAAvkC,UAAAssB,kBAAA,WACE9pB,OAAOo5B,iBAAiB,aAAct0B,KAAKk9B,eAG7CD,EAAAvkC,UAAAwsB,qBAAA,WACEhqB,OAAOq5B,oBAAoB,aAAcv0B,KAAKk9B,eAGhDD,EAAAvkC,UAAAwkC,aAAA,WACQ,IAAAp6B,EAAA9C,KAAAm9B,2BAACrjC,EAAAgJ,EAAAhJ,OAAQkL,EAAAlC,EAAAkC,KACfhF,KAAKgc,UACHliB,OAAMA,EACNkL,KAAIA,GACH,WAED,IAAIs4B,OAAyBzc,EAC7B,GAAI7b,EAAM,CACR,IAAMu4B,EAAab,SAASc,eAAe,mBAC3BF,EAAZC,EAAsCriC,OAAO4hC,YAAcS,EAAWE,wBAAwB7I,IACpE,GH/DhC,SAAiC9xB,OAACw6B,EAAAx6B,EAAAw6B,uBAClCV,QAAQ37B,YAAuC4f,IAA9B+b,QAAQ37B,MAAM67B,YACjC5hC,OAAOwiC,SAAS,EAAGd,QAAQ37B,MAAM67B,kBACGjc,IAA3Byc,GACTpiC,OAAOwiC,SAAS,EAAGJ,GG6DjBK,EAAuBL,uBAAsBA,OAIjDL,EAAAvkC,UAAA2kC,kBAAA,WACU,IAAAl4B,EAAAnF,KAAAlD,MAAAqI,OACFy4B,EAAcz4B,EAAOy4B,aAAez4B,EAAOtM,QAAQsE,IAAI,SAAAnD,GAAK,OAAAA,EAAEiL,KACpE,OAAO24B,EAEJzgC,IAAI,SAAA8H,GAAM,OAAAE,EAAOtM,QAAQ4U,KAAK,SAAAzT,GAAK,OAAAA,EAAEiL,KAAOA,MAE5CL,OAAO,SAAA5K,GAAK,QAAEA,IAEdqC,OAAQ8I,EAAOtM,QAAQ+L,OAAO,SAAA5K,GAAK,OAAC4jC,EAAYnwB,KAAK,SAAAxI,GAAM,OAAAjL,EAAEiL,KAAOA,QAGzEg4B,EAAAvkC,UAAAujB,OAAA,WACQ,IAAAnZ,EAAA9C,KAAAlD,MAACqI,EAAArC,EAAAqC,OAAQ04B,EAAA/6B,EAAA+6B,iBACT96B,EAAA/C,KAAAiB,MAACnH,EAAAiJ,EAAAjJ,OAAQkL,EAAAjC,EAAAiC,KACT84B,EAAiB99B,KAAKq9B,oBAC5B,OAAO7Y,EAAA,yBACLA,EAAA,cAAC6R,GACCna,MAAO/W,EAAOhL,KAAO,MAAQgL,EAAO44B,OAAS,IAC7CzH,iBAAkBnxB,EAAO64B,OAAOvwB,KAAK,SAAAwwB,GAAO,OAAAA,EAAIh5B,KAAOE,EAAO+4B,YAAa3zB,IAAI,KAAKA,IACpFgsB,OAAQp8B,KAAM,UAAmCqP,KAAM,IAAKvN,IAAK,YAC9DI,OAAOyhC,EAAe3gC,IAAI,SAAC2F,OAAE3I,EAAA2I,EAAA3I,KAAW,OAAGA,KAAIA,EAAEqP,KAAM,IAAM5B,mBAAmBzN,GAAO8B,IAAK9B,MAC5FkC,OAAO8I,EAAOi0B,eACbj/B,KAAM,aACN8B,IAAK,WACLuN,KAAMrE,EAAOi0B,mBAEd/8B,OAAO5D,OAAAyxB,EAAA,EAAAzxB,CAAe0M,KACrBhL,KAAMqqB,EAAA,0BAAMA,EAAA,mBAAG1X,UAAU,eAAc2C,cAAa,iCACpDxT,IAAK,OACLuN,KAAS/Q,OAAAyxB,EAAA,EAAAzxB,CAA2BolC,MAAqB,aAAa14B,EAAOF,GAAE,cAGnFuxB,UAAW18B,EAAS,IAAI8N,mBAAmB9N,EAAOK,MAAQ,MAE5DqqB,EAAA,qBAAK1X,UAAU,oBAGb0X,EAAA,qBAAK1X,UAAU,yCACb0X,EAAA,qBAAK1X,UAAU,yDACb0X,EAAA,qBAAK1X,UAAU,yDACb0X,EAAA,qBAAK1X,UAAU,mCACb0X,EAAA,qBAAK1X,UAAU,wCACZ9H,EACCwf,EAAA,cAACoX,GAAS52B,KAAMA,EAAMG,OAAQA,IAC/BrL,EACC0qB,EAAA,cAACyT,GAAiB9yB,OAAQA,EAAQrL,OAAQA,IAC1C0qB,EAAA,cAACwU,GAAU7zB,OAAQA,KAEvBqf,EAAA,qBAAK1X,UAAU,yBACb0X,EAAA,qBAAK1X,UAAU,wCACb0X,EAAA,qBAAK1X,UAAU,6CACb0X,EAAA,cAAC2Z,EAAA,GAAYnU,cAAe,eAWlDiT,EAzHA,CAAgCzY,EAAA,2BCpB1B,SAAA4Z,IACJ,OAAO5Z,EAAA,qBAAK1X,UAAU,8BACpB0X,EAAA,cAAC6R,GACCna,MAAOpa,EAAA,EAAIU,YAAYgE,OACvB8vB,gBAAgB,GAChBC,OAASp8B,KAAM,iBAAkBqP,KAAM,MACvCgtB,UAAW,MAEbhS,EAAA,qBAAK1X,UAAU,oBACb0X,EAAA,qBAAK1X,UAAU,yCACb0X,EAAA,qBAAK1X,UAAU,yDACb0X,EAAA,cAAC6Z,EAAA,EAAW,0CCGtB,IAAAC,EAAA,SAAAr8B,GACE,SAAAs8B,EAAYzhC,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACHkE,OAAQ,KACRypB,WAAW,KA4BjB,OAjCkCjsB,EAAA,EAAA47B,EAAAt8B,GAShCs8B,EAAA7lC,UAAA86B,mBAAA,eAAArxB,EAAAnC,KACEA,KAAKU,OAAOid,MAAMlL,EAAA,GACfvC,KAAK,WAAI,OAAA/N,EAAK6Z,UAAU4S,WAAW,OAGlC2P,EAAA7lC,UAAAgI,KAAN,wHACQmY,EAAWpgB,OAAAmW,EAAA,EAAAnW,CAAiBoW,SAASC,QAAkB,WACnC,EAAMrW,OAAA+lC,EAAA,EAAA/lC,CAAYogB,KAA7B,mBAAW/V,EAAAC,EAAAC,oBAA8BF,EAAA,6BAAlDqC,EAAMrC,EACZ9C,KAAKgc,UAAU7W,OAAMA,cAGvBo5B,EAAA7lC,UAAAujB,OAAA,WACE,OAAOuI,EAAA,qBAAK1X,UAAU,iBACnB9M,KAAKiB,MAAM2tB,UACVpK,EAAA,cAACyM,EAAA,EAAO,MACRjxB,KAAKiB,MAAMkE,OACTqf,EAAA,cAACwY,GACC73B,OAAQnF,KAAKiB,MAAMkE,OACnB04B,iBAAkB79B,KAAKlD,MAAM+gC,mBAC/BrZ,EAAA,cAAC4Z,EAAe,MAEpB5Z,EAAA,cAACia,EAAA,EAAoB,QAG3BF,EAjCA,CAAkC/Z,EAAA,qMCnB5Bka,EAAgB58B,EAAA,EAAI+R,eAAerB,YAmBzCmsB,EAAA,SAAA18B,GACE,SAAA28B,EAAY9hC,GAAZ,IAAAqF,EACEF,EAAArJ,KAAAoH,KAAMlD,IAAMkD,YACZmC,EAAKlB,OACH49B,eAAe,KAiBrB,OArBwCl8B,EAAA,EAAAi8B,EAAA38B,GAQtC28B,EAAAlmC,UAAA86B,mBAAA,eAAArxB,EAAAnC,KACE0+B,EAAcxuB,KAAK,WACjB/N,EAAK6Z,UAAU6iB,eAAe,MAC7BlhB,MAAM,SAAAP,GACP3kB,OAAAga,EAAA,EAAAha,CAAU2kB,MAIdwhB,EAAAlmC,UAAAujB,OAAA,WACE,OAAOjc,KAAKiB,MAAM49B,cAChBra,EAAA,cAACsa,EAAA,GAAajB,iBAAkB79B,KAAKlD,MAAM+gC,mBAC3CrZ,EAAA,uBAAGA,EAAA,cAACyM,EAAA,EAAO,wCAEjB2N,EArBA,CAAwCpa,EAAA,WClBxC/kB,EAAA,EAAIs/B,WAAUp8B,EAAA,KAAOlD,EAAA,EAAIs/B,WAAeC","file":"kedappcourseviewer.min.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \tvar installedChunks = {\n \t\t4: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp_name_\"] = window[\"webpackJsonp_name_\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([84,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = React;","\nexport function capitalizeFirst (str) {\n    for (let i=0, l=str.length; i<l; ++i) {\n        if (str.charCodeAt(i) < 0x2000) {\n            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);\n        }\n    }\n    return str;\n}\n\nexport function extend(obj, extension) {\n    if (typeof extension !== 'object') return obj;\n    Object.keys(extension).forEach(key => {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\n\nexport function clone<T,E> (obj : T, extension?: E) {\n    let clone = {};\n    Object.getOwnPropertyNames(obj).forEach(key => {\n        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));\n    });\n    if (extension) extend(clone, extension);\n    return clone as (T & E);\n}\n\nconst concat = [].concat;\nexport function flatten<T> (a : (T | T[])[]) {\n    return concat.apply([], a) as T[];\n}\n\nexport function compareProp(prop:string) {\n    return (a,b) => {\n        const aProp = a[prop], bProp = b[prop];\n        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;\n    }\n}\n\nexport function compareProps(props: string | string[], locales?: string | string[], options?: Intl.CollatorOptions) {\n    props = Array.isArray(props) ? props : [props];\n\n    const localeCompare = (a,b) =>\n        typeof a === 'string' ?\n            a.localeCompare(b, locales, options) :\n            a < b ? -1 : a > b ? 1 : 0;\n\n    return props\n        .map(prop => (a,b) => localeCompare(a[prop], b[prop]))\n        .reduce((cmp1, cmp2) =>\n            (a,b) => cmp1(a,b) || cmp2(a,b));\n}\n\nexport function L(text, ...args) {\n    let first = text[0];\n    return buildMessage(text, args);\n}\n\nfunction buildMessage (text, args) {\n    let rv = text[0];\n    for (let i=1, l=text.length; i<l; ++i) {\n        rv += args[i-1] + text[i];\n    }\n    return rv;\n}\n\nexport class TC<T> {\n    constructor(template: T) {\n        extend(this, template);\n    }\n}\n\nexport function dateTimeReviver (key, value) {\n    var a;\n    if (typeof value === 'string') {\n        a = /\\/Date\\((\\d*)\\)\\//.exec(value);\n        if (a) {\n            return new Date(+a[1]);\n        }\n    }\n    return value;\n}\n\nexport function showInfo (msg) {\n    var event = new CustomEvent('info', { 'detail': msg });\n    window.dispatchEvent(event);\n}\n\nexport function showError (errMsg: string | Error) {\n    const msg = typeof errMsg === 'string' ? errMsg : errMsg.message;\n    var event = new CustomEvent('customerror', { 'detail': msg });\n    console.error(errMsg);\n    window.dispatchEvent(event);\n}\n\nexport function maxLength(str: string, maxLen: number) {\n    return str.length > maxLen ?\n        str.substr(0, maxLen - 3) + \"...\" :\n        str;\n}\n\nexport function arrayToLookup<T>(a: T[], keyAccessor: (item: T) => string | number) {\n    const result : {[key: string] : T[]} = {};\n    for (let i=0, l=a.length; i<l; ++i) {\n        const item = a[i];\n        const key = keyAccessor(item);\n        let array = result[key];\n        if (array) array.push(item);\n        else result[key] = [item];\n    }\n    return result;\n}\n\nexport function arrayToMap<T>(a: T[], keyAccessor: (item: T) => string | number) {\n    const result : {[key: string] : T} = {};\n    for (let i=0, l=a.length; i<l; ++i) {\n        const item = a[i];\n        const key = keyAccessor(item);\n        result[key] = item;\n    }\n    return result;\n}\n\nexport function cherryPickProps<T> (obj: T, propsToPick: string[]): Partial<T> {\n    const result = {};\n    for (const param of propsToPick) {\n      if (param in obj) result[param] = obj[param];\n    }\n    return result as Partial<T>;\n}\n\nexport function distinct<T> (a: T[], keyAccessor: (item: T) => any) {\n    const map = arrayToMap(a, keyAccessor);\n    return Object.keys(map).map(key => map[key]);\n}\n","\nexport const KED_NAMESPACE = \"KED\";\n\ndeclare var KED: any;\n\nvar result = typeof KED === 'undefined' ? {} : KED;\n\nif (typeof window !== 'undefined' && typeof KED === 'undefined') {\n    window[KED_NAMESPACE] = result;\n}\n\nexport default result;\n","import {User, LearningModuleTasks} from '../contracts/ked-models';\nimport { KedBackendClient, BearerProvider } from 'kedbackend/client';\nimport {UserTask} from 'kedbackend/models';\nimport {KedRepo} from '../repos/ked-repo';\nimport {EdsClient} from '../apis/edsclient';\nimport KED from './ked';\n\nexport interface Env {\n    currentUser?: User;\n    learningModuleTasks?: LearningModuleTasks;\n    bearerProvider?: BearerProvider;\n    googleTokenProvider?: BearerProvider;\n    kedBackendClient?: KedBackendClient;\n    edsClient?: EdsClient;\n    userTasksRepo?;\n    hiddenCoursesRepo?;\n}\n\nif (!KED.env) KED.env = {};\n\nexport default KED.env as Env;\n","import moment from 'moment';\nimport { localMoment } from '../../globals/moment-sv-locale';\n\ntype Moment = moment.Moment;\n\nexport class WeekPlannerPersistedState {\n  static EXPIRATION_HOURS = 12;\n  static VERSION = 2;\n\n  user: string;\n  lastWrite: number;\n  weekDate: number;\n  openCourses: { [path: string]: boolean }\n\n  constructor (userOrCopy: string | WeekPlannerPersistedState) {\n    if (typeof userOrCopy === 'string') {\n      this.user = userOrCopy;\n      this.lastWrite = Date.now();\n      this.weekDate = localMoment().startOf('week').valueOf();\n      this.openCourses = {};\n    } else {\n      Object.assign(this, userOrCopy);\n    }\n  }\n\n  static async load(user: string) {\n    const cookie = localStorage.getItem('WeekPlannerPersistedState2');\n    const storedData = cookie && (JSON.parse(cookie) as WeekPlannerPersistedState);\n    const state = new WeekPlannerPersistedState(user);\n    if (storedData) Object.assign(state, storedData);\n\n    return state.user === user && !state.isExpired(moment()) ?\n      state : new WeekPlannerPersistedState(user);\n  }\n\n  async save() {\n    this.lastWrite = Date.now();\n    const json = JSON.stringify(this);\n    localStorage.setItem('WeekPlannerPersistedState2', json);\n  }\n\n  isExpired (asOf: Moment) {\n      return moment(this.lastWrite)\n        .isBefore(\n            asOf.add(\n                0-WeekPlannerPersistedState.EXPIRATION_HOURS, 'hours')\n        );\n  }\n}\n","import {KedRepo} from './ked-repo';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport env from '../globals/KED.env';\nimport { WeekPlannerPersistedState } from \"../components/weekplanner/weekplanner-persisted-state\";\nimport moment from 'moment';\nimport { createUUID, DocumentAccess } from 'kedbackend/client';\nimport { getAdjustedWeek, KEDWeek } from '../utils/weekutil';\n\nexport let userTasksRepo = env.userTasksRepo as UserTasksRepo;\n\nclass UserTasksRepo extends KedRepo<UserTask> {\n  persistedState: WeekPlannerPersistedState | null;\n\n  constructor() {\n    super({\n      getClient() { return env.kedBackendClient; },\n      optimistic: true,\n      table: \"usertasks\",\n      user: env.currentUser ? env.currentUser.mail : \"\",\n      getQueryOptions: async () => {\n        const userEmail = env.currentUser ? env.currentUser.mail : \"\";\n        if (!this.persistedState)\n          this.persistedState = await WeekPlannerPersistedState.load(userEmail);\n        const { weekDate } = this.persistedState;\n        const weekNumber = moment(weekDate).week();\n        const kedWeek = KEDWeek(moment(weekDate).year(), weekNumber);\n        /*const [from, to] = [moment(weekDate).startOf('week'), moment(weekDate).endOf('week')]\n          .map(m => m.toDate().getTime());*/\n        \n          return {\n            from: kedWeek.notBefore,\n            to: kedWeek.notAfter,\n            role: \"USER\",\n            include: [\"task\", \"course\"],\n            flags: [\"includeIdsOnly\"],\n          };\n        }\n    });\n    this.persistedState = null;\n  }\n\n  async updatePersistedState(stateChanges: Partial<WeekPlannerPersistedState>) {\n    Object.assign(this.persistedState, stateChanges);\n    await this.persistedState.save();\n    this.mem.notifySubscribers();\n  }\n\n  async setTaskDoneState(userTask: UserTask, done: boolean) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    const modifiedItem = Object.assign({}, userTask, {done});\n    if (optimistic) await this.mem.update(Object.assign({}, modifiedItem, {$meta: 'updating'}));\n    // Now make sure to change the state for other weeks as well:\n    const similarTasks = await client.list<UserTask>('usertasks', {\n      name: userTask.name,\n      role: \"USER\",\n      include: [\"task\",\"course\"],\n      flags: [\"includeIdsOnly\"],\n      from: moment(this.persistedState.weekDate).add(-3, 'weeks').valueOf(),\n      to: moment(this.persistedState.weekDate).add(3, 'weeks').valueOf()\n    }, {\n      cache: 'no-cache'\n    });\n    const identicalTasks = similarTasks.filter(t =>\n      t.courseName === userTask.courseName &&\n      t.learningGoal === userTask.learningGoal &&\n      (!userTask.task || t.task.map(t=>t.id).join('') === userTask.task.map(t=>t.id).join('')) &&\n      (!userTask.course || t.course.map(c=>c.id).join('') === userTask.course.map(c=>c.id).join('')));\n    await this.update(identicalTasks, t => t.done = done);\n  }\n\n  async setSubTaskDoneState (userTask: UserTask, subTaskId: string, done: boolean) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    await this.update([userTask],\n      t => t.subTasks && t.subTasks.filter(st => st.id === subTaskId)\n        .forEach(st => st.done = done));\n  }\n\n  async setWeekPlannerBoxOpen(courseName: string, isOpen: boolean) {\n    const openCourses = { ...this.persistedState.openCourses };\n    if (isOpen)\n      openCourses[courseName] = true;\n    else\n      delete openCourses[courseName];\n    await this.updatePersistedState({openCourses});\n  }\n\n  async changeWeek(weekDate: Date) {\n    let persistedState = this.persistedState;\n    if (!persistedState) {\n      persistedState = await WeekPlannerPersistedState.load(env.currentUser.mail);\n    }\n    const newPersisted = new WeekPlannerPersistedState(persistedState);\n    newPersisted.weekDate = moment(weekDate).startOf('week').valueOf();\n    newPersisted.save();\n    this.persistedState = newPersisted;\n    await this.mem.refreshFromServer();\n  }\n\n  subscribe(subscriber: (userTasks: UserTask[], persistedState: WeekPlannerPersistedState, weekTextsUT: UserTask) => void) {\n    const proxySubscriber = (userTasks: UserTask[]) => {\n      subscriber(\n        userTasks.filter(ut => !ut.weekTexts),\n        this.persistedState,\n        userTasks.filter(ut => !!ut.weekTexts)[0] || {\n          id: createUUID(),\n          dateTime: this.persistedState.weekDate,\n          weekTexts: {assessment:'', strategy:''},\n          acl: [\n            // Default ACL: Let user self have full control over this item:\n            new DocumentAccess(\"email\", env.currentUser.mail, \"S\"),\n            // Additional ACL: Let employees on same school have read access to it.\n            // This currently only applies to tasks that refer to course tasks (not own tasks!)\n            new DocumentAccess(\"schoolRole\", `${env.currentUser.school}/EMPLOYEE`, \"R\")\n          ].map(ac => ac.toString())\n        });\n    };\n    proxySubscriber[\"subscriber\"] = subscriber;\n    this.mem.subscribe(proxySubscriber);\n  }\n\n  unsubscribe(subscriber: (userTasks: UserTask[], persistedState: WeekPlannerPersistedState, weekTextsUT: UserTask) => void) {\n    this.mem.subscribers = this.mem.subscribers.filter (s => s[\"subscriber\"] !== subscriber);\n  }\n  \n}\n\nif (!userTasksRepo) {\n  userTasksRepo = env.userTasksRepo = new UserTasksRepo();\n  userTasksRepo.mem.ensureHasData();\n}\n","module.exports = jQuery;","import KED from './KED';\n\n/* This default configuration is used as a fallback.\nNormally both test pages and production pages will override these configrations\n*/\n/*const defaultConfiguration = {\n  // Environment\n  ENVIRONMENT: 'development' as 'production' | 'development' | 'test',\n  // Authentication Server:\n  KED_TOKEN_URL: 'https://kedauthtest.azurewebsites.net/token',\n  KED_TOKEN_PATH: '/api/token.Skript.portlet?sv.contenttype=application/json',\n  KED_CLIENT_ID: 'devclient',\n  KED_CLIENT_SECRET: '4fRdfQpWtJqjTWf',\n  // Services:\n  KED_API_URL: 'https://kedbackendtest.azurewebsites.net/api/',  \n  EDS_API_URL: 'https://edsportalowinapi.azurewebsites.net/api/'\n}*/\n\nexport interface IKedConfiguration {\n  ENVIRONMENT: 'production' | 'development' | 'test';\n  KED_TOKEN_URL: string;\n  KED_TOKEN_PATH: string;\n  KED_CLIENT_ID: string;\n  KED_CLIENT_SECRET: string;\n  KED_API_URL: string;\n  EDS_API_URL: string;\n};\n\nif (!KED.cfg) KED.cfg = {};\n\nexport default KED.cfg as IKedConfiguration;\n","export interface ParseQueryStringOptions {\n  toLower?: boolean;\n}\n\nexport function parseQueryString(locationSearch: string, options?: ParseQueryStringOptions): { [key: string]: string } {\n  const {toLower} = (options || {}) as ParseQueryStringOptions;\n  const result = {};\n  if (locationSearch && locationSearch.length > 1)\n    locationSearch.substr(1)\n      .split('&')\n      .map(part => part.split('=').map(s => decodeURIComponent(s.trim())))\n      .forEach(([key, value]) => result[toLower ? key.toLowerCase() : key] = value);\n  return result;\n}\n\nfunction encodeParams(params: {[key: string]:string}) {\n  return Object.keys(params).map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`).join('&');\n}\n\nexport function generateQueryString(params: {[key: string]:string}) {\n  return \"?\" + encodeParams(params);\n}\n\nexport function parseHashQueryString(locationHash: string, options?: ParseQueryStringOptions) {\n  return parseQueryString(locationHash, options);\n}\n\nexport function generateHashQueryString(params: {[key: string]:string}) {\n  return \"#\" + encodeParams(params);\n}\n\nexport function splitUrlAndQuery (urlWithPossibleQuery: string) {\n  const pQuery = urlWithPossibleQuery.indexOf('?');\n  return pQuery >= 0 ?\n    [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :\n    [urlWithPossibleQuery, \"\"];\n}\n","import moment from 'moment';\nimport { L } from '../../utils/utils';\nimport { Document, Resource, ModificationTracked, Course, Task } from 'kedbackend/models';\nimport { BatchRunner, createUUID } from 'kedbackend/client';\nimport update from 'react-addons-update';\nimport { User } from '../../contracts/ked-models';\nimport $ from 'jquery';\nimport env from '../../globals/KED.env';\n\nexport function updateDocumentGraphs(oldDoc, newDoc, table: string, graphs: { [label: string]: string }, batch: BatchRunner) {\n  const docUpdates = {};\n  const docId = newDoc.id;\n  for (let navProp of Object.keys(graphs)) {\n    const foreignTable = graphs[navProp];\n    const oldList: Document[] = oldDoc[navProp] || [];\n    const newList: Document[] = newDoc[navProp];\n    if (!newList) continue;\n    const tuples = newList\n      .map((doc, idx)=>({doc, idx})); // Create tubles of {doc, array-index} so we can update result\n    const added = tuples.filter(tuple => !oldList.some(o => o.id === tuple.doc.id)); // Find added items\n\n    for (let a of added) {\n      const mutatedSubDoc = {...a.doc};\n      const meta = mutatedSubDoc.$meta;\n      delete mutatedSubDoc.$meta; // Delete $meta so that \"add\" or \"update\" does not persiste to next state.\n      if (meta === 'add') {\n        if (!mutatedSubDoc.id) mutatedSubDoc.id = createUUID(); // Generate ID if not done yet.\n        // Now put an 'add' mutation in the batch queue.\n        batch.add(foreignTable, mutatedSubDoc);\n      } else if (meta === 'update') {\n        batch.put(foreignTable, mutatedSubDoc);\n      }\n      batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);\n\n      // Update result so that state is reflected after succesful POST to server.\n      if (!docUpdates[navProp]) docUpdates[navProp] = {};\n      docUpdates[navProp][a.idx] = {$set: mutatedSubDoc};\n    }\n    const removed = oldList.filter(o => !newList.some(n => n.id === o.id));\n    for (let r of removed) {\n      batch.unlink(table, docId, foreignTable, r.id, navProp);\n    }\n    const updated = tuples.filter(tuple => oldList.some(o => o.id === tuple.doc.id && tuple.doc.$meta === 'update'));\n    for (let u of updated) {\n      const mutatedSubDoc = {...u.doc};\n      delete mutatedSubDoc.$meta;\n      batch.put(foreignTable, mutatedSubDoc);\n\n      // Update result so that $meta is removed from navigation prop after successful POST to server.\n      if (!docUpdates[navProp]) docUpdates[navProp] = {};\n      docUpdates[navProp][u.idx] = {$set: mutatedSubDoc};\n    }\n  }\n  return update(newDoc, docUpdates);\n}\n\nexport function dtFormat(dateTime: number | Date | moment.Moment) {\n  return moment(dateTime).format('YYMMDD HH:mm');\n}\n\nexport function shortDateFormat(dateTime: number | Date | moment.Moment) {\n  return moment(dateTime).format('YYMMDD');\n}\n\nexport function updateModificationStamp (now: number, obj: ModificationTracked, user: User) {\n  return update(obj, {\n    dateTime: {$set: now}, // For queries...\n    modifiedDate: {$set: now},\n    modifiedBy: {\n      $set: {\n        name: user.displayName,\n        url: \"mailto:\" + user.mail\n      }\n    }\n  });\n}\n\nexport function updateCreationStamp (now: number, obj: ModificationTracked, user: User) {\n  return update(obj, {\n    createdDate: {$set: Date.now()},\n    createdBy: {\n      $set: {\n        name: user.displayName,\n        url: \"mailto:\" + user.mail\n      }\n    }\n  });\n}\n\nexport function updateModificationAndCreationStamps(obj: ModificationTracked, user: User) {\n  const now = Date.now();\n  obj = updateModificationStamp(now, obj, user);\n  if (!obj.createdBy) obj = updateCreationStamp(now, obj, user);\n  return obj;\n}\n\nexport function applyEtags(doc: Document, newEtags: {[id: string]: string}, graphs: string[]) {\n  const res = {...doc};\n  const etag = newEtags[doc.id];\n  if (etag)\n    res.$etag = etag;\n  for (let label of graphs) {\n    const newList = doc[label].map(d => applyEtags(d, newEtags, []));\n    res[label] = newList;\n  }\n  return res;\n}\n\nexport function readBlob(blob: Blob, m: (r:FileReader)=>void) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = ev => resolve((ev.target as any).result);\n    reader.onabort = ev => reject(new Error(\"file read aborted\"));\n    reader.onerror = ev => reject((ev.target as any).error);\n    m(reader);\n  });\n}\n\nexport function readBlobAsText (blob: Blob) {\n  return readBlob(blob, r=>r.readAsText(blob));\n}\n\nexport function readBlobAsDataUrl (blob: Blob) {\n  return readBlob(blob, r=>r.readAsDataURL(blob));\n}\n\nexport function allowCopy(e: React.DragEvent<HTMLDivElement>) {\n  e.stopPropagation();\n  e.preventDefault();\n  e.dataTransfer.dropEffect = 'copy';\n}\n\nexport function updateCourseBuilderStatus(status: 'unsaved' | 'saved' | 'error' | '') {\n  const div = $('div.course-builder')[0];\n  if (div) div.className = \"course-builder\" + (status ? \" status \" + status : \"\");\n}\n\nexport async function loadCourse(id: string, options?: {\n    includeTemplateChain?: boolean\n  }): Promise<Course>\n{\n  const client = env.kedBackendClient;\n  const includeTemplateChain = options && options.includeTemplateChain;\n  const [course, courseTasks, templateChain] = (await Promise.all([\n    client.get(\"courses\", id, {\n      include: [\n        \"centralContent\",\n        \"knowledgeRequirements\",\n        \"abilities\",\n        \"images\",\n        \"acl\" // Don't include tasks here...\n      ]\n    }),\n    // ... but include tasks here instead so that we can load the graphs for the\n    // tasks as well!\n    client.list(\"tasks\", {\n      hasEdgesFrom: id,\n      include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],\n      flags: ['includeIdsOnly'] // Don't need redundant info that's already on course\n    }),\n    includeTemplateChain && client.list(\"courses\", {\n      hasEdgesFrom: id,\n      flags: ['idsOnly']\n    })\n  ])) as [Course, Task[], Course[]];\n  course.tasks = courseTasks;\n\n  // Correct the order of KnowledgeRequirements\n  if (course.knowledgeRequirementsOrder) {\n    course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(id =>\n      course.knowledgeRequirements.find(c => c.id === id));\n  }\n\n  // Correct the order of CentralContent\n  if (course.centralContentOrder) {\n    course.centralContent = course.centralContentOrder.map(id =>\n      course.centralContent.find(cc => cc.id === id));\n  }\n  \n  // Include template chain if requested.\n  if (includeTemplateChain) course.templateChain = templateChain;\n  return course;\n}\n\n","import { User } from \"../contracts/ked-models\";\n\nexport default function getUserClaims (user: User) {\n  return [{\n    type: \"email\",\n    value: user.mail\n  },{\n    type: \"school\",\n    value: user.school\n  }].concat(user.roles.map(role => ({\n    type: \"role\",\n    value: role\n  }))).concat(user.roles.map(role => ({\n    type: \"schoolRole\",\n    value: user.school + \"/\" + role\n  })));\n}\n","import { AccessClaim, DocumentAccess, hasAccess as _hasAccess, AccessRight } from 'kedbackend/client';\nimport { Document } from 'kedbackend/models';\nimport getUserClaims from './get-user-claims';\nimport env from '../globals/KED.env';\nimport { parseQueryString, generateQueryString } from \"../utils/query-string\";\nexport { getUserClaims };\n\nexport const IMPERSONATION_QUERY_PARAMS = [\"user\",\"role\",\"school\",\"debug\",\"testVersion\",\"testversion\",\"schoolType\",\"schooltype\"];\n\nexport function hasAccess(doc: Document, requestedRight: AccessRight) {\n  var claims = getUserClaims(env.currentUser);\n  var result = _hasAccess(DocumentAccess.fromStringArray(doc.acl || []), claims, requestedRight);\n  //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);\n  return result;\n}\n\nexport function hasReadAccess(doc: Document) {\n  return hasAccess(doc, 'R');\n}\n\nexport function hasWriteAccess(doc: Document) {\n  return hasAccess(doc, 'W');\n}\n\nexport function hasShareAccess(doc: Document) {\n  return hasAccess(doc, 'S');\n}\n\nexport function isTeacherAtSchool(school: string) {\n  const isTeacher = env.currentUser.roles.some(role => role === 'EMPLOYEE' || role === 'ADMIN');\n  const belongsToSchool = (school||\"\").toLowerCase() === env.currentUser.school.toLowerCase();\n  return (isTeacher && belongsToSchool);\n}\n\nexport const impersonationEnv = {\n  actAs (options: {role, school, url?}) {\n    const {role, school, url} = options;\n    const currentQuery = parseQueryString(location.search);\n    const newQuery = {...currentQuery, role, school};\n    const newQueryString = generateQueryString(newQuery);\n    if (url) {\n      location.href = `${url}${newQueryString}`;\n    } else {\n      location.hash = \"#\";\n      location.search = newQueryString;\n    }\n  }\n}\n\nexport function actAs(options: {role, school, url?}) {\n  impersonationEnv.actAs(options);\n}\n\nexport function preserveImpersonationQuery (url: string, query: {[name: string] : string}) {\n  const currentQuery = parseQueryString(location.search);\n  const newQuery = {...query};\n  for (const param of IMPERSONATION_QUERY_PARAMS) {\n    if (currentQuery[param]) newQuery[param] = currentQuery[param];\n  }\n  const newQueryString = generateQueryString(newQuery);\n  return `${url}${newQueryString}`;\n}\n","import * as React from 'react';\n\nexport const Spinner = ()=> <span><i className=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i>&nbsp;</span>;\n","\nexport function createUUID() {\n  // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript\n  var d = Date.now();\n  var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    var r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n  });\n  return uuid;\n}\n\nexport function avoidSimultanousCalls<T,A>(method: (...args:A[])=>Promise<T>) : (...args:A[])=>Promise<T> {\n  let ongoingPromise: Promise<T> = null;\n  return function() {\n      if (!ongoingPromise) {\n          ongoingPromise = method.apply(this, arguments).then(result=>{\n              ongoingPromise = null;\n              return result;\n          });\n      }\n      return ongoingPromise;\n  }\n}\n","import moment from 'moment';\nimport { Term, AcademicYear } from '../contracts/ked-models';\n\nexport interface SchoolMoment {\n  academicYear: AcademicYear;\n  term: Term;\n  week?: number;\n}\n\nexport function getFirstAndLastWeekOfTerm(term: Term) {\n  return term === 'AT' ?\n    [32, 51] :\n    [1, 25];\n}\n\nexport function getTermStartAndEnd(now: moment.Moment) : moment.Moment[] {\n  return now.month() >= 7 ? // 7 = August in JS Dates and in moment as well!\n    [moment(new Date(now.year(), 7, 1)), moment(new Date(now.year(), 11, 31))] : // aug1 - dec31\n    [moment(new Date(now.year(), 0, 1)), moment(new Date(now.year(), 6, 31))]; // jan1 - july31\n}\n\nexport function getSchoolMoment(m: moment.Moment): SchoolMoment {\n  const thisYear = m.year();\n  const isAutumn = m.month() >= 7;\n  const [autumnYear, springYear] = isAutumn ?\n    [thisYear, thisYear + 1] :\n    [thisYear - 1, thisYear];\n  const academicYear = '' + autumnYear + '/' + springYear;\n  const term = isAutumn ? 'AT' : 'ST';\n  const week = m.week();\n  return { academicYear, term, week };\n}\n\nexport function addYear(aYear: AcademicYear, numYearsToAdd: number): AcademicYear {\n  return aYear.split('/')\n    .map(yearStr => parseInt(yearStr) + numYearsToAdd)\n    .map(year => '' + year)\n    .join('/');\n}\n\nexport function nextAcademicYear(aYear: AcademicYear): AcademicYear {\n  return addYear(aYear, 1);\n}\n\nexport function prevAcademicYear(aYear: AcademicYear): AcademicYear {\n  return addYear(aYear, -1);\n}\n","import {BearerPersistentStorage, BearerTokenInfo} from '../ked-backend-client';\n\nexport class BearerStorageSessionStorage implements BearerPersistentStorage {\n    save(id: string, tokenInfo: BearerTokenInfo) {\n        sessionStorage.setItem(\"bearer-\" + id, JSON.stringify(tokenInfo));\n    }\n\n    load(id: string): Promise<BearerTokenInfo> {\n        try {\n            const json = sessionStorage.getItem(\"bearer-\" + id);\n            return Promise.resolve(json ? JSON.parse(json) : {token: null, expires: 0});\n        } catch (ex) {\n            return Promise.resolve({token: null, expires: 0});\n        }\n    }\n}\n","import { Task } from '../../KED.Backend.API/schema';\n\nexport default function migrateTask(task: Task) {\n    if (!task.resources) task.resources = [];\n}\n","import * as model from '../../KED.Backend.API/schema';\nimport migrateCourse from './migrate-course';\nimport migrateTask from './migrate-task';\n\nexport default function migrate(doc, table: string, graphs?: string[]) {\n  switch (table) {\n    case \"courses\":\n      migrateCourse(doc, graphs);\n      break;\n    case \"tasks\":\n      migrateTask(doc);\n      break;\n  }\n}\n","import { Course } from '../../KED.Backend.API/schema';\nimport migrateTask from './migrate-task';\n\nexport default function migrateCourse(course: Course, graphs?: string[]) {\n  if (!course.modules) course.modules = [];\n  course.modules.forEach(module => {\n    if (!module.resources) {\n      module.resources = [];\n    }\n    if (!module.taskIds) {\n      module.taskIds = [];\n    }\n  });\n\n  if (!course.responsibleTeachers) {\n    course.responsibleTeachers = []\n  }\n\n  // Earlier wrong spelling of resources\n  if ('resourses' in (course as any) && !('resources' in (course as any))) {\n    course.resources = (course as any).resourses;\n    delete (course as any).resourses;\n  }\n  if (!course.resources) {\n    course.resources = [];\n  }\n\n  if (graphs) {\n    graphs.forEach(label => {\n      switch (label) {\n        case 'tasks':\n          course.tasks.forEach(task => migrateTask(task));\n          break;\n      }\n    });\n  }\n}\n","import { KedBackendClient } from '../ked-backend-client';\nimport migrate from './migrate';\n\nexport const KedModelMigratorMixin = (client: KedBackendClient) => {\n    if ((client as any).__migrator_mixed_in) return;\n    (client as any).__migrator_mixed_in = true;\n    \n    const get = client.get;\n    const list = client.list;\n\n    client.get = function (table, id, options) {\n        const include = options && options.include;\n        return get.apply(this, arguments).then(result => {\n            migrate(result, table, include && include.toString().split(','));\n            return result;\n        });\n    }\n\n    client.list = function (table, options) {\n        const include = options && options.include;\n        return list.apply(this, arguments).then(result => {\n            result.forEach(doc => migrate(doc, table, include && include.toString().split(',')));\n            return result;\n        });\n    }\n\n    return client;\n}\n\n","import { KedBackendClient, BearerProvider, BearerTokenInfo, IsomorphicEnv } from '../ked-backend-client';\nimport { BearerStorageSessionStorage } from \"./bearer-storage-sessionstorage\";\nimport { avoidSimultanousCalls } from '../ked-backend-client/utils';\nimport { KedModelMigratorMixin } from '../ked-model-migrator';\nKedModelMigratorMixin(KedBackendClient.prototype);\n\nexport const storage = new BearerStorageSessionStorage();\n\nconst timeOfPageLoad = Date.now();\n\nexport class WebServerBearerProvider implements BearerProvider {\n    tokenInfo: BearerTokenInfo;\n    wantsRedirect: boolean;\n\n    constructor (\n        public tokenPath: string,\n        public tokenResponseMapper: (responseText: string) => BearerTokenInfo,\n        public tokenId: string)\n    {\n        this.tokenInfo = {token: null, expires: 0};\n        this.getBearer = avoidSimultanousCalls(this.getBearer.bind(this));\n        this.refreshBearer = avoidSimultanousCalls(this.refreshBearer.bind(this));\n    }\n\n    async getBearer() {\n        if (!this.tokenInfo.token) {\n            if (this.tokenId) this.tokenInfo = await storage.load(this.tokenId);\n        }\n        if (this.tokenInfo.expires < Date.now()) {\n            await this.refreshBearer();\n        }\n        return this.tokenInfo;\n    }\n\n    async refreshBearer() {\n        const res = await fetch(this.tokenPath, {\n            headers: {Accept: \"text/plain; application/json\"},\n            redirect: 'manual',\n            cache: 'no-cache',\n            credentials: \"same-origin\"\n        });\n        if (res.status === 302 || (!res.status && res.type === \"opaqueredirect\")) {\n            // User session timed out and server wants to redirect entire page to login page\n            // Time to reload current page to force a redirect of the entire page instead for\n            // just redirecting to /api/token or whatever.\n            if (Date.now() - timeOfPageLoad > 60000) {// prohibit endless loop of reloading self.\n                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.\n                console.log(\"Redirect wanted. Reload page.\")\n                window.location.reload(true);\n            }\n        }\n        if (res.status != 200) throw new Error(\"HTTP\"+res.status + \" \" + await res.text());\n        this.tokenInfo = this.tokenResponseMapper(await res.text());\n        storage.save(this.tokenId, this.tokenInfo);\n        return this.tokenInfo;\n    }\n}\n\nexport const isomorphic = {fetch: fetch.bind(self), btoa: btoa.bind(self)};\n\nexport class KedBackendClientWeb extends KedBackendClient {\n    constructor(\n        apiBaseUrl: string,\n        providerOrTokenPath: string | BearerProvider,\n        options?: {\n            tokenResponseMapper?: (responseText: string) => BearerTokenInfo,\n            tokenId?: string\n        })\n    {\n        const bearerProvider = typeof providerOrTokenPath !== 'string' ?\n            providerOrTokenPath :\n            new WebServerBearerProvider(\n                providerOrTokenPath,\n                (options && options.tokenResponseMapper) || (x=>({token: x, expires: Date.now() + 59 * 60 * 60})),\n                options && options.tokenId);\n        super(isomorphic, bearerProvider, apiBaseUrl);\n    }\n}\n","/*\ndeclare var Buffer; // node built-in\n\n\nfunction basicAuthHeader(username, password) {\n    return \"Basic \" + new Buffer(username + \":\" + password).toString(\"base64\");\n}\n*/\n\nimport {IsomorphicEnv} from './isomorphic-env';\nimport { createUUID } from \"./utils\";\n\nexport interface BearerTokenInfo {\n    token: string;\n    expires: number;\n}\n\nexport interface BearerProvider {\n    getBearer(): Promise<BearerTokenInfo>;\n    refreshBearer(): Promise<BearerTokenInfo>;\n    wantsRedirect?: boolean;\n}\n\nexport class RestClient {\n    authHeader?: string;\n    tokenInfo?: BearerTokenInfo;\n    bearerProvider?: BearerProvider;\n    fetchOptions: RequestInit;\n\n    constructor(\n        public isomorphic: IsomorphicEnv,\n        public baseUrl: string,\n        public options: {\n            username?,\n            password?,\n            bearer?,\n            bearerProvider?: BearerProvider\n        },\n    ) {\n        this.fetchOptions = {mode: 'cors'};\n        this.authHeader = options.bearer ?\n            \"Bearer \" + options.bearer :\n            options.username ?\n                \"Basic \" + isomorphic.btoa(options.username + \":\" + (options.password || \"\")) :\n                null;\n        this.bearerProvider = options.bearerProvider || null;\n    }\n\n    async fetch(path: string, method: string, headers, query?, fetchOptions?: RequestInit): Promise<Response> {\n        if (fetchOptions && fetchOptions.cache === 'no-cache') {\n            // Workaround for back-button not respecting cache control in Chrome/Opera.\n            // Append a query parameter to force a cache entry\n            query = {...query, nocache: createUUID()}\n        }\n        const queryStr = query && Object.keys(query).map(key =>\n            encodeURIComponent(key) +\n            \"=\" +\n            encodeURIComponent(query[key]))\n            .join('&');\n\n        let {authHeader, tokenInfo, bearerProvider} = this;\n\n        // {username, password or bearer} not specified in options, but bearerProvider specified:\n        if (!authHeader && !tokenInfo && bearerProvider) {\n            this.tokenInfo = tokenInfo = await bearerProvider.getBearer();\n        }\n        // Either because we've just specified bearerProvider in options, OR, we've got a 401\n        // in earlier response with www-authenticate: Bearer, and we had a BearerProvider,\n        // so we saved the tokenInfo. Now use it regardless of whether username,password or bearer was given\n        // to options in constructor:\n        if (tokenInfo) {\n            if (tokenInfo.expires < Date.now()) {\n                console.log(\"Token expired. Refresh it:\");\n                this.tokenInfo = tokenInfo = await bearerProvider.refreshBearer();\n            }\n            authHeader = \"Bearer \" + tokenInfo.token;            \n        }\n\n        // In one way or another, we've concluded an Authorization header to use:\n        if (authHeader) {\n            headers.Authorization = authHeader;\n        }\n\n        const url = this.baseUrl + path + (queryStr ? \"?\" + queryStr : \"\");\n        let res: Response = await this.isomorphic.fetch(url, { ...this.fetchOptions, headers, method, ...fetchOptions });\n        if (res.status == 401 && this.bearerProvider) {\n            const wwwauth = res.headers.get(\"www-authenticate\");\n            console.log(`Got ${res.status} from ${this.baseUrl + path}`);\n            if (wwwauth && /Bearer/i.test(wwwauth)) {\n                this.tokenInfo = await this.bearerProvider.refreshBearer();\n                headers.Authorization = \"Bearer \" + this.tokenInfo.token;\n                res = await this.isomorphic.fetch(url, { ...this.fetchOptions, headers, method, ...fetchOptions });\n            }\n        }\n        return res;\n    }\n\n    get(path: string, query?, fetchOptions?: RequestInit) {\n        return this.fetch(path, \"GET\", { Accept: \"application/json; text/plain\" }, query, fetchOptions);\n    }\n\n    post(path: string, data, fetchOptions?: RequestInit): Promise<Response> {\n        return this.fetch(path, \"POST\", {\n            \"Content-Type\": \"application/json\",\n            \"Accept\": \"application/json\"\n        }, null, {...fetchOptions, body: JSON.stringify(data)});\n    }\n\n    delete(path: string, query?, body?, fetchOptions?: RequestInit) {\n        return this.fetch(path, \"DELETE\", { Accept: \"application/json; text/plain\" }, query, {...fetchOptions, body});\n    }\n}\n","module.exports = ReactDOM;","\nexport const KED_NAMESPACE = \"KED\";\n\ndeclare var KED: any;\n\nvar result = typeof KED === 'undefined' ? {} : KED;\n\nif (typeof window !== 'undefined' && typeof KED === 'undefined') {\n    window[KED_NAMESPACE] = result;\n}\n\nexport default result;\n","import {BearerProvider, RestClient, BearerTokenInfo} from './restclient';\nimport {IsomorphicEnv} from './isomorphic-env';\nimport {TokenQuery} from './token-query';\nimport {avoidSimultanousCalls} from './utils';\n\nexport interface BearerPersistentStorage {\n    save(id: string, tokenInfo: BearerTokenInfo);\n    load(id: string) : Promise<BearerTokenInfo>;\n}\n\nexport class KedBearerProvider implements BearerProvider {\n    tokenInfo: BearerTokenInfo;\n    client: RestClient;\n    \n    constructor (\n        public isomorphic: IsomorphicEnv,\n        public storage: BearerPersistentStorage,\n        public tokenId:string,\n        public clientId: string,\n        public clientSecret: string,\n        public tokenUrl: string,\n        public tokenQuery: TokenQuery)\n    {\n        this.tokenInfo = {token: null, expires: 0};\n        this.client = new RestClient(isomorphic, \"\", {\n            username: this.clientId,\n            password: this.clientSecret\n        });\n        this.getBearer = avoidSimultanousCalls(this.getBearer.bind(this));\n        this.refreshBearer = avoidSimultanousCalls(this.refreshBearer.bind(this));\n    }\n\n    async getBearer(): Promise<BearerTokenInfo> {\n        const {token, expires} = this.tokenInfo;\n        if (token && expires >= Date.now()) return this.tokenInfo;\n        try {\n            this.tokenInfo = await this.storage.load(this.clientId + \"/\" + this.tokenId);\n            if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now()) return this.tokenInfo;\n            await this.refreshBearer();\n            return this.tokenInfo;\n        } catch (e) {\n            await this.refreshBearer();\n            return this.tokenInfo;\n        }\n    }\n\n    async refreshBearer(): Promise<BearerTokenInfo> {\n        let res: Response;\n        for (let retries=0;retries<6;++retries) {\n            console.log(`Retrieving token for ${this.tokenId}`);\n            res = await this.client.get(this.tokenUrl, this.tokenQuery, {cache: 'reload'});\n            if (res.status !== 200) {\n                console.warn(`Got ${res.status} ${res.statusText}`);\n                continue;\n            }\n            this.tokenInfo = {token: await res.text(), expires: Date.now() + 59 * 60 * 1000};\n            console.log(`Got token for ${this.tokenId}: ${JSON.stringify(this.tokenInfo)}`);\n            this.storage.save(this.clientId + \"/\" + this.tokenId, this.tokenInfo);\n            return this.tokenInfo;\n        }\n        throw new Error(\"Failed to retrieve token for \" + JSON.stringify(this.tokenId));\n    }\n}\n","export interface AccessClaim {\n  type: string;\n  value: string;\n}\n\nexport type AccessRight = 'R' | 'W' | 'S';\n\nexport class DocumentAccess {\n  constructor(\n    public accessClaimType: string,\n    public accessClaimValue: string,\n    public right: AccessRight\n  ) { }\n\n  static fromString(ac: string) {\n    if (!ac) return null;\n    var split = ac.split(':');\n    if (split.length < 3) throw new Error(\"Invalid access string: \" + ac);\n    var claimType = DocumentAccess.unescape(split[0]);\n    var claimValue = DocumentAccess.unescape(split[1]);\n    var right = split[2];\n    if (right !== 'R' && right !== 'W' && right !== 'S')\n      throw new Error(\"Invalid access string: \" + ac);\n    return new DocumentAccess(\n      claimType,\n      claimValue,\n      right);\n  }\n\n  static escape(accessComponent: string) {\n    return accessComponent.replace(/\\%/g, \"%25\").replace(/\\:/g, \"%3A\");\n  }\n\n  static unescape(accessComponent: string) {\n    return accessComponent.replace(/\\%3A/g, \":\").replace(/\\%25/g, \"%\");\n  }\n\n  toString() {\n    return DocumentAccess.escape(this.accessClaimType) + \":\" +\n      DocumentAccess.escape(this.accessClaimValue) + \":\" +\n      this.right;\n  }\n\n  static fromStringArray(acl: string[]) {\n    return acl\n      .map(ac => DocumentAccess.fromString(ac))\n      .filter(ac => ac);\n  }\n\n  static toStringArray(acl: DocumentAccess[]) {\n    return acl.map(ac => ac.toString());\n  }\n}\n\nexport function hasAccess(acl: DocumentAccess[], userClaims: AccessClaim[], requestedRight: AccessRight) {\n  if (userClaims.some(claim => claim.type === 'role' && claim.value === \"ADMIN\"))\n    return true;\n\n  return acl.some(a =>\n    userClaims.some(c =>\n      a.accessClaimType === c.type &&\n      a.accessClaimValue === c.value && (\n        (a.right === 'R' && requestedRight === 'R') ||\n        (a.right === 'W' && ['R','W'].indexOf(requestedRight) >= 0) ||\n        (a.right === 'S'))));\n}\n","\nexport class HttpError extends Error {\n    constructor (public code: number, public message: string) {\n      super(\"HTTP\" + code + \" \" + message)\n      this.name = \"http\" + code;\n    }\n}\n","import {RestClient, BearerProvider, BearerTokenInfo} from './restclient';\nexport {BearerProvider, BearerTokenInfo};\nexport {BearerPersistentStorage} from './ked-bearer-provider';\nexport {createUUID} from './utils';\nexport {KedBearerProvider} from './ked-bearer-provider';\nimport {IsomorphicEnv} from './isomorphic-env';\nexport {IsomorphicEnv};\nexport {TokenQuery} from './token-query';\nexport * from './access-control';\nimport {HttpError} from './http-error';\nexport {HttpError}\n\nexport interface ListOptions {\n    from?: number,\n    to?: number,\n    include?: string | string[],\n    role?: string | string[],\n    hasEdgesTo?: string | string[],\n    hasEdgesFrom?: string | string[],\n    ids?: string[],\n    name?: string,\n    tags?: string | string[],\n    flags?: QueryFlag[],\n    cacheBust?: string | number\n};\n\nexport type QueryFlag = 'idsOnly' | 'includeIdsOnly' | 'idsAndNamesOnly' | 'includeIdsAndNamesOnly'; // | 'otherFlag' | 'thirdFlag';...\n\nexport class KedBackendClient {\n    http: RestClient;\n\n    constructor (\n        isomorphic: IsomorphicEnv,\n        bearerProvider: BearerProvider,\n        baseUrl: string)\n    {\n        this.http = new RestClient(\n            isomorphic,\n            baseUrl,\n            {bearerProvider});\n    }\n\n    async getMyClaims(table?: string, fetchOptions?: RequestInit) : Promise<any> // TODO: Specify what you get here\n    {\n        const res = await this.http.get(\"me/claims/\" + (table ||\"\"), null, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async get<T = any>(table, id, options?: {include?: string | string[]}, fetchOptions?: RequestInit) : Promise<T> {\n        const res = await this.http.get(`${table}/${id}`, options, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }    \n\n    async list<T = any>(table: string, options?: ListOptions, fetchOptions?: RequestInit) : Promise<T[]>\n    {\n        const res = await this.http.get(`${table}`, options, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async batch(reqs: MutationRequest[], fetchOptions?: RequestInit) : Promise<BatchResponse> {\n        // Reorder operations so that 'add's come first and 'delete's come last:\n        reqs = reqs.slice().sort((req1, req2) =>\n            req1.op === 'add' ? -1 : req2.op === 'add' ? 1 : \n            req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0);\n        const res = await this.http.post(`batch`, reqs, fetchOptions);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    async do(scopeFn: (r:BatchRunner)=>void) : Promise<BatchResponse> {\n        const runner = new BatchRunner();\n        scopeFn(runner);\n        return await this.batch(runner.mutationRequests);\n    }\n\n    async deleteRealm(realm: string) : Promise<number> {\n        const res = await this.http.delete(\"realms/\" + realm);\n        if (res.status != 200) throw new HttpError(res.status, await res.text());\n        return await res.json();\n    }\n\n    add(table:string, doc) {\n        return this.do(r=>r.add(table, doc));\n    }\n    put(table:string, doc) {\n        return this.do(r=>r.put(table, doc));\n    }\n    delete (table:string, id:string) {\n        return this.do(r=>r.delete(table, id));\n    }\n    share(table:string, id:string, acl: string[]) {\n        return this.do(r=>r.share(table, id, acl));\n    }\n    unshare (table:string, id:string, acl: string[]) {\n        return this.do(r=>r.unshare(table, id, acl));\n    }\n    link (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        return this.do(r=>r.link(sourceTable, sourceId, targetTable, targetId, label));\n    }\n    link2 (sourceTable:string, sourceId:string, targetId:string, label:string) {\n        return this.do(r=>r.link2(sourceTable, sourceId, label, targetId));\n    } \n    unlink (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        return this.do(r=>r.unlink(sourceTable, sourceId, targetTable, targetId, label));\n    }\n    unlink2 (sourceTable:string, sourceId:string, targetId:string, label:string) {\n        return this.do(r=>r.unlink2(sourceTable, sourceId, label, targetId));\n    }\n}\n\nexport class BatchRunner {\n    mutationRequests: MutationRequest[];\n\n    constructor() {\n        this.mutationRequests = [];\n    }\n\n    add (table:string, doc) {\n        this.mutationRequests.push({op: 'add', table, doc});\n        return this;\n    }\n    put (table:string, doc) {\n        doc = {...doc};\n        delete doc.acl; // Forbidden to send acl with put() calls.\n        this.mutationRequests.push({op: 'put', table, doc});\n        return this;\n    }\n    delete (table:string, id:string) {\n        this.mutationRequests.push({op: 'delete', table, id});\n        return this;\n    }\n    share (table:string, id:string, acl:string[]) {\n        this.mutationRequests.push({op: 'share', table, id, acl});\n        return this;\n    }\n    unshare (table:string, id:string, acl:string[]) {\n        this.mutationRequests.push({op: 'unshare', table, id, acl});\n        return this;\n    }\n    link (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        this.mutationRequests.push({op: 'link', sourceTable, sourceId, targetTable, targetId, label});\n        return this;\n    }\n    link2 (sourceTable:string, sourceId:string, label:string, targetId:string) {\n        this.mutationRequests.push({op: 'link', sourceTable, sourceId, targetId, label});\n    }\n    unlink (sourceTable:string, sourceId:string, targetTable:string, targetId:string, label:string) {\n        this.mutationRequests.push({op: 'unlink', sourceTable, sourceId, targetTable, targetId, label});\n        return this;\n    }\n    unlink2 (sourceTable:string, sourceId:string, label:string, targetId:string) {\n        this.mutationRequests.push({op: 'unlink', sourceTable, sourceId, targetId, label});\n        return this;\n    }\n}\n\nexport interface AddRequest {\n    op: 'add';\n    table: string;\n    doc: {id?: string, acl?: string[], name?: string, dateTime?: number};\n}\n\nexport interface PutRequest {\n    op: 'put';\n    table: string;\n    doc: {id: string, name?: string, dateTime?: number};\n}\n\nexport interface DeleteRequest {\n    op: 'delete';\n    table: string;\n    id: string;\n}\n\nexport interface ShareRequest {\n    op: 'share';\n    table: string;\n    id: string;\n    acl: string[];\n}\n\nexport interface UnshareRequest {\n    op: 'unshare';\n    table: string;\n    id: string;\n    acl: string[];\n}\n\nexport interface LinkRequest {\n    op: 'link';\n    sourceTable: string;\n    sourceId: string;\n    targetTable?: string;\n    targetId: string;\n    label: string;\n}\n\nexport interface UnlinkRequest {\n    op: 'unlink';\n    sourceTable: string;\n    sourceId: string;\n    targetTable?: string;\n    targetId: string;\n    label: string;\n}\n\nexport type MutationRequest =\n    AddRequest |\n    PutRequest |\n    DeleteRequest |\n    ShareRequest |\n    UnshareRequest |\n    LinkRequest |\n    UnlinkRequest;\n\nexport interface BatchResponse {\n    newEtags: {[id:string] : string};\n}\n\n","import {EDSCourse} from '../../contracts/eds';\n\nexport const courses: {courses: EDSCourse[]} =\n\n{\n    \"courses\": [\n        // Test data for Gymnasium students (made-up!)\n        {\n            \n            \"courseId\": \"2070d120-30ad-49e9-89c3-9c584a6cfa29\",\n            \"periodName\": \"HT2017\",\n            \"periodGoalGrade\": \"A\",\n            \"name\": \"Naturkunskap 1b\",\n            \"shortName\": \"XXX\",\n            \"courseSteps\": []\n        },\n        // Test data once retrieved from EDS test API for ground-school students:\n        {\n            \"courseId\": \"2070d120-30ad-49e9-89c3-9c584a6cfa2c\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"A\",\n            \"name\": \"Engelska\",\n            \"shortName\": \"EN\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"61f02bc7-1a0d-4b80-9bf1-07b6280379db\",\n                    \"name\": \"1. Lära känna varandra\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903600)\\/\"\n                },\n                {\n                    \"stepId\": \"a34c07c7-3932-4f64-87f9-feb5646db3db\",\n                    \"name\": \"10. En saga\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903740)\\/\"\n                },\n                {\n                    \"stepId\": \"e931f2bb-5727-4d99-b9e5-1bababfbc2e9\",\n                    \"name\": \"11. Det här är jag\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903757)\\/\"\n                },\n                {\n                    \"stepId\": \"ab823339-90ac-4b7f-a895-869d25cef504\",\n                    \"name\": \"12. Jag och min familj\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903770)\\/\"\n                },\n                {\n                    \"stepId\": \"53e00313-4980-4ab2-84ff-abe80ecd72d2\",\n                    \"name\": \"13. Jag och mina vänner\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903787)\\/\"\n                },\n                {\n                    \"stepId\": \"828796e9-84ad-4496-aa78-7850dd5bb23a\",\n                    \"name\": \"14. Jag och min fritid\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903803)\\/\"\n                },\n                {\n                    \"stepId\": \"31e08f37-4ec5-4366-9af6-bca5b9070198\",\n                    \"name\": \"15. The Blog\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111904117)\\/\"\n                },\n                {\n                    \"stepId\": \"4f88e9a3-9b36-47af-9686-d28b00ca98fc\",\n                    \"name\": \"16. Sport\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474888651180)\\/\"\n                },\n                {\n                    \"stepId\": \"abb57443-be68-48b7-a719-3454afbf3daa\",\n                    \"name\": \"17. Musik\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1477656328037)\\/\"\n                },\n                {\n                    \"stepId\": \"964f7ac3-8cf7-4042-912f-58ffb6812ddb\",\n                    \"name\": \"18. Vykort\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3002e95c-8de0-4914-a754-0773a18606bf\",\n                    \"name\": \"19. Läsa noveller\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d8708a56-e4fb-4ad3-84ef-bb40481eaf80\",\n                    \"name\": \"2. Veckans aktiviteter\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903613)\\/\"\n                },\n                {\n                    \"stepId\": \"46915f18-288c-44df-b224-1852d221b6ca\",\n                    \"name\": \"20. Summer camp\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"db22d300-0126-4a32-950d-aaf2f7142627\",\n                    \"name\": \"21. Hus och hem\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"68111c18-e610-45c0-b290-9dd3cede1e48\",\n                    \"name\": \"22. Sightseeing\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4c84dd89-66f2-4ea1-bce8-3fde1724dcc9\",\n                    \"name\": \"23. Vid matbordet\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1488205880703)\\/\"\n                },\n                {\n                    \"stepId\": \"75943640-f031-41da-8495-9d87b5804a3e\",\n                    \"name\": \"24. Traditioner\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"72021bc2-0ea8-4d39-87fa-11cc976e9c9f\",\n                    \"name\": \"25. Staying with a host family\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"574e1626-cad3-4220-8ba7-b443f03830b4\",\n                    \"name\": \"26. Det engelska språket\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"50a3682e-057d-45b1-81b5-e2eaa8b6d16b\",\n                    \"name\": \"27. Skolan och framtidsdrömmar\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"15a47a71-989a-4348-8fcb-a10683d263ec\",\n                    \"name\": \"28. Identitet\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5717f099-477f-433d-b10a-c2bf0dfe6f8e\",\n                    \"name\": \"29. Att läsa en bok\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"0443638f-a546-40d8-a533-e2d12abef609\",\n                    \"name\": \"3. Fira ett speciellt tillfälle\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903630)\\/\"\n                },\n                {\n                    \"stepId\": \"54ff6488-f0ae-4fb6-b4e4-0f29d9274b23\",\n                    \"name\": \"30. The World Today\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"2ab8a527-cd74-4847-97a6-79f629e22e84\",\n                    \"name\": \"31. Entertainment\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1b5d42ff-9615-439a-9ae2-89779040bf91\",\n                    \"name\": \"32. Interview\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"29ffc098-d26d-4f3b-a295-b5f065923bf2\",\n                    \"name\": \"33. Filmed books\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4d5fe734-9af9-42b8-8c50-920c9a450bc1\",\n                    \"name\": \"34. See the film\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"dd87c548-4a3a-4a62-9114-70ec7e713aee\",\n                    \"name\": \"35. Write a bestseller\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1fb5ce80-faf0-465c-9be8-c9bc722297bb\",\n                    \"name\": \"36. The English-speaking World\",\n                    \"shortName\": \"36\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f0007f75-0d1f-48c7-8f19-bb2e9f2c5377\",\n                    \"name\": \"37. Poetry\",\n                    \"shortName\": \"37\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"addebfcc-5b3c-4360-b819-0de0269a5e2d\",\n                    \"name\": \"38. Rhetoric\",\n                    \"shortName\": \"38\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"23c16db5-d435-49d3-8daa-c2b6433366b7\",\n                    \"name\": \"39. An important issue\",\n                    \"shortName\": \"39\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"e4d22285-735a-4bab-8884-ca5b736ebb88\",\n                    \"name\": \"4. Åka någonstans\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903647)\\/\"\n                },\n                {\n                    \"stepId\": \"4c489a2b-ee79-4f89-9818-787632abfba8\",\n                    \"name\": \"40. Write a speech\",\n                    \"shortName\": \"40\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"9667976c-83ab-4b9e-8a76-d330983c28f5\",\n                    \"name\": \"41. Changing world\",\n                    \"shortName\": \"41\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6bb14af9-9094-4938-be2d-2725a931895c\",\n                    \"name\": \"42. An organization\",\n                    \"shortName\": \"42\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"fe313a1a-dc5c-4890-b11e-b8e109db689b\",\n                    \"name\": \"43. The written word\",\n                    \"shortName\": \"43\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f1a592ec-6095-4ae4-9b9e-ebd527c18a2a\",\n                    \"name\": \"44. Communication\",\n                    \"shortName\": \"44\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5f6a5e15-462b-40ab-981b-b93e5fc0ee22\",\n                    \"name\": \"45. Giving a lecture\",\n                    \"shortName\": \"45\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"8c9b57c1-cf05-4465-84b2-68cf353b1075\",\n                    \"name\": \"5. Min semester\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903660)\\/\"\n                },\n                {\n                    \"stepId\": \"1bd11f36-6438-40b5-ad4c-4b02b6f481d0\",\n                    \"name\": \"6. Låt oss prata om det\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903677)\\/\"\n                },\n                {\n                    \"stepId\": \"d49c08ee-c0e6-4599-b79f-5efd811fe33c\",\n                    \"name\": \"7. Jag är en turist\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903693)\\/\"\n                },\n                {\n                    \"stepId\": \"2def3414-de65-46c0-8f48-f8aa18be7b7c\",\n                    \"name\": \"8. Vänner över hela världen\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903707)\\/\"\n                },\n                {\n                    \"stepId\": \"ea8ff1a0-4bad-43ac-b328-62dff3e4d08e\",\n                    \"name\": \"9. Hjältar och kända personer\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472111903723)\\/\"\n                }\n            ]\n        },\n        {\n            \"courseId\": \"9d129e6a-9557-4849-a53f-416725502895\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"C\",\n            \"name\": \"Matematik\",\n            \"shortName\": \"MA\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"f1af6c2c-799a-4a3d-9985-c423940e91c0\",\n                    \"name\": \"1. Tal och mönster\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815917)\\/\"\n                },\n                {\n                    \"stepId\": \"4a34c53d-93d0-4247-ba19-9ce9dbed6de5\",\n                    \"name\": \"10. Lägesmått och diagram\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816200)\\/\"\n                },\n                {\n                    \"stepId\": \"0816a2b0-3aa7-41a9-bc39-971ccc7bd79c\",\n                    \"name\": \"11. Räknesätt\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1476103754013)\\/\"\n                },\n                {\n                    \"stepId\": \"fdc90a9c-b06a-48b1-9781-606c230c425c\",\n                    \"name\": \"12. Geometri\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1481279716607)\\/\"\n                },\n                {\n                    \"stepId\": \"bfd77c92-6636-45fa-9002-d813beaa56c3\",\n                    \"name\": \"13. Rymdgeometri\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1489669353170)\\/\"\n                },\n                {\n                    \"stepId\": \"58a619a1-b99a-487b-bbd5-abd31a903e5a\",\n                    \"name\": \"14. Räknemetoder och algebra\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"55b88760-22aa-452a-8a57-131346669aad\",\n                    \"name\": \"15. Problemet\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"47f16476-ea47-40a2-a073-7ac4b36c4bf0\",\n                    \"name\": \"16. Delen och det hela\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"704e3d5b-fce7-409b-b989-340b2d7b2e18\",\n                    \"name\": \"17. Geometri och vinklar\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"db5693ea-48ef-44ce-8107-be9915ef5256\",\n                    \"name\": \"18. Funktioner\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f9250c97-d932-4bf6-989e-204c0ef582c9\",\n                    \"name\": \"19. Proportionalitet\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d0411b1d-c9b4-452f-9fb6-ea7206755ecd\",\n                    \"name\": \"2. Längd och räknesätt\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815930)\\/\"\n                },\n                {\n                    \"stepId\": \"616b742e-b175-45c3-a926-fda3e4d8af80\",\n                    \"name\": \"20. Förflyttningsgraf\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f8a9b467-6ba6-4d9a-8174-87e369062621\",\n                    \"name\": \"21. Likformighet\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"8fe483d7-b78b-4d9d-9402-15d57da05832\",\n                    \"name\": \"22. Bråk, sannolikhet och kombinatorik\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7eb39090-6461-4ce4-b008-dd98f8a57679\",\n                    \"name\": \"23. Negativa tal, procentsatser och förändringsfaktor\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"34cb3911-3a78-4773-a823-2f9054a9a925\",\n                    \"name\": \"24. Algebra och ekvationer\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"49abad1a-dd4b-4b0b-8d1f-752796723ca1\",\n                    \"name\": \"25. Lotteriet\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6756d8bc-e31a-4139-8d95-8f47916a361b\",\n                    \"name\": \"26. Geometriska samband\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"0f0efee5-e617-4bca-b84e-e50e32aac90b\",\n                    \"name\": \"27. Rymdgeometri\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"de4e12d1-f678-4b1a-ac7b-5d62cdaeb52d\",\n                    \"name\": \"28. Storheter och proportionella samband\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"80323de8-fe66-4750-bb2e-d0dbabbb3dac\",\n                    \"name\": \"29. Funktioner och grafer\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"68894968-8a16-497a-8b97-711df61fca71\",\n                    \"name\": \"3. Tal och enheter\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815947)\\/\"\n                },\n                {\n                    \"stepId\": \"fa32d170-ab25-466d-91a8-a88f955cc5bc\",\n                    \"name\": \"30. Förpackning\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4c31e00f-aeda-409f-8583-9805c0bb4f7f\",\n                    \"name\": \"31. Negativa tal och statistik\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"691bb48b-070d-4227-8fb6-2edce2fc6be4\",\n                    \"name\": \"32. Bråk\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"320481da-e417-4c52-af23-0076b694794d\",\n                    \"name\": \"33. Procent och förändringsfaktor\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f3a4338d-504e-4092-9610-ef2775b5b411\",\n                    \"name\": \"34. Potenser\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f43d7931-158c-4759-b7be-b14cf68c939a\",\n                    \"name\": \"35. Solsystemet\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"8931fc26-693a-41bd-8040-e01a6d22b2b5\",\n                    \"name\": \"36. Ekvationer och algebra\",\n                    \"shortName\": \"36\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"94370d70-dcbd-4eef-baf1-e92f6680b966\",\n                    \"name\": \"37. Funktioner och grafer\",\n                    \"shortName\": \"37\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ab0535df-68cc-4c10-86eb-afba3e199d0a\",\n                    \"name\": \"38. Geometri\",\n                    \"shortName\": \"38\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4ba66c7a-7d8f-4576-aefa-c09397b99db0\",\n                    \"name\": \"39. Sannolikhet\",\n                    \"shortName\": \"39\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c4e12bc8-1428-4d1b-a273-e947fa0574f3\",\n                    \"name\": \"4. Multiplikation och division\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815963)\\/\"\n                },\n                {\n                    \"stepId\": \"0b75ce2b-89de-432a-9eee-d6a7b74b6f38\",\n                    \"name\": \"40. Chokladfabriken\",\n                    \"shortName\": \"40\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"dba4a055-c143-4bd4-b436-3eb508ebe658\",\n                    \"name\": \"41. Genrella lösningsmetoder\",\n                    \"shortName\": \"41\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"db193873-0a8c-4073-8618-99c5a56f710b\",\n                    \"name\": \"42. Avancerad ekvationslösning\",\n                    \"shortName\": \"42\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"357ee123-1d77-4568-8fa1-78b5662e12b3\",\n                    \"name\": \"43. Problemlösning\",\n                    \"shortName\": \"43\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"015cdd58-7b31-4a89-a9fe-cd0bb45e7434\",\n                    \"name\": \"44. Avancerad problemlösning\",\n                    \"shortName\": \"44\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"785e12ac-4a71-4acf-bf40-27652faf20ff\",\n                    \"name\": \"45. Vad är matematik?\",\n                    \"shortName\": \"45\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6372cdb6-91cf-4f0f-ac9c-8578c00760ff\",\n                    \"name\": \"5. Form och storlek\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815977)\\/\"\n                },\n                {\n                    \"stepId\": \"c781e529-fefa-43ce-99fb-d232585a1e1a\",\n                    \"name\": \"6. Tid och räknesätt\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401815993)\\/\"\n                },\n                {\n                    \"stepId\": \"5df2975c-f84e-4620-abe9-5c47ebcb0f90\",\n                    \"name\": \"7. Bråk och decimaltal\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816007)\\/\"\n                },\n                {\n                    \"stepId\": \"9cbb966f-32df-48cf-be77-5e00d466d63a\",\n                    \"name\": \"8. Procent och bråk\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816023)\\/\"\n                },\n                {\n                    \"stepId\": \"b1b59f38-63c6-428a-a512-220b7d838e5f\",\n                    \"name\": \"9. Sannolikhet och bråk\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1474401816040)\\/\"\n                }\n            ]\n        },\n        {\n            \"courseId\": \"cfdc5bc0-ea41-4683-b941-d980de4e82a5\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"D\",\n            \"name\": \"Spanska, språkval\",\n            \"shortName\": \"M2SP\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"16bb0ce6-60ac-4937-8e60-dd633cd7c5f0\",\n                    \"name\": \"1. Första mötet\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1476255771933)\\/\"\n                },\n                {\n                    \"stepId\": \"f3504ab6-386c-42d2-882b-668719f329b5\",\n                    \"name\": \"10. Turist\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d2de4e01-44dd-4ba7-a69f-075450c627a7\",\n                    \"name\": \"11. Skolan\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"58e4d577-05f5-4071-8745-a41571df3019\",\n                    \"name\": \"12. Fritiden\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d8a079f9-3fef-4fbc-b868-6b050e3832d1\",\n                    \"name\": \"13. Stämma träff\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d62f63a1-3806-4650-b6a9-354eccd056b9\",\n                    \"name\": \"14. Sport och musik\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"b475dc9d-e694-4eb9-8c78-b150494dfe84\",\n                    \"name\": \"15. Presentera dig själv\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"009c68f6-db7e-44a3-bc5c-d1e2e78d327c\",\n                    \"name\": \"16. När och fjärran\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"a124f250-2fb7-4b57-b2bc-b72e0e8fd21a\",\n                    \"name\": \"17. Mat och traditioner\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ec6ccef4-58b5-4111-b152-8a7a7f546bb8\",\n                    \"name\": \"18. Planera en resa\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ec96d506-112e-4b38-8946-6f19130bd741\",\n                    \"name\": \"19. Etikett och regler\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"0b52b5e6-bbc7-4c78-815c-efc30fa984af\",\n                    \"name\": \"2. Min familj\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1488368769260)\\/\"\n                },\n                {\n                    \"stepId\": \"e05c674b-1097-4646-ac47-1d8c4342a343\",\n                    \"name\": \"20. Resan\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f6f8cffb-69ae-4148-81fa-35e1f984f836\",\n                    \"name\": \"21. Boende\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"aee9167c-2f65-4f8d-a94b-684458c300bc\",\n                    \"name\": \"22. Familjeliv\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"115f28de-fe33-435e-a7fb-36fea0a37cce\",\n                    \"name\": \"23. Bostadsläge\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d5e8b9e2-b84e-4af7-8b20-e37896dec41d\",\n                    \"name\": \"24. Min stad\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c2f15857-a682-4b02-8d00-ec042858e799\",\n                    \"name\": \"25. Presentera någon annan\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1bc87327-1e3f-42f6-b839-e9b385200149\",\n                    \"name\": \"26. Media\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"36f23967-f30b-4cbc-a69c-4191094e182d\",\n                    \"name\": \"27. En tv-kväll\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"32ead07a-fa58-4770-ac20-3a31f27069cf\",\n                    \"name\": \"28. Tidningar\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"598d7b7e-97b6-4ff3-b7a7-8f5c45c164cd\",\n                    \"name\": \"29. Film\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"12e8d03b-7d80-434c-9201-7f852f5c114c\",\n                    \"name\": \"3. Fler siffror, månader och väder\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"98f0825e-e200-43f4-9f4b-866bb50d28dd\",\n                    \"name\": \"30. Tidningen\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"956757b9-979f-4d12-be01-8b30970b603e\",\n                    \"name\": \"31. Min framtid\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c2003358-0ce9-409b-82fa-e7a0bff891fc\",\n                    \"name\": \"32. Ung i framtiden\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"1c1ca040-f96d-46af-862b-a978698e2745\",\n                    \"name\": \"33. Insändare\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"64f620bb-8c77-4de2-88e2-feaa21f4c41e\",\n                    \"name\": \"34. På gymnasiet\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4c3c19eb-0447-47cf-bb72-8d1176118c71\",\n                    \"name\": \"35. Framtiden\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c3779788-030e-46f3-89a7-a15015931a51\",\n                    \"name\": \"4. Det här är jag\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"a6628c06-443a-481d-96fc-c019800e8e4e\",\n                    \"name\": \"5. Boken\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"f34e1dee-1dd3-4bcd-89b4-f0ba6638c65c\",\n                    \"name\": \"6. På café\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"9ffb3665-0e3a-423a-af93-c5006a2a4839\",\n                    \"name\": \"7. Att handla\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"63e62432-ba1e-4f96-911c-52bd756c803e\",\n                    \"name\": \"8. I staden\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3c93cf1d-2e82-452b-9333-16b336fdda6d\",\n                    \"name\": \"9. På hotellet\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                }\n            ]\n        },\n        {\n            \"courseId\": \"3cc7c710-63fb-49bd-8dc5-b95be6374122\",\n            \"periodName\": \"VT2017\",\n            \"periodGoalGrade\": \"C\",\n            \"name\": \"Svenska\",\n            \"shortName\": \"SV\",\n            \"courseSteps\": [\n                {\n                    \"stepId\": \"379585a4-f602-4086-920d-d506d2e93fed\",\n                    \"name\": \"1. Min bästa sak\",\n                    \"shortName\": \"1\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179490)\\/\"\n                },\n                {\n                    \"stepId\": \"5d90747a-d5ff-4c12-818c-d301e4cf2405\",\n                    \"name\": \"10. Quizkampen\",\n                    \"shortName\": \"10\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179630)\\/\"\n                },\n                {\n                    \"stepId\": \"fb271830-5368-43dc-b911-3d65af082e26\",\n                    \"name\": \"11. Ta kontakt\",\n                    \"shortName\": \"11\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179647)\\/\"\n                },\n                {\n                    \"stepId\": \"bf7a93a6-24af-4d01-8839-aa4f3f6b438d\",\n                    \"name\": \"12. Samla fakta och presentera\",\n                    \"shortName\": \"12\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179660)\\/\"\n                },\n                {\n                    \"stepId\": \"2a712108-e5d7-4ffb-a55f-80ff195ea946\",\n                    \"name\": \"13. Påverka och uttrycka åsikter\",\n                    \"shortName\": \"13\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179943)\\/\"\n                },\n                {\n                    \"stepId\": \"94b5abaa-0471-4ab4-be3c-c0b0d4098609\",\n                    \"name\": \"14. Språk i Sverige\",\n                    \"shortName\": \"14\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1475049857367)\\/\"\n                },\n                {\n                    \"stepId\": \"e0169353-8ac0-4fcd-8a45-4cfffc5fe55e\",\n                    \"name\": \"15. Min förebild\",\n                    \"shortName\": \"15\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1480951054357)\\/\"\n                },\n                {\n                    \"stepId\": \"e12c8fa6-8aaa-4598-8e6f-5c6d318163db\",\n                    \"name\": \"16. Förstå, minnas och lära\",\n                    \"shortName\": \"16\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1490605558217)\\/\"\n                },\n                {\n                    \"stepId\": \"1a19c53b-36f0-4309-adfd-26a307b43dbd\",\n                    \"name\": \"17. Använda språket i olika sammanhang\",\n                    \"shortName\": \"17\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"31aa5b91-59d0-41db-ab2e-0bdec6342dfe\",\n                    \"name\": \"18. Sammanfatta och presentera\",\n                    \"shortName\": \"18\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"48747057-835d-40fd-811f-dde4fd48f3a0\",\n                    \"name\": \"19. Den moderna ungdomen\",\n                    \"shortName\": \"19\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4708aedf-3b7d-4ec0-80c9-769de4cdda9b\",\n                    \"name\": \"2. Författare\",\n                    \"shortName\": \"2\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179507)\\/\"\n                },\n                {\n                    \"stepId\": \"4258123d-d122-4058-8120-9de7d1fb3d66\",\n                    \"name\": \"20. Att vara ungdom idag\",\n                    \"shortName\": \"20\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3d94e56d-9d38-4d3c-a3cb-d4f2d13814c9\",\n                    \"name\": \"21. Upplysningstiden och romantiken\",\n                    \"shortName\": \"21\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5d8c3d70-e996-4236-9326-982ed128340c\",\n                    \"name\": \"22. Realismen och modernismen\",\n                    \"shortName\": \"22\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"02037ab3-ffdf-4fe2-a172-26de404c58bc\",\n                    \"name\": \"23. Våga utanför ramarna\",\n                    \"shortName\": \"23\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7c376d37-0170-49ac-865d-5479d82ce806\",\n                    \"name\": \"24. Modern litteratur\",\n                    \"shortName\": \"24\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7131b28d-89d1-40f6-8d87-80fd0c15486d\",\n                    \"name\": \"25. Budskapet\",\n                    \"shortName\": \"25\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"30c876a6-48a7-4fc7-a49f-ad44bac3d4bb\",\n                    \"name\": \"26. Övertyga och påverka\",\n                    \"shortName\": \"26\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"97b328ea-3342-41d6-a1c5-91e9c1d17a08\",\n                    \"name\": \"27. Språkbruk genom tiderna\",\n                    \"shortName\": \"27\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"e4ec472d-b31c-4d20-886c-0162e1159e55\",\n                    \"name\": \"28. Tidningstexter\",\n                    \"shortName\": \"28\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"47ccf40e-28a1-4432-91ed-f3013eb97aa8\",\n                    \"name\": \"29. Samtala om texter\",\n                    \"shortName\": \"29\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"6c89c307-adff-46b8-9d75-2ecb1fc714ce\",\n                    \"name\": \"3. Leka med ord\",\n                    \"shortName\": \"3\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179520)\\/\"\n                },\n                {\n                    \"stepId\": \"2145d4aa-60db-42f9-918b-49f3bf714786\",\n                    \"name\": \"30. Språkets möjligheter\",\n                    \"shortName\": \"30\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"c211ba3d-b8fa-4c5c-bbe1-bcfea2a243b5\",\n                    \"name\": \"31. Dikt och diktanalys\",\n                    \"shortName\": \"31\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"fbeb356a-5c9d-4114-9a4b-9ac2325913d0\",\n                    \"name\": \"32. Berättarteknik i skönlitteratur\",\n                    \"shortName\": \"32\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"4446df13-5bb8-4cf1-beb4-4d2b43bf97b8\",\n                    \"name\": \"33. Utveckla ditt skönlitterära skrivande\",\n                    \"shortName\": \"33\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"47e0c5bf-2898-4cc3-8119-2346d4c6c78f\",\n                    \"name\": \"34. Noveller\",\n                    \"shortName\": \"34\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"3b072a72-9f2c-4439-b095-33edb5ae3276\",\n                    \"name\": \"35. Det fria ordet - En skönlitterär djupdykning\",\n                    \"shortName\": \"35\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"56a2b991-63f5-4f1c-8e48-1bc1f83fa9a9\",\n                    \"name\": \"36. Debatt och retorik\",\n                    \"shortName\": \"36\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"7b0e633b-65b5-407d-8bdd-d77673d1be1f\",\n                    \"name\": \"37. Argumenterande texter\",\n                    \"shortName\": \"37\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d76356c9-2fdd-4845-aa7a-1bf54547a34e\",\n                    \"name\": \"38. Analysera tal\",\n                    \"shortName\": \"38\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"eb312838-f59b-4815-987f-d7f11973a95f\",\n                    \"name\": \"39. Tal\",\n                    \"shortName\": \"39\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"48559f29-37cb-451f-8f40-354101a413af\",\n                    \"name\": \"4. Skrivarskola\",\n                    \"shortName\": \"4\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179537)\\/\"\n                },\n                {\n                    \"stepId\": \"a054f1e2-b296-4185-b9b7-dac94f600ab3\",\n                    \"name\": \"40. Muntlig argumentation\",\n                    \"shortName\": \"40\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"2e5ff9f3-ac8e-4fea-abe2-a7534e64e25f\",\n                    \"name\": \"41. Modern lyrik\",\n                    \"shortName\": \"41\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"ceed4cee-dd38-40b9-af97-43b0af244a41\",\n                    \"name\": \"42. Nobelpriset i litteratur\",\n                    \"shortName\": \"42\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"2df27363-1a57-4129-96dc-5e2a26dc0209\",\n                    \"name\": \"43. Analysmetod i akademiska uppsatser\",\n                    \"shortName\": \"43\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"71062f38-2874-4d6a-96b9-8128a10e3559\",\n                    \"name\": \"44. Litteratur som väckt debatt genom tiderna\",\n                    \"shortName\": \"44\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"d0e40b55-4638-45fd-b9f3-924c68c673cc\",\n                    \"name\": \"45. Analysera vetenskapligt\",\n                    \"shortName\": \"45\",\n                    \"isCompleted\": null,\n                    \"completedDate\": null\n                },\n                {\n                    \"stepId\": \"5954c057-cdc2-4293-bb9e-8b96ec27e04c\",\n                    \"name\": \"5. Min bästa sak på äventyr\",\n                    \"shortName\": \"5\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179553)\\/\"\n                },\n                {\n                    \"stepId\": \"5b9e5c30-c9de-4092-b7e6-0dbb4e3513ff\",\n                    \"name\": \"6. Faktatext\",\n                    \"shortName\": \"6\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179567)\\/\"\n                },\n                {\n                    \"stepId\": \"2b823257-8dad-4f6b-8f2b-539e4dae0bd4\",\n                    \"name\": \"7. Tal- och skriftspråk\",\n                    \"shortName\": \"7\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179583)\\/\"\n                },\n                {\n                    \"stepId\": \"28e73fd2-c40a-4319-8b93-ec0f1b658c81\",\n                    \"name\": \"8. Dikter\",\n                    \"shortName\": \"8\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179600)\\/\"\n                },\n                {\n                    \"stepId\": \"35a5926a-8cb3-4c9d-a7ef-714761935755\",\n                    \"name\": \"9. Olika texttyper\",\n                    \"shortName\": \"9\",\n                    \"isCompleted\": true,\n                    \"completedDate\": \"\\/Date(1472559179613)\\/\"\n                }\n            ]\n        }\n    ]\n}\n","import {EDSAssessment} from '../../contracts/eds';\n\nexport const assessments: {assessments: EDSAssessment[]} =\n\n{\n    \"assessments\": [\n      {\n        \"publishDateTime\": \"2017-08-28T09:05:43.16\",\n        \"text\": \"Testbedömning Engelsa 5\",\n        \"gradeName\": \"C\",\n        \"courseUnitName\": \"1. Ready, steady, go!\"\n      },\n      {\n        \"publishDateTime\": \"2017-08-28T08:59:21.253\",\n        \"text\": \"Testbedömning...\\r\\n/ Kim test\",\n        \"gradeName\": \"C\",\n        \"courseUnitName\": \"Tema 1\"\n      },\n      {\n        \"publishDateTime\": \"2017-08-10T09:43:36.797\",\n        \"text\": \"Test\",\n        \"gradeName\": \"D\",\n        \"courseUnitName\": \"Block 1\"\n      }\n    ]\n  }","import {EDSStudyPlan} from '../../contracts/eds';\n\nexport const studyPlans: {StudyPlans: EDSStudyPlan[]} =\n\n{\n    \"StudyPlans\": [\n        {\n            \"courseUnitName\": \"Hem- och konsumentkunskap\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Historia\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Fysik\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Geografi\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Matematik\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Samhällskunskap\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Engelska\",\n            \"finalGoalGrade\": \"A\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"A\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"B\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Religionskunskap\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Idrott och hälsa\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Biologi\",\n            \"finalGoalGrade\": \"D\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Svenska\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Teknik\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Bild\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"C\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Spanska, språkval\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Kemi\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"B\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Slöjd\",\n            \"finalGoalGrade\": \"C\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"D\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"B\"\n                }\n            ]\n        },\n        {\n            \"courseUnitName\": \"Musik\",\n            \"finalGoalGrade\": \"B\",\n            \"strategyText\": \"\",\n            \"periodGoals\": [\n                {\n                    \"periodName\": \"VT2017\",\n                    \"gradeName\": \"C\"\n                },\n                {\n                    \"periodName\": \"HT2016\",\n                    \"gradeName\": \"D\"\n                }\n            ]\n        }\n    ]\n}","import { EDSCourse, EDSAssessment, EDSStudyPlan, EDSStudentFutureAbility } from '../contracts/eds';\nimport { RestClient } from 'kedbackend/js/dist/ked-backend-client/restclient';\nimport { IsomorphicEnv, BearerProvider, HttpError } from 'kedbackend/client';\nimport { SchoolMoment } from '../utils/school-moment';\nimport { SchoolTerm } from '../utils/school-term';\nimport { dateTimeReviver, L } from '../utils/utils';\nimport { courses } from './eds-stubdata/ActiveCourses';\nimport { assessments } from './eds-stubdata/LatestAssessments';\nimport { studyPlans } from './eds-stubdata/StudentGoals';\nimport env from '../globals/KED.env';\n//Gamla: const API_URL = \"https://test-dev-eds-cs.cloudapp.net/WebAPI/\";\n//NYA: const API_URL = \"https://edsportalowinapi.azurewebsites.net/api/\";\n\nfunction privatizingCacheBust () {\n  return {user: env.currentUser.mail};\n}\nexport class EdsClient {\n  http: RestClient;\n\n  constructor (\n    isomorphic: IsomorphicEnv,\n    baseUrl: string,\n    bearerProvider: BearerProvider\n  ) {\n    this.http = new RestClient (isomorphic, baseUrl, {bearerProvider});\n    this.getActiveCourses = avoidSimultanousCalls(this.getActiveCourses);\n    this.getLatestAssessments = avoidSimultanousCalls(this.getLatestAssessments);\n    this.getStudentGoals = avoidSimultanousCalls(this.getStudentGoals);\n    this.getStudentFutureAbilities = avoidSimultanousCalls(this.getStudentFutureAbilities);\n  }\n\n/**\n   * Retrieve active courses for current logged in student.\n   *\n   * @param courseCode Short-name of the course. Optional.\n   */\n  async getActiveCourses(q: {courseCode?: string, periodName: string}) {\n    try {\n      const query:any = privatizingCacheBust();\n      if (q) {\n        if (q.courseCode) query.CourseCode = q.courseCode;\n        if (q.periodName) query.PeriodName = q.periodName;\n      }\n      const res = await this.http.get(\"studentactivecourses\", query);\n      if (res.status != 200) throw new HttpError(res.status, await res.text());\n      const json = await res.json();\n      return json.courses as EDSCourse[];\n    } catch (ex) {\n      console.error(\"Error from EDS: \" + ex);\n      throw new Error(L`Kunde tyvärr inte ladda terminsmål eller avklarade steg från EDS. Försök igen senare...`);\n    }\n  }\n\n  /**\n   * Retrieve latest assessments for current logged in user.\n   * \n   * @param limit Optional limit\n   */\n  async getLatestAssessments(limit?: number) {\n    const query:any = privatizingCacheBust();\n    if (!isNaN(limit)) query.Count = limit;\n    const res = await this.http.get(\"studentassessments\", query);\n    if (res.status != 200) throw new HttpError(res.status, await res.text());\n    const json = await res.json();\n    return json.assessments as EDSAssessment[];    \n  }\n\n  /**\n   * Retrieve studyplans for current logged-in user\n   */\n  async getStudentGoals() {\n    const res = await this.http.get(\"studentgoals\", privatizingCacheBust());\n    if (res.status != 200) throw new HttpError(res.status, await res.text());\n    const json = await res.json();\n    return json.studentGoals as EDSStudyPlan[];    \n  }\n\n  async getStudentFutureAbilities() {\n    const res = await this.http.get(\"studentFutureAbilities\", privatizingCacheBust());\n    if (res.status != 200) throw new HttpError(res.status, await res.text());\n    const json = await res.json();\n    return json.studentFutureAbilities as EDSStudentFutureAbility[];\n  }\n}\n\nexport class EDSPeriod {\n  period: string;\n  term: 'AT' | 'ST';\n  year: number;\n  constructor (periodStringOrSchoolTerm: string | SchoolMoment) {\n    if (typeof periodStringOrSchoolTerm === 'string') {\n      this.period = periodStringOrSchoolTerm;\n      this.term = this.period.startsWith('HT') ? 'AT' : 'ST';\n      this.year = parseInt(this.period.substr(2));\n      if (isNaN(this.year)) throw new Error (`Invalid period: ${this.period}`);\n    } else {\n      const schoolTerm = new SchoolTerm(periodStringOrSchoolTerm);\n      this.period = (schoolTerm.term === 'AT' ? \"HT\" : \"VT\") + schoolTerm.year;\n      this.term = schoolTerm.term;\n      this.year = schoolTerm.year;\n    }\n  }\n\n  get schoolTerm () : SchoolTerm {\n    return new SchoolTerm({\n      academicYear: this.term === 'AT' ?\n        `${this.year}/${this.year + 1}` :\n        `${this.year-1}/${this.year}`,\n      term: this.term\n    });\n  }\n\n  toString() {\n    return this.period;\n  }\n\n  valueOf() {\n    return this.year + \":\" + (this.term === 'ST' ? \"1\" : \"2\");\n  }\n}\n\nexport function parseJsonDate_old (jsonDateStr: string) : Date {\n  const date = dateTimeReviver(\"\", jsonDateStr);\n  if (!(date instanceof Date)) throw new Error(\"Invalid JSON date string: \" + jsonDateStr);\n  return date;\n}\n\nexport class StubEdsClient implements EdsClient {\n  http: RestClient;\n\n  constructor () {\n    this.http = null;\n  }\n\n  async getActiveCourses(q?: { courseCode?: string; periodName?: string; }) {\n    let result = courses.courses;\n      if (q) {\n        if (q.courseCode) result = result.filter (c => c.shortName === q.courseCode);\n        if (q.periodName) result = result.filter(c => c.periodName === q.periodName);\n      }\n      return result;\n  }\n\n  async getLatestAssessments(limit?: number) {\n    return limit ?\n        assessments.assessments.slice(0, limit) :\n        assessments.assessments;\n  }\n\n  async getStudentGoals() {\n    return studyPlans.StudyPlans;\n  }\n\n  async getStudentFutureAbilities() {\n    return [] as EDSStudentFutureAbility[];\n  }  \n}\n\nfunction avoidSimultanousCalls<T,A>(method: (...args:A[])=>Promise<T>) : (...args:A[])=>Promise<T> {\n  let ongoingPromises: {[argsJson: string]: Promise<T>} = {};\n  return function() {\n    const argsJson = JSON.stringify([].slice.call(arguments));\n    if (!ongoingPromises[argsJson]) {\n      ongoingPromises[argsJson] = method.apply(this, arguments).then(result=>{\n        delete ongoingPromises[argsJson];\n        return result;\n      });\n    }\n    return ongoingPromises[argsJson];\n  }\n}\n","/* REFACTOR: Move this component outside coursebuilder!\n   This is a general-purpose component\n*/\n\nimport * as React from 'react';\n\ninterface Props {\n  title: string | JSX.Element;\n  className?: string;\n  headerClassName?: string;\n  contentClassName?: string;\n  headerOpen?: boolean;\n  onOpenClose?: (becameOpen: boolean) => void;\n  children;\n}\n\ninterface State {\n  headerOpen: boolean;\n}\n\nexport class OpenCloseBox extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      headerOpen: props.headerOpen || false\n    };\n  }\n\n  componentWillReceiveProps (nextProps: Props) {\n    if (nextProps.headerOpen !== this.props.headerOpen) {\n      this.setState({headerOpen: nextProps.headerOpen});\n    }\n  }\n\n  render() {\n    const { title, className, children, headerClassName, contentClassName } = this.props;\n    const { headerOpen } = this.state;\n\n    return <div className={(className||'') + \" openClose\" + (headerOpen ? \" open\" : \"\")}>\n      <div className={\"openHeader\" + (headerClassName ? \" \" + headerClassName : \"\")}\n        onClick={() => {\n          if (this.props.onOpenClose) this.props.onOpenClose(!this.state.headerOpen);\n          this.setState({ headerOpen: !this.state.headerOpen });\n        }} >\n        {title}\n      </div>\n      <div className={\"openContent\" + (contentClassName ? \" \" + contentClassName : \"\")}>\n        {children}\n      </div>\n    </div>;\n  }\n}\n","import moment, { Moment } from \"moment\";\n\nexport function KEDWeek (year: number, week: number) {\n  const m = moment(new Date(year, 1, 1)).locale('sv').week(week);\n  const res = {\n    year,\n    week,\n    notBefore: m.clone().startOf('week').add(-2, 'days').toDate().getTime(),\n    notAfter: m.clone().startOf('week').add(5, 'days').toDate().getTime()\n  };\n  return res;\n}\n\nexport function getAdjustedWeek(m: Moment) {\n  const clone = m.clone().locale('sv');\n  return m.weekday() >= 5 ? // Lördag 00:00 / Söndag 00:00?\n      m.week() + 1 : // Tillhör nästa vecka\n      m.week();\n}\n\n/*export function getWeekLimits (m: Moment) {\n  const clonedSwedish = m.clone().locale('sv');\n  const limits = {\n    notBefore: clonedSwedish.startOf('week').add(-2, 'days'),\n    notAfter: clonedSwedish.startOf('week').add(5, 'days')\n  };\n}\n*/\n","import { KedRepo } from './ked-repo';\nimport { UserHiddenCourse, School, Course } from 'kedbackend/models';\nimport env from '../globals/KED.env';\nimport { EDSCourse } from '../contracts/eds';\nimport { showError, flatten, compareProp, arrayToMap } from '../utils/utils';\nimport { createUUID } from 'kedbackend/client';\nimport { EDSPeriod } from '../apis/edsclient';\nimport { getSchoolMoment } from '../utils/school-moment';\nimport moment from 'moment';\nexport let hiddenCoursesRepo = env.hiddenCoursesRepo as HiddenCoursesRepo;\n\n\nexport interface CourseWithHiddenState {\n  id: string;\n  name: string;\n  description?: string;\n  visible: boolean;\n  defaultVisible: boolean;\n}\n\nexport type HiddenCoursesSubscriber = (courses: CourseWithHiddenState[]) => void;\n\nexport interface SubscriberOptions {\n  fullCourse: boolean;\n}\n\nclass HiddenCoursesRepo {\n  result: CourseWithHiddenState[] | null = null;\n  subscribers: {subscriber: HiddenCoursesSubscriber, options: SubscriberOptions}[] = [];\n  fullCourse: boolean = false;\n  kedCoursesPromise: Promise<Partial<Course>[]>;\n  edsCoursesPromise: Promise<EDSCourse[]>;\n  userHiddenCoursesPromise: Promise<UserHiddenCourse[]>;\n  kedRepo: KedRepo<UserHiddenCourse>;\n\n  constructor() {\n    this.kedRepo = new KedRepo<UserHiddenCourse>({\n      getClient: () => env.kedBackendClient,\n      optimistic: true,\n      table: \"userhiddencourses\",\n      user: env.currentUser ? env.currentUser.mail : \"\",\n      getQueryOptions: async () => ({role: \"USER\"}),\n    });\n\n    const initPromise = this.init();\n\n    Promise.all([\n      initPromise,\n      this.kedCoursesPromise,\n      this.edsCoursesPromise\n    ]).catch(err => showError(err));\n  }\n\n  async init() {\n    // Wait till we have a currentUser that is accurate also for impersonated users.\n    const bearerPromise = env.bearerProvider ? env.bearerProvider.getBearer() : Promise.resolve({});\n\n    // In parallell, we request:\n    //  1) KEDBackend: Schools.activeCourses\n    //  2) EDS.getActiveAcourses()\n    //  3) (via subscription): KEDBackend: userHiddenCourses\n\n    this.kedCoursesPromise = bearerPromise.then(()=>this.listKedCourses());\n    this.edsCoursesPromise = bearerPromise.then(()=>this.listEDSCourses());\n    let resolveUserHiddenCoursesPromise: (x: UserHiddenCourse[])=>void;\n    let userHiddenCoursesResolved = false;\n    this.userHiddenCoursesPromise = new Promise(resolve => resolveUserHiddenCoursesPromise = x => {\n      if (userHiddenCoursesResolved) {\n        this.userHiddenCoursesPromise = Promise.resolve(x);\n      } else {\n        userHiddenCoursesResolved = true;\n        resolve(x);\n      }\n    });\n    await bearerPromise;\n\n    this.kedRepo.mem.subscribe(async userHiddenCourses => {\n      // Change or initial value ready to be notified out.\n      // But first, check we have all the related data responses we need.\n      const [activeCourses, edsActiveCourses] = await Promise.all([\n        this.kedCoursesPromise, \n        this.edsCoursesPromise]);\n      \n      // Refine the three results into a single result\n      this.result = await this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses);\n      // Notify our subscribers:\n      this.subscribers.forEach(subscriber => this.notifySubscriber(subscriber.subscriber, subscriber.options));\n      resolveUserHiddenCoursesPromise(userHiddenCourses);\n    });\n  }\n\n  async listKedCourses() {\n    const fullCourse = this.fullCourse;\n    console.log(\"FullCourse: \"+ fullCourse);\n    const schools = await env.kedBackendClient.list<School>('schools', {\n      role: \"USER\", // Workaround from showing activated templates among courses of the school\n      name: env.currentUser.school,\n      include: \"activeCourses\",\n      flags: fullCourse ? [] : [\"includeIdsAndNamesOnly\"],\n      cacheBust: env.currentUser.username\n    });\n    const activeCourses = flatten(schools.map(school => school.activeCourses)).sort(compareProp(\"name\"))\n    return activeCourses;\n  }\n\n  listEDSCourses(): Promise<EDSCourse[] | null> {\n    const periodName = new EDSPeriod(getSchoolMoment(moment())).period;\n    return env.currentUser.roles.indexOf('EMPLOYEE') === -1 ?\n      // STUDENTs should, by default, only show courses that is listed in EDS\n      env.edsClient.getActiveCourses({periodName}) :\n      // EMPLOYEEs should, by default, show all courses on school - no need to query EDS\n      null;\n  }\n\n  async createCoursesList(\n    edsActiveCourses: EDSCourse[] | null,\n    userHiddenCourses: UserHiddenCourse[],\n    activeCourses: Partial<Course>[]) : Promise<CourseWithHiddenState[]>\n  {\n    const hiddenCoursesMap = arrayToMap(userHiddenCourses.filter(hc => !hc.show), hc => hc.name);\n    const visibleCoursesMap = arrayToMap(userHiddenCourses.filter(hc => hc.show), hc => hc.name);\n\n    const isStudent = env.currentUser.roles.some(role => role === 'STUDENT');\n\n    const edsCourseMap = edsActiveCourses ?\n      arrayToMap(edsActiveCourses, c => c.name.substr(0, 20)) :\n      {};\n\n    const result = await Promise.all(activeCourses.map(async ({id, name, description, modifiedBy}) => {\n\n      const edsCourse = edsCourseMap[name.substr(0, 20)];\n\n      const defaultVisible = isStudent ?\n        edsCourse != null : // Course name also listed in EDS\n        true; // Teachers not dependent on EDS listing\n\n      const visible = defaultVisible ?\n        !hiddenCoursesMap[id] : // Visible unless user has overridden that.\n        !!visibleCoursesMap[id]; // Hidden unless user has overridden that.\n      \n      if (!this.fullCourse && name.length >= 20) {\n        // name could be truncated. Resolve the full name.\n        if (edsCourse) {\n          // Resolve full course name from EDS.\n          name = edsCourse.name;\n        } else if (visible) {\n          // No EDS to fallback to. Unless we wanna print course name as \"THE Partial name\" + \"...\",\n          // we must query the full course here from kedbackend:\n          const fullCourse = await env.kedBackendClient.get(\"courses\", id);\n          name = fullCourse.name;\n        }\n      }\n\n      // Resolve description:\n      if (modifiedBy && modifiedBy.name && !description) {\n        description = `${modifiedBy.name}s version`;\n      }\n\n      return {\n        id,\n        name,\n        description,\n        visible,\n        defaultVisible\n      };\n    }));\n\n    return result;\n  }\n\n  async hideCourse(c: CourseWithHiddenState) {\n    const overrides = this.kedRepo.mem.items.filter(hc => hc.name === c.id);\n    if (c.defaultVisible) {\n      await this.kedRepo.insert([{\n        id: createUUID(),\n        name: c.id\n      }]);\n    } else {\n      await this.kedRepo.delete(overrides.map(ov => ov.id));      \n    }\n  }\n\n  async showCourse(c: CourseWithHiddenState) {\n    const overrides = this.kedRepo.mem.items.filter(hc => hc.name === c.id);\n    if (c.defaultVisible) {\n      await this.kedRepo.delete(overrides.map(ov => ov.id));\n    } else {\n      await this.kedRepo.insert([{\n        id: createUUID(),\n        name: c.id,\n        show: true\n      }]);\n    }\n  }\n\n  notifySubscriber = (subscriber: HiddenCoursesSubscriber, options: SubscriberOptions) => {\n    try {\n      subscriber(options.fullCourse ? this.result : this.result.filter(c => c.visible));\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  async subscribe (subscriber: HiddenCoursesSubscriber, options: SubscriberOptions) {\n    if (!this.fullCourse && options.fullCourse) {\n      // The subscriber demands full courses\n      // Need to query that before notifying\n      // Also affect state for future internal notification\n      this.fullCourse = options.fullCourse;\n      this.kedCoursesPromise = this.listKedCourses(); // Redo this call, now loading full courses\n      // Wait for all outstanding fetch() calls to complete:\n      const [activeCourses, edsActiveCourses, userHiddenCourses] = await Promise.all([\n        this.kedCoursesPromise, \n        this.edsCoursesPromise,\n        this.userHiddenCoursesPromise]);\n      // Assemble result:\n      this.result = await this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses);\n    }\n    await this.userHiddenCoursesPromise; // So we know that this.result is there.\n    this.notifySubscriber(subscriber, options);\n    this.subscribers.push({subscriber, options});\n  }\n\n  unsubscribe (subscriber: HiddenCoursesSubscriber) {\n    this.subscribers = this.subscribers.filter(s => s.subscriber !== subscriber);\n  }\n}\n\nif (!hiddenCoursesRepo) {\n  hiddenCoursesRepo = env.hiddenCoursesRepo = new HiddenCoursesRepo();\n}\n","import { Repo, RepoCommunicator} from './repo';\nimport { KedBackendClient, ListOptions, BatchRunner, createUUID } from 'kedbackend/client';\nimport { Document} from 'kedbackend/models';\n\nexport interface KedRepoOptions<T extends Document> {\n  getClient: ()=>KedBackendClient;\n  getQueryOptions: ()=>Promise<ListOptions>;\n  optimistic: boolean;\n  table: string;\n  user: string;\n}\n\nexport class KedRepo<T extends Document> {\n  mem: Repo<T>;\n  options: KedRepoOptions<T>;\n  \n  constructor(options: KedRepoOptions<T>) {\n    const {table, getClient, getQueryOptions} = options;\n    this.mem = new Repo<T>({query: async ()=>{\n      const queryOptions = await getQueryOptions();\n      return await getClient().list<T>(table, {\n        ...queryOptions,\n        cacheBust: this.getCacheBust()});\n    }});\n    this.options = options;\n  }\n\n  private getCacheBust() {\n    const {table, user} = this.options;\n    const cacheBust = localStorage.getItem('cache-bust-' + table + '-' + user);\n    return cacheBust || this.regenerateCacheBust();\n  }\n\n  private regenerateCacheBust() {\n    const {table, user} = this.options;\n    const cacheBust = createUUID();\n    localStorage.setItem('cache-bust-' + table + '-' + user, cacheBust);\n    return cacheBust;\n  }\n\n  async upsert(item: T, updater: (item: T) => void) {\n    if (!item.$etag) {\n      // Items without $etag cannot be retrieved from server, so it should be inserted.\n      const updatedItem = Object.assign({}, item);\n      updater(updatedItem);\n      return await this.insert([updatedItem]);\n    } else {\n      // We have an $etag, so we can expect it to live on the server.\n      // However, take care of the unlikely situation that it was deleted from server,\n      // and if so, insert it again.\n      await this.update([item], updater).catch(e => {\n        if (e.name === \"http404\" || e.name === \"http403\") {\n          const updatedItem = Object.assign({}, item);\n          updater(updatedItem);\n          return this.insert([updatedItem]);\n        }\n        return Promise.reject(e);\n      });\n    }\n  }\n\n  async update(items: T[], updater: (item: T) => void) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    const modifiedItems: T[] = items.map(item => {\n      const memRepoItem = this.mem.items.find(it => it.id === item.id);\n      item = Object.assign({}, memRepoItem || item);\n      updater(item);\n      return item;\n    });\n    if (optimistic) await this.mem.update(modifiedItems.map(x => Object.assign({}, x, {$meta: 'updating'})));\n    const res = await client.do (br => modifiedItems.forEach(item => br.put(table, item)))\n    .catch(e => e.name === \"http409\" ? // conflict\n      // Get a fresh version from server:\n      client.list<T>(table, {ids: items.map(item => item.id)}, {cache: 'no-cache'}).then(freshItems => {\n        // Update local version:\n        const modifiedItems = freshItems.map(freshItem => {\n          // Clone the fresh item\n          const modified = Object.assign({}, freshItem);\n          // Re-run the updater on the clone:\n          updater(modified);\n          return modified;\n        });\n        // Re-do the the put operation towards the server.\n        return client.do(br => modifiedItems.forEach(item => br.put(table, item)));\n      }) :\n      // Other unexpected error:\n      Promise.resolve(optimistic &&\n        this.mem.update(items)) // Undo optimistic update\n      .then(()=>{\n        return Promise.reject(e); // Reject with the error no matter.\n      }));\n    this.regenerateCacheBust();\n    modifiedItems.forEach(item => {\n      item.$etag = res.newEtags[item.id];\n      item.$meta = undefined;\n    });\n    await this.mem.update(modifiedItems); // Ensures new etag is is applied on next action.\n  }\n\n  stripGraphs (items: T[], graphs: string[]) {\n    return items.map(item => {\n      const clone = Object.assign({}, item);\n      graphs.forEach(graph => {\n        if (item[graph]) {\n          clone[graph] = (item[graph] as {id:string}[]).map (doc => ({id: doc.id}));\n        }\n      });\n      return clone;\n    });\n  }\n\n  async insert(items: T[]) {\n    const {getClient, optimistic, table, getQueryOptions} = this.options;\n    const client = getClient();\n    const queryOptions = await getQueryOptions();\n    const graphs = [].concat(queryOptions.include);\n    // Give IDs to each item:\n    items = items.map(item => item.id ? item : Object.assign({}, item, {id: createUUID()}));\n    const stripped = this.stripGraphs(items, graphs);\n    if (optimistic) await this.mem.insert(stripped.map(x => Object.assign({}, x, {$meta: 'adding'})));\n    const br = new BatchRunner();\n    for (const item of stripped) {\n      // Also add links to all foreign related items:\n      for (const graph of graphs) {\n        const foreignItems: Document[] = item[graph];\n        if (foreignItems) {\n          foreignItems.forEach(doc => {\n            br.link2(table, item.id, graph, doc.id);\n          });\n        }\n      }\n      br.add(table, item);\n    }\n    const res = await client.batch(br.mutationRequests).catch(e => {\n      if (optimistic) this.mem.delete(items.map(item => item.id));\n      return Promise.reject(e);\n    })\n    this.regenerateCacheBust();\n    items.forEach(item => item.$etag = res.newEtags[item.id]);\n    if (optimistic)\n      await this.mem.update(items); // Update with new $etag.\n    else\n      await this.mem.insert(items);\n  }\n\n  async delete (ids: string[]) {\n    const {getClient, optimistic, table} = this.options;\n    const client = getClient();\n    if (optimistic) await this.mem.update(ids\n      .map(id => this.mem.items.find(x => x.id === id))\n      .filter(x => x)\n      .map(x => Object.assign({}, x, {$meta: 'deleting'})));\n    const res = await client.do (br => ids.forEach(id => br.delete(table, id))).catch(async e => {\n      if (optimistic) {\n        await this.mem.update(ids\n          .map(id => this.mem.items.find(x => x.id === id))\n          .filter(x => x)\n          .map(x => {\n            x = Object.assign({}, x);\n            delete x.$meta;\n            return x;\n          }));\n      }\n      throw e;\n    });\n    this.regenerateCacheBust();\n    await this.mem.delete(ids);\n  }\n}\n","import moment from 'moment';\nimport { SchoolMoment, getSchoolMoment, addYear } from './school-moment';\nimport { AcademicYear, Term } from '../contracts/ked-models';\n\ntype Moment = moment.Moment;\n\nfunction isSchoolMoment(obj: Date | SchoolMoment): obj is SchoolMoment {\n  return 'academicYear' in obj;\n}\n\nexport class SchoolTerm {\n  academicYear: AcademicYear;\n  term: Term;\n\n  constructor(dateOrSchoolMoment: Date | SchoolMoment) {\n    const schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?\n      dateOrSchoolMoment : getSchoolMoment(moment(dateOrSchoolMoment));\n    this.academicYear = schoolMoment.academicYear;\n    this.term = schoolMoment.term;\n  }\n\n  get year() {\n    return parseInt(this.academicYear\n        .split('/')[this.term === 'AT' ? 0 : 1]);\n  }\n\n  nextTerm() {\n    return new SchoolTerm(this.term === 'AT' ?\n      {\n        term: 'ST',\n        academicYear: this.academicYear\n      } :\n      {\n        term: 'AT',\n        academicYear: addYear(this.academicYear, 1)\n      });\n  }\n\n  prevTerm() {\n    return new SchoolTerm(this.term === 'AT' ?\n      {\n        term: 'ST',\n        academicYear: addYear(this.academicYear, -1)\n      } :\n      {\n        term: 'AT',\n        academicYear: this.academicYear\n      });\n    \n  }\n\n  toLocaleString(locales: string[], shortYear?: boolean) {\n    let year = this.term === 'AT' ?\n      this.academicYear.split('/')[0]:\n      this.academicYear.split('/')[1];\n\n    if (shortYear)\n      year = year.substr(2);\n\n    for (let locale of locales) {\n      switch (locale.split('-')[0].split('_')[0].toLowerCase()) {\n        case 'en':\n          return `${this.term === 'AT' ? \"AT\" : \"ST\"} ${year}`;\n        case 'sv':\n          return `${this.term === 'AT' ? \"HT\" : \"VT\"} ${year}`;\n      }\n    }\n  }\n}\n","import * as React from 'react';\nimport { L } from \"../../../utils/utils\";\n\ninterface Props {\n  onClick,\n  className?,\n  style?,\n  title?\n};\n\nexport const RemoveItem = ({ onClick, className, style, title }: Props) =>\n\n  <div\n    title={title || L`Radera`}\n    className={\"removeItem \" + (className || \"\")}\n    onClick={onClick} style={style} />\n","import moment from 'moment';\n\nmoment.updateLocale('sv', {\n    months : 'januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december'.split('_'),\n    monthsShort : 'jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec'.split('_'),\n    weekdays : 'söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag'.split('_'),\n    weekdaysShort : 'sön_mån_tis_ons_tor_fre_lör'.split('_'),\n    weekdaysMin : 'sö_må_ti_on_to_fr_lö'.split('_'),\n    longDateFormat : {\n        LT : 'HH:mm',\n        LTS : 'HH:mm:ss',\n        L : 'YYYY-MM-DD',\n        LL : 'D MMMM YYYY',\n        LLL : 'D MMMM YYYY [kl.] HH:mm',\n        LLLL : 'dddd D MMMM YYYY [kl.] HH:mm',\n        lll : 'D MMM YYYY HH:mm',\n        llll : 'ddd D MMM YYYY HH:mm'\n    },\n    calendar : {\n        sameDay: '[Idag] LT',\n        nextDay: '[Imorgon] LT',\n        lastDay: '[Igår] LT',\n        nextWeek: '[På] dddd LT',\n        lastWeek: '[I] dddd[s] LT',\n        sameElse: 'L'\n    },\n    relativeTime : {\n        future : 'om %s',\n        past : 'för %s sedan',\n        s : 'några sekunder',\n        ss : '%d sekunder',\n        m : 'en minut',\n        mm : '%d minuter',\n        h : 'en timme',\n        hh : '%d timmar',\n        d : 'en dag',\n        dd : '%d dagar',\n        M : 'en månad',\n        MM : '%d månader',\n        y : 'ett år',\n        yy : '%d år'\n    },\n    dayOfMonthOrdinalParse: /\\d{1,2}(e|a)/,\n    ordinal : function (number) {\n        var b = number % 10,\n            output = (~~(number % 100 / 10) === 1) ? 'e' :\n            (b === 1) ? 'a' :\n            (b === 2) ? 'a' :\n            (b === 3) ? 'e' : 'e';\n        return number + output;\n    },\n    week : {\n        dow : 1, // Monday is the first day of the week.\n        doy : 4  // The week that contains Jan 4th is the first week of the year.\n    }\n});\n\nexport const localMoment = function () {\n    return moment.apply(this, arguments).locale('sv');\n}\n","import * as React from 'react';\n\ninterface Props {\n  visible: boolean;\n  text: string;\n  className?: string;\n  onConfirm: ()=>void;\n  onCancel: ()=>void;\n}\n\nexport function Confirmation (props: Props) {\n  return <div\n    className={`confirmation-box ${props.className}${props.visible ? \" visible\" : \"\"}`}>\n    <p>{props.text}</p>\n    <button onClick={()=>props.onConfirm()}>OK</button>\n    <button onClick={()=>props.onCancel()}>Avbryt</button>\n  </div>;\n}\n","import * as React from 'react';\nimport { Course, CourseModule, Task, UserTask } from 'kedbackend/models';\nimport env from '../../../globals/KED.env';\nimport { WeekPlannerPersistedState } from \"../../weekplanner/weekplanner-persisted-state\";\nimport moment from 'moment';\nimport { createUUID, BatchRunner, DocumentAccess } from 'kedbackend/client';\nimport { userTasksRepo } from '../../../repos/user-tasks-repo';\nimport { arrayToMap, L } from '../../../utils/utils';\nimport { Spinner } from '../../course-builder/sub-components/spinner';\nimport { Confirmation } from './confirmation';\n\ninterface Props {\n  learningTasks: LearningModuleTask[]\n}\n\ninterface State {\n  weekDate: number;\n  userTasks: UserTask[];\n  confirmations: string[];\n}\n\nexport interface LearningModuleTask {\n  id: string;\n  name: string;\n  url: string;\n  /** courseName\n   * For KG: courseName\n   * For KS: Subject name\n   */\n  courseName: string;\n  /** learningGoal\n   * For KG: module name or learning goal of the task\n   * For KS/step-course: course name\n   * For KS/theme-course: learning goal\n   */\n  learningGoal: string;\n  /** Step\n   * Only present in KS/step-course\n   */\n  step?: number;\n  /** task\n   * Only for courses built by coursebuilder\n   */\n  task?: Task;\n  /** course\n   * Only for courses built by coursebuilder\n   */\n  course?: Course;\n}\n\nexport class TaskList extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      userTasks: [],\n      weekDate: Date.now(),\n      confirmations: []\n    }\n    this.onChange = this.onChange.bind(this);    \n  }\n\n  onChange (userTasks: UserTask[], persisted: WeekPlannerPersistedState) {\n    if (persisted.weekDate !== this.state.weekDate) {\n      this.setState({\n        confirmations: []\n      })\n    }\n    this.setState({\n      userTasks,\n      weekDate: persisted.weekDate\n    });\n  }\n\n  componentDidMount() {\n    userTasksRepo.subscribe(this.onChange);\n  }\n\n  componentWillUnmount() {\n    userTasksRepo.unsubscribe(this.onChange);\n  }\n\n  async toggleTask (learningTask: LearningModuleTask) {\n    const userTasks = this.state.userTasks.filter(ut => {\n      return learningTask.task ?\n        ut.task && ut.task.some(t => t.id === learningTask.id) :\n        ut.siteVisionPageId === learningTask.id;\n    });\n    const {weekDate} = this.state;\n    \n    if (userTasks.length === 0) {\n      // No task matches this learningModuleTask - not present in weekplanner.\n      let latestTimeStamp = Math.max.apply(\n        Math.max,\n        [weekDate].concat(this.state.userTasks.map(t => t.dateTime)));\n\n      const userTask: UserTask = {\n        id: createUUID(),\n        courseName: learningTask.courseName,\n        dateTime: latestTimeStamp + 2000,\n        learningGoal: learningTask.learningGoal,\n        name: learningTask.name,\n        url: learningTask.url,\n        acl: [\n          // Default ACL: Let user self have full control over this item:\n          new DocumentAccess(\"email\", env.currentUser.mail, \"S\"),\n          // Additional ACL: Let employees on same school have read access to it.\n          // This currently only applies to tasks that refer to course tasks (not custom tasks!)\n          new DocumentAccess(\"schoolRole\", `${env.currentUser.school}/EMPLOYEE`, \"R\")\n        ].map(ac => ac.toString())\n      };\n      if (learningTask.task && learningTask.task.deadline) {\n        userTask.deadline = learningTask.task.deadline;\n      }\n      if (learningTask.task && learningTask.course) {\n        userTask.task = [learningTask.task];\n        userTask.course = [learningTask.course];\n      } else {\n        userTask.siteVisionPageId = learningTask.id;\n      }\n      if (learningTask.step) {\n        userTask.step = learningTask.step;\n      }\n      await Promise.all([\n        userTasksRepo.setWeekPlannerBoxOpen(learningTask.courseName, true),\n        userTasksRepo.insert([userTask])]);\n    } else {\n      // Already present in weekplanner. It's time to delete those that matched us.\n      await userTasksRepo.delete(userTasks.map(t => t.id));\n    }\n    \n  }\n\n  render() {\n    const {learningTasks} = this.props;\n    const userTasks = arrayToMap(this.state.userTasks, ut => ut.task && ut.task.length > 0 ?\n      ut.task.map(t => t.id)[0] : // course-builder tasks looked up by id\n      ut.siteVisionPageId ? ut.siteVisionPageId : // non-course-builder tasks\n      ut.url);\n    const {confirmations} = this.state;\n    const weekPlannerWeek = moment(this.state.weekDate).week();\n    const currentWeek = moment().week();\n    const forWeekString = weekPlannerWeek === currentWeek ? \"\" :\n    weekPlannerWeek === currentWeek + 1 ? L`för nästa vecka (v${weekPlannerWeek})` :\n    weekPlannerWeek === currentWeek - 1 ? L`för förra veckan (v${weekPlannerWeek})` :\n    L`för vecka ${weekPlannerWeek}`;\n\n    return <div className=\"taskContainer\">\n      {learningTasks.map((learningTask, idx) => {\n        const taskLookupId = learningTask.id;\n        const userTask = userTasks[taskLookupId] || {$meta: 'deleted'} as Partial<UserTask>; // No exist = $meta: 'deleted'\n        const isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting';\n        const selected = userTask.$meta !== 'deleted' && userTask.$meta !== 'deleting';\n        const describedAction = selected ?\n                  L`Ta bort uppgiften från egen veckoplanering ${forWeekString}` :\n                  L`Lägg till uppgiften i egen veckoplanering ${forWeekString}`;\n        const confirmationVisible =\n          confirmations.some(tid => taskLookupId === tid);\n\n        return <div key={learningTask.id}><div key={taskLookupId} className=\"align-horizontal\">\n          <div className=\"horizontalItem top\">\n              <div\n                className={`selectedBox${selected ? ' selected' : ''}`}\n                style={isWorking ? {opacity: 0.5}: {}}\n                onClick={()=>!isWorking && weekPlannerWeek === currentWeek ?\n                  this.toggleTask(learningTask) :\n                  confirmationVisible ? \n                    this.setState({confirmations: confirmations.filter(tid => tid !== taskLookupId)}) :\n                    this.setState({confirmations: [...confirmations].concat(taskLookupId)})}\n                title={describedAction}>\n              </div>\n          </div>\n          <div className=\"horizontalItem top\">\n            <a href={learningTask.url}>{learningTask.name}</a>\n          </div>\n        </div>\n        <Confirmation\n            visible={confirmationVisible}\n            text={describedAction}\n            onConfirm={()=>{\n              this.toggleTask(learningTask);\n              this.setState({confirmations: confirmations.filter(tid => tid !== taskLookupId)});\n            }}\n            onCancel={()=>{\n              this.setState({confirmations: confirmations.filter(tid => tid !== taskLookupId)});\n            }} />\n        </div>\n        }\n      )}\n    </div>\n  }\n}\n","import { User } from '../contracts/ked-models';\nimport { parseQueryString } from '../utils/query-string';\nimport env from '../globals/KED.env';\n\nexport class Features {\n  EditUserTasksViaPenOnly?: boolean;\n  SubTasks?: boolean;\n  AssignmentTasks?: boolean;\n\n  constructor () {\n    const user = env.currentUser!;\n    const query = parseQueryString(location.search, {toLower: true});\n    const features = ((query.features||'').split(',') as string[])\n      .map(feature => feature.toLowerCase()); // Can be used on forwards...\n\n    this.EditUserTasksViaPenOnly =\n      user.schoolType !== 'Grundskolor' && query.schooltype !== \"Grundskolor\";\n    this.SubTasks =\n      user.schoolType !== 'Grundskolor' && query.schooltype !== \"Grundskolor\";\n    this.AssignmentTasks = !!query.testversion;\n  }\n}\n","\n\nexport interface RepoCommunicator<T extends {id: string}> {\n  query(): Promise<T[]>;\n}\n\ntype Subscriber<T> = (items:T[]) => any;\n\nexport class Repo<T extends {id: string}> {\n  listPromise: Promise<void>;\n  items: T[];\n  subscribers: Subscriber<T>[];\n\n  constructor(public comm: RepoCommunicator<T>) {\n    this.listPromise = null;\n    this.items = null;\n    this.subscribers = [];\n  }\n\n  subscribe(subscriber: Subscriber<T>) {\n    return this.ensureHasData().then(()=>{\n      subscriber(this.items);\n      this.subscribers.push(subscriber);\n    });\n  }\n\n  unsubscribe(subscriber: Subscriber<T>) {\n    this.subscribers = this.subscribers.filter (s => s !== subscriber);\n  }\n\n  notifySubscribers() {\n    this.subscribers.forEach(s => s(this.items));\n  }\n\n  ensureHasData() {\n    if (!this.listPromise) this.refreshFromServer();\n    return this.listPromise;\n  }\n\n  refreshFromServer() {\n    this.listPromise = this.comm.query().then(items => {\n      this.items = items;\n      this.notifySubscribers();\n    });\n    return this.listPromise;\n  }\n  \n  async update(item: T | T[]) {\n    await this.ensureHasData();\n    const items = Array.isArray(item) ? item : [item];\n    this.items = this.items.map(it => {\n      const item = items.find(({id}) => it.id === id);\n      return item ?\n        Object.assign({}, item) :\n        it;\n    });\n    this.notifySubscribers();\n  }\n\n  insert(item: T | T[]) {\n    return this.ensureHasData().then(()=>{\n      this.items = this.items.concat(item);\n      this.notifySubscribers();\n    });\n  }\n\n  delete(id: string | string[]) {\n    const ids = Array.isArray(id) ? id : [id];\n    return this.ensureHasData().then(()=>{\n      this.items = this.items.filter(it => !ids.some(id => it.id === id));\n      this.notifySubscribers();\n    });\n  }\n}\n","import * as React from 'react';\nimport { RemoveItem } from '../course-builder/sub-components/remove-item';\nimport { findDOMNode } from 'react-dom';\nimport $ from 'jquery';\n\ninterface Props {\n  dialogs: React.Component[];\n  popDialog: ()=>void;\n}\n\nexport class Dialogs extends React.Component<Props> {\n  lastDiv: HTMLDivElement | null;\n\n  constructor(props: Props) {\n    super(props);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.lastDiv !== null && prevProps.dialogs.length > this.props.dialogs.length) {\n      // A dialog was closed. Now focus the last dialog:\n      $(findDOMNode(this.lastDiv)).find(':input').first().focus();\n    }\n  }\n\n  render () {\n    this.lastDiv = null;\n    const {dialogs, popDialog} = this.props;\n    $('body').attr('aria-disabled', dialogs.length > 0);\n    $('body').css('overflow', dialogs.length > 0 ? 'hidden' : 'auto');\n\n    return dialogs.length > 0 && <div>\n      {dialogs.map((dialog, idx) => {\n        let div: HTMLDivElement;\n        function onKeyPress(ev: React.KeyboardEvent<HTMLDivElement>) {\n          if (ev.which === 13 && (!ev.target || (ev.target as HTMLElement).tagName !== 'TEXTAREA')) {\n            $(findDOMNode(div)).find('.btn-default').click();\n          }\n          ev.stopPropagation();\n        }\n        function onKeyDown(ev) {\n          if (ev.which === 27) { // Escape\n            popDialog();\n            ev.stopPropagation();\n            return;\n          }\n          if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S\n            const domNode = findDOMNode(div);\n            ev.preventDefault();\n            const defaultButton = $(domNode).find('.btn-default');\n            defaultButton.click();\n            ev.stopPropagation();\n          }\n        }\n        return <div key={idx}>\n      <div className=\"darken\" />\n      <div className=\"modal-page-wrap\">\n        <div className=\"modal-page\" ref={elem => {\n          div = elem;\n          if (idx === dialogs.length - 1) this.lastDiv = elem;\n        }}\n            tabIndex={0}\n            aria-disabled={idx < dialogs.length - 1}\n            onKeyPress={onKeyPress}\n            onKeyDown={onKeyDown}>\n          {dialog}\n          <RemoveItem onClick={popDialog} />\n          <div className=\"stopFloats\"></div>\n        </div>\n      </div>\n    </div>})}\n  </div>;\n  }\n}\n","export function courseNameToCssClass(cssPrefix: string, courseName: string) {\n  return `${cssPrefix}${courseName.substr(0,3).toLowerCase()}`;\n}\n","import { UserTask } from \"kedbackend/models\";\n\nexport function getTaskType (userTask: UserTask) : 'courseBuilderTask' | 'siteVisionTask' | 'customTask' {\n  return userTask.course && userTask.task && userTask.course.length > 0 && userTask.task.length > 0 ?\n    'courseBuilderTask' :\n    userTask.siteVisionPageId ?\n      'siteVisionTask' :\n      'customTask';\n}\n","import * as React from 'react';\nimport { UserTask, Task, UserSubTask } from 'kedbackend/models';\nimport { OpenCloseBox } from '../utility-components/open-close-box';\nimport { L } from '../../utils/utils';\nimport { preserveImpersonationQuery } from '../../access-control';\nimport { courseNameToCssClass } from '../calendar/course-name-to-css-class';\nimport { getTaskType } from './get-task-type';\nimport moment from 'moment';\nimport { VirtualLearningGoal } from './refiner';\nimport { Features } from '../../features';\n\nexport interface UserTasksBoxProps {\n  courseName: string;\n  learningGoals: VirtualLearningGoal[],\n  viewCourseUrl: string;\n  openCourses?: { [path: string]: boolean };\n  setIsOpen?: (courseName: string, isOpen: boolean) => void;\n  setTaskDone?: (task: UserTask, done: boolean) => void;\n  setSubTaskDone: (task: UserTask, subTask: UserSubTask, done: boolean) => void;\n  addOwnTask?: (courseName: string, learningGoalName: string) => void;\n  editTask: (task: UserTask) => void;\n  editSubTask: (task: UserTask, subTask: UserSubTask) => void;\n  removeLearningGoal: (lg: VirtualLearningGoal)=>void;\n};\n\nexport class UserTasksBox extends React.Component<UserTasksBoxProps> {\n  constructor(props: UserTasksBoxProps) {\n    super(props);\n  }\n\n  render() {\n    const {\n      courseName,\n      learningGoals\n    } = this.props;\n    const isOpen = !!this.props.openCourses[courseName];\n    const features = new Features();\n\n    return <OpenCloseBox\n      title={<h5>{courseName || L`Egna lärandemål`}</h5>}\n      headerOpen={isOpen}\n      className={courseName && courseNameToCssClass('wp-course-', courseName)}\n      onOpenClose={becameOpen => this.props.setIsOpen(courseName, becameOpen)}>\n      {learningGoals.map(lg =>\n        <div key={lg.name} className=\"learningGoalContainer\">\n          {lg.step && <div className=\"stepIndicator\">{lg.step}</div>}\n          <div className=\"align-horizontal\">\n            <div className=\"learningGoalText horizontalItem top\">{lg.name}</div>\n            <div className=\"horizontalItem\">\n              &nbsp;<a\n                className=\"trash\"\n                href=\"#\"\n                title=\"Ta bort lärandemålet och dess uppgifter\"\n                onClick={ev=>{\n                  ev.preventDefault();\n                  this.props.removeLearningGoal(lg);\n                }}\n              >\n                <i className=\"fa fa-trash\" />\n              </a>\n            </div>\n          </div>\n\n          <div className=\"learningGoalTasks\">\n            <div className=\"taskContainer\">\n              {lg.tasks.map(userTask => {\n                const isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting' || userTask.$meta === 'updating';\n\n                const taskType = getTaskType(userTask);\n                const expired = moment(userTask.deadline).startOf('day') < moment().startOf('day');\n\n                return <div key={userTask.id} style={isWorking ? { opacity: 0.5 } : {}}>\n                  <div className=\"align-horizontal\">\n                    <div className=\"horizontalItem top\">\n                      <div className={\"checkBox\" + (userTask.done ? \" checked\" : \"\")}\n                        onClick={ev => !isWorking && this.props.setTaskDone(userTask, !userTask.done)}>\n                      </div>\n                    </div>\n                    <div className=\"horizontalItem top\">\n                      {taskType === 'courseBuilderTask' ?\n                        <a href={getTaskUrl(userTask, this.props.viewCourseUrl)}>{userTask.name}</a> :\n                        taskType === 'siteVisionTask' ?\n                          <a href={userTask.url}>{userTask.name}</a> :\n                          <a\n                            className={features.EditUserTasksViaPenOnly && !userTask.url ? \"link-less\": \"\"}\n                            onClick={features.EditUserTasksViaPenOnly ?\n                              undefined :\n                              ev=>{\n                                ev.preventDefault();\n                                this.props.editTask(userTask);\n                              }}\n                            href={userTask.url}\n                            target={(userTask.url+'').toLowerCase().startsWith(location.host.toLowerCase()) ?\n                              \"_self\" :\n                              \"_blank\"}\n                          >{userTask.name}</a>}\n                      {userTask.deadline && <div className={\"dateSet\" + (expired ? ' expired' : '')}>\n                        <i title={moment(userTask.deadline).format(\"YYYY-MM-DD\")} className=\"fa fa-calendar\" aria-hidden=\"true\"\n                          /*style={{cursor: 'pointer'}} */\n                          onClick={()=>{}}></i>\n                      </div>}\n                    </div>\n                    {\n                      features.EditUserTasksViaPenOnly ?\n                      <div className=\"horizontalItem top taskEdit\">\n                        <a className=\"editItem\" onClick={() => this.props.editTask(userTask)} />\n                      </div> : undefined\n                    }\n                  </div>\n                  {userTask.subTasks && <div className=\"subtasks\">\n                    {userTask.subTasks.map(subTask =>\n                      <div key={subTask.id} >\n                        <div className=\"horizontalItem top\">\n                          <div\n                            className={\"checkBox\" + (subTask.done ? \" checked\" : \"\")}\n                            onClick={ev =>\n                              !isWorking &&\n                              this.props.setSubTaskDone(userTask, subTask, !subTask.done)}>\n                          </div>\n                        </div>\n                        <div className=\"horizontalItem top\">\n                          <a\n                            href={subTask.url || undefined}\n                            target={(userTask.url+'').toLowerCase().startsWith(location.host.toLowerCase()) ?\n                            \"_self\" :\n                            \"_blank\"}\n                            className={\n                              subTask.url ?\n                                undefined :\n                                'link-less'\n                          }>{subTask.name}</a>\n                        </div>\n                        <div className=\"horizontalItem top taskEdit\">\n                          <a className=\"editItem\" onClick={() => this.props.editSubTask(userTask, subTask)} />\n                        </div>\n                      </div>)}\n                  </div>}\n                </div>\n              })}\n            </div>\n          </div>\n\n          <div className=\"learningGoalTools\">\n            <div className=\"btn addOwnGoal\"\n              onClick={() => this.props.addOwnTask(this.props.courseName, lg.name)}>\n              <i className=\"fa fa-plus\" aria-hidden=\"true\"></i> {L`Eget arbetsmål`}\n            </div>\n          </div>\n          <br />\n        </div>\n      )}\n    </OpenCloseBox>\n  }\n}\n\nfunction getTaskUrl(userTask: UserTask, viewCourseUrl: string) {\n  if (userTask.course && userTask.course.length > 0 && userTask.task && userTask.task.length > 0) {\n    const courseUrl = preserveImpersonationQuery(viewCourseUrl, { courseId: userTask.course[0].id });\n    return `${courseUrl}#/task/${userTask.task[0].id}`;\n  }\n  return userTask.url;\n}\n","import * as React from 'react';\n\ninterface Props {\n  learningGoal?: string;\n  onSave: (learningGoal: string) => void;\n}\n\ninterface State {\n  learningGoal: string;\n}\n\nexport class AddCustomGoal extends React.Component<Props,State> {\n  constructor (props: Props) {\n    super(props)\n    this.state = {\n      learningGoal: props.learningGoal || ''\n    }\n  }\n\n  render() {\n    const {learningGoal} = this.state;\n    const {onSave} = this.props;\n\n    return <div>\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n          <h2>Lägg till eget lärandemål</h2>\n          <hr />\n          <div className=\"align-horizontal\">\n            <div className=\"horizontalItem top\">Mål:</div>\n            <div className=\"horizontalItem top\">\n              <input type=\"text\" tabIndex={1} size={50} autoFocus\n                value={learningGoal}\n                onChange={e => this.setState({learningGoal: e.target.value})} />\n            </div>\n            <div className=\"horizontalItem top spaced\" />\n          </div>\n          <br /></div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        <button\n          tabIndex={1}\n          className=\"btn btn-large btn-default\"\n          onClick={()=>onSave(learningGoal)}>Spara</button>\n      </div>\n    </div>\n  }\n}\n\n","import * as React from 'react';\n\ninterface Props {\n  label: any;\n  children: any;\n}\n\nfunction findId(node) {\n  const recucheck = new Set();\n  return (function findId(node){\n    if (typeof node === 'string') return null;\n    if (recucheck.has(node)) {\n      debugger;\n      return;\n    }\n    recucheck.add(node);\n    if (node.props) {\n      if (node.props.id) return node.props.id;\n      if (node.props.children) {\n        return findId(node.props.children);\n      }\n      return;\n    }\n    if (node.length) {\n      for (let i=0;i<node.length; ++i) {\n        const child = node[i];\n        if (child) {\n          const childId = findId(child);\n          if (childId) return childId;\n          //console.log(child);\n        }\n      }\n    }\n  })(node);\n}\n\nexport class FormField extends React.Component<Props> {\n  constructor (props: Props) {\n    super(props);\n  }\n\n  render() {\n    return <>\n        <label className=\"kclabel\" htmlFor={findId(this.props.children)}>{this.props.label}</label>\n        {this.props.children}\n    </>\n  }\n}\n","import * as React from 'react';\nimport { FormField } from './form-field';\n\ninterface Props {\n  label: any;\n  id: string;\n  value: string;\n  placeholder?: string;\n  autoFocus?: boolean;\n  children?;\n  onChange: (value: string) => void;\n}\n\nexport class TextInput extends React.Component<Props> {\n  constructor (props: Props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <FormField label={this.props.label}>\n        <div className=\"align-horizontal\">\n          <div className=\"horizontalItem top\">\n            <input type=\"text\" autoFocus={this.props.autoFocus} id={this.props.id} size={35} value={this.props.value}\n              onChange={ev => this.props.onChange(ev.target.value)}\n              placeholder={this.props.placeholder} />\n          </div>\n          {!!this.props.children && <div className=\"horizontalItem\">\n            {this.props.children}\n          </div>}\n        </div>\n      </FormField>\n    );\n  }\n}\n\n","import * as React from 'react';\nimport { FormField } from './form-field';\n\ninterface Props {\n  label: any;\n  id: string;\n  value: string;\n  placeholder?: string;\n  autoFocus?: boolean;\n  rows?: number;\n  children?;\n  onChange: (value: string) => void;\n}\n\nexport class TextAreaFormField extends React.Component<Props> {\n  constructor (props: Props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <FormField label={this.props.label}>\n        <div className=\"align-horizontal\">\n          <div className=\"horizontalItem top\">\n            <textarea autoFocus={this.props.autoFocus} id={this.props.id} cols={35} rows={this.props.rows || 5} value={this.props.value}\n              onChange={ev => this.props.onChange(ev.target.value)}\n              placeholder={this.props.placeholder} />\n          </div>\n          {!!this.props.children && <div className=\"horizontalItem\">\n            {this.props.children}\n          </div>}\n        </div>\n      </FormField>\n    );\n  }\n}\n\n","import * as React from 'react';\nimport { TextInput } from '../utility-components/form-field-text-input';\nimport { TextAreaFormField } from '../utility-components/form-field-textarea';\n\ninterface Props {\n  isTask: boolean\n  onSave: (name: string, description: string, url: string) => void;\n}\n\ninterface State {\n  name: string;\n  description: string;\n  url: string;\n}\n\nexport class AddCustomTask extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props)\n    this.state = {\n      name: '',\n      description: '',\n      url: ''\n    }\n  }\n\n  render() {\n    const { name, description, url } = this.state;\n    const { isTask, onSave } = this.props;\n\n    return <div>\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n        <h2>Lägg till eget arbetsmål</h2>\n        <hr />\n        <TextInput\n          label=\"Namn\"\n          id=\"AddCustomTask:name\"\n          placeholder=\"Ange namn...\"\n          value={name}\n          autoFocus\n          onChange={name => this.setState({name})} />\n\n        <TextAreaFormField\n          rows={7}\n          label=\"Beskrivning\"\n          id=\"AddCustomTask:description\"\n          placeholder=\"Lägg till en beskrivning...\"\n          value={description}\n          onChange={description=>this.setState({description})} />\n\n        <TextInput\n          label=\"Länk\"\n          id=\"AddCustomTask:url\"\n          placeholder=\"http://www...\"\n          value={url}\n          onChange={name => this.setState({url})} />\n\n      </div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        <button\n          tabIndex={1}\n          className=\"btn btn-large btn-default\"\n          onClick={() => onSave(name, description, url)}>Spara</button>\n      </div>\n    </div>\n  }\n}\n\n","import * as React from 'react';\nimport { TextInput } from '../utility-components/form-field-text-input';\nimport { TextAreaFormField } from '../utility-components/form-field-textarea';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport { userTasksRepo } from '../../repos/user-tasks-repo';\nimport { createUUID } from 'kedbackend/client';\n\ntype Props = {\n  // Edit Mode\n  mode: 'add';\n  userTask: UserTask;\n  closeDialog;\n} | {\n  mode: 'edit';\n  userTask: UserTask;\n  subTask: UserSubTask;\n  closeDialog: ()=>void;\n}\n\ninterface State {\n  name: string;\n  description: string;\n  url: string;\n}\n\nexport class AddOrEditSubTask extends React.Component<Props,State> {\n  constructor (props: Props) {\n    super(props);\n    if (props.mode === 'edit') {\n      const {subTask} = props;\n      this.state = {\n        name: subTask.name || '',\n        description: subTask.description || '',\n        url: subTask.url || ''\n      };\n    } else {  \n      this.state = {\n        name: '',\n        description: '',\n        url: ''\n      };\n    }\n  }\n\n  save() {\n    // Update repo:\n    const {props} = this;\n    const {userTask, closeDialog} = props;\n    const {name, description, url} = this.state;\n    if (props.mode === 'edit') {\n      // Edit existing:\n      userTasksRepo.update([userTask], ut => {\n        const {subTasks} = ut;\n        if (subTasks) {\n          ut.subTasks = subTasks.map(st =>\n            st.id === props.subTask.id ? {...st, name, description, url} :\n            {...st}\n          );\n        }\n      });\n    } else {\n      // Create new task\n      const newSubTask = {\n        id: createUUID(),\n        name,\n        description,\n        url\n      };\n\n      // Update repo:\n      userTasksRepo.update([userTask], ut => {\n        if (!ut.subTasks) {\n          ut.subTasks = [];\n        }\n        ut.subTasks = ut.subTasks.concat(newSubTask);\n      });\n    }\n\n    // Close dialog\n    closeDialog();    \n  }\n\n  delete() {\n    // Update repo:\n    const props = this.props;  \n    if (props.mode !== 'edit') {\n      throw new Error(\"Can only delete in edit mode\");\n    }\n    userTasksRepo.update([props.userTask], ut => {\n      if (ut.subTasks) {\n        ut.subTasks = ut.subTasks.filter(t => t.id !== props.subTask.id);\n      }\n    });\n\n    // Close dialog:\n    props.closeDialog();\n  }\n\n  render() {\n    const {name, description, url} = this.state;\n    const {props} = this;\n    const isEditMode = props.mode === 'edit';\n    \n    return <>\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n        <h2>{isEditMode ? 'Redigera underuppgift' : 'Lägg till underuppgift'}</h2>\n        <hr />\n        <TextInput\n          autoFocus\n          label=\"Underuppgiftens namn\"\n          id=\"AddUserSubTask:name\"\n          placeholder=\"\"\n          value={this.state.name}\n          onChange={name => this.setState({name})}\n            />\n        <TextAreaFormField\n          label=\"Beskrivning\"\n          id=\"AddUserSubTask:description\"\n          rows={7}\n          placeholder=\"\"\n          value={this.state.description}\n          onChange={description => this.setState({description})}\n            />\n        <TextInput\n          label=\"Länk\"\n          id=\"AddUserSubTask:url\"\n          placeholder=\"\"\n          value={this.state.url}\n          onChange={url => this.setState({url})}\n            />\n        <br />\n      </div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        {\n          props.mode === 'edit' && <button className=\"btn btn-warning btn-large pull-right\"\n          onClick={ev => this.delete()}>\n          {\"Ta bort underuppgift\"}</button>}\n        <button\n          tabIndex={1}\n          className=\"btn btn-large btn-default\"\n          onClick={()=>this.save()}>Spara</button>\n      </div>\n    </>\n  }\n}\n\n","import * as React from 'react';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport { RenameableText } from '../utility-components/renameable-text';\nimport { L } from '../../utils/utils';\nimport { getTaskType } from './get-task-type';\nimport ReactDatePicker, { ReactDatePickerProps } from 'react-datepicker';\nimport '../../globals/moment-sv-locale';\nimport {TextInput} from '../utility-components/form-field-text-input';\nimport moment from 'moment';\nimport { FormField } from '../utility-components/form-field';\nimport { AddOrEditSubTask } from './add-or-edit-sub-task';\nimport { createUUID } from 'kedbackend/client';\nimport update from 'react-addons-update';\nimport { userTasksRepo } from '../../repos/user-tasks-repo';\nimport { TextAreaFormField } from '../utility-components/form-field-textarea';\n\ninterface Props {\n  userTask: UserTask;\n  onUpdate: (updater: (userTask: UserTask) => void) => void;\n  onDelete: (userTaskId: string) => void;\n  openDialog: (dialog) => void;\n  closeDialog: ()=>void;\n}\n\ninterface State {\n  userTask: UserTask;\n  name: string;\n  description?: string;\n  deadline?: string;\n  url: string;\n  subTasks?: UserSubTask[];\n  showCalendar?: boolean;\n}\n\nexport class EditUserTask extends React.Component<Props,State> {\n  datePicker: any;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      userTask: props.userTask,\n      name: props.userTask.name,\n      description: props.userTask.description,\n      url: props.userTask.url,\n      deadline: props.userTask.deadline,\n      subTasks: props.userTask.subTasks\n    }\n    this.onUserTasksChanged = this.onUserTasksChanged.bind(this);\n  }\n\n  componentDidMount() {\n    userTasksRepo.subscribe(this.onUserTasksChanged);\n  }\n\n  onUserTasksChanged(userTasks: UserTask[]) {\n    const myUserTask = userTasks.find(ut => ut.id === this.props.userTask.id);\n    if (!myUserTask) {\n      this.props.closeDialog();\n      return;\n    }\n    this.setState({\n      userTask: myUserTask,\n      subTasks: myUserTask.subTasks\n    });\n  }\n\n  componentWillUnmount() {\n    userTasksRepo.unsubscribe(this.onUserTasksChanged);\n  }\n\n  isModified() {\n    // Don't count subtask changes! They live their own life and is maintained\n    // in add-or-edit-sub-task.tsx. Reason: User would expect added /edited subtasks\n    // to be persisted right away. May click away this dialog.\n    // Also reason: Can invoke that dialog by itself from other components. From WeekPlanner\n    // when clicking the subtask for example!\n\n    const {deadline, description, name, url, userTask} = this.state;\n    return (\n      deadline !== userTask.deadline ||\n      description !== userTask.description ||\n      name !== userTask.name ||\n      url !== userTask.url);\n  }\n\n  addSubTask(): any {\n    this.props.openDialog(<AddOrEditSubTask\n      mode=\"add\"\n      userTask={this.state.userTask}\n      closeDialog={this.props.closeDialog}\n    />);\n  }\n\n  editSubTask(subTask: UserSubTask) {\n    this.props.openDialog(<AddOrEditSubTask\n      mode=\"edit\"\n      subTask={subTask}\n      userTask={this.state.userTask}\n      closeDialog={this.props.closeDialog}\n    />);\n  }\n  \n  render() {\n    const { name, description, url, deadline, subTasks, showCalendar, userTask } = this.state;\n    const { id, courseName } = userTask;\n    const { onUpdate, onDelete } = this.props;\n    const isModified = this.isModified();\n\n    const taskType = getTaskType(userTask);\n    const isCustomTask = taskType === 'customTask';\n    const expired = moment(userTask.deadline) < moment();\n\n    return <div className=\"editTaskDialog sv-html-portlet sv-portlet sv-skip-spacer\">\n      <h2>{isCustomTask ? `Redigera arbetsmål` : `Redigera uppgift`}</h2>\n      <hr />\n      <TextInput\n        autoFocus\n        label={isCustomTask ? \"Arbetsmålets namn\" : \"Uppgiftens namn\"}\n        id=\"EditUserTask:name\"\n        placeholder={isCustomTask ? \"Vad ska du göra?\" : \"Ange uppgiftens namn...\"}\n        value={name}\n        onChange={name => this.setState({name})} />\n      \n      {isCustomTask && <>\n        <TextAreaFormField\n          rows={5}\n          label=\"Beskrivning\"\n          id=\"EditUserTask:description\"\n          placeholder=\"Lägg till en beskrivning...\"\n          value={description}\n          onChange={description=>this.setState({description})} />\n\n        <TextInput\n          label=\"Länk\"\n          id=\"EdutUserTask:url\"\n          placeholder=\"http(s)://...\"\n          value={url}\n          onChange={url => this.setState({url})} >\n\n        </TextInput></>}\n\n        <FormField label=\"Ange deadline\">\n          {(deadline || showCalendar) ?\n            <div className=\"align-horizontal\">\n              <div className=\"horizontalItem top\">\n                <ReactDatePicker ref={elem => this.datePicker = elem}\n                  id=\"EditUserTask:deadline\"\n                  selected={deadline && moment(deadline)}\n                  autoFocus={showCalendar}\n                  dateFormat=\"YYYY-MM-DD\"\n                  className={expired ? \"expired\" : undefined}\n                  locale={\"sv\"}\n                  popperPlacement={isCustomTask ? \"top-start\" : \"bottom-start\"}\n                  onBlur={()=>this.setState({showCalendar: false})}\n                  onChange={value=>{\n                    this.setState({\n                      deadline: value && value.format(\"YYYY-MM-DD\"),\n                      showCalendar: false\n                    });\n                  }}\n                />\n              </div>\n              <div className=\"horizontalItem top\">\n                <a className=\"deleteDate\" href=\"#\" title=\"Ta bort deadline\" onClick={ev=>{\n                  ev.preventDefault();\n                  this.setState({deadline: null, showCalendar: false});\n                }}></a>\n              </div>\n            </div> :\n            <div className=\"top\" ref={()=>{this.datePicker = null}}>\n                <a className=\"btn\" onClick={ev => {\n                  if (this.datePicker) {\n                    this.datePicker.setOpen(true);\n                  }\n                  this.setState({\n                    showCalendar: true\n                  });\n                }}>\n                <i className=\"fa fa-calendar\" aria-hidden=\"true\"></i> Ange deadline...\n              </a>              \n            </div>}\n        </FormField>\n      <FormField label=\"Underuppgifter\">\n        <div className=\"learningGoalTasks\">\n          <div className=\"taskContainer\">\n\n              {subTasks && subTasks.map(subTask => <div key={subTask.id} className=\"align-horizontal\">\n                <div className=\"horizontalItem top\"><a\n                  onClick={()=>this.editSubTask(subTask)}\n                  href=\"#\">{subTask.name}</a></div>\n              </div>)}\n          </div>\n        </div>\n        <div className=\"align-horizontal\">\n          <div className=\"top\">\n            <button id=\"EditUserTask:addSubTask\" className=\"btn\"\n              onClick={()=>this.addSubTask()}>\n              <i className=\"fa fa-plus\" aria-hidden=\"true\"></i> Lägg till underuppgift\n            </button>\n          </div>\n        </div>\n      </FormField>\n      <div className=\"divider large\" />\n      <div className=\"align-horizontal\">\n        <div className=\"horizontalButton top\">\n          <button tabIndex={1}\n            className=\"btn btn-default\"\n            onClick={()=>{\n              isModified ? onUpdate(userTask => {\n                userTask.name = name;\n                userTask.description = description;\n                userTask.url = url;\n                userTask.deadline = deadline;\n              }) : this.props.closeDialog();\n            }}> Spara </button>\n        </div>\n        <div className=\"horizontalButton top\">\n          <button tabIndex={1}\n            className=\"btn\"\n            onClick={()=>{\n              this.props.closeDialog();\n            }}> Avbryt </button>\n        </div>\n        <div className=\"confirm top pull-right\">\n          <button\n            tabIndex={1}\n            className=\"btn btn-warning\"\n            onClick={()=>{\n              onDelete(id);\n            }}>{isCustomTask ?\n              \" Ta bort arbetsmål\" :\n              \" Ta bort den här uppgiften\"\n          }</button>\n        </div>\n      </div>\n                  \n      {/*<div className=\"btn btn-warning btn-large pull-right\" onClick={ev => onDelete(id)}>\n        {L`Ta bort arbetsmål`}</div>\n      {isModified &&\n        <div\n          className=\"btn btn-large btn-default\"\n          tabIndex={0}\n          onClick={()=>onUpdate(userTask => {\n            userTask.name = name;\n            userTask.description = description;\n            userTask.url = url;\n          })}> Spara</div>}*/}\n    </div>\n  }\n}\n\n","\nexport class PendingJob {\n  private timeoutId = null;\n  private cancelled = false;\n  private pending = false;\n  private isJobExecuting = false;\n  private jobCallback: ()=>Promise<any>;\n  \n  constructor(callback: ()=>Promise<any>) {\n    this.jobCallback = callback;\n  }\n\n  triggerChange(throttle: number): any {\n    if (this.cancelled) return;\n    this.pending = true;\n    if (this.timeoutId !== null)\n      clearTimeout(this.timeoutId);\n    this.timeoutId = setTimeout(()=>this.launchJob(), throttle);\n  }\n\n  stop() {\n    if (this.timeoutId !== null)\n      clearTimeout(this.timeoutId);\n    this.timeoutId = null;\n    this.cancelled = true;\n  }\n\n  private async launchJob() {\n    if (this.cancelled) return;\n    if (!this.pending) return;\n    if (this.isJobExecuting) return;\n    this.timeoutId = null;\n    try {\n      this.isJobExecuting = true;\n      this.pending = false;\n      await this.jobCallback();\n    } finally {\n      this.isJobExecuting = false;\n    }\n    if (this.pending)\n      await this.launchJob();\n  }\n}\n","import * as React from 'react';\nimport { UserTasksBox } from './user-tasks-box';\nimport { UserTask, UserSubTask } from 'kedbackend/models';\nimport { createUUID, HttpError } from \"kedbackend/client\";\nimport { refine, VirtualLearningGoal } from './refiner';\nimport env from '../../globals/KED.env';\nimport { userTasksRepo } from '../../repos/user-tasks-repo';\nimport { L, compareProp } from '../../utils/utils';\nimport moment from 'moment';\n//import { CustomGoal } from '../../contracts/ked-models';\nimport { TSON } from '../../utils/tson';\nimport { WeekPlannerPersistedState } from './weekplanner-persisted-state';\nimport { RemoveItem } from '../course-builder/sub-components/remove-item';\nimport { Dialogs } from '../utility-components/dialogs';\nimport { AddCustomGoal } from './add-custom-goal';\nimport { AddCustomTask } from './add-custom-task';\nimport { EditUserTask } from './edit-user-task';\nimport { Spinner } from '../course-builder/sub-components/spinner';\nimport { OpenCloseBox } from '../utility-components/open-close-box';\nimport { PendingJob } from '../../utils/pending-job';\nimport { AddOrEditSubTask } from './add-or-edit-sub-task';\nimport { getAdjustedWeek, KEDWeek } from '../../utils/weekutil';\n\ninterface Props {\n  viewCourseUrl: string;\n}\n\ninterface State {\n  weekDate: number;\n  dialogs: any[];\n  userTasks: UserTask[];\n  openCourses: { [path: string]: boolean }\n  strategy?: string;\n  assessment?: string;\n  weekTextsUT: UserTask | null;\n  saving: boolean;\n  isLoading: boolean;\n}\n\nexport class WeekPlanner extends React.Component<Props,State> {\n  weekTextsSavingJob: PendingJob;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      userTasks: [],\n      weekDate: Date.now(),\n      openCourses: {},\n      dialogs: [],\n      saving: false,\n      weekTextsUT: null,\n      isLoading: true\n    }\n    this.onChange = this.onChange.bind(this);\n    this.weekTextsSavingJob = new PendingJob(()=>this.saveWeekTexts());\n  }\n\n  componentDidMount() {\n    userTasksRepo.subscribe(this.onChange);\n  }\n\n  componentWillUnmount() {\n    userTasksRepo.unsubscribe(this.onChange);\n    this.weekTextsSavingJob.stop();\n  }\n\n  onChange(userTasks: UserTask[], persisted: WeekPlannerPersistedState, weekTextsUT: UserTask) {\n    const newState : Partial<State> = {\n      userTasks,\n      weekDate: persisted.weekDate,\n      openCourses: persisted.openCourses,\n      weekTextsUT,\n      isLoading: false\n    }\n    if (!this.state.weekTextsUT || (weekTextsUT.dateTime !== this.state.weekTextsUT.dateTime)) {\n      // Changing week. Reset to new week's values\n      newState.strategy = weekTextsUT.weekTexts.strategy;\n      newState.assessment = weekTextsUT.weekTexts.assessment;\n    }\n    this.setState(newState as any); // React's use of Pick instead of Partial makes things complex here.\n  }\n\n  isWeekTextsEdited() {\n    const { strategy, assessment, weekTextsUT } = this.state;\n    return !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy || assessment !== weekTextsUT.weekTexts.assessment);\n  }\n\n  private async saveWeekTexts() {\n    console.log(\"Saving texts...\");\n    const { strategy, assessment, weekTextsUT } = this.state;\n    if (this.isWeekTextsEdited()) {\n      await userTasksRepo.upsert(weekTextsUT, ut => {\n        ut.weekTexts = { strategy, assessment };\n      });\n    }\n  }\n\n  prevWeek() {\n    //this.saveWeekTexts();\n    userTasksRepo.changeWeek(moment(this.state.weekDate).add(-1, 'week').toDate());\n  }\n\n  nextWeek() {\n    //this.saveWeekTexts();\n    userTasksRepo.changeWeek(moment(this.state.weekDate).add(1, 'week').toDate());\n  }\n\n  openDialog(dialog) {\n    this.setState({ dialogs: [...this.state.dialogs, dialog] });\n  }\n\n  openAddGoalDialog() {\n    this.openDialog(<AddCustomGoal\n      onSave={async (learningGoal: string) => {\n        if (!learningGoal) throw new Error (L`Lärandemålet kan inte vara tomt`);\n        if (!this.state.saving) {\n          this.setState({ saving: true });\n          try {\n            await this.addCustomGoal(learningGoal);\n          } finally {\n            this.setState({ saving: false });\n          }\n          this.closeDialog();\n        }\n      }} />);\n  }\n\n  openAddOwnTaskDialog(courseName: string, learningGoalName: string) {\n    this.openDialog(<AddCustomTask\n      isTask={!courseName}\n      onSave={async (name: string, description: string, url: string) => {\n        if (!name) throw new Error (L`Namnet kan inte vara tomt`);\n        if (!this.state.saving) {\n          this.setState({ saving: true });\n          try {\n            await this.addCustomTask(courseName, learningGoalName, name, description, url);\n          } finally {\n            this.setState({ saving: false });\n          }\n          this.closeDialog();\n        }\n      }} />);\n  }\n\n  editTask(userTask: UserTask) {\n    this.openDialog(<EditUserTask\n      userTask={userTask}\n      onUpdate={async (updater: (ut: UserTask) => void) => {\n        const test = {...userTask};\n        updater(test);\n        if (!test.name) throw new Error (L`Namnet får inte vara tomt`);\n        this.closeDialog();\n        await userTasksRepo.update([userTask], updater);\n      }}\n      onDelete={async id => {\n        this.closeDialog();\n        await userTasksRepo.delete([id]);\n      }}\n      openDialog={dialog=>this.openDialog(dialog)}\n      closeDialog={()=>this.closeDialog()}\n    />);\n  }\n\n  editSubTask(userTask: UserTask, subTask: UserSubTask) {\n    this.openDialog(<AddOrEditSubTask\n      mode=\"edit\"\n      userTask={userTask}\n      subTask={subTask}\n      closeDialog={()=>this.closeDialog()}\n    />);\n  }\n\n  closeDialog() {\n    this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });\n  }\n\n\n\n  async addCustomGoal(learningGoal: string) {\n    let latestTimeStamp = Math.max.apply(\n      Math.max,\n      [this.state.weekDate].concat(this.state.userTasks.map(t => t.dateTime)));\n\n    await userTasksRepo.insert([{\n      id: createUUID(),\n      learningGoal,\n      dateTime: latestTimeStamp + 2000\n    }]);\n\n    await userTasksRepo.setWeekPlannerBoxOpen(\"\", true);\n  }\n\n  async removeLearningGoal(learningGoal: VirtualLearningGoal) {\n    if (learningGoal.tasks.length > 0) {\n      if (!confirm(`Ta bort lärandemål samt ${learningGoal.tasks.length} uppgifter?`)) {\n        return;\n      }\n    }\n    await userTasksRepo.delete(learningGoal.allTasks.map(t => t.id));\n  }\n\n  async addCustomTask(courseName: string, learningGoal: string, name: string, description: string, url: string) {\n    let latestTimeStamp = Math.max.apply(\n      Math.max,\n      [this.state.weekDate].concat(this.state.userTasks.map(t => t.dateTime)));\n\n    /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>\n      ut.name == null &&\n      !ut.courseName &&\n      ut.learningGoal === learningGoal);\n\n    if (emptyLearningGoalPlaceholder) {\n      // Hijack learning-goal placeholder and make it the real task.\n      // This will make the learning goal disappear once this task\n      // is deleted.\n      await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {\n        Object.assign(ut, { name, description, url });\n      });\n    } else {*/\n      // Add another task to same learning-goal\n      await userTasksRepo.insert([{\n        id: createUUID(),\n        dateTime: latestTimeStamp + 2000,\n        courseName,\n        learningGoal,\n        name,\n        description,\n        url\n      }]);\n    //}\n  }\n\n  setIsOpen(courseName: string, isOpen: boolean) {\n    userTasksRepo.setWeekPlannerBoxOpen(courseName, isOpen);\n  }\n\n  async setTaskDone(task: UserTask, done: boolean) {\n    await userTasksRepo.setTaskDoneState(task, done);\n  }\n\n  async setSubTaskDone(task: UserTask, subTask: UserSubTask, done: boolean) {\n    await userTasksRepo.setSubTaskDoneState(task, subTask.id, done);\n  }\n\n  async copyFromPreviousWeek() {\n    const { userTasks, openCourses, weekDate } = this.state;\n    const prevWeekNo = getAdjustedWeek (moment(weekDate).add(-1, 'week'));\n    const prevKEDWeek = KEDWeek(moment(weekDate).year(), prevWeekNo);\n    // Read last week's goals and tasks\n    let prevTasks = await env.kedBackendClient.list<UserTask>(\"usertasks\", {\n      from: prevKEDWeek.notBefore,\n      to: prevKEDWeek.notAfter,\n      role: \"USER\",\n      include: [\"task\", \"course\", \"acl\"],\n      flags: [\"includeIdsOnly\"]\n    });\n    prevTasks = prevTasks\n      .filter(prevTask => !prevTask.done)  // Don't copy done tasks\n      .filter(prevTask => !!prevTask.name) // Don't copy empty learning goals\n      .filter(prevTask => !userTasks.some(taskOfCurrentWeek =>\n        taskOfCurrentWeek.name === prevTask.name &&\n        taskOfCurrentWeek.learningGoal === prevTask.learningGoal &&\n        taskOfCurrentWeek.courseName === prevTask.courseName)); // Ignore identical tasks (already copied)\n\n    // Now create copies but place them in the current week.\n    let latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(userTasks.map(t => t.dateTime)));\n\n    const copies = prevTasks.sort(compareProp(\"dateTime\")).map(task => {\n      const copy: UserTask = { ...task, dateTime: latestTimeStamp += 1000 };\n      copy.id = createUUID();\n      if (copy.subTasks) {\n        copy.subTasks = copy.subTasks.filter(st => !st.done);\n      }\n      delete copy.$etag;\n      return copy;\n    });\n\n    // Store it\n    await userTasksRepo.insert(copies);\n  }\n\n  render() {\n    const weekNumber = moment(this.state.weekDate).week();\n    //console.log(\"Weekydate: \"  + new Date(this.state.weekDate) + \" which is week no \" + weekNumber);\n    const currentWeek = moment().week();\n    const taskSets = refine(this.state.userTasks);\n    const { dialogs, weekTextsUT, strategy, assessment, isLoading } = this.state;\n    const isSaving = weekTextsUT && (weekTextsUT.$meta === 'adding' || weekTextsUT.$meta === 'updating');\n    const isStrategyEdited = !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy);\n    const isAssessmentEdited = !!weekTextsUT && (assessment !== weekTextsUT.weekTexts.assessment);\n    const enableSaveButton = !isSaving && (isStrategyEdited || isAssessmentEdited);\n    return <div>\n      <div className={`ked_boxed weekPlanner${weekNumber === currentWeek ? \" currentWeek\" : \"\"}`}\n        onKeyDown={ev => {\n          if (ev.which === 83 && ev.ctrlKey) {\n            ev.preventDefault();\n            if (!isSaving && this.isWeekTextsEdited()) {\n              this.weekTextsSavingJob.triggerChange(0);\n            }\n          }\n        }}>\n        <div className={`weekSelect`}>\n          <div className=\"horizontalItem\">\n            <p>{L`Vecka ${weekNumber}`}</p>\n          </div>\n          <div className=\"horizontalItem\">\n            <div className=\"btn-group\">\n              <button className=\"btn\" onClick={() => this.prevWeek()}>\n                <i className=\"fa fa-angle-left\" aria-hidden=\"true\"></i>\n              </button>\n              <button className=\"btn\" onClick={() => this.nextWeek()}>\n                <i className=\"fa fa-angle-right\" aria-hidden=\"true\"></i>\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <h4>{L`Loggbok`}</h4>\n        {taskSets.length > 0 && <hr />}\n\n        {taskSets.map(props =>\n          <UserTasksBox\n            key={props.courseName}\n            {...props}\n            courseName={props.courseName}\n            learningGoals={props.learningGoals}\n            viewCourseUrl={this.props.viewCourseUrl}\n            openCourses={this.state.openCourses}\n            addOwnTask={(courseName: string, learningGoalName: string) => this.openAddOwnTaskDialog(courseName, learningGoalName)}\n            setIsOpen={this.setIsOpen.bind(this)}\n            setTaskDone={this.setTaskDone.bind(this)}\n            setSubTaskDone={this.setSubTaskDone.bind(this)}\n            editTask={task => this.editTask(task)}\n            editSubTask={(task, subTask) => this.editSubTask(task, subTask)}\n            removeLearningGoal={lg => this.removeLearningGoal(lg)} />)}\n\n        <hr />\n\n        {isLoading ? <Spinner /> : <div>\n          <div className=\"btn\" onClick={ev => this.openAddGoalDialog()}>\n            <i className=\"fa fa-list-alt\" aria-hidden=\"true\"></i> {L`Eget lärandemål`}\n\n          </div>\n          <div className=\"btn\" onClick={ev => this.copyFromPreviousWeek()}>\n            <i className=\"fa fa-clone\" aria-hidden=\"true\"></i> {L`Kopiera ej klara från föregående vecka`}\n          </div>\n          <OpenCloseBox\n            title={<h5>{L`Strategi & Utvärdering`}</h5>}\n            headerOpen={this.state.openCourses[\"StratUtv\"]}\n            onOpenClose={becameOpen => this.setIsOpen(\"StratUtv\", becameOpen)}\n          >\n            <h3>Strategi</h3>\n            <p>Hur jag ska göra för att lära mig.</p>\n            <hr/>\n            <textarea\n              className=\"weekplanner-textarea\"\n              value={strategy}\n              onChange={ev => {\n                this.setState({strategy: ev.target.value});\n                this.weekTextsSavingJob.triggerChange(500);\n              }} />\n\n            <h3>Utvärdering</h3>\n            <p>Reflektion kring din arbetsinsats och dina valda strategier under veckan.\n              Utvärdera i förhållande till dina mål.</p>\n            <hr/>\n            <textarea\n              className=\"weekplanner-textarea\"\n              value={assessment}\n              onChange={ev => {\n                this.setState({assessment: ev.target.value})\n                this.weekTextsSavingJob.triggerChange(500);\n              } }/>\n            <div\n              className=\"btn\"\n              tabIndex={0}\n              style={enableSaveButton ? {} : {opacity: 0.5}}\n              onClick={()=>!isSaving && this.weekTextsSavingJob.triggerChange(0)}>\n                <i className=\"fa fa-floppy-o\" aria-hidden=\"true\" />\n                  {enableSaveButton ? \" Spara\" : \" Sparad\"}\n            </div>\n        </OpenCloseBox>\n\n        </div>}\n      </div>\n      <Dialogs\n        dialogs={dialogs}\n        popDialog={() => {\n            this.setState(\n              ({dialogs}) => ({ dialogs: dialogs.slice(0, dialogs.length - 1) }));\n          }\n        } />\n    </div>\n  }\n}\n","import { UserTask } from 'kedbackend/models';\nimport { UserTasksBoxProps } from './user-tasks-box';\nimport { arrayToMap, arrayToLookup, compareProp, L } from \"../../utils/utils\";\n\nexport interface VirtualLearningGoal {\n  name: string;\n  allTasks: UserTask[];\n  step?: number;\n  url?: string;\n  tasks: UserTask[];\n}\n\nexport function refine(tasks: UserTask[]) {\n  const result = [] as Partial<UserTasksBoxProps>[];\n  const mapper = {} as { [name: string]: UserTasksBoxProps };\n  const tasksPerCourse = arrayToLookup(tasks, t => t.courseName || '');\n  for (const courseName of Object.keys(tasksPerCourse).sort().filter(x => x).concat(tasksPerCourse[''] ?\n    [''] : [])) {\n    const courseTasks = tasksPerCourse[courseName] || tasksPerCourse[''];\n    const tasksPerLearningGoal = arrayToLookup(courseTasks, t => t.learningGoal);\n    const resultLearningGoals: VirtualLearningGoal[] = [];\n    for (const learningGoal of Object.keys(tasksPerLearningGoal)) {\n      const lgTasks = tasksPerLearningGoal[learningGoal].sort(compareProp(\"dateTime\"));\n      const learningGoalTask = lgTasks\n        .filter(t => t.name == null) // If name is undefined or null, this represents a learning goal\n        [0];\n      const url = learningGoalTask && learningGoalTask.url;\n      resultLearningGoals.push({\n        name: learningGoal,\n        allTasks: lgTasks,\n        url,\n        step: lgTasks.map(t => t.step).filter(step => step)[0],\n        tasks: lgTasks.filter(t => t.name)\n      });\n    }\n    result.push({\n      courseName,\n      learningGoals: resultLearningGoals\n    });\n  }\n  return result;\n}\n","import env from '../globals/KED.env';\nimport cfg from '../globals/KED.cfg';\nimport { KedBackendClientWeb } from 'kedbackend/clientweb';\n\nenv.kedBackendClient = new KedBackendClientWeb (\n  cfg.KED_API_URL,\n  env.bearerProvider);\n\n","import { parseQueryString, generateQueryString, splitUrlAndQuery } from \"../utils/query-string\";\nimport { KedBackendClientWeb, WebServerBearerProvider, isomorphic, storage } from 'kedbackend/clientweb';\nimport { BearerProvider, KedBearerProvider } from 'kedbackend/client';\nimport cfg from '../globals/KED.cfg';\nimport env from '../globals/KED.env';\nimport { User } from \"../contracts/ked-models\";\nimport { IMPERSONATION_QUERY_PARAMS } from \"../access-control/index\";\nimport { cherryPickProps } from \"../utils/utils\";\n\nfunction getMergedTokenPath(tokenPath: string, locationSearch: string, scopes: string[]) {\n  // Merge configured query params of token path with params given to current page\n  const currentQuery = parseQueryString(locationSearch);\n  const impersonationProps = cherryPickProps(currentQuery, IMPERSONATION_QUERY_PARAMS);\n  const [tokenPathWithoutQuery, tokenQueryString] = splitUrlAndQuery(tokenPath);\n  const tokenPathQuery = parseQueryString(tokenQueryString);\n  return tokenPathWithoutQuery + generateQueryString({\n    ...tokenPathQuery,\n    ...impersonationProps,\n    scopes: scopes.join(',')\n  });\n}\n\nfunction getTokenId(mergedTokenPath: string, userEmail: string) {\n  return mergedTokenPath + \"/\" + userEmail;\n}\n\nfunction saveUserInfo(user: User, tokenId: string) {\n  env.currentUser = user;\n  sessionStorage.setItem(\"userInfo\" + tokenId, JSON.stringify(user));\n}\n\nfunction loadUserInfo(tokenId: string) {\n  const storedSessionUser = sessionStorage.getItem(\"userInfo\" + tokenId);\n  if (storedSessionUser) {\n    env.currentUser = JSON.parse(storedSessionUser);\n  }\n}\n\nfunction createBearerProvider(mergedTokenPath: string, userEmail: string) {\n  const tokenId = getTokenId(mergedTokenPath, userEmail);\n  return new WebServerBearerProvider(mergedTokenPath, responseText => {\n    const res = JSON.parse(responseText) as { ok: boolean, error?: string, token?: string, user?: User };\n    if (!res.ok) throw new Error(res.error);\n    if (res.user) {\n      saveUserInfo(res.user, tokenId);\n    }\n    return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };\n  }, tokenId);\n}\n\nfunction createGoogleTokenProvider(mergedTokenPath: string, userEmail: string) {\n  const tokenId = getTokenId(mergedTokenPath, userEmail);\n  return new WebServerBearerProvider(mergedTokenPath, responseText => {\n    const res = JSON.parse(responseText) as { ok: boolean, error?: string, token?: string, user?: User };\n    if (!res.ok) throw new Error(res.error);\n    return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };\n  }, tokenId);\n}\n\nfunction createTestTokenProvider(tokenUrl: string, user: User, scopes: string[]) {\n  return new KedBearerProvider(\n    isomorphic,\n    storage,\n    tokenUrl + user.mail + location.search,\n    cfg.KED_CLIENT_ID,\n    cfg.KED_CLIENT_SECRET,\n    tokenUrl, {\n      email: user.mail.toLowerCase(),\n      roles: user.roles,\n      school: user.school,\n      schoolType: user.schoolType,\n      scopes\n    });\n}\n\n// env.currentUser.mail is set by SiteVision server initially.\n// A response from /api/token may change the mail attribute of the current\n// user, so env.currentUser.mail may be different after getting a response.\n// However, the initial value is valuable always in order to distinguish the case\n// when one normal user logs out and another user logs in.\nconst initialUserEmail = env.currentUser && env.currentUser.mail; // Initial value of mail. May change.\nif (initialUserEmail) {\n  // KED\n  if (cfg.KED_TOKEN_PATH) {\n    //\n    //\n    // Production / SiteVision proxied /api/token to request tokens from:\n    //\n    //\n    const mergedTokenPath = getMergedTokenPath(\n      cfg.KED_TOKEN_PATH,\n      location.search, [\n        \"kedbackend\",\n        \"EDS\",\n      ]);\n    env.bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);\n    loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));\n\n    // Google\n    const googleMergedPath = getMergedTokenPath(\n      cfg.KED_TOKEN_PATH,\n      location.search, [\n        \"https://www.googleapis.com/auth/calendar.readonly\",\n      ]);\n    env.googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);\n  } else if (cfg.KED_TOKEN_URL && cfg.KED_CLIENT_ID && cfg.KED_CLIENT_SECRET) {\n    //\n    //\n    // Test - go directly to KEDAUTH server to retrieve tokens\n    //\n    //\n    env.bearerProvider = createTestTokenProvider(cfg.KED_TOKEN_URL, env.currentUser, [\n      \"kedbackend\",\n      \"EDS\",\n    ]);\n    env.googleTokenProvider = createTestTokenProvider(cfg.KED_TOKEN_URL + \"/google\", env.currentUser, [\n      \"https://www.googleapis.com/auth/calendar.readonly\",\n    ]);\n  } else {\n    throw new Error(`Missing configuration parameter KED_TOKEN_PATH`);\n  }\n}\n","import * as React from 'react';\nimport { Course, School, UserHiddenCourse } from 'kedbackend/models';\nimport env from '../../globals/KED.env';\nimport { showError, flatten, compareProp, showInfo, L } from \"../../utils/utils\";\nimport { createUUID } from 'kedbackend/client';\nimport { Spinner } from \"../course-builder/sub-components/spinner\";\nimport { parseQueryString, generateQueryString } from \"../../utils/query-string\";\nimport { preserveImpersonationQuery } from '../../access-control/index';\nimport { hiddenCoursesRepo, CourseWithHiddenState } from '../../repos/hidden-courses-repo';\n\ninterface Props {\n  viewCourseUrl?: string;\n}\n\ninterface State {\n  isLoading: boolean\n  courses: CourseWithHiddenState[]\n  headerOpen: boolean\n}\n\nexport class ListCourses extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      courses: [],\n      headerOpen: false\n    };\n    this.updateHiddenCourses = this.updateHiddenCourses.bind(this);\n  }\n\n  componentWillMount() {\n    hiddenCoursesRepo.subscribe(this.updateHiddenCourses, {fullCourse: true});\n  }\n\n  componentWillUnmount() {\n    hiddenCoursesRepo.unsubscribe(this.updateHiddenCourses);\n  }\n\n  updateHiddenCourses(courses: CourseWithHiddenState[]) {\n    this.setState({courses, isLoading: false});\n  }\n\n  async hideCourse(course: CourseWithHiddenState) {\n    showInfo(L`Sparar...`);\n    await hiddenCoursesRepo.hideCourse(course);\n    showInfo(\"\");\n  }\n\n  async showCourse(course: CourseWithHiddenState) {\n    showInfo(L`Sparar...`);\n    await hiddenCoursesRepo.showCourse(course);\n    showInfo(\"\");\n  }\n\n  render() {\n    if (this.state.isLoading) return <Spinner />;\n    const {courses} = this.state;\n    const visibleCourses = courses.filter(course => course.visible);\n    const hiddenCourses = courses.filter(course => !course.visible);\n    const query = parseQueryString(location.search);\n    const viewCourseUrl = this.props.viewCourseUrl || \"\";\n\n    return <div className=\"ked_boxed\">\n      <h3>Skolans kurser</h3>\n      <div className=\"taskContainer odd-even\">\n        {visibleCourses.map(course =>\n          <div className=\"studentCourse\" key={course.id}>\n            <div className=\"align-horizontal\">\n              <div className=\"horizontalItem top pull-right\">\n                <a className=\"hideItem\" onClick={() => this.hideCourse(course)} />\n              </div>\n              <div className=\"horizontalItem top\">\n                <a href={preserveImpersonationQuery(viewCourseUrl, {courseId: course.id})}>{course.name}</a>\n              </div>\n            </div>\n            <div className=\"horizontalItem top\">\n              <p className=\"small\">{course.description}</p>\n            </div>\n          </div>)}\n      </div>\n\n      <div className={\"openClose\" + (this.state.headerOpen ? \" open\" : \"\")}>\n        <div className=\"openHeader\" onClick={() => this.setState({ headerOpen: !this.state.headerOpen })}>\n          <h5>Dolda kurser</h5>\n        </div>\n        <div className=\"openContent\">\n          <div className=\"taskContainer odd-even\">\n            {hiddenCourses.map(course => \n            <div className=\"studentCourse\" key={course.id}>\n              <div className=\"align-horizontal\">\n                <div className=\"horizontalItem top pull-right\">\n                  <a className=\"showItem\" onClick={() => this.showCourse(course)}></a>\n                </div>\n                <a href={generateQueryString({...query, courseId: course.id})}>{course.name}</a>\n              </div>\n              <div className=\"horizontalItem top\">\n                <p className=\"small\">{course.description}</p>\n              </div>\n            </div>)}\n          </div>\n        </div>\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport {L} from './utils';\nimport $ from 'jquery';\n\ninterface Props {\n}\n\ninterface State {\n  error: string | undefined;\n  info: string | undefined;\n}\n\nexport class ErrorSuccessFeedback extends React.Component<Props,State> {\n  constructor (props: Props) {\n    super(props);\n    this.state={\n      error: undefined,\n      info: undefined\n    };\n    this._unhandledRejection = this._unhandledRejection.bind(this);\n    this._error = this._error.bind(this);\n    this._customError = this._customError.bind(this);\n    this._onInfo = this._onInfo.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener('unhandledrejection', this._unhandledRejection);\n    window.addEventListener('error', this._error);\n    window.addEventListener('customerror', this._customError);\n    window.addEventListener('info', this._onInfo);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('unhandledrejection', this._unhandledRejection);\n    window.removeEventListener('error', this._error);\n    window.removeEventListener('customerror', this._customError);\n    window.removeEventListener('info', this._onInfo);\n  }\n\n  _unhandledRejection (ev: Event & {reason: Error}) {\n    this.setState({error: ev.reason ? ev.reason.message : L`Ett okänt fel inträffade...`, info: null});\n    setTimeout(()=>this.setState({error: null}), 10000);\n  }\n\n  _error (ev: Event & {error: Error}) {\n    this.setState({error: ev.error ? ev.error.message : L`Ett okänt fel inträffade...`, info: null});\n    setTimeout(()=>this.setState({error: null}), 10000);\n  }\n\n  _customError (ev: CustomEvent) {\n    this.setState({error: ev.detail, info: null});\n    setTimeout(()=>this.setState({error: null}), 10000);\n  }\n\n  _onInfo(ev: CustomEvent) {\n    this.setState({error: null, info: ev.detail });\n    setTimeout(()=>this.setState({info: null}), 10000);\n  } \n\n  render() {\n    return <div className=\"error-success-feedback\" style={{\n      position: \"fixed\",\n      left: 0,\n      top: 0,\n      width: \"100%\",\n      pointerEvents: 'none'\n    }}>\n      <div style={{display: 'table', margin: \"0 auto\"}}>\n        <p className=\"error\" style={{display: this.state.error ? \"\" : \"none\"}}>{this.state.error && this.state.error}</p>\n        <p className=\"info\" style={{display: this.state.info ? \"\" : \"none\"}}>{this.state.info}</p>\n      </div>\n    </div>;\n  }\n}\n","import * as React from 'react';\nimport { LearningModuleTask, TaskList } from './task-list';\n\ninterface Props {\n  commonTasks: LearningModuleTask[]\n  learningGoals: LearningGoal[]\n}\n\nexport interface LearningGoal {\n  name: string;\n  learningTasks: LearningModuleTask[];\n}\n\nexport class LearningGoalsList extends React.Component<Props> {\n  render() {\n    const {commonTasks, learningGoals} = this.props;\n    return <div>{learningGoals.map(lg => <div key={lg.name}>\n      <h5>{lg.name}</h5>\n      <TaskList learningTasks={lg.learningTasks} />\n    </div>)}\n    {commonTasks.length > 0 && <div>\n      {learningGoals.length > 0 && <h5>Övergripande</h5>}\n      <TaskList learningTasks={commonTasks} />\n    </div>}\n    </div>;\n  }\n}","import env from '../globals/KED.env';\nimport cfg from '../globals/KED.cfg';\nimport { isomorphic } from 'kedbackend/clientweb';\nimport { EdsClient } from '../apis/edsclient';\n\nenv.edsClient = new EdsClient (\n  isomorphic,\n  cfg.EDS_API_URL,\n  env.bearerProvider);\n\n","var map = {\n\t\"./en-au\": 47,\n\t\"./en-au.js\": 47,\n\t\"./en-ca\": 46,\n\t\"./en-ca.js\": 46,\n\t\"./en-gb\": 45,\n\t\"./en-gb.js\": 45,\n\t\"./en-ie\": 44,\n\t\"./en-ie.js\": 44,\n\t\"./en-nz\": 43,\n\t\"./en-nz.js\": 43,\n\t\"./sv\": 42,\n\t\"./sv.js\": 42\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\tvar module = __webpack_require__(id);\n\treturn module;\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error('Cannot find module \"' + req + '\".');\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 58;","import * as React from 'react';\nimport { Course } from 'kedbackend/models';\n\ntype Callback = ()=>void;\n\ninterface Props {\n  title: string,\n  backgroundImage: string,\n  tabs: {name: string | JSX.Element, key?: string, link: string}[],\n  activeTab: string\n}\n\nexport const CourseBanner = (props: Props) => {\n  const { title, backgroundImage, tabs, activeTab } = props;\n\n  return <div className=\"sv-row sv-layout sv-skip-spacer\">\n    <div className=\"sv-layout sv-skip-spacer sv-column-12\">\n      <div className=\"sv-script-portlet sv-portlet sv-skip-spacer\">\n        {backgroundImage && <style>{`\n        .pageHeader {\n          background-image: url('${backgroundImage}') !important;\n        }\n      `}</style>}\n        <div className=\"pageHeader\">\n          <a>\n            <h1>{title}</h1>\n          </a>\n          <div className=\"buttonsField\">\n            <div className=\"buttonsContainer\">\n              <div className=\"align-horizontal\"></div>\n              <div className='horizontalMenu'>\n                <ul>\n                  {tabs.map(({name, key, link}, idx) => {\n                    const isActive = activeTab === link;\n                    return <li key={key || (typeof name === 'string' ? name : idx)} className={isActive ? \"activePage\" : \"\"}>\n                      <a href={link}>{name}</a>\n                    </li>\n                  })}\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n}\n","import * as React from 'react';\nimport { KnowledgeRequirement } from 'kedbackend/models';\nimport { OpenCloseBox } from \"../../utility-components/open-close-box\";\n\ninterface Props {\n  title: string;\n  className?: string;\n  requirements: KnowledgeRequirement[];\n  includedIds?: {[id: string] : true};\n  headerOpen?: boolean;\n}\n\ninterface State {\n}\n\nexport class KnowledgeRequirementsTable extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {};\n  }\n\n  render() {\n    const { title, requirements, className, includedIds, headerOpen } = this.props;\n\n    const columns = [\"E\", \"C\", \"A\"];\n    const rows: KnowledgeRequirement[][] = [];\n    const reqs = requirements.slice();\n    let row: KnowledgeRequirement[] | null = null;\n    while (true) {\n      row = columns.map(grade => {\n        const pNext = reqs.findIndex(r => r.gradeStep.toUpperCase() === grade);\n        if (pNext < 0) return null;\n        const rv = reqs[pNext];\n        reqs.splice(pNext, 1);\n        return includedIds ?\n          (includedIds[rv.id] ? rv : undefined) :\n          rv;\n      });\n      if (row.every(r => r === null))\n        break;\n      if (!row.every(r => !r)) {\n        rows.push(row);\n      }\n    }\n\n    return <OpenCloseBox title={<p>{title}</p>} className={className} headerOpen={headerOpen}>\n      <table>\n        <thead>\n          <tr>\n            {columns.map(c => <th key={c}>{c}</th>)}\n          </tr>\n        </thead>\n        <tbody>\n          {rows.map((row,i) =>\n            <tr key={i}>\n              {row.map((column,j) =>\n                <td key={j} dangerouslySetInnerHTML={{__html: column ? column.name : \"\"}} />\n              )}\n            </tr>\n          )}\n        </tbody>\n      </table>\n    </OpenCloseBox>\n  }\n}\n","import * as React from 'react';\nimport { Ability } from 'kedbackend/models';\n\ninterface Props {\n  title: string;\n  subTitle?: string;\n  abilities: Ability[];\n  className?: string;\n  headerOpen?: boolean;\n}\n\ninterface State {\n  headerOpen: boolean;\n}\n\nexport class AbilitiesBox extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      headerOpen: props.headerOpen || false\n    };\n  }\n\n  render() {\n    const { title, subTitle, abilities, className } = this.props;\n    const { headerOpen } = this.state;\n\n    return <div className={(className||'') + \" openClose\" + (headerOpen ? \" open\" : \"\")}>\n      <div className=\"openHeader\" onClick={() => this.setState({ headerOpen: !this.state.headerOpen })}>\n        <p>{title}</p>\n      </div>\n      <div className=\"openContent\">\n        <div className=\"abilityList\">\n          {subTitle && <div className=\"contentHeader\">\n            <h5>{subTitle}</h5>\n          </div>}\n          {abilities.map(a =>\n            <div key={a.id} className=\"contentPart\">\n              <div className=\"contentText\">\n                <p dangerouslySetInnerHTML={{__html: a.name}} />\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>;\n  }\n}\n","import * as React from 'react';\nimport { CentralContent } from 'kedbackend/models';\n\ninterface Props {\n  title: string;\n  subTitle?: string;\n  centralContent: CentralContent[];\n  className?: string;\n  headerOpen?: boolean;\n}\n\ninterface State {\n  headerOpen: boolean;\n}\n\nexport class CentralContentBox extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      headerOpen: props.headerOpen || false\n    };\n  }\n\n  render() {\n    const { title, subTitle, centralContent, className } = this.props;\n    const { headerOpen } = this.state;\n\n    return <div className={(className || '') + \" openClose\" + (headerOpen ? \" open\" : \"\")}>\n      <div className=\"openHeader\" onClick={() => this.setState({ headerOpen: !this.state.headerOpen })}>\n        <p>{title}</p>\n      </div>\n      <div className=\"openContent\">\n        <div className=\"abilityList\">\n          {subTitle && <div className=\"contentHeader\">\n            <h5>{subTitle}</h5>\n          </div>}\n          {centralContent.map(cc =>\n            <div key={cc.id} className=\"contentPart\">\n              <div className=\"contentText\">\n                <p dangerouslySetInnerHTML={{__html: cc.name}} />\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>;\n  }\n}\n","import { CourseModule, Task } from \"kedbackend/models\";\n\nexport function getCustomizedTask(module: CourseModule, task: Task) {\n  return module.taskCustomizations ?\n    {...task, ...module.taskCustomizations[task.id]} :\n    task;\n}\n","import * as React from 'react';\nimport { L, arrayToLookup } from '../../../utils/utils';\nimport { Course, CourseModule, Task } from 'kedbackend/models';\nimport { KnowledgeRequirementsTable } from \"../subcomponents/knowledge-requirements-table\";\nimport getIncludedIds from '../utils/get-included-ids';\nimport { AbilitiesBox } from \"../subcomponents/abilities-box\";\nimport { CentralContentBox } from \"../subcomponents/central-content-box\";\nimport { LearningGoalsList } from '../subcomponents/learning-goals-list';\nimport { TaskList } from '../subcomponents/task-list';\nimport { getCustomizedTask } from './get-customized-task';\n\n// Views\n\ninterface Props {\n  course: Course;\n  module: CourseModule;\n}\n\ninterface State {\n}\n\nexport class CourseModulePage extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n    }\n  }\n\n  render() {\n    const { module, course } = this.props;\n    const incluedIds = getIncludedIds(module, course);\n    const learningTasks = module.taskIds\n      .map(id => course.tasks.find(t => t.id === id))\n      .filter(task => !!task)\n      .map(task => ({\n        id: task.id,\n        task: getCustomizedTask(module, task),\n        course,\n        name: task.name,\n        url: `#${encodeURIComponent(module.name.trim())}/${task.id}`, // Försättsbladets URL\n        courseName: course.name,\n        learningGoal: task.learningGoal || module.name,\n      }));\n    const assignmentTasks = learningTasks.filter(t => t.task && t.task.assignment);\n    const nonAssignmentTasks = learningTasks.filter(t => !t.task || !t.task.assignment);\n    const commonTasks = nonAssignmentTasks.filter(t => !t.task.learningGoal);\n    const learningGoals = arrayToLookup(\n      nonAssignmentTasks.filter(t => !!t.task.learningGoal),\n      t => t.learningGoal);\n    return <div>\n      <div className=\"sv-text-portlet sv-use-margins sv-skip-spacer\">\n        <div className=\"sv-text-portlet-content\">\n          <h1 className=\"h1\">{module.name}</h1>\n        </div>\n      </div>\n      <div className=\"sv-vertical sv-layout\">\n        <div dangerouslySetInnerHTML={{ __html: module.mandatoryContent }}>\n        </div>\n      </div>\n\n      <div className=\"sv-html-portlet sv-portlet\">\n        <div className=\"ked_boxed\">\n          <h3>Modulens kunskapskrav, förmågor och centrala innehåll</h3>\n          {(!!module.startWeek || !!module.endWeek) && <div className=\"week-period-div\">\n            <div>Startvecka</div>\n            <div>{module.startWeek || \"--\"}</div>\n            <div>Slutvecka</div>\n            <div>{module.endWeek || \"--\"}</div>\n            <br />\n          </div>}\n          <hr />\n\n          <KnowledgeRequirementsTable\n            title=\"I den här modulen bedöms följande kunskapskrav\"\n            requirements={course.knowledgeRequirements}\n            includedIds={incluedIds} />\n\n          <AbilitiesBox\n            title=\"Den här modulen behandlar följande förmågor\"\n            abilities={course.abilities.filter(a => incluedIds[a.id])} />\n\n          <CentralContentBox\n            title=\"Den här modulen behandlar följande centrala innehåll\"\n            centralContent={course.centralContent.filter(c => incluedIds[c.id])} />\n\n        </div>\n      </div>\n\n      {module.taskIds.length > 0 && <div className=\"sv-script-portlet sv-portlet\">\n        <div className=\"ked_boxed\">\n          {assignmentTasks.length === 0 ? undefined : <>\n            <h2>Inlämningsuppgifter</h2>\n            <hr />\n            <TaskList learningTasks={assignmentTasks} />\n          </>}\n          {nonAssignmentTasks.length === 0 ? undefined : <>\n            <h2>Uppgifter</h2>\n            <hr />\n            <LearningGoalsList\n              commonTasks={commonTasks}\n              learningGoals={Object.keys(learningGoals).map(learningGoal => ({\n                name: learningGoal,\n                learningTasks: learningGoals[learningGoal]\n              }))} />\n            </>}\n        </div>\n      </div>}\n      {module.resources.length > 0 && <div className=\"sv-html-portlet sv-portlet\">\n        <div className=\"ked_boxed\">\n          <h2>Resurser</h2>\n          <hr />\n          <div className=\"taskContainer\">{module.resources.map((r, idx) =>\n            <div className=\"align-horizontal\" key={idx}>\n              <div className=\"horizontalItem top\">\n                <a href={r.url}>{r.name}</a>\n              </div>\n            </div>)}\n          </div>\n        </div>\n      </div>}\n    </div>\n  }\n}\n","import {CourseModule, Course} from 'kedbackend/models';\n\nexport default function getIncludedIds (module: CourseModule, course: Course) {\n  const result = {};\n  course.tasks.filter(t => module.taskIds.indexOf(t.id) !== -1).forEach(task => {\n    task.abilities.forEach(({id}) => result[id] = true);\n    task.centralContent.forEach(({id}) => result[id] = true);\n    task.knowledgeRequirements.forEach(({id}) => result[id] = true);\n  });\n  return result;\n}\n","import * as React from 'react';\nimport {Resource} from 'kedbackend/models';\n\ninterface Props {\n  resources: Resource[];\n}\n\nexport class ResourceList extends React.Component<Props> {\n  constructor(props: Props) {\n    super(props);\n  }\n\n  render() {\n    const {resources} = this.props;\n    return <div>\n      <div className=\"taskContainer\">\n        {resources.map((resource, idx) => \n          <div className=\"align-horizontal\" key={idx}>\n            <div className=\"horizontalItem top\">\n              <a href={resource.url}>{resource.name}</a>\n            </div>\n          </div>)}\n     </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { L } from '../../../utils/utils';\nimport { Course, CourseModule } from 'kedbackend/models';\nimport env from '../../../globals/KED.env';\n// Views\nimport { AbilitiesBox } from '../subcomponents/abilities-box';\nimport { CentralContentBox } from '../subcomponents/central-content-box';\nimport { KnowledgeRequirementsTable } from '../subcomponents/knowledge-requirements-table';\nimport { ResourceList } from '../subcomponents/resource-list';\n\ninterface Props {\n  course: Course;\n}\n\ninterface State {\n}\n\nexport class RunUpPage extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {}\n  }\n\n  render() {\n    const { course } = this.props;\n    return <div>\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n          {course.runUpText && <div>\n            <h1>Upptakt</h1>\n            <p className=\"normal\" dangerouslySetInnerHTML={{__html: course.runUpText}} />\n          </div>}\n          {course.responsibleTeachers && course.responsibleTeachers.length > 0 && <div>\n            <h2>Lärare</h2>\n            {course.responsibleTeachers.map((teacher, i) =>\n              <p key={i}><a href={interpretTeacherUrl(teacher.url)}>{teacher.name}</a></p>\n            )}\n          </div>}\n          {course.workFlowLink && <a className=\"btn\" href={course.workFlowLink}>Arbetsgång</a>}\n          <br />\n          <br />\n          <AbilitiesBox\n            title=\"Ämnets förmågor\"\n            subTitle=\"Förmågor\"\n            abilities={course.abilities}\n            className=\"larger\" />\n\n          <CentralContentBox\n            title=\"Kursens centrala innehåll\"\n            subTitle=\"Centralt innehåll\"\n            centralContent={course.centralContent}\n            className=\"larger\" />\n\n          <KnowledgeRequirementsTable\n            title=\"Kursens kunskapskrav\"\n            requirements={course.knowledgeRequirements}\n            className=\"larger\" />\n\n        </div>\n        {course.resources.length > 0 && <div className=\"sv-html-portlet sv-portlet\">\n          <div className=\"ked_boxed\">\n            <h2>Resurser</h2>\n            <hr />\n            <ResourceList resources={course.resources} />\n          </div>\n        </div>}\n      </div>\n  }\n}\n\nfunction interpretTeacherUrl(url: string) {\n  if (url.indexOf(':') === -1 && url.indexOf('@') >= 0) return \"mailto:\" + url;\n  return url;\n}\n","let initialized = false;\n\nexport function initManualScrollRestoration() {\n  if (!initialized) {\n    initialized = true;\n    document.documentElement.addEventListener('click', ev => {\n      const target = ev.target as HTMLElement;\n      if (target && target.tagName === 'A') {\n        history.replaceState({ pageYOffset: window.pageYOffset }, null, null);\n      }\n    });\n    if (history.scrollRestoration) history.scrollRestoration = 'manual';\n  }\n}\n\nexport function restoreScrollPosition ({fallbackScrollPosition}) {\n  if (history.state && history.state.pageYOffset !== undefined) {\n    window.scrollTo(0, history.state.pageYOffset);\n  } else if (fallbackScrollPosition !== undefined) {\n    window.scrollTo(0, fallbackScrollPosition);\n  }\n}\n\n","import * as React from 'react';\nimport env from '../../../globals/KED.env';\nimport { Assignment } from 'kedbackend/models';\nimport { showError, compareProp, compareProps } from '../../../utils/utils';\nimport { Spinner } from '../../course-builder/sub-components/spinner';\nimport moment from 'moment';\nimport { HttpError } from 'kedbackend/client';\nimport { hasWriteAccess, isTeacherAtSchool } from '../../../access-control';\nimport download from 'downloadjs';\n\nconst MAX_FILE_SIZE_MB = 10;\nconst ALLOWED_EXTENSIONS = [\n  \".pdf\",\n  \".odt\",\n  \".docx\"\n];\n\ninterface Props {\n  courseId: string;\n  taskId: string;\n  school: string;\n}\n\ninterface State {\n  assignments: Assignment[];\n  loading: boolean;\n  uploadingFile?: File;\n  error?: string;\n}\n\nexport class TaskAssignments extends React.Component<Props, State> {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      assignments: [],\n      loading: true\n    };\n  }\n\n  setStatePromised(cb: (prevState: Readonly<State>, props: Props) => Partial<State>) {\n    return new Promise(resolve => super.setState(cb as any, resolve));\n  }  \n\n  componentDidMount() {\n    this.load();\n  }\n\n  async componentWillReceiveProps(nextProps: Props) {\n    try {\n      if (nextProps.taskId !== this.props.taskId ||\n          nextProps.courseId !== this.props.courseId)\n      {\n        await this.setStatePromised(()=>({\n          assignments: [],\n          loading: true\n        }));\n        await this.load();\n      }\n    } catch (err) {\n      showError(err);\n    }\n  }\n\n  async load() {\n    try {\n      const client = env.kedBackendClient.http;\n      const {courseId, taskId, school} = this.props;\n      const teacherAtSchool = isTeacherAtSchool(school);\n      const res = await (teacherAtSchool ?\n        client.get(`assignments/${courseId}/${taskId}`) :\n        client.get(`assignments/${courseId}/${taskId}/${env.currentUser.mail}`));\n      if (res.status !== 200) {\n        throw new HttpError(res.status, await res.text());\n      }\n\n      const assignments = await res.json() as Assignment[];\n      this.setState({\n        error: null,\n        loading: false,\n        assignments\n      });\n    } catch (error) {\n      this.setState({\n        loading: false,\n        error: `Kunde inte ladda inlämningsuppgifter`,\n        assignments: []\n      });\n      console.error(error);\n    }\n  }\n\n  onDrag (ev: React.DragEvent<HTMLDivElement>) {\n    ev.stopPropagation();\n    ev.preventDefault();\n    ev.dataTransfer.dropEffect = 'copy';\n  }\n  \n  async onDrop(ev: React.DragEvent<HTMLDivElement>) {\n    try {\n      ev.stopPropagation();\n      ev.preventDefault();\n      const file = ev.dataTransfer.files[0];\n      if (this.state.assignments.some(a =>\n        a.user === env.currentUser.mail &&\n        a.filename === file.name))\n      {\n        if (!confirm(`Ersätta befintlig fil (${file.name})?`)) {\n          return;\n        }\n      }\n      if (this.props.school.toLowerCase() !== env.currentUser.school.toLowerCase()) {\n        if (!confirm(`Uppgiften tillhör en annan skola (${this.props.school}).\\n`+\n          `Vill du ändå lämna in ditt arbete här?`))\n        {\n          return;\n        }\n      }\n      this.setState({uploadingFile: file});\n      await this.upload(file);\n      await this.load();\n      this.setState({\n        uploadingFile: null\n      });\n    } catch (error) {\n      this.setState({\n        error: \"Kunde inte ladda upp filen. \" + (error.message || error),\n        uploadingFile: null\n      });\n      console.error(error);\n    }\n  }\n  \n  async upload(file: File) {\n    const client = env.kedBackendClient.http;\n    const {courseId, taskId} = this.props;\n    const {mail} = env.currentUser;\n    if (file.size > MAX_FILE_SIZE_MB * 1024 * 1024) {\n      throw new Error(`Filen får inte vara större än ${MAX_FILE_SIZE_MB} MB`);\n    }\n    const lowerFilename = file.name.toLowerCase();\n    if (!ALLOWED_EXTENSIONS.some(ext => lowerFilename.endsWith(ext))) {\n      throw new Error(`Filens ändelse måste vara ${ALLOWED_EXTENSIONS.join(' / ')}`);\n    }\n    const body = new FormData();\n    body.append('files', file);\n    const res = await env.kedBackendClient.http.fetch(\n      `assignments/${courseId}/${taskId}/${mail}`,\n      'put',\n      {},\n      {userDisplayName: env.currentUser.displayName},\n      {\n        body\n      });\n    if (res.status !== 200) {\n      throw new HttpError(res.status, await res.text());\n    }\n  }\n\n  async download(file: Assignment) {\n    try {\n      const res = await env.kedBackendClient.http.fetch(file.mediaLink, 'get', {});\n      if (res.status >= 400) {\n        throw new HttpError(res.status, await res.text());\n      }\n      const blob = await res.blob();\n      download(blob, file.filename, file.contentType);\n    } catch (err) {\n      this.setState({error: \"Kunde inte ladda ned filen. \" + (err.message || err)});\n      console.error(err);\n    }    \n  }\n\n  async delete(url: string) {\n    try {\n      await this.setStatePromised(({assignments}) => ({assignments: assignments.map(a => a.mediaLink === url ?\n        {...a, metadata: {...a.metadata, $meta: 'delete'}} : {...a})}));\n      const res = await env.kedBackendClient.http.fetch(url, 'delete', {});\n      if (res.status >= 400) {\n        throw new HttpError(res.status, await res.text());\n      }\n      await this.load();\n    } catch (err) {\n      this.setState({error: \"Kunde inte ta bort filen. \" + (err.message || err)});\n      console.error(err);\n    }\n  }\n\n  render() {\n    const {courseId, taskId, school} = this.props;\n    const {loading, assignments, error, uploadingFile} = this.state;\n    const teacherAtThisSchool = isTeacherAtSchool(school);\n    let files = [...assignments];\n    if (uploadingFile) {\n      const virtualFile: Assignment = {\n        courseId,\n        taskId,\n        filename: uploadingFile.name,\n        size: uploadingFile.size,\n        user: env.currentUser.mail,\n        contentType: uploadingFile.type,\n        uploadDate: Date.now(),\n        mediaLink: `assignments/${courseId}/${taskId}/${env.currentUser.mail}/${uploadingFile.name}`,\n        metadata: {$meta: 'add'} as {[key: string]: string}\n      };\n      files = files.filter(file => file.mediaLink !== virtualFile.mediaLink);\n      files = [...files, virtualFile];\n    }\n    files = files.sort(compareProps([\"user\", \"filename\"], [\"sv\", \"en\"], {sensitivity: 'base'}));\n    \n    return (\n      <div onDragOver={ev => this.onDrag(ev)} onDrop={ev=>this.onDrop(ev)}>\n        {error ? <>\n          <p className=\"error\">{error}</p>\n        </>: undefined}\n        {loading ? <>\n          <Spinner /> Laddar inlämnade filer...\n        </> : files.length === 0 ?\n          teacherAtThisSchool ?\n            <p>Ingen elev har lämnat in något arbete ännu.</p> :\n            undefined\n        : <>\n          <table className=\"task-assignments-table\"><thead><tr>\n            {teacherAtThisSchool ? <th>Elev</th> : undefined}\n            <th>Filnamn</th>\n            <th>Inlämnat den</th>\n            <th>Status</th>\n            <th />\n          </tr></thead><tbody>{\n            files.map(file => <tr\n              key={file.mediaLink}\n              style={file.metadata.$meta ? {opacity: 0.5}: {}}\n            >\n              {teacherAtThisSchool ? <td>\n                <a href={`mailto:${file.user}`}>\n                  {file.metadata.userDisplayName || file.user}\n                </a>\n              </td> : undefined}\n              <td><a href=\"#\" onClick={ev => {\n                ev.preventDefault();\n                ev.stopPropagation();\n                this.download(file);\n              }}>{file.filename}</a></td>\n              <td>{moment(file.uploadDate).format('YYYY-MM-DD HH:mm')}</td>\n              <td>{file.metadata.$meta === 'add' ?\n                <><Spinner /> Laddar upp...</>:\n                file.metadata.$meta === 'delete' ?\n                <><Spinner /> Tar bort...</> :\n                <><i className=\"fa fas fa-check\" /> Inlämnad</>\n              }</td>\n              <td>{!file.metadata.$meta && file.user === env.currentUser.mail &&\n                <a href=\"#\" onClick={ev => {\n                  ev.stopPropagation();\n                  ev.preventDefault();\n                  this.delete(file.mediaLink);\n                }}><i className=\"fa fa-trash\"/></a>}</td>\n            </tr>)\n          }</tbody></table>\n        </>}\n        {teacherAtThisSchool ? undefined : <div className=\"drop-zone task-assignment-drop-zone\">\n            Droppa ditt färdiga arbete här<br/>\n            <b>(.pdf, .docx, .odt)</b>)\n          </div>}\n      </div>\n    );\n\n  }\n}","import * as React from 'react';\nimport { Task, Course, UserTask } from 'kedbackend/models';\nimport { AbilitiesBox } from \"../subcomponents/abilities-box\";\nimport { CentralContentBox } from \"../subcomponents/central-content-box\";\nimport { KnowledgeRequirementsTable } from \"../subcomponents/knowledge-requirements-table\";\nimport { userTasksRepo } from '../../../repos/user-tasks-repo';\nimport { L } from '../../../utils/utils';\nimport { createUUID, DocumentAccess } from 'kedbackend/client';\nimport env from '../../../globals/KED.env';\nimport moment from 'moment';\nimport { TaskAssignments } from './task-assignments';\nimport { isTeacherAtSchool } from '../../../access-control';\n\ninterface Props {\n  task: Task\n  course: Course\n}\n\ninterface State {\n  userTask: UserTask | null | undefined;\n  weekPlannerWeek: number;\n}\n\nexport class TaskPage extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      userTask: undefined,\n      weekPlannerWeek: moment().week()\n    };\n    this.onUserTasksChanged = this.onUserTasksChanged.bind(this);\n  }\n\n  componentDidMount() {\n    userTasksRepo.subscribe(this.onUserTasksChanged);\n  }\n\n  componentWillUnmount() {\n    userTasksRepo.unsubscribe(this.onUserTasksChanged);\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.task.id !== this.props.task.id) {\n      const userTask = userTasksRepo.mem.items.find(ut => ut.task && ut.task.length > 0 && ut.task[0].id === nextProps.task.id) || null;\n      this.setState({\n        userTask,\n        weekPlannerWeek: moment(userTasksRepo.persistedState.weekDate).week()\n      });\n    }\n  }\n\n  onUserTasksChanged(userTasks: UserTask[]) {\n    const userTask = userTasks.find(ut => ut.task && ut.task.length > 0 && ut.task[0].id === this.props.task.id) || null;\n    this.setState({\n      userTask,\n      weekPlannerWeek: moment(userTasksRepo.persistedState.weekDate).week()\n    });\n  }\n\n  async toggleTask () {\n    const { weekDate } = userTasksRepo.persistedState;\n    const { userTask } = this.state;\n    const { course, task } = this.props;\n    const module = course.modules.find(m => m.taskIds.some(id => id === task.id));\n    if (!module) return; // Oh uh!\n    if (userTask === undefined) return; // Not yet loaded.\n    if (!userTask) {\n      let latestTimeStamp = Math.max.apply(\n        Math.max,\n        [weekDate].concat(userTasksRepo.mem.items.map(t => t.dateTime)));\n\n      const userTask: UserTask = {\n        id: createUUID(),\n        courseName: course.name,\n        dateTime: latestTimeStamp + 2000,\n        learningGoal: task.learningGoal || module.name,\n        name: task.name,\n        url: task.url,\n        task: [task],\n        course: [course],\n        acl: [\n          // Default ACL: Let user self have full control over this item:\n          new DocumentAccess(\"email\", env.currentUser.mail, \"S\"),\n          // Additional ACL: Let employees on same school have read access to it.\n          // This currently only applies to tasks that refer to course tasks (not own tasks!)\n          new DocumentAccess(\"schoolRole\", `${env.currentUser.school}/EMPLOYEE`, \"R\")\n        ].map(ac => ac.toString())\n      };\n      if (task.deadline) {\n        userTask.deadline = task.deadline;\n      }\n      await Promise.all([\n        userTasksRepo.setWeekPlannerBoxOpen(this.props.course.name, true),\n        userTasksRepo.insert([userTask])]);\n    } else {\n      await userTasksRepo.delete([userTask.id]);\n    }\n  }\n\n  render() {\n    const { task, course } = this.props;\n    const { userTask, weekPlannerWeek } = this.state;\n    const abilities = task.abilities.map(a => course.abilities.find(ab => ab.id === a.id)).filter(a => !!a);\n    const centralContent = task.centralContent.map(c => course.centralContent.find(cc => cc.id == c.id)).filter(c => !!c);\n    const requirements = task.knowledgeRequirements.map(k => course.knowledgeRequirements.find(kr => kr.id === k.id)).filter(k => !!k);\n    const isWorking = userTask && (userTask.$meta === 'adding' || userTask.$meta === 'deleting');\n    const currentWeek = moment().week();\n    const forWeekString = weekPlannerWeek === currentWeek ? \"loggboken\" :\n      weekPlannerWeek === currentWeek + 1 ? L`vald vecka (nästa vecka)` :\n      weekPlannerWeek === currentWeek - 1 ? L`vald vecka (förra veckan)` :\n      L`vald vecka (v ${weekPlannerWeek})`;\n    const deadlineTooLate = task.deadline && moment(task.deadline).endOf('day') < moment();\n\n    return <div>\n      <div className=\"sv-text-portlet sv-use-margins sv-skip-spacer\">\n        <div className=\"sv-text-portlet-content\">\n          <h1 className=\"h1\">{task.name}</h1>\n        </div>\n      </div>\n      <div className=\"sv-html-portlet sv-portlet\">\n        {task.content && <>\n          <div dangerouslySetInnerHTML={{__html: task.content}} />\n        </>}\n        {task.learningGoal && <div><h2>Uppgiftens lärandemål</h2>\n          <p>{task.learningGoal}</p>\n        </div>}\n        {task.url && <a href={task.url} className=\"btn btn-large\">Gå till uppgiften</a>}\n      </div>\n      <br/>\n      {task.assignment ? <>\n        <h2>Inlämningsuppgift</h2>\n        {isTeacherAtSchool(course.school) ?\n          <p>Här kan du som lärare se elevernas inlämnade arbeten.\n          </p> : <>\n            <p>Det här är en inlämningsuppgift. Lämna in ditt arbete som en pdf, doc eller odt fil\n              genom att dra det till fältet under.\n            </p>\n            {task.deadline ? <p><b>\n              Den här uppgiften {deadlineTooLate ? 'skulle varit inlämnad ' : 'skall vara inlämnad '}\n              {moment(task.deadline).format('YYYY MM DD')}\n            </b></p> : undefined}\n            </>}\n          <TaskAssignments\n            courseId={course.id}\n            taskId={task.id}\n            school={course.school}\n           />\n        <br/>\n      </> : undefined}\n      <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n        {abilities.length > 0 && <AbilitiesBox\n            title=\"Den här uppgiften behandlar följande förmågor\"\n            className=\"larger\"\n            headerOpen={false}\n            abilities={abilities} />}\n\n        {centralContent.length > 0 && <CentralContentBox\n            title=\"Den här uppgiften behandlar följande centrala innehåll\"\n            className=\"larger\"\n            headerOpen={false}\n            centralContent={centralContent} />}\n\n        {requirements.length > 0 && <KnowledgeRequirementsTable\n          title=\"I den här uppgiften bedöms följande kunskapskrav\"\n          className=\"larger\"\n          headerOpen={true}\n          requirements={requirements}\n          />}\n      </div>      \n      <hr/>\n      {userTask !== undefined && <div className=\"taskContainer\">\n          <div className=\"align-horizontal\">\n            <div className=\"horizontalItem top\">\n                <div\n                  className={`selectedBox${userTask && userTask.$meta !== 'deleting' ? ' selected' : ''}`}\n                  style={isWorking ? {opacity: 0.5}: {}}\n                  onClick={()=>!isWorking && this.toggleTask()}>\n                </div>\n            </div>\n            <div className=\"horizontalItem top\">\n              {userTask ?\n                L`Ta bort uppgiften från ${forWeekString}`:\n                L`Lägg till uppgiften i ${forWeekString}`}\n            </div>\n          </div>\n        </div>}\n      <hr/>\n      {task.resources && task.resources.length > 0 && <div className=\"sv-html-portlet sv-portlet\">\n        <h2>Resurser kopplade till uppgiften</h2>\n        <div className=\"taskContainer\">\n          {task.resources.map((r, idx) =>\n            <div key={idx} className=\"align-horizontal\">\n              <div className=\"horizontalItem top\">\n                <a href={r.url}>{r.name}</a>\n              </div>\n            </div>\n          )}\n        </div>\n        <br />\n      </div>}\n\n \n      <br /><br /><br /><br /><br /><br /><br /><br /><br />\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { L, showError } from '../../../utils/utils';\nimport { CourseBanner } from \"./course-banner\";\nimport { Course, CourseModule, Task } from 'kedbackend/models';\nimport { parseHashQueryString } from \"../../../utils/query-string\";\nimport { CourseModulePage } from './course-module-page';\nimport { RunUpPage } from './run-up-page';\nimport { initManualScrollRestoration, restoreScrollPosition } from '../utils/manual-scroll-restoration';\nimport { hasWriteAccess, preserveImpersonationQuery } from '../../../access-control';\nimport { WeekPlanner } from \"../../weekplanner\";\nimport { TaskPage } from \"./task-page\";\nimport { getCustomizedTask } from './get-customized-task';\n\ninterface Props {\n  course: Course;\n  courseBuilderUrl: string;\n}\n\ninterface State {\n  module: CourseModule | null;\n  task: Task | null;\n}\n\n\ninitManualScrollRestoration();\n\nexport class CoursePage extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.onHashChange = this.onHashChange.bind(this);\n    const {module, task} = this.getModuleAndTaskFromHash();\n    this.state = {\n      module,\n      task\n    };\n  }\n\n  getModuleAndTaskFromHash() {\n    let split = (location.hash.substr(1) || \"\").split('/');\n    if (split.length > 0 && !split[0]) split = split.slice(1); // Allow leading slash #/module/task\n    const [moduleName, taskId] = split.map(part => decodeURIComponent(part));\n    let module = this.props.course.modules\n      .filter(m => (m.name || \"\")\n        .trim().toLowerCase() === (moduleName || \"\").trim().toLowerCase())[0] || null;\n    let task = taskId ?\n      this.props.course.tasks.find(t => t.id === taskId) || null :\n      null;\n    if (task && !module) {\n      // Resolve module by finding the module that holds the task:\n      module = this.getOrderedModules()\n        .filter(m => m.taskIds\n          .some(taskId => task.id === taskId))[0];\n    }\n    if (task && module) {\n      task = getCustomizedTask(module, task);\n    }\n    return {module, task};\n  }\n\n  componentDidMount() {\n    window.addEventListener('hashchange', this.onHashChange);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('hashchange', this.onHashChange);\n  }\n\n  onHashChange() {\n    const {module, task} = this.getModuleAndTaskFromHash();\n    this.setState({\n      module,\n      task\n    }, ()=>{\n      \n      let fallbackScrollPosition = undefined;\n      if (task) {\n        const taskAnchor = document.getElementById('ked-task-anchor');\n        if (taskAnchor) fallbackScrollPosition = (window.pageYOffset + taskAnchor.getBoundingClientRect().top);\n        else fallbackScrollPosition = 0;\n      }\n      restoreScrollPosition({fallbackScrollPosition});\n    });\n  }\n\n  getOrderedModules() {\n    const { course } = this.props;\n    const moduleOrder = course.moduleOrder || course.modules.map(m => m.id);\n    return moduleOrder\n      // Map ordered id to module\n      .map(id => course.modules.find(m => m.id === id))\n      // Ignore entries that only exists in moduleOrder but not in modules\n      .filter(m => !!m)\n      // Append modules at end that are not listed in moduleOrder\n      .concat (course.modules.filter(m => !moduleOrder.find(id => m.id === id)));\n  }  \n\n  render() {\n    const {course, courseBuilderUrl} = this.props;\n    const {module, task} = this.state;\n    const orderedModules = this.getOrderedModules();\n    return <div>\n      <CourseBanner\n        title={course.name + \" - \" + course.points + \"p\"}\n        backgroundImage={(course.images.find(img => img.id === course.imageId) || {url:''}).url}\n        tabs={[{name: \"Upptakt\" as string | JSX.Element, link: \"#\", key: \"Upptakt\"}]\n          .concat(orderedModules.map(({ name }) => ({ name, link: \"#\" + encodeURIComponent(name), key: name })))\n          .concat(course.workFlowLink ? [{\n            name: \"Arbetsgång\",\n            key: \"workflow\",\n            link: course.workFlowLink\n          }] : [])\n          .concat(hasWriteAccess(course) ? [{\n            name: <span><i className=\"fa fa-pencil\" aria-hidden=\"true\"></i> Redigera denna kurs</span>,\n            key: \"edit\",\n            link: `${preserveImpersonationQuery(courseBuilderUrl, {})}#/courses/${course.id}/edit`}] : [])\n\n        }\n        activeTab={module ? \"#\"+encodeURIComponent(module.name) : \"#\"}\n      />\n      <div className=\"sv-row sv-layout\"\n        //id=\"ked-task-anchor\" // For window.scrollTo to position here!. Skipping this. scroll to top instead!\n      >\n        <div className=\"sv-layout sv-skip-spacer sv-column-12\">\n          <div className=\"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer\">\n            <div className=\"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer\">\n              <div className=\"sv-row sv-layout sv-skip-spacer\">\n                <div className=\"sv-layout sv-skip-spacer sv-column-7\">\n                  {task ?\n                    <TaskPage task={task} course={course} /> :\n                   module ?\n                    <CourseModulePage course={course} module={module} /> :\n                    <RunUpPage course={course} />}\n                </div>\n                <div className=\"sv-layout sv-column-5\">\n                  <div className=\"sv-vertical sv-layout sv-skip-spacer\">\n                    <div className=\"sv-html-portlet sv-portlet sv-skip-spacer\">\n                      <WeekPlanner viewCourseUrl={''} />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  }\n}\n","import * as React from 'react';\nimport { CourseBanner } from \"../course-viewer/course-page/course-banner\";\nimport { ListCourses } from './list-courses';\nimport { L } from \"../../utils/utils\";\nimport env from '../../globals/KED.env';\n\nexport function ListCoursesPage() {\n  return <div className=\"sv-html-portlet sv-portlet\">\n    <CourseBanner\n      title={env.currentUser.school}\n      backgroundImage=\"\"\n      tabs={[{ name: \"Skolans kurser\", link: \"#\" }]}\n      activeTab={\"#\"}\n    />\n    <div className=\"sv-row sv-layout\">\n      <div className=\"sv-layout sv-skip-spacer sv-column-12\">\n        <div className=\"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer\">\n          <ListCourses />\n        </div>\n      </div>\n    </div>\n  </div>\n}","import * as React from 'react';\nimport { L, showError } from '../../utils/utils';\nimport { ErrorSuccessFeedback } from '../../utils/error-success-feedback';\nimport env from '../../globals/KED.env';\nimport { Course } from 'kedbackend/models';\nimport { loadCourse } from \"../course-builder/utils\";\nimport { Spinner } from \"../course-builder/sub-components/spinner\";\nimport { CoursePage } from \"./course-page\";\nimport { parseQueryString } from \"../../utils/query-string\";\nimport { ListCoursesPage } from '../list-courses/list-courses-page';\n\ninterface Props {\n  courseBuilderUrl?: string;\n}\n\ninterface State {\n  course: Course | null,\n  isLoading: boolean\n}\n\nexport class CourseViewer extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      course: null,\n      isLoading: true\n    }\n  }\n\n  componentWillMount() {\n    this.load().catch(showError)\n      .then(()=>this.setState({isLoading: false}));\n  }\n\n  async load() {\n    const courseId = parseQueryString(location.search)[\"courseId\"];\n    const course = courseId ? await loadCourse (courseId) : null;\n    this.setState({course});\n  }\n\n  render() {\n    return <div className=\"course-viewer\">\n      {this.state.isLoading ?\n        <Spinner /> :\n        this.state.course ?\n          <CoursePage\n            course={this.state.course} \n            courseBuilderUrl={this.props.courseBuilderUrl} /> :\n          <ListCoursesPage />\n      }\n      <ErrorSuccessFeedback />\n    </div>\n  }\n}\n","import '../../global-setters/set-bearer-providers';\nconst bearerPromise = env.bearerProvider.getBearer(); // Start getting bearer as soon as possible.\nimport '../../global-setters/set-ked-backend-client';\nimport '../../global-setters/set-eds-client';\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport env from '../../globals/KED.env';\nimport { CourseViewer } from '../../components/course-viewer';\nimport $ from 'jquery';\nimport { showError, showInfo } from \"../../utils/utils\";\nimport { Spinner } from \"../../components/course-builder/sub-components/spinner\"; // TODO: Move outside of course-builder!\n\ninterface Props {\n  courseBuilderUrl: string;\n}\n\ninterface State {\n  isTokenLoaded: boolean;\n}\n\nexport class KEDAppCourseViewer extends React.Component<Props,State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      isTokenLoaded: false\n    }\n  }\n\n  componentWillMount() {\n    bearerPromise.then(()=>{\n      this.setState({isTokenLoaded: true});\n    }).catch(err => {\n      showError(err);\n    });\n  }\n\n  render() {\n    return this.state.isTokenLoaded ?\n      <CourseViewer courseBuilderUrl={this.props.courseBuilderUrl} /> :\n      <p><Spinner/>V.g. vänta... autenticerar...</p>\n  }\n}\n","import KED from '../../globals/KED';\nimport * as components from './app.courseviewer.client';\nKED.components = {...KED.components, ...components};\n"],"sourceRoot":""}